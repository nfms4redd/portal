/*!
 * jQuery JavaScript Library v2.1.0
 * http://jquery.com/
 *
 * Includes Sizzle.js
 * http://sizzlejs.com/
 *
 * Copyright 2005, 2014 jQuery Foundation, Inc. and other contributors
 * Released under the MIT license
 * http://jquery.org/license
 *
 * Date: 2014-01-23T21:10Z
 */

/*!
 * Sizzle CSS Selector Engine v1.10.16
 * http://sizzlejs.com/
 *
 * Copyright 2013 jQuery Foundation, Inc. and other contributors
 * Released under the MIT license
 * http://jquery.org/license
 *
 * Date: 2014-01-13
 */

/*

  OpenLayers.js -- OpenLayers Map Viewer Library

  Copyright (c) 2006-2012 by OpenLayers Contributors
  Published under the 2-clause BSD license.
  See http://openlayers.org/dev/license.txt for the full text of the license, and http://openlayers.org/dev/authors.txt for full list of contributors.

  Includes compressed code under the following licenses:

  (For uncompressed versions of the code used, please see the
  OpenLayers Github repository: <https://github.com/openlayers/openlayers>)

*/

/**
 * Contains XMLHttpRequest.js <http://code.google.com/p/xmlhttprequest/>
 * Copyright 2007 Sergey Ilinsky (http://www.ilinsky.com)
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * http://www.apache.org/licenses/LICENSE-2.0
 */

/**
 * OpenLayers.Util.pagePosition is based on Yahoo's getXY method, which is
 * Copyright (c) 2006, Yahoo! Inc.
 * All rights reserved.
 * 
 * Redistribution and use of this software in source and binary forms, with or
 * without modification, are permitted provided that the following conditions
 * are met:
 * 
 * * Redistributions of source code must retain the above copyright notice,
 *   this list of conditions and the following disclaimer.
 * 
 * * Redistributions in binary form must reproduce the above copyright notice,
 *   this list of conditions and the following disclaimer in the documentation
 *   and/or other materials provided with the distribution.
 * 
 * * Neither the name of Yahoo! Inc. nor the names of its contributors may be
 *   used to endorse or promote products derived from this software without
 *   specific prior written permission of Yahoo! Inc.
 * 
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
 * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
 * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE
 * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
 * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
 * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
 * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE 
 * POSSIBILITY OF SUCH DAMAGE.
 */

/* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */

/**
 * Function: pagePosition
 * Calculates the position of an element on the page (see
 * http://code.google.com/p/doctype/wiki/ArticlePageOffset)
 *
 * OpenLayers.Util.pagePosition is based on Yahoo's getXY method, which is
 * Copyright (c) 2006, Yahoo! Inc.
 * All rights reserved.
 * 
 * Redistribution and use of this software in source and binary forms, with or
 * without modification, are permitted provided that the following conditions
 * are met:
 * 
 * * Redistributions of source code must retain the above copyright notice,
 *   this list of conditions and the following disclaimer.
 * 
 * * Redistributions in binary form must reproduce the above copyright notice,
 *   this list of conditions and the following disclaimer in the documentation
 *   and/or other materials provided with the distribution.
 * 
 * * Neither the name of Yahoo! Inc. nor the names of its contributors may be
 *   used to endorse or promote products derived from this software without
 *   specific prior written permission of Yahoo! Inc.
 * 
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
 * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
 * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE
 * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
 * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
 * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
 * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE 
 * POSSIBILITY OF SUCH DAMAGE.
 *
 * Parameters:
 * forElement - {DOMElement}
 * 
 * Returns:
 * {Array} two item array, Left value then Top value.
 */

/**
 * APIFunction: getScrollbarWidth
 * This function has been modified by the OpenLayers from the original version,
 *     written by Matthew Eernisse and released under the Apache 2 
 *     license here:
 * 
 *     http://www.fleegix.org/articles/2006/05/30/getting-the-scrollbar-width-in-pixels
 * 
 *     It has been modified simply to cache its value, since it is physically 
 *     impossible that this code could ever run in more than one browser at 
 *     once. 
 * 
 * Returns:
 * {Integer}
 */

/**
 * Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. 
 *
 * @requires OpenLayers/SingleFile.js
 */

// XMLHttpRequest.js Copyright (C) 2010 Sergey Ilinsky (http://www.ilinsky.com)
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
//   http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

/*!
 * mustache.js - Logic-less {{mustache}} templates with JavaScript
 * http://github.com/janl/mustache.js
 */

/*! jQuery UI - v1.10.4 - 2014-01-28
* http://jqueryui.com
* Includes: jquery.ui.core.js, jquery.ui.widget.js, jquery.ui.mouse.js, jquery.ui.position.js, jquery.ui.draggable.js, jquery.ui.resizable.js, jquery.ui.accordion.js, jquery.ui.button.js, jquery.ui.dialog.js, jquery.ui.slider.js
* Copyright 2014 jQuery Foundation and other contributors; Licensed MIT */

/*! fancyBox v2.1.5 fancyapps.com | fancyapps.com/fancybox/#license */

(function(e,t){typeof module=="object"&&typeof module.exports=="object"?module.exports=e.document?t(e,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return t(e)}:t(e)})(typeof window!="undefined"?window:this,function(window,noGlobal){function isArraylike(e){var t=e.length,n=jQuery.type(e);return n==="function"||jQuery.isWindow(e)?!1:e.nodeType===1&&t?!0:n==="array"||t===0||typeof t=="number"&&t>0&&t-1 in e}function winnow(e,t,n){if(jQuery.isFunction(t))return jQuery.grep(e,function(e,r){return!!t.call(e,r,e)!==n});if(t.nodeType)return jQuery.grep(e,function(e){return e===t!==n});if(typeof t=="string"){if(risSimple.test(t))return jQuery.filter(t,e,n);t=jQuery.filter(t,e)}return jQuery.grep(e,function(e){return indexOf.call(t,e)>=0!==n})}function sibling(e,t){while((e=e[t])&&e.nodeType!==1);return e}function createOptions(e){var t=optionsCache[e]={};return jQuery.each(e.match(rnotwhite)||[],function(e,n){t[n]=!0}),t}function completed(){document.removeEventListener("DOMContentLoaded",completed,!1),window.removeEventListener("load",completed,!1),jQuery.ready()}function Data(){Object.defineProperty(this.cache={},0,{get:function(){return{}}}),this.expando=jQuery.expando+Math.random()}function dataAttr(e,t,n){var r;if(n===undefined&&e.nodeType===1){r="data-"+t.replace(rmultiDash,"-$1").toLowerCase(),n=e.getAttribute(r);if(typeof n=="string"){try{n=n==="true"?!0:n==="false"?!1:n==="null"?null:+n+""===n?+n:rbrace.test(n)?jQuery.parseJSON(n):n}catch(i){}data_user.set(e,t,n)}else n=undefined}return n}function returnTrue(){return!0}function returnFalse(){return!1}function safeActiveElement(){try{return document.activeElement}catch(e){}}function manipulationTarget(e,t){return jQuery.nodeName(e,"table")&&jQuery.nodeName(t.nodeType!==11?t:t.firstChild,"tr")?e.getElementsByTagName("tbody")[0]||e.appendChild(e.ownerDocument.createElement("tbody")):e}function disableScript(e){return e.type=(e.getAttribute("type")!==null)+"/"+e.type,e}function restoreScript(e){var t=rscriptTypeMasked.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function setGlobalEval(e,t){var n=0,r=e.length;for(;n<r;n++)data_priv.set(e[n],"globalEval",!t||data_priv.get(t[n],"globalEval"))}function cloneCopyEvent(e,t){var n,r,i,s,o,u,a,f;if(t.nodeType!==1)return;if(data_priv.hasData(e)){s=data_priv.access(e),o=data_priv.set(t,s),f=s.events;if(f){delete o.handle,o.events={};for(i in f)for(n=0,r=f[i].length;n<r;n++)jQuery.event.add(t,i,f[i][n])}}data_user.hasData(e)&&(u=data_user.access(e),a=jQuery.extend({},u),data_user.set(t,a))}function getAll(e,t){var n=e.getElementsByTagName?e.getElementsByTagName(t||"*"):e.querySelectorAll?e.querySelectorAll(t||"*"):[];return t===undefined||t&&jQuery.nodeName(e,t)?jQuery.merge([e],n):n}function fixInput(e,t){var n=t.nodeName.toLowerCase();if(n==="input"&&rcheckableType.test(e.type))t.checked=e.checked;else if(n==="input"||n==="textarea")t.defaultValue=e.defaultValue}function actualDisplay(e,t){var n=jQuery(t.createElement(e)).appendTo(t.body),r=window.getDefaultComputedStyle?window.getDefaultComputedStyle(n[0]).display:jQuery.css(n[0],"display");return n.detach(),r}function defaultDisplay(e){var t=document,n=elemdisplay[e];if(!n){n=actualDisplay(e,t);if(n==="none"||!n)iframe=(iframe||jQuery("<iframe frameborder='0' width='0' height='0'/>")).appendTo(t.documentElement),t=iframe[0].contentDocument,t.write(),t.close(),n=actualDisplay(e,t),iframe.detach();elemdisplay[e]=n}return n}function curCSS(e,t,n){var r,i,s,o,u=e.style;return n=n||getStyles(e),n&&(o=n.getPropertyValue(t)||n[t]),n&&(o===""&&!jQuery.contains(e.ownerDocument,e)&&(o=jQuery.style(e,t)),rnumnonpx.test(o)&&rmargin.test(t)&&(r=u.width,i=u.minWidth,s=u.maxWidth,u.minWidth=u.maxWidth=u.width=o,o=n.width,u.width=r,u.minWidth=i,u.maxWidth=s)),o!==undefined?o+"":o}function addGetHookIf(e,t){return{get:function(){if(e()){delete this.get;return}return(this.get=t).apply(this,arguments)}}}function vendorPropName(e,t){if(t in e)return t;var n=t[0].toUpperCase()+t.slice(1),r=t,i=cssPrefixes.length;while(i--){t=cssPrefixes[i]+n;if(t in e)return t}return r}function setPositiveNumber(e,t,n){var r=rnumsplit.exec(t);return r?Math.max(0,r[1]-(n||0))+(r[2]||"px"):t}function augmentWidthOrHeight(e,t,n,r,i){var s=n===(r?"border":"content")?4:t==="width"?1:0,o=0;for(;s<4;s+=2)n==="margin"&&(o+=jQuery.css(e,n+cssExpand[s],!0,i)),r?(n==="content"&&(o-=jQuery.css(e,"padding"+cssExpand[s],!0,i)),n!=="margin"&&(o-=jQuery.css(e,"border"+cssExpand[s]+"Width",!0,i))):(o+=jQuery.css(e,"padding"+cssExpand[s],!0,i),n!=="padding"&&(o+=jQuery.css(e,"border"+cssExpand[s]+"Width",!0,i)));return o}function getWidthOrHeight(e,t,n){var r=!0,i=t==="width"?e.offsetWidth:e.offsetHeight,s=getStyles(e),o=jQuery.css(e,"boxSizing",!1,s)==="border-box";if(i<=0||i==null){i=curCSS(e,t,s);if(i<0||i==null)i=e.style[t];if(rnumnonpx.test(i))return i;r=o&&(support.boxSizingReliable()||i===e.style[t]),i=parseFloat(i)||0}return i+augmentWidthOrHeight(e,t,n||(o?"border":"content"),r,s)+"px"}function showHide(e,t){var n,r,i,s=[],o=0,u=e.length;for(;o<u;o++){r=e[o];if(!r.style)continue;s[o]=data_priv.get(r,"olddisplay"),n=r.style.display,t?(!s[o]&&n==="none"&&(r.style.display=""),r.style.display===""&&isHidden(r)&&(s[o]=data_priv.access(r,"olddisplay",defaultDisplay(r.nodeName)))):s[o]||(i=isHidden(r),(n&&n!=="none"||!i)&&data_priv.set(r,"olddisplay",i?n:jQuery.css(r,"display")))}for(o=0;o<u;o++){r=e[o];if(!r.style)continue;if(!t||r.style.display==="none"||r.style.display==="")r.style.display=t?s[o]||"":"none"}return e}function Tween(e,t,n,r,i){return new Tween.prototype.init(e,t,n,r,i)}function createFxNow(){return setTimeout(function(){fxNow=undefined}),fxNow=jQuery.now()}function genFx(e,t){var n,r=0,i={height:e};t=t?1:0;for(;r<4;r+=2-t)n=cssExpand[r],i["margin"+n]=i["padding"+n]=e;return t&&(i.opacity=i.width=e),i}function createTween(e,t,n){var r,i=(tweeners[t]||[]).concat(tweeners["*"]),s=0,o=i.length;for(;s<o;s++)if(r=i[s].call(n,t,e))return r}function defaultPrefilter(e,t,n){var r,i,s,o,u,a,f,l=this,c={},h=e.style,p=e.nodeType&&isHidden(e),d=data_priv.get(e,"fxshow");n.queue||(u=jQuery._queueHooks(e,"fx"),u.unqueued==null&&(u.unqueued=0,a=u.empty.fire,u.empty.fire=function(){u.unqueued||a()}),u.unqueued++,l.always(function(){l.always(function(){u.unqueued--,jQuery.queue(e,"fx").length||u.empty.fire()})})),e.nodeType===1&&("height"in t||"width"in t)&&(n.overflow=[h.overflow,h.overflowX,h.overflowY],f=jQuery.css(e,"display"),f==="none"&&(f=defaultDisplay(e.nodeName)),f==="inline"&&jQuery.css(e,"float")==="none"&&(h.display="inline-block")),n.overflow&&(h.overflow="hidden",l.always(function(){h.overflow=n.overflow[0],h.overflowX=n.overflow[1],h.overflowY=n.overflow[2]}));for(r in t){i=t[r];if(rfxtypes.exec(i)){delete t[r],s=s||i==="toggle";if(i===(p?"hide":"show")){if(i!=="show"||!d||d[r]===undefined)continue;p=!0}c[r]=d&&d[r]||jQuery.style(e,r)}}if(!jQuery.isEmptyObject(c)){d?"hidden"in d&&(p=d.hidden):d=data_priv.access(e,"fxshow",{}),s&&(d.hidden=!p),p?jQuery(e).show():l.done(function(){jQuery(e).hide()}),l.done(function(){var t;data_priv.remove(e,"fxshow");for(t in c)jQuery.style(e,t,c[t])});for(r in c)o=createTween(p?d[r]:0,r,l),r in d||(d[r]=o.start,p&&(o.end=o.start,o.start=r==="width"||r==="height"?1:0))}}function propFilter(e,t){var n,r,i,s,o;for(n in e){r=jQuery.camelCase(n),i=t[r],s=e[n],jQuery.isArray(s)&&(i=s[1],s=e[n]=s[0]),n!==r&&(e[r]=s,delete e[n]),o=jQuery.cssHooks[r];if(o&&"expand"in o){s=o.expand(s),delete e[r];for(n in s)n in e||(e[n]=s[n],t[n]=i)}else t[r]=i}}function Animation(e,t,n){var r,i,s=0,o=animationPrefilters.length,u=jQuery.Deferred().always(function(){delete a.elem}),a=function(){if(i)return!1;var t=fxNow||createFxNow(),n=Math.max(0,f.startTime+f.duration-t),r=n/f.duration||0,s=1-r,o=0,a=f.tweens.length;for(;o<a;o++)f.tweens[o].run(s);return u.notifyWith(e,[f,s,n]),s<1&&a?n:(u.resolveWith(e,[f]),!1)},f=u.promise({elem:e,props:jQuery.extend({},t),opts:jQuery.extend(!0,{specialEasing:{}},n),originalProperties:t,originalOptions:n,startTime:fxNow||createFxNow(),duration:n.duration,tweens:[],createTween:function(t,n){var r=jQuery.Tween(e,f.opts,t,n,f.opts.specialEasing[t]||f.opts.easing);return f.tweens.push(r),r},stop:function(t){var n=0,r=t?f.tweens.length:0;if(i)return this;i=!0;for(;n<r;n++)f.tweens[n].run(1);return t?u.resolveWith(e,[f,t]):u.rejectWith(e,[f,t]),this}}),l=f.props;propFilter(l,f.opts.specialEasing);for(;s<o;s++){r=animationPrefilters[s].call(f,e,l,f.opts);if(r)return r}return jQuery.map(l,createTween,f),jQuery.isFunction(f.opts.start)&&f.opts.start.call(e,f),jQuery.fx.timer(jQuery.extend(a,{elem:e,anim:f,queue:f.opts.queue})),f.progress(f.opts.progress).done(f.opts.done,f.opts.complete).fail(f.opts.fail).always(f.opts.always)}function addToPrefiltersOrTransports(e){return function(t,n){typeof t!="string"&&(n=t,t="*");var r,i=0,s=t.toLowerCase().match(rnotwhite)||[];if(jQuery.isFunction(n))while(r=s[i++])r[0]==="+"?(r=r.slice(1)||"*",(e[r]=e[r]||[]).unshift(n)):(e[r]=e[r]||[]).push(n)}}function inspectPrefiltersOrTransports(e,t,n,r){function o(u){var a;return i[u]=!0,jQuery.each(e[u]||[],function(e,u){var f=u(t,n,r);if(typeof f=="string"&&!s&&!i[f])return t.dataTypes.unshift(f),o(f),!1;if(s)return!(a=f)}),a}var i={},s=e===transports;return o(t.dataTypes[0])||!i["*"]&&o("*")}function ajaxExtend(e,t){var n,r,i=jQuery.ajaxSettings.flatOptions||{};for(n in t)t[n]!==undefined&&((i[n]?e:r||(r={}))[n]=t[n]);return r&&jQuery.extend(!0,e,r),e}function ajaxHandleResponses(e,t,n){var r,i,s,o,u=e.contents,a=e.dataTypes;while(a[0]==="*")a.shift(),r===undefined&&(r=e.mimeType||t.getResponseHeader("Content-Type"));if(r)for(i in u)if(u[i]&&u[i].test(r)){a.unshift(i);break}if(a[0]in n)s=a[0];else{for(i in n){if(!a[0]||e.converters[i+" "+a[0]]){s=i;break}o||(o=i)}s=s||o}if(s)return s!==a[0]&&a.unshift(s),n[s]}function ajaxConvert(e,t,n,r){var i,s,o,u,a,f={},l=e.dataTypes.slice();if(l[1])for(o in e.converters)f[o.toLowerCase()]=e.converters[o];s=l.shift();while(s){e.responseFields[s]&&(n[e.responseFields[s]]=t),!a&&r&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),a=s,s=l.shift();if(s)if(s==="*")s=a;else if(a!=="*"&&a!==s){o=f[a+" "+s]||f["* "+s];if(!o)for(i in f){u=i.split(" ");if(u[1]===s){o=f[a+" "+u[0]]||f["* "+u[0]];if(o){o===!0?o=f[i]:f[i]!==!0&&(s=u[0],l.unshift(u[1]));break}}}if(o!==!0)if(o&&e["throws"])t=o(t);else try{t=o(t)}catch(c){return{state:"parsererror",error:o?c:"No conversion from "+a+" to "+s}}}}return{state:"success",data:t}}function buildParams(e,t,n,r){var i;if(jQuery.isArray(t))jQuery.each(t,function(t,i){n||rbracket.test(e)?r(e,i):buildParams(e+"["+(typeof i=="object"?t:"")+"]",i,n,r)});else if(!n&&jQuery.type(t)==="object")for(i in t)buildParams(e+"["+i+"]",t[i],n,r);else r(e,t)}function getWindow(e){return jQuery.isWindow(e)?e:e.nodeType===9&&e.defaultView}var arr=[],slice=arr.slice,concat=arr.concat,push=arr.push,indexOf=arr.indexOf,class2type={},toString=class2type.toString,hasOwn=class2type.hasOwnProperty,trim="".trim,support={},document=window.document,version="2.1.0",jQuery=function(e,t){return new jQuery.fn.init(e,t)},rmsPrefix=/^-ms-/,rdashAlpha=/-([\da-z])/gi,fcamelCase=function(e,t){return t.toUpperCase()};jQuery.fn=jQuery.prototype={jquery:version,constructor:jQuery,selector:"",length:0,toArray:function(){return slice.call(this)},get:function(e){return e!=null?e<0?this[e+this.length]:this[e]:slice.call(this)},pushStack:function(e){var t=jQuery.merge(this.constructor(),e);return t.prevObject=this,t.context=this.context,t},each:function(e,t){return jQuery.each(this,e,t)},map:function(e){return this.pushStack(jQuery.map(this,function(t,n){return e.call(t,n,t)}))},slice:function(){return this.pushStack(slice.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,n=+e+(e<0?t:0);return this.pushStack(n>=0&&n<t?[this[n]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:push,sort:arr.sort,splice:arr.splice},jQuery.extend=jQuery.fn.extend=function(){var e,t,n,r,i,s,o=arguments[0]||{},u=1,a=arguments.length,f=!1;typeof o=="boolean"&&(f=o,o=arguments[u]||{},u++),typeof o!="object"&&!jQuery.isFunction(o)&&(o={}),u===a&&(o=this,u--);for(;u<a;u++)if((e=arguments[u])!=null)for(t in e){n=o[t],r=e[t];if(o===r)continue;f&&r&&(jQuery.isPlainObject(r)||(i=jQuery.isArray(r)))?(i?(i=!1,s=n&&jQuery.isArray(n)?n:[]):s=n&&jQuery.isPlainObject(n)?n:{},o[t]=jQuery.extend(f,s,r)):r!==undefined&&(o[t]=r)}return o},jQuery.extend({expando:"jQuery"+(version+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isFunction:function(e){return jQuery.type(e)==="function"},isArray:Array.isArray,isWindow:function(e){return e!=null&&e===e.window},isNumeric:function(e){return e-parseFloat(e)>=0},isPlainObject:function(e){if(jQuery.type(e)!=="object"||e.nodeType||jQuery.isWindow(e))return!1;try{if(e.constructor&&!hasOwn.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(t){return!1}return!0},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},type:function(e){return e==null?e+"":typeof e=="object"||typeof e=="function"?class2type[toString.call(e)]||"object":typeof e},globalEval:function(code){var script,indirect=eval;code=jQuery.trim(code),code&&(code.indexOf("use strict")===1?(script=document.createElement("script"),script.text=code,document.head.appendChild(script).parentNode.removeChild(script)):indirect(code))},camelCase:function(e){return e.replace(rmsPrefix,"ms-").replace(rdashAlpha,fcamelCase)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t,n){var r,i=0,s=e.length,o=isArraylike(e);if(n)if(o)for(;i<s;i++){r=t.apply(e[i],n);if(r===!1)break}else for(i in e){r=t.apply(e[i],n);if(r===!1)break}else if(o)for(;i<s;i++){r=t.call(e[i],i,e[i]);if(r===!1)break}else for(i in e){r=t.call(e[i],i,e[i]);if(r===!1)break}return e},trim:function(e){return e==null?"":trim.call(e)},makeArray:function(e,t){var n=t||[];return e!=null&&(isArraylike(Object(e))?jQuery.merge(n,typeof e=="string"?[e]:e):push.call(n,e)),n},inArray:function(e,t,n){return t==null?-1:indexOf.call(t,e,n)},merge:function(e,t){var n=+t.length,r=0,i=e.length;for(;r<n;r++)e[i++]=t[r];return e.length=i,e},grep:function(e,t,n){var r,i=[],s=0,o=e.length,u=!n;for(;s<o;s++)r=!t(e[s],s),r!==u&&i.push(e[s]);return i},map:function(e,t,n){var r,i=0,s=e.length,o=isArraylike(e),u=[];if(o)for(;i<s;i++)r=t(e[i],i,n),r!=null&&u.push(r);else for(i in e)r=t(e[i],i,n),r!=null&&u.push(r);return concat.apply([],u)},guid:1,proxy:function(e,t){var n,r,i;return typeof t=="string"&&(n=e[t],t=e,e=n),jQuery.isFunction(e)?(r=slice.call(arguments,2),i=function(){return e.apply(t||this,r.concat(slice.call(arguments)))},i.guid=e.guid=e.guid||jQuery.guid++,i):undefined},now:Date.now,support:support}),jQuery.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){class2type["[object "+t+"]"]=t.toLowerCase()});var Sizzle=function(e){function rt(e,t,r,i){var s,o,u,a,f,h,v,m,w,E;(t?t.ownerDocument||t:b)!==c&&l(t),t=t||c,r=r||[];if(!e||typeof e!="string")return r;if((a=t.nodeType)!==1&&a!==9)return[];if(p&&!i){if(s=G.exec(e))if(u=s[1]){if(a===9){o=t.getElementById(u);if(!o||!o.parentNode)return r;if(o.id===u)return r.push(o),r}else if(t.ownerDocument&&(o=t.ownerDocument.getElementById(u))&&g(t,o)&&o.id===u)return r.push(o),r}else{if(s[2])return _.apply(r,t.getElementsByTagName(e)),r;if((u=s[3])&&n.getElementsByClassName&&t.getElementsByClassName)return _.apply(r,t.getElementsByClassName(u)),r}if(n.qsa&&(!d||!d.test(e))){m=v=y,w=t,E=a===9&&e;if(a===1&&t.nodeName.toLowerCase()!=="object"){h=dt(e),(v=t.getAttribute("id"))?m=v.replace(Z,"\\$&"):t.setAttribute("id",m),m="[id='"+m+"'] ",f=h.length;while(f--)h[f]=m+vt(h[f]);w=Y.test(e)&&ht(t.parentNode)||t,E=h.join(",")}if(E)try{return _.apply(r,w.querySelectorAll(E)),r}catch(S){}finally{v||t.removeAttribute("id")}}}return xt(e.replace(R,"$1"),t,r,i)}function it(){function t(n,i){return e.push(n+" ")>r.cacheLength&&delete t[e.shift()],t[n+" "]=i}var e=[];return t}function st(e){return e[y]=!0,e}function ot(e){var t=c.createElement("div");try{return!!e(t)}catch(n){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function ut(e,t){var n=e.split("|"),i=e.length;while(i--)r.attrHandle[n[i]]=t}function at(e,t){var n=t&&e,r=n&&e.nodeType===1&&t.nodeType===1&&(~t.sourceIndex||k)-(~e.sourceIndex||k);if(r)return r;if(n)while(n=n.nextSibling)if(n===t)return-1;return e?1:-1}function ft(e){return function(t){var n=t.nodeName.toLowerCase();return n==="input"&&t.type===e}}function lt(e){return function(t){var n=t.nodeName.toLowerCase();return(n==="input"||n==="button")&&t.type===e}}function ct(e){return st(function(t){return t=+t,st(function(n,r){var i,s=e([],n.length,t),o=s.length;while(o--)n[i=s[o]]&&(n[i]=!(r[i]=n[i]))})})}function ht(e){return e&&typeof e.getElementsByTagName!==C&&e}function pt(){}function dt(e,t){var n,i,s,o,u,a,f,l=x[e+" "];if(l)return t?0:l.slice(0);u=e,a=[],f=r.preFilter;while(u){if(!n||(i=U.exec(u)))i&&(u=u.slice(i[0].length)||u),a.push(s=[]);n=!1;if(i=z.exec(u))n=i.shift(),s.push({value:n,type:i[0].replace(R," ")}),u=u.slice(n.length);for(o in r.filter)(i=$[o].exec(u))&&(!f[o]||(i=f[o](i)))&&(n=i.shift(),s.push({value:n,type:o,matches:i}),u=u.slice(n.length));if(!n)break}return t?u.length:u?rt.error(e):x(e,a).slice(0)}function vt(e){var t=0,n=e.length,r="";for(;t<n;t++)r+=e[t].value;return r}function mt(e,t,n){var r=t.dir,i=n&&r==="parentNode",s=E++;return t.first?function(t,n,s){while(t=t[r])if(t.nodeType===1||i)return e(t,n,s)}:function(t,n,o){var u,a,f=[w,s];if(o){while(t=t[r])if(t.nodeType===1||i)if(e(t,n,o))return!0}else while(t=t[r])if(t.nodeType===1||i){a=t[y]||(t[y]={});if((u=a[r])&&u[0]===w&&u[1]===s)return f[2]=u[2];a[r]=f;if(f[2]=e(t,n,o))return!0}}}function gt(e){return e.length>1?function(t,n,r){var i=e.length;while(i--)if(!e[i](t,n,r))return!1;return!0}:e[0]}function yt(e,t,n,r,i){var s,o=[],u=0,a=e.length,f=t!=null;for(;u<a;u++)if(s=e[u])if(!n||n(s,r,i))o.push(s),f&&t.push(u);return o}function bt(e,t,n,r,i,s){return r&&!r[y]&&(r=bt(r)),i&&!i[y]&&(i=bt(i,s)),st(function(s,o,u,a){var f,l,c,h=[],p=[],d=o.length,v=s||St(t||"*",u.nodeType?[u]:u,[]),m=e&&(s||!t)?yt(v,h,e,u,a):v,g=n?i||(s?e:d||r)?[]:o:m;n&&n(m,g,u,a);if(r){f=yt(g,p),r(f,[],u,a),l=f.length;while(l--)if(c=f[l])g[p[l]]=!(m[p[l]]=c)}if(s){if(i||e){if(i){f=[],l=g.length;while(l--)(c=g[l])&&f.push(m[l]=c);i(null,g=[],f,a)}l=g.length;while(l--)(c=g[l])&&(f=i?P.call(s,c):h[l])>-1&&(s[f]=!(o[f]=c))}}else g=yt(g===o?g.splice(d,g.length):g),i?i(null,o,g,a):_.apply(o,g)})}function wt(e){var t,n,i,s=e.length,o=r.relative[e[0].type],a=o||r.relative[" "],f=o?1:0,l=mt(function(e){return e===t},a,!0),c=mt(function(e){return P.call(t,e)>-1},a,!0),h=[function(e,n,r){return!o&&(r||n!==u)||((t=n).nodeType?l(e,n,r):c(e,n,r))}];for(;f<s;f++)if(n=r.relative[e[f].type])h=[mt(gt(h),n)];else{n=r.filter[e[f].type].apply(null,e[f].matches);if(n[y]){i=++f;for(;i<s;i++)if(r.relative[e[i].type])break;return bt(f>1&&gt(h),f>1&&vt(e.slice(0,f-1).concat({value:e[f-2].type===" "?"*":""})).replace(R,"$1"),n,f<i&&wt(e.slice(f,i)),i<s&&wt(e=e.slice(i)),i<s&&vt(e))}h.push(n)}return gt(h)}function Et(e,t){var n=t.length>0,i=e.length>0,s=function(s,o,a,f,l){var h,p,d,v=0,m="0",g=s&&[],y=[],b=u,E=s||i&&r.find.TAG("*",l),S=w+=b==null?1:Math.random()||.1,x=E.length;l&&(u=o!==c&&o);for(;m!==x&&(h=E[m])!=null;m++){if(i&&h){p=0;while(d=e[p++])if(d(h,o,a)){f.push(h);break}l&&(w=S)}n&&((h=!d&&h)&&v--,s&&g.push(h))}v+=m;if(n&&m!==v){p=0;while(d=t[p++])d(g,y,o,a);if(s){if(v>0)while(m--)!g[m]&&!y[m]&&(y[m]=O.call(f));y=yt(y)}_.apply(f,y),l&&!s&&y.length>0&&v+t.length>1&&rt.uniqueSort(f)}return l&&(w=S,u=b),g};return n?st(s):s}function St(e,t,n){var r=0,i=t.length;for(;r<i;r++)rt(e,t[r],n);return n}function xt(e,t,i,s){var u,a,f,l,c,h=dt(e);if(!s&&h.length===1){a=h[0]=h[0].slice(0);if(a.length>2&&(f=a[0]).type==="ID"&&n.getById&&t.nodeType===9&&p&&r.relative[a[1].type]){t=(r.find.ID(f.matches[0].replace(et,tt),t)||[])[0];if(!t)return i;e=e.slice(a.shift().value.length)}u=$.needsContext.test(e)?0:a.length;while(u--){f=a[u];if(r.relative[l=f.type])break;if(c=r.find[l])if(s=c(f.matches[0].replace(et,tt),Y.test(a[0].type)&&ht(t.parentNode)||t)){a.splice(u,1),e=s.length&&vt(a);if(!e)return _.apply(i,s),i;break}}}return o(e,h)(s,t,!p,i,Y.test(e)&&ht(t.parentNode)||t),i}var t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y="sizzle"+ -(new Date),b=e.document,w=0,E=0,S=it(),x=it(),T=it(),N=function(e,t){return e===t&&(f=!0),0},C=typeof undefined,k=1<<31,L={}.hasOwnProperty,A=[],O=A.pop,M=A.push,_=A.push,D=A.slice,P=A.indexOf||function(e){var t=0,n=this.length;for(;t<n;t++)if(this[t]===e)return t;return-1},H="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",B="[\\x20\\t\\r\\n\\f]",j="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",F=j.replace("w","w#"),I="\\["+B+"*("+j+")"+B+"*(?:([*^$|!~]?=)"+B+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+F+")|)|)"+B+"*\\]",q=":("+j+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+I.replace(3,8)+")*)|.*)\\)|)",R=new RegExp("^"+B+"+|((?:^|[^\\\\])(?:\\\\.)*)"+B+"+$","g"),U=new RegExp("^"+B+"*,"+B+"*"),z=new RegExp("^"+B+"*([>+~]|"+B+")"+B+"*"),W=new RegExp("="+B+"*([^\\]'\"]*?)"+B+"*\\]","g"),X=new RegExp(q),V=new RegExp("^"+F+"$"),$={ID:new RegExp("^#("+j+")"),CLASS:new RegExp("^\\.("+j+")"),TAG:new RegExp("^("+j.replace("w","w*")+")"),ATTR:new RegExp("^"+I),PSEUDO:new RegExp("^"+q),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+B+"*(even|odd|(([+-]|)(\\d*)n|)"+B+"*(?:([+-]|)"+B+"*(\\d+)|))"+B+"*\\)|)","i"),bool:new RegExp("^(?:"+H+")$","i"),needsContext:new RegExp("^"+B+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+B+"*((?:-\\d)?\\d*)"+B+"*\\)|)(?=[^-]|$)","i")},J=/^(?:input|select|textarea|button)$/i,K=/^h\d$/i,Q=/^[^{]+\{\s*\[native \w/,G=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,Y=/[+~]/,Z=/'|\\/g,et=new RegExp("\\\\([\\da-f]{1,6}"+B+"?|("+B+")|.)","ig"),tt=function(e,t,n){var r="0x"+t-65536;return r!==r||n?t:r<0?String.fromCharCode(r+65536):String.fromCharCode(r>>10|55296,r&1023|56320)};try{_.apply(A=D.call(b.childNodes),b.childNodes),A[b.childNodes.length].nodeType}catch(nt){_={apply:A.length?function(e,t){M.apply(e,D.call(t))}:function(e,t){var n=e.length,r=0;while(e[n++]=t[r++]);e.length=n-1}}}n=rt.support={},s=rt.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return t?t.nodeName!=="HTML":!1},l=rt.setDocument=function(e){var t,i=e?e.ownerDocument||e:b,o=i.defaultView;if(i===c||i.nodeType!==9||!i.documentElement)return c;c=i,h=i.documentElement,p=!s(i),o&&o!==o.top&&(o.addEventListener?o.addEventListener("unload",function(){l()},!1):o.attachEvent&&o.attachEvent("onunload",function(){l()})),n.attributes=ot(function(e){return e.className="i",!e.getAttribute("className")}),n.getElementsByTagName=ot(function(e){return e.appendChild(i.createComment("")),!e.getElementsByTagName("*").length}),n.getElementsByClassName=Q.test(i.getElementsByClassName)&&ot(function(e){return e.innerHTML="<div class='a'></div><div class='a i'></div>",e.firstChild.className="i",e.getElementsByClassName("i").length===2}),n.getById=ot(function(e){return h.appendChild(e).id=y,!i.getElementsByName||!i.getElementsByName(y).length}),n.getById?(r.find.ID=function(e,t){if(typeof t.getElementById!==C&&p){var n=t.getElementById(e);return n&&n.parentNode?[n]:[]}},r.filter.ID=function(e){var t=e.replace(et,tt);return function(e){return e.getAttribute("id")===t}}):(delete r.find.ID,r.filter.ID=function(e){var t=e.replace(et,tt);return function(e){var n=typeof e.getAttributeNode!==C&&e.getAttributeNode("id");return n&&n.value===t}}),r.find.TAG=n.getElementsByTagName?function(e,t){if(typeof t.getElementsByTagName!==C)return t.getElementsByTagName(e)}:function(e,t){var n,r=[],i=0,s=t.getElementsByTagName(e);if(e==="*"){while(n=s[i++])n.nodeType===1&&r.push(n);return r}return s},r.find.CLASS=n.getElementsByClassName&&function(e,t){if(typeof t.getElementsByClassName!==C&&p)return t.getElementsByClassName(e)},v=[],d=[];if(n.qsa=Q.test(i.querySelectorAll))ot(function(e){e.innerHTML="<select t=''><option selected=''></option></select>",e.querySelectorAll("[t^='']").length&&d.push("[*^$]="+B+"*(?:''|\"\")"),e.querySelectorAll("[selected]").length||d.push("\\["+B+"*(?:value|"+H+")"),e.querySelectorAll(":checked").length||d.push(":checked")}),ot(function(e){var t=i.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&d.push("name"+B+"*[*^$|!~]?="),e.querySelectorAll(":enabled").length||d.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),d.push(",.*:")});return(n.matchesSelector=Q.test(m=h.webkitMatchesSelector||h.mozMatchesSelector||h.oMatchesSelector||h.msMatchesSelector))&&ot(function(e){n.disconnectedMatch=m.call(e,"div"),m.call(e,"[s!='']:x"),v.push("!=",q)}),d=d.length&&new RegExp(d.join("|")),v=v.length&&new RegExp(v.join("|")),t=Q.test(h.compareDocumentPosition),g=t||Q.test(h.contains)?function(e,t){var n=e.nodeType===9?e.documentElement:e,r=t&&t.parentNode;return e===r||!!r&&r.nodeType===1&&!!(n.contains?n.contains(r):e.compareDocumentPosition&&e.compareDocumentPosition(r)&16)}:function(e,t){if(t)while(t=t.parentNode)if(t===e)return!0;return!1},N=t?function(e,t){if(e===t)return f=!0,0;var r=!e.compareDocumentPosition-!t.compareDocumentPosition;return r?r:(r=(e.ownerDocument||e)===(t.ownerDocument||t)?e.compareDocumentPosition(t):1,r&1||!n.sortDetached&&t.compareDocumentPosition(e)===r?e===i||e.ownerDocument===b&&g(b,e)?-1:t===i||t.ownerDocument===b&&g(b,t)?1:a?P.call(a,e)-P.call(a,t):0:r&4?-1:1)}:function(e,t){if(e===t)return f=!0,0;var n,r=0,s=e.parentNode,o=t.parentNode,u=[e],l=[t];if(!s||!o)return e===i?-1:t===i?1:s?-1:o?1:a?P.call(a,e)-P.call(a,t):0;if(s===o)return at(e,t);n=e;while(n=n.parentNode)u.unshift(n);n=t;while(n=n.parentNode)l.unshift(n);while(u[r]===l[r])r++;return r?at(u[r],l[r]):u[r]===b?-1:l[r]===b?1:0},i},rt.matches=function(e,t){return rt(e,null,null,t)},rt.matchesSelector=function(e,t){(e.ownerDocument||e)!==c&&l(e),t=t.replace(W,"='$1']");if(n.matchesSelector&&p&&(!v||!v.test(t))&&(!d||!d.test(t)))try{var r=m.call(e,t);if(r||n.disconnectedMatch||e.document&&e.document.nodeType!==11)return r}catch(i){}return rt(t,c,null,[e]).length>0},rt.contains=function(e,t){return(e.ownerDocument||e)!==c&&l(e),g(e,t)},rt.attr=function(e,t){(e.ownerDocument||e)!==c&&l(e);var i=r.attrHandle[t.toLowerCase()],s=i&&L.call(r.attrHandle,t.toLowerCase())?i(e,t,!p):undefined;return s!==undefined?s:n.attributes||!p?e.getAttribute(t):(s=e.getAttributeNode(t))&&s.specified?s.value:null},rt.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},rt.uniqueSort=function(e){var t,r=[],i=0,s=0;f=!n.detectDuplicates,a=!n.sortStable&&e.slice(0),e.sort(N);if(f){while(t=e[s++])t===e[s]&&(i=r.push(s));while(i--)e.splice(r[i],1)}return a=null,e},i=rt.getText=function(e){var t,n="",r=0,s=e.nodeType;if(!s)while(t=e[r++])n+=i(t);else if(s===1||s===9||s===11){if(typeof e.textContent=="string")return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=i(e)}else if(s===3||s===4)return e.nodeValue;return n},r=rt.selectors={cacheLength:50,createPseudo:st,match:$,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(et,tt),e[3]=(e[4]||e[5]||"").replace(et,tt),e[2]==="~="&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),e[1].slice(0,3)==="nth"?(e[3]||rt.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*(e[3]==="even"||e[3]==="odd")),e[5]=+(e[7]+e[8]||e[3]==="odd")):e[3]&&rt.error(e[0]),e},PSEUDO:function(e){var t,n=!e[5]&&e[2];return $.CHILD.test(e[0])?null:(e[3]&&e[4]!==undefined?e[2]=e[4]:n&&X.test(n)&&(t=dt(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(et,tt).toLowerCase();return e==="*"?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=S[e+" "];return t||(t=new RegExp("(^|"+B+")"+e+"("+B+"|$)"))&&S(e,function(e){return t.test(typeof e.className=="string"&&e.className||typeof e.getAttribute!==C&&e.getAttribute("class")||"")})},ATTR:function(e,t,n){return function(r){var i=rt.attr(r,e);return i==null?t==="!=":t?(i+="",t==="="?i===n:t==="!="?i!==n:t==="^="?n&&i.indexOf(n)===0:t==="*="?n&&i.indexOf(n)>-1:t==="$="?n&&i.slice(-n.length)===n:t==="~="?(" "+i+" ").indexOf(n)>-1:t==="|="?i===n||i.slice(0,n.length+1)===n+"-":!1):!0}},CHILD:function(e,t,n,r,i){var s=e.slice(0,3)!=="nth",o=e.slice(-4)!=="last",u=t==="of-type";return r===1&&i===0?function(e){return!!e.parentNode}:function(t,n,a){var f,l,c,h,p,d,v=s!==o?"nextSibling":"previousSibling",m=t.parentNode,g=u&&t.nodeName.toLowerCase(),b=!a&&!u;if(m){if(s){while(v){c=t;while(c=c[v])if(u?c.nodeName.toLowerCase()===g:c.nodeType===1)return!1;d=v=e==="only"&&!d&&"nextSibling"}return!0}d=[o?m.firstChild:m.lastChild];if(o&&b){l=m[y]||(m[y]={}),f=l[e]||[],p=f[0]===w&&f[1],h=f[0]===w&&f[2],c=p&&m.childNodes[p];while(c=++p&&c&&c[v]||(h=p=0)||d.pop())if(c.nodeType===1&&++h&&c===t){l[e]=[w,p,h];break}}else if(b&&(f=(t[y]||(t[y]={}))[e])&&f[0]===w)h=f[1];else while(c=++p&&c&&c[v]||(h=p=0)||d.pop())if((u?c.nodeName.toLowerCase()===g:c.nodeType===1)&&++h){b&&((c[y]||(c[y]={}))[e]=[w,h]);if(c===t)break}return h-=i,h===r||h%r===0&&h/r>=0}}},PSEUDO:function(e,t){var n,i=r.pseudos[e]||r.setFilters[e.toLowerCase()]||rt.error("unsupported pseudo: "+e);return i[y]?i(t):i.length>1?(n=[e,e,"",t],r.setFilters.hasOwnProperty(e.toLowerCase())?st(function(e,n){var r,s=i(e,t),o=s.length;while(o--)r=P.call(e,s[o]),e[r]=!(n[r]=s[o])}):function(e){return i(e,0,n)}):i}},pseudos:{not:st(function(e){var t=[],n=[],r=o(e.replace(R,"$1"));return r[y]?st(function(e,t,n,i){var s,o=r(e,null,i,[]),u=e.length;while(u--)if(s=o[u])e[u]=!(t[u]=s)}):function(e,i,s){return t[0]=e,r(t,null,s,n),!n.pop()}}),has:st(function(e){return function(t){return rt(e,t).length>0}}),contains:st(function(e){return function(t){return(t.textContent||t.innerText||i(t)).indexOf(e)>-1}}),lang:st(function(e){return V.test(e||"")||rt.error("unsupported lang: "+e),e=e.replace(et,tt).toLowerCase(),function(t){var n;do if(n=p?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return n=n.toLowerCase(),n===e||n.indexOf(e+"-")===0;while((t=t.parentNode)&&t.nodeType===1);return!1}}),target:function(t){var n=e.location&&e.location.hash;return n&&n.slice(1)===t.id},root:function(e){return e===h},focus:function(e){return e===c.activeElement&&(!c.hasFocus||c.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return e.disabled===!1},disabled:function(e){return e.disabled===!0},checked:function(e){var t=e.nodeName.toLowerCase();return t==="input"&&!!e.checked||t==="option"&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!r.pseudos.empty(e)},header:function(e){return K.test(e.nodeName)},input:function(e){return J.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return t==="input"&&e.type==="button"||t==="button"},text:function(e){var t;return e.nodeName.toLowerCase()==="input"&&e.type==="text"&&((t=e.getAttribute("type"))==null||t.toLowerCase()==="text")},first:ct(function(){return[0]}),last:ct(function(e,t){return[t-1]}),eq:ct(function(e,t,n){return[n<0?n+t:n]}),even:ct(function(e,t){var n=0;for(;n<t;n+=2)e.push(n);return e}),odd:ct(function(e,t){var n=1;for(;n<t;n+=2)e.push(n);return e}),lt:ct(function(e,t,n){var r=n<0?n+t:n;for(;--r>=0;)e.push(r);return e}),gt:ct(function(e,t,n){var r=n<0?n+t:n;for(;++r<t;)e.push(r);return e})}},r.pseudos.nth=r.pseudos.eq;for(t in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})r.pseudos[t]=ft(t);for(t in{submit:!0,reset:!0})r.pseudos[t]=lt(t);return pt.prototype=r.filters=r.pseudos,r.setFilters=new pt,o=rt.compile=function(e,t){var n,r=[],i=[],s=T[e+" "];if(!s){t||(t=dt(e)),n=t.length;while(n--)s=wt(t[n]),s[y]?r.push(s):i.push(s);s=T(e,Et(i,r))}return s},n.sortStable=y.split("").sort(N).join("")===y,n.detectDuplicates=!!f,l(),n.sortDetached=ot(function(e){return e.compareDocumentPosition(c.createElement("div"))&1}),ot(function(e){return e.innerHTML="<a href='#'></a>",e.firstChild.getAttribute("href")==="#"})||ut("type|href|height|width",function(e,t,n){if(!n)return e.getAttribute(t,t.toLowerCase()==="type"?1:2)}),(!n.attributes||!ot(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),e.firstChild.getAttribute("value")===""}))&&ut("value",function(e,t,n){if(!n&&e.nodeName.toLowerCase()==="input")return e.defaultValue}),ot(function(e){return e.getAttribute("disabled")==null})||ut(H,function(e,t,n){var r;if(!n)return e[t]===!0?t.toLowerCase():(r=e.getAttributeNode(t))&&r.specified?r.value:null}),rt}(window);jQuery.find=Sizzle,jQuery.expr=Sizzle.selectors,jQuery.expr[":"]=jQuery.expr.pseudos,jQuery.unique=Sizzle.uniqueSort,jQuery.text=Sizzle.getText,jQuery.isXMLDoc=Sizzle.isXML,jQuery.contains=Sizzle.contains;var rneedsContext=jQuery.expr.match.needsContext,rsingleTag=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,risSimple=/^.[^:#\[\.,]*$/;jQuery.filter=function(e,t,n){var r=t[0];return n&&(e=":not("+e+")"),t.length===1&&r.nodeType===1?jQuery.find.matchesSelector(r,e)?[r]:[]:jQuery.find.matches(e,jQuery.grep(t,function(e){return e.nodeType===1}))},jQuery.fn.extend({find:function(e){var t,n=this.length,r=[],i=this;if(typeof e!="string")return this.pushStack(jQuery(e).filter(function(){for(t=0;t<n;t++)if(jQuery.contains(i[t],this))return!0}));for(t=0;t<n;t++)jQuery.find(e,i[t],r);return r=this.pushStack(n>1?jQuery.unique(r):r),r.selector=this.selector?this.selector+" "+e:e,r},filter:function(e){return this.pushStack(winnow(this,e||[],!1))},not:function(e){return this.pushStack(winnow(this,e||[],!0))},is:function(e){return!!winnow(this,typeof e=="string"&&rneedsContext.test(e)?jQuery(e):e||[],!1).length}});var rootjQuery,rquickExpr=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,init=jQuery.fn.init=function(e,t){var n,r;if(!e)return this;if(typeof e=="string"){e[0]==="<"&&e[e.length-1]===">"&&e.length>=3?n=[null,e,null]:n=rquickExpr.exec(e);if(n&&(n[1]||!t)){if(n[1]){t=t instanceof jQuery?t[0]:t,jQuery.merge(this,jQuery.parseHTML(n[1],t&&t.nodeType?t.ownerDocument||t:document,!0));if(rsingleTag.test(n[1])&&jQuery.isPlainObject(t))for(n in t)jQuery.isFunction(this[n])?this[n](t[n]):this.attr(n,t[n]);return this}return r=document.getElementById(n[2]),r&&r.parentNode&&(this.length=1,this[0]=r),this.context=document,this.selector=e,this}return!t||t.jquery?(t||rootjQuery).find(e):this.constructor(t).find(e)}return e.nodeType?(this.context=this[0]=e,this.length=1,this):jQuery.isFunction(e)?typeof rootjQuery.ready!="undefined"?rootjQuery.ready(e):e(jQuery):(e.selector!==undefined&&(this.selector=e.selector,this.context=e.context),jQuery.makeArray(e,this))};init.prototype=jQuery.fn,rootjQuery=jQuery(document);var rparentsprev=/^(?:parents|prev(?:Until|All))/,guaranteedUnique={children:!0,contents:!0,next:!0,prev:!0};jQuery.extend({dir:function(e,t,n){var r=[],i=n!==undefined;while((e=e[t])&&e.nodeType!==9)if(e.nodeType===1){if(i&&jQuery(e).is(n))break;r.push(e)}return r},sibling:function(e,t){var n=[];for(;e;e=e.nextSibling)e.nodeType===1&&e!==t&&n.push(e);return n}}),jQuery.fn.extend({has:function(e){var t=jQuery(e,this),n=t.length;return this.filter(function(){var e=0;for(;e<n;e++)if(jQuery.contains(this,t[e]))return!0})},closest:function(e,t){var n,r=0,i=this.length,s=[],o=rneedsContext.test(e)||typeof e!="string"?jQuery(e,t||this.context):0;for(;r<i;r++)for(n=this[r];n&&n!==t;n=n.parentNode)if(n.nodeType<11&&(o?o.index(n)>-1:n.nodeType===1&&jQuery.find.matchesSelector(n,e))){s.push(n);break}return this.pushStack(s.length>1?jQuery.unique(s):s)},index:function(e){return e?typeof e=="string"?indexOf.call(jQuery(e),this[0]):indexOf.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(jQuery.unique(jQuery.merge(this.get(),jQuery(e,t))))},addBack:function(e){return this.add(e==null?this.prevObject:this.prevObject.filter(e))}}),jQuery.each({parent:function(e){var t=e.parentNode;return t&&t.nodeType!==11?t:null},parents:function(e){return jQuery.dir(e,"parentNode")},parentsUntil:function(e,t,n){return jQuery.dir(e,"parentNode",n)},next:function(e){return sibling(e,"nextSibling")},prev:function(e){return sibling(e,"previousSibling")},nextAll:function(e){return jQuery.dir(e,"nextSibling")},prevAll:function(e){return jQuery.dir(e,"previousSibling")},nextUntil:function(e,t,n){return jQuery.dir(e,"nextSibling",n)},prevUntil:function(e,t,n){return jQuery.dir(e,"previousSibling",n)},siblings:function(e){return jQuery.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return jQuery.sibling(e.firstChild)},contents:function(e){return e.contentDocument||jQuery.merge([],e.childNodes)}},function(e,t){jQuery.fn[e]=function(n,r){var i=jQuery.map(this,t,n);return e.slice(-5)!=="Until"&&(r=n),r&&typeof r=="string"&&(i=jQuery.filter(r,i)),this.length>1&&(guaranteedUnique[e]||jQuery.unique(i),rparentsprev.test(e)&&i.reverse()),this.pushStack(i)}});var rnotwhite=/\S+/g,optionsCache={};jQuery.Callbacks=function(e){e=typeof e=="string"?optionsCache[e]||createOptions(e):jQuery.extend({},e);var t,n,r,i,s,o,u=[],a=!e.once&&[],f=function(c){t=e.memory&&c,n=!0,o=i||0,i=0,s=u.length,r=!0;for(;u&&o<s;o++)if(u[o].apply(c[0],c[1])===!1&&e.stopOnFalse){t=!1;break}r=!1,u&&(a?a.length&&f(a.shift()):t?u=[]:l.disable())},l={add:function(){if(u){var n=u.length;(function o(t){jQuery.each(t,function(t,n){var r=jQuery.type(n);r==="function"?(!e.unique||!l.has(n))&&u.push(n):n&&n.length&&r!=="string"&&o(n)})})(arguments),r?s=u.length:t&&(i=n,f(t))}return this},remove:function(){return u&&jQuery.each(arguments,function(e,t){var n;while((n=jQuery.inArray(t,u,n))>-1)u.splice(n,1),r&&(n<=s&&s--,n<=o&&o--)}),this},has:function(e){return e?jQuery.inArray(e,u)>-1:!!u&&!!u.length},empty:function(){return u=[],s=0,this},disable:function(){return u=a=t=undefined,this},disabled:function(){return!u},lock:function(){return a=undefined,t||l.disable(),this},locked:function(){return!a},fireWith:function(e,t){return u&&(!n||a)&&(t=t||[],t=[e,t.slice?t.slice():t],r?a.push(t):f(t)),this},fire:function(){return l.fireWith(this,arguments),this},fired:function(){return!!n}};return l},jQuery.extend({Deferred:function(e){var t=[["resolve","done",jQuery.Callbacks("once memory"),"resolved"],["reject","fail",jQuery.Callbacks("once memory"),"rejected"],["notify","progress",jQuery.Callbacks("memory")]],n="pending",r={state:function(){return n},always:function(){return i.done(arguments).fail(arguments),this},then:function(){var e=arguments;return jQuery.Deferred(function(n){jQuery.each(t,function(t,s){var o=jQuery.isFunction(e[t])&&e[t];i[s[1]](function(){var e=o&&o.apply(this,arguments);e&&jQuery.isFunction(e.promise)?e.promise().done(n.resolve).fail(n.reject).progress(n.notify):n[s[0]+"With"](this===r?n.promise():this,o?[e]:arguments)})}),e=null}).promise()},promise:function(e){return e!=null?jQuery.extend(e,r):r}},i={};return r.pipe=r.then,jQuery.each(t,function(e,s){var o=s[2],u=s[3];r[s[1]]=o.add,u&&o.add(function(){n=u},t[e^1][2].disable,t[2][2].lock),i[s[0]]=function(){return i[s[0]+"With"](this===i?r:this,arguments),this},i[s[0]+"With"]=o.fireWith}),r.promise(i),e&&e.call(i,i),i},when:function(e){var t=0,n=slice.call(arguments),r=n.length,i=r!==1||e&&jQuery.isFunction(e.promise)?r:0,s=i===1?e:jQuery.Deferred(),o=function(e,t,n){return function(r){t[e]=this,n[e]=arguments.length>1?slice.call(arguments):r,n===u?s.notifyWith(t,n):--i||s.resolveWith(t,n)}},u,a,f;if(r>1){u=new Array(r),a=new Array(r),f=new Array(r);for(;t<r;t++)n[t]&&jQuery.isFunction(n[t].promise)?n[t].promise().done(o(t,f,n)).fail(s.reject).progress(o(t,a,u)):--i}return i||s.resolveWith(f,n),s.promise()}});var readyList;jQuery.fn.ready=function(e){return jQuery.ready.promise().done(e),this},jQuery.extend({isReady:!1,readyWait:1,holdReady:function(e){e?jQuery.readyWait++:jQuery.ready(!0)},ready:function(e){if(e===!0?--jQuery.readyWait:jQuery.isReady)return;jQuery.isReady=!0;if(e!==!0&&--jQuery.readyWait>0)return;readyList.resolveWith(document,[jQuery]),jQuery.fn.trigger&&jQuery(document).trigger("ready").off("ready")}}),jQuery.ready.promise=function(e){return readyList||(readyList=jQuery.Deferred(),document.readyState==="complete"?setTimeout(jQuery.ready):(document.addEventListener("DOMContentLoaded",completed,!1),window.addEventListener("load",completed,!1))),readyList.promise(e)},jQuery.ready.promise();var access=jQuery.access=function(e,t,n,r,i,s,o){var u=0,a=e.length,f=n==null;if(jQuery.type(n)==="object"){i=!0;for(u in n)jQuery.access(e,t,u,n[u],!0,s,o)}else if(r!==undefined){i=!0,jQuery.isFunction(r)||(o=!0),f&&(o?(t.call(e,r),t=null):(f=t,t=function(e,t,n){return f.call(jQuery(e),n)}));if(t)for(;u<a;u++)t(e[u],n,o?r:r.call(e[u],u,t(e[u],n)))}return i?e:f?t.call(e):a?t(e[0],n):s};jQuery.acceptData=function(e){return e.nodeType===1||e.nodeType===9||!+e.nodeType},Data.uid=1,Data.accepts=jQuery.acceptData,Data.prototype={key:function(e){if(!Data.accepts(e))return 0;var t={},n=e[this.expando];if(!n){n=Data.uid++;try{t[this.expando]={value:n},Object.defineProperties(e,t)}catch(r){t[this.expando]=n,jQuery.extend(e,t)}}return this.cache[n]||(this.cache[n]={}),n},set:function(e,t,n){var r,i=this.key(e),s=this.cache[i];if(typeof t=="string")s[t]=n;else if(jQuery.isEmptyObject(s))jQuery.extend(this.cache[i],t);else for(r in t)s[r]=t[r];return s},get:function(e,t){var n=this.cache[this.key(e)];return t===undefined?n:n[t]},access:function(e,t,n){var r;return t===undefined||t&&typeof t=="string"&&n===undefined?(r=this.get(e,t),r!==undefined?r:this.get(e,jQuery.camelCase(t))):(this.set(e,t,n),n!==undefined?n:t)},remove:function(e,t){var n,r,i,s=this.key(e),o=this.cache[s];if(t===undefined)this.cache[s]={};else{jQuery.isArray(t)?r=t.concat(t.map(jQuery.camelCase)):(i=jQuery.camelCase(t),t in o?r=[t,i]:(r=i,r=r in o?[r]:r.match(rnotwhite)||[])),n=r.length;while(n--)delete o[r[n]]}},hasData:function(e){return!jQuery.isEmptyObject(this.cache[e[this.expando]]||{})},discard:function(e){e[this.expando]&&delete this.cache[e[this.expando]]}};var data_priv=new Data,data_user=new Data,rbrace=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,rmultiDash=/([A-Z])/g;jQuery.extend({hasData:function(e){return data_user.hasData(e)||data_priv.hasData(e)},data:function(e,t,n){return data_user.access(e,t,n)},removeData:function(e,t){data_user.remove(e,t)},_data:function(e,t,n){return data_priv.access(e,t,n)},_removeData:function(e,t){data_priv.remove(e,t)}}),jQuery.fn.extend({data:function(e,t){var n,r,i,s=this[0],o=s&&s.attributes;if(e===undefined){if(this.length){i=data_user.get(s);if(s.nodeType===1&&!data_priv.get(s,"hasDataAttrs")){n=o.length;while(n--)r=o[n].name,r.indexOf("data-")===0&&(r=jQuery.camelCase(r.slice(5)),dataAttr(s,r,i[r]));data_priv.set(s,"hasDataAttrs",!0)}}return i}return typeof e=="object"?this.each(function(){data_user.set(this,e)}):access(this,function(t){var n,r=jQuery.camelCase(e);if(s&&t===undefined){n=data_user.get(s,e);if(n!==undefined)return n;n=data_user.get(s,r);if(n!==undefined)return n;n=dataAttr(s,r,undefined);if(n!==undefined)return n;return}this.each(function(){var n=data_user.get(this,r);data_user.set(this,r,t),e.indexOf("-")!==-1&&n!==undefined&&data_user.set(this,e,t)})},null,t,arguments.length>1,null,!0)},removeData:function(e){return this.each(function(){data_user.remove(this,e)})}}),jQuery.extend({queue:function(e,t,n){var r;if(e)return t=(t||"fx")+"queue",r=data_priv.get(e,t),n&&(!r||jQuery.isArray(n)?r=data_priv.access(e,t,jQuery.makeArray(n)):r.push(n)),r||[]},dequeue:function(e,t){t=t||"fx";var n=jQuery.queue(e,t),r=n.length,i=n.shift(),s=jQuery._queueHooks(e,t),o=function(){jQuery.dequeue(e,t)};i==="inprogress"&&(i=n.shift(),r--),i&&(t==="fx"&&n.unshift("inprogress"),delete s.stop,i.call(e,o,s)),!r&&s&&s.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return data_priv.get(e,n)||data_priv.access(e,n,{empty:jQuery.Callbacks("once memory").add(function(){data_priv.remove(e,[t+"queue",n])})})}}),jQuery.fn.extend({queue:function(e,t){var n=2;return typeof e!="string"&&(t=e,e="fx",n--),arguments.length<n?jQuery.queue(this[0],e):t===undefined?this:this.each(function(){var n=jQuery.queue(this,e,t);jQuery._queueHooks(this,e),e==="fx"&&n[0]!=="inprogress"&&jQuery.dequeue(this,e)})},dequeue:function(e){return this.each(function(){jQuery.dequeue(this,e)})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var n,r=1,i=jQuery.Deferred(),s=this,o=this.length,u=function(){--r||i.resolveWith(s,[s])};typeof e!="string"&&(t=e,e=undefined),e=e||"fx";while(o--)n=data_priv.get(s[o],e+"queueHooks"),n&&n.empty&&(r++,n.empty.add(u));return u(),i.promise(t)}});var pnum=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,cssExpand=["Top","Right","Bottom","Left"],isHidden=function(e,t){return e=t||e,jQuery.css(e,"display")==="none"||!jQuery.contains(e.ownerDocument,e)},rcheckableType=/^(?:checkbox|radio)$/i;(function(){var e=document.createDocumentFragment(),t=e.appendChild(document.createElement("div"));t.innerHTML="<input type='radio' checked='checked' name='t'/>",support.checkClone=t.cloneNode(!0).cloneNode(!0).lastChild.checked,t.innerHTML="<textarea>x</textarea>",support.noCloneChecked=!!t.cloneNode(!0).lastChild.defaultValue})();var strundefined=typeof undefined;support.focusinBubbles="onfocusin"in window;var rkeyEvent=/^key/,rmouseEvent=/^(?:mouse|contextmenu)|click/,rfocusMorph=/^(?:focusinfocus|focusoutblur)$/,rtypenamespace=/^([^.]*)(?:\.(.+)|)$/;jQuery.event={global:{},add:function(e,t,n,r,i){var s,o,u,a,f,l,c,h,p,d,v,m=data_priv.get(e);if(!m)return;n.handler&&(s=n,n=s.handler,i=s.selector),n.guid||(n.guid=jQuery.guid++),(a=m.events)||(a=m.events={}),(o=m.handle)||(o=m.handle=function(t){return typeof jQuery!==strundefined&&jQuery.event.triggered!==t.type?jQuery.event.dispatch.apply(e,arguments):undefined}),t=(t||"").match(rnotwhite)||[""],f=t.length;while(f--){u=rtypenamespace.exec(t[f])||[],p=v=u[1],d=(u[2]||"").split(".").sort();if(!p)continue;c=jQuery.event.special[p]||{},p=(i?c.delegateType:c.bindType)||p,c=jQuery.event.special[p]||{},l=jQuery.extend({type:p,origType:v,data:r,handler:n,guid:n.guid,selector:i,needsContext:i&&jQuery.expr.match.needsContext.test(i),namespace:d.join(".")},s),(h=a[p])||(h=a[p]=[],h.delegateCount=0,(!c.setup||c.setup.call(e,r,d,o)===!1)&&e.addEventListener&&e.addEventListener(p,o,!1)),c.add&&(c.add.call(e,l),l.handler.guid||(l.handler.guid=n.guid)),i?h.splice(h.delegateCount++,0,l):h.push(l),jQuery.event.global[p]=!0}},remove:function(e,t,n,r,i){var s,o,u,a,f,l,c,h,p,d,v,m=data_priv.hasData(e)&&data_priv.get(e);if(!m||!(a=m.events))return;t=(t||"").match(rnotwhite)||[""],f=t.length;while(f--){u=rtypenamespace.exec(t[f])||[],p=v=u[1],d=(u[2]||"").split(".").sort();if(!p){for(p in a)jQuery.event.remove(e,p+t[f],n,r,!0);continue}c=jQuery.event.special[p]||{},p=(r?c.delegateType:c.bindType)||p,h=a[p]||[],u=u[2]&&new RegExp("(^|\\.)"+d.join("\\.(?:.*\\.|)")+"(\\.|$)"),o=s=h.length;while(s--)l=h[s],(i||v===l.origType)&&(!n||n.guid===l.guid)&&(!u||u.test(l.namespace))&&(!r||r===l.selector||r==="**"&&l.selector)&&(h.splice(s,1),l.selector&&h.delegateCount--,c.remove&&c.remove.call(e,l));o&&!h.length&&((!c.teardown||c.teardown.call(e,d,m.handle)===!1)&&jQuery.removeEvent(e,p,m.handle),delete a[p])}jQuery.isEmptyObject(a)&&(delete m.handle,data_priv.remove(e,"events"))},trigger:function(e,t,n,r){var i,s,o,u,a,f,l,c=[n||document],h=hasOwn.call(e,"type")?e.type:e,p=hasOwn.call(e,"namespace")?e.namespace.split("."):[];s=o=n=n||document;if(n.nodeType===3||n.nodeType===8)return;if(rfocusMorph.test(h+jQuery.event.triggered))return;h.indexOf(".")>=0&&(p=h.split("."),h=p.shift(),p.sort()),a=h.indexOf(":")<0&&"on"+h,e=e[jQuery.expando]?e:new jQuery.Event(h,typeof e=="object"&&e),e.isTrigger=r?2:3,e.namespace=p.join("."),e.namespace_re=e.namespace?new RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=undefined,e.target||(e.target=n),t=t==null?[e]:jQuery.makeArray(t,[e]),l=jQuery.event.special[h]||{};if(!r&&l.trigger&&l.trigger.apply(n,t)===!1)return;if(!r&&!l.noBubble&&!jQuery.isWindow(n)){u=l.delegateType||h,rfocusMorph.test(u+h)||(s=s.parentNode);for(;s;s=s.parentNode)c.push(s),o=s;o===(n.ownerDocument||document)&&c.push(o.defaultView||o.parentWindow||window)}i=0;while((s=c[i++])&&!e.isPropagationStopped())e.type=i>1?u:l.bindType||h,f=(data_priv.get(s,"events")||{})[e.type]&&data_priv.get(s,"handle"),f&&f.apply(s,t),f=a&&s[a],f&&f.apply&&jQuery.acceptData(s)&&(e.result=f.apply(s,t),e.result===!1&&e.preventDefault());return e.type=h,!r&&!e.isDefaultPrevented()&&(!l._default||l._default.apply(c.pop(),t)===!1)&&jQuery.acceptData(n)&&a&&jQuery.isFunction(n[h])&&!jQuery.isWindow(n)&&(o=n[a],o&&(n[a]=null),jQuery.event.triggered=h,n[h](),jQuery.event.triggered=undefined,o&&(n[a]=o)),e.result},dispatch:function(e){e=jQuery.event.fix(e);var t,n,r,i,s,o=[],u=slice.call(arguments),a=(data_priv.get(this,"events")||{})[e.type]||[],f=jQuery.event.special[e.type]||{};u[0]=e,e.delegateTarget=this;if(f.preDispatch&&f.preDispatch.call(this,e)===!1)return;o=jQuery.event.handlers.call(this,e,a),t=0;while((i=o[t++])&&!e.isPropagationStopped()){e.currentTarget=i.elem,n=0;while((s=i.handlers[n++])&&!e.isImmediatePropagationStopped())if(!e.namespace_re||e.namespace_re.test(s.namespace))e.handleObj=s,e.data=s.data,r=((jQuery.event.special[s.origType]||{}).handle||s.handler).apply(i.elem,u),r!==undefined&&(e.result=r)===!1&&(e.preventDefault(),e.stopPropagation())}return f.postDispatch&&f.postDispatch.call(this,e),e.result},handlers:function(e,t){var n,r,i,s,o=[],u=t.delegateCount,a=e.target;if(u&&a.nodeType&&(!e.button||e.type!=="click"))for(;a!==this;a=a.parentNode||this)if(a.disabled!==!0||e.type!=="click"){r=[];for(n=0;n<u;n++)s=t[n],i=s.selector+" ",r[i]===undefined&&(r[i]=s.needsContext?jQuery(i,this).index(a)>=0:jQuery.find(i,this,null,[a]).length),r[i]&&r.push(s);r.length&&o.push({elem:a,handlers:r})}return u<t.length&&o.push({elem:this,handlers:t.slice(u)}),o},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return e.which==null&&(e.which=t.charCode!=null?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,t){var n,r,i,s=t.button;return e.pageX==null&&t.clientX!=null&&(n=e.target.ownerDocument||document,r=n.documentElement,i=n.body,e.pageX=t.clientX+(r&&r.scrollLeft||i&&i.scrollLeft||0)-(r&&r.clientLeft||i&&i.clientLeft||0),e.pageY=t.clientY+(r&&r.scrollTop||i&&i.scrollTop||0)-(r&&r.clientTop||i&&i.clientTop||0)),!e.which&&s!==undefined&&(e.which=s&1?1:s&2?3:s&4?2:0),e}},fix:function(e){if(e[jQuery.expando])return e;var t,n,r,i=e.type,s=e,o=this.fixHooks[i];o||(this.fixHooks[i]=o=rmouseEvent.test(i)?this.mouseHooks:rkeyEvent.test(i)?this.keyHooks:{}),r=o.props?this.props.concat(o.props):this.props,e=new jQuery.Event(s),t=r.length;while(t--)n=r[t],e[n]=s[n];return e.target||(e.target=document),e.target.nodeType===3&&(e.target=e.target.parentNode),o.filter?o.filter(e,s):e},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==safeActiveElement()&&this.focus)return this.focus(),!1},delegateType:"focusin"},blur:{trigger:function(){if(this===safeActiveElement()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if(this.type==="checkbox"&&this.click&&jQuery.nodeName(this,"input"))return this.click(),!1},_default:function(e){return jQuery.nodeName(e.target,"a")}},beforeunload:{postDispatch:function(e){e.result!==undefined&&(e.originalEvent.returnValue=e.result)}}},simulate:function(e,t,n,r){var i=jQuery.extend(new jQuery.Event,n,{type:e,isSimulated:!0,originalEvent:{}});r?jQuery.event.trigger(i,null,t):jQuery.event.dispatch.call(t,i),i.isDefaultPrevented()&&n.preventDefault()}},jQuery.removeEvent=function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n,!1)},jQuery.Event=function(e,t){if(!(this instanceof jQuery.Event))return new jQuery.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||e.defaultPrevented===undefined&&e.getPreventDefault&&e.getPreventDefault()?returnTrue:returnFalse):this.type=e,t&&jQuery.extend(this,t),this.timeStamp=e&&e.timeStamp||jQuery.now(),this[jQuery.expando]=!0},jQuery.Event.prototype={isDefaultPrevented:returnFalse,isPropagationStopped:returnFalse,isImmediatePropagationStopped:returnFalse,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=returnTrue,e&&e.preventDefault&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=returnTrue,e&&e.stopPropagation&&e.stopPropagation()},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=returnTrue,this.stopPropagation()}},jQuery.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(e,t){jQuery.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,r=this,i=e.relatedTarget,s=e.handleObj;if(!i||i!==r&&!jQuery.contains(r,i))e.type=s.origType,n=s.handler.apply(this,arguments),e.type=t;return n}}}),support.focusinBubbles||jQuery.each({focus:"focusin",blur:"focusout"},function(e,t){var n=function(e){jQuery.event.simulate(t,e.target,jQuery.event.fix(e),!0)};jQuery.event.special[t]={setup:function(){var r=this.ownerDocument||this,i=data_priv.access(r,t);i||r.addEventListener(e,n,!0),data_priv.access(r,t,(i||0)+1)},teardown:function(){var r=this.ownerDocument||this,i=data_priv.access(r,t)-1;i?data_priv.access(r,t,i):(r.removeEventListener(e,n,!0),data_priv.remove(r,t))}}}),jQuery.fn.extend({on:function(e,t,n,r,i){var s,o;if(typeof e=="object"){typeof t!="string"&&(n=n||t,t=undefined);for(o in e)this.on(o,t,n,e[o],i);return this}n==null&&r==null?(r=t,n=t=undefined):r==null&&(typeof t=="string"?(r=n,n=undefined):(r=n,n=t,t=undefined));if(r===!1)r=returnFalse;else if(!r)return this;return i===1&&(s=r,r=function(e){return jQuery().off(e),s.apply(this,arguments)},r.guid=s.guid||(s.guid=jQuery.guid++)),this.each(function(){jQuery.event.add(this,e,r,n,t)})},one:function(e,t,n,r){return this.on(e,t,n,r,1)},off:function(e,t,n){var r,i;if(e&&e.preventDefault&&e.handleObj)return r=e.handleObj,jQuery(e.delegateTarget).off(r.namespace?r.origType+"."+r.namespace:r.origType,r.selector,r.handler),this;if(typeof e=="object"){for(i in e)this.off(i,t,e[i]);return this}if(t===!1||typeof t=="function")n=t,t=undefined;return n===!1&&(n=returnFalse),this.each(function(){jQuery.event.remove(this,e,n,t)})},trigger:function(e,t){return this.each(function(){jQuery.event.trigger(e,t,this)})},triggerHandler:function(e,t){var n=this[0];if(n)return jQuery.event.trigger(e,t,n,!0)}});var rxhtmlTag=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,rtagName=/<([\w:]+)/,rhtml=/<|&#?\w+;/,rnoInnerhtml=/<(?:script|style|link)/i,rchecked=/checked\s*(?:[^=]|=\s*.checked.)/i,rscriptType=/^$|\/(?:java|ecma)script/i,rscriptTypeMasked=/^true\/(.*)/,rcleanScript=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,wrapMap={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};wrapMap.optgroup=wrapMap.option,wrapMap.tbody=wrapMap.tfoot=wrapMap.colgroup=wrapMap.caption=wrapMap.thead,wrapMap.th=wrapMap.td,jQuery.extend({clone:function(e,t,n){var r,i,s,o,u=e.cloneNode(!0),a=jQuery.contains(e.ownerDocument,e);if(!support.noCloneChecked&&(e.nodeType===1||e.nodeType===11)&&!jQuery.isXMLDoc(e)){o=getAll(u),s=getAll(e);for(r=0,i=s.length;r<i;r++)fixInput(s[r],o[r])}if(t)if(n){s=s||getAll(e),o=o||getAll(u);for(r=0,i=s.length;r<i;r++)cloneCopyEvent(s[r],o[r])}else cloneCopyEvent(e,u);return o=getAll(u,"script"),o.length>0&&setGlobalEval(o,!a&&getAll(e,"script")),u},buildFragment:function(e,t,n,r){var i,s,o,u,a,f,l=t.createDocumentFragment(),c=[],h=0,p=e.length;for(;h<p;h++){i=e[h];if(i||i===0)if(jQuery.type(i)==="object")jQuery.merge(c,i.nodeType?[i]:i);else if(!rhtml.test(i))c.push(t.createTextNode(i));else{s=s||l.appendChild(t.createElement("div")),o=(rtagName.exec(i)||["",""])[1].toLowerCase(),u=wrapMap[o]||wrapMap._default,s.innerHTML=u[1]+i.replace(rxhtmlTag,"<$1></$2>")+u[2],f=u[0];while(f--)s=s.lastChild;jQuery.merge(c,s.childNodes),s=l.firstChild,s.textContent=""}}l.textContent="",h=0;while(i=c[h++]){if(r&&jQuery.inArray(i,r)!==-1)continue;a=jQuery.contains(i.ownerDocument,i),s=getAll(l.appendChild(i),"script"),a&&setGlobalEval(s);if(n){f=0;while(i=s[f++])rscriptType.test(i.type||"")&&n.push(i)}}return l},cleanData:function(e){var t,n,r,i,s,o,u=jQuery.event.special,a=0;for(;(n=e[a])!==undefined;a++){if(jQuery.acceptData(n)){s=n[data_priv.expando];if(s&&(t=data_priv.cache[s])){r=Object.keys(t.events||{});if(r.length)for(o=0;(i=r[o])!==undefined;o++)u[i]?jQuery.event.remove(n,i):jQuery.removeEvent(n,i,t.handle);data_priv.cache[s]&&delete data_priv.cache[s]}}delete data_user.cache[n[data_user.expando]]}}}),jQuery.fn.extend({text:function(e){return access(this,function(e){return e===undefined?jQuery.text(this):this.empty().each(function(){if(this.nodeType===1||this.nodeType===11||this.nodeType===9)this.textContent=e})},null,e,arguments.length)},append:function(){return this.domManip(arguments,function(e){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var t=manipulationTarget(this,e);t.appendChild(e)}})},prepend:function(){return this.domManip(arguments,function(e){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var t=manipulationTarget(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},remove:function(e,t){var n,r=e?jQuery.filter(e,this):this,i=0;for(;(n=r[i])!=null;i++)!t&&n.nodeType===1&&jQuery.cleanData(getAll(n)),n.parentNode&&(t&&jQuery.contains(n.ownerDocument,n)&&setGlobalEval(getAll(n,"script")),n.parentNode.removeChild(n));return this},empty:function(){var e,t=0;for(;(e=this[t])!=null;t++)e.nodeType===1&&(jQuery.cleanData(getAll(e,!1)),e.textContent="");return this},clone:function(e,t){return e=e==null?!1:e,t=t==null?e:t,this.map(function(){return jQuery.clone(this,e,t)})},html:function(e){return access(this,function(e){var t=this[0]||{},n=0,r=this.length;if(e===undefined&&t.nodeType===1)return t.innerHTML;if(typeof e=="string"&&!rnoInnerhtml.test(e)&&!wrapMap[(rtagName.exec(e)||["",""])[1].toLowerCase()]){e=e.replace(rxhtmlTag,"<$1></$2>");try{for(;n<r;n++)t=this[n]||{},t.nodeType===1&&(jQuery.cleanData(getAll(t,!1)),t.innerHTML=e);t=0}catch(i){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var e=arguments[0];return this.domManip(arguments,function(t){e=this.parentNode,jQuery.cleanData(getAll(this)),e&&e.replaceChild(t,this)}),e&&(e.length||e.nodeType)?this:this.remove()},detach:function(e){return this.remove(e,!0)},domManip:function(e,t){e=concat.apply([],e);var n,r,i,s,o,u,a=0,f=this.length,l=this,c=f-1,h=e[0],p=jQuery.isFunction(h);if(p||f>1&&typeof h=="string"&&!support.checkClone&&rchecked.test(h))return this.each(function(n){var r=l.eq(n);p&&(e[0]=h.call(this,n,r.html())),r.domManip(e,t)});if(f){n=jQuery.buildFragment(e,this[0].ownerDocument,!1,this),r=n.firstChild,n.childNodes.length===1&&(n=r);if(r){i=jQuery.map(getAll(n,"script"),disableScript),s=i.length;for(;a<f;a++)o=n,a!==c&&(o=jQuery.clone(o,!0,!0),s&&jQuery.merge(i,getAll(o,"script"))),t.call(this[a],o,a);if(s){u=i[i.length-1].ownerDocument,jQuery.map(i,restoreScript);for(a=0;a<s;a++)o=i[a],rscriptType.test(o.type||"")&&!data_priv.access(o,"globalEval")&&jQuery.contains(u,o)&&(o.src?jQuery._evalUrl&&jQuery._evalUrl(o.src):jQuery.globalEval(o.textContent.replace(rcleanScript,"")))}}}return this}}),jQuery.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){jQuery.fn[e]=function(e){var n,r=[],i=jQuery(e),s=i.length-1,o=0;for(;o<=s;o++)n=o===s?this:this.clone(!0),jQuery(i[o])[t](n),push.apply(r,n.get());return this.pushStack(r)}});var iframe,elemdisplay={},rmargin=/^margin/,rnumnonpx=new RegExp("^("+pnum+")(?!px)[a-z%]+$","i"),getStyles=function(e){return e.ownerDocument.defaultView.getComputedStyle(e,null)};(function(){function o(){s.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%",r.appendChild(i);var n=window.getComputedStyle(s,null);e=n.top!=="1%",t=n.width==="4px",r.removeChild(i)}var e,t,n="padding:0;margin:0;border:0;display:block;-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box",r=document.documentElement,i=document.createElement("div"),s=document.createElement("div");s.style.backgroundClip="content-box",s.cloneNode(!0).style.backgroundClip="",support.clearCloneStyle=s.style.backgroundClip==="content-box",i.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px",i.appendChild(s),window.getComputedStyle&&jQuery.extend(support,{pixelPosition:function(){return o(),e},boxSizingReliable:function(){return t==null&&o(),t},reliableMarginRight:function(){var e,t=s.appendChild(document.createElement("div"));return t.style.cssText=s.style.cssText=n,t.style.marginRight=t.style.width="0",s.style.width="1px",r.appendChild(i),e=!parseFloat(window.getComputedStyle(t,null).marginRight),r.removeChild(i),s.innerHTML="",e}})})(),jQuery.swap=function(e,t,n,r){var i,s,o={};for(s in t)o[s]=e.style[s],e.style[s]=t[s];i=n.apply(e,r||[]);for(s in t)e.style[s]=o[s];return i};var rdisplayswap=/^(none|table(?!-c[ea]).+)/,rnumsplit=new RegExp("^("+pnum+")(.*)$","i"),rrelNum=new RegExp("^([+-])=("+pnum+")","i"),cssShow={position:"absolute",visibility:"hidden",display:"block"},cssNormalTransform={letterSpacing:0,fontWeight:400},cssPrefixes=["Webkit","O","Moz","ms"];jQuery.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=curCSS(e,"opacity");return n===""?"1":n}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":"cssFloat"},style:function(e,t,n,r){if(!e||e.nodeType===3||e.nodeType===8||!e.style)return;var i,s,o,u=jQuery.camelCase(t),a=e.style;t=jQuery.cssProps[u]||(jQuery.cssProps[u]=vendorPropName(a,u)),o=jQuery.cssHooks[t]||jQuery.cssHooks[u];if(n===undefined)return o&&"get"in o&&(i=o.get(e,!1,r))!==undefined?i:a[t];s=typeof n,s==="string"&&(i=rrelNum.exec(n))&&(n=(i[1]+1)*i[2]+parseFloat(jQuery.css(e,t)),s="number");if(n==null||n!==n)return;s==="number"&&!jQuery.cssNumber[u]&&(n+="px"),!support.clearCloneStyle&&n===""&&t.indexOf("background")===0&&(a[t]="inherit");if(!o||!("set"in o)||(n=o.set(e,n,r))!==undefined)a[t]="",a[t]=n},css:function(e,t,n,r){var i,s,o,u=jQuery.camelCase(t);return t=jQuery.cssProps[u]||(jQuery.cssProps[u]=vendorPropName(e.style,u)),o=jQuery.cssHooks[t]||jQuery.cssHooks[u],o&&"get"in o&&(i=o.get(e,!0,n)),i===undefined&&(i=curCSS(e,t,r)),i==="normal"&&t in cssNormalTransform&&(i=cssNormalTransform[t]),n===""||n?(s=parseFloat(i),n===!0||jQuery.isNumeric(s)?s||0:i):i}}),jQuery.each(["height","width"],function(e,t){jQuery.cssHooks[t]={get:function(e,n,r){if(n)return e.offsetWidth===0&&rdisplayswap.test(jQuery.css(e,"display"))?jQuery.swap(e,cssShow,function(){return getWidthOrHeight(e,t,r)}):getWidthOrHeight(e,t,r)},set:function(e,n,r){var i=r&&getStyles(e);return setPositiveNumber(e,n,r?augmentWidthOrHeight(e,t,r,jQuery.css(e,"boxSizing",!1,i)==="border-box",i):0)}}}),jQuery.cssHooks.marginRight=addGetHookIf(support.reliableMarginRight,function(e,t){if(t)return jQuery.swap(e,{display:"inline-block"},curCSS,[e,"marginRight"])}),jQuery.each({margin:"",padding:"",border:"Width"},function(e,t){jQuery.cssHooks[e+t]={expand:function(n){var r=0,i={},s=typeof n=="string"?n.split(" "):[n];for(;r<4;r++)i[e+cssExpand[r]+t]=s[r]||s[r-2]||s[0];return i}},rmargin.test(e)||(jQuery.cssHooks[e+t].set=setPositiveNumber)}),jQuery.fn.extend({css:function(e,t){return access(this,function(e,t,n){var r,i,s={},o=0;if(jQuery.isArray(t)){r=getStyles(e),i=t.length;for(;o<i;o++)s[t[o]]=jQuery.css(e,t[o],!1,r);return s}return n!==undefined?jQuery.style(e,t,n):jQuery.css(e,t)},e,t,arguments.length>1)},show:function(){return showHide(this,!0)},hide:function(){return showHide(this)},toggle:function(e){return typeof e=="boolean"?e?this.show():this.hide():this.each(function(){isHidden(this)?jQuery(this).show():jQuery(this).hide()})}}),jQuery.Tween=Tween,Tween.prototype={constructor:Tween,init:function(e,t,n,r,i,s){this.elem=e,this.prop=n,this.easing=i||"swing",this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=s||(jQuery.cssNumber[n]?"":"px")},cur:function(){var e=Tween.propHooks[this.prop];return e&&e.get?e.get(this):Tween.propHooks._default.get(this)},run:function(e){var t,n=Tween.propHooks[this.prop];return this.options.duration?this.pos=t=jQuery.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):Tween.propHooks._default.set(this),this}},Tween.prototype.init.prototype=Tween.prototype,Tween.propHooks={_default:{get:function(e){var t;return e.elem[e.prop]==null||!!e.elem.style&&e.elem.style[e.prop]!=null?(t=jQuery.css(e.elem,e.prop,""),!t||t==="auto"?0:t):e.elem[e.prop]},set:function(e){jQuery.fx.step[e.prop]?jQuery.fx.step[e.prop](e):e.elem.style&&(e.elem.style[jQuery.cssProps[e.prop]]!=null||jQuery.cssHooks[e.prop])?jQuery.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},Tween.propHooks.scrollTop=Tween.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},jQuery.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}},jQuery.fx=Tween.prototype.init,jQuery.fx.step={};var fxNow,timerId,rfxtypes=/^(?:toggle|show|hide)$/,rfxnum=new RegExp("^(?:([+-])=|)("+pnum+")([a-z%]*)$","i"),rrun=/queueHooks$/,animationPrefilters=[defaultPrefilter],tweeners={"*":[function(e,t){var n=this.createTween(e,t),r=n.cur(),i=rfxnum.exec(t),s=i&&i[3]||(jQuery.cssNumber[e]?"":"px"),o=(jQuery.cssNumber[e]||s!=="px"&&+r)&&rfxnum.exec(jQuery.css(n.elem,e)),u=1,a=20;if(o&&o[3]!==s){s=s||o[3],i=i||[],o=+r||1;do u=u||".5",o/=u,jQuery.style(n.elem,e,o+s);while(u!==(u=n.cur()/r)&&u!==1&&--a)}return i&&(o=n.start=+o||+r||0,n.unit=s,n.end=i[1]?o+(i[1]+1)*i[2]:+i[2]),n}]};jQuery.Animation=jQuery.extend(Animation,{tweener:function(e,t){jQuery.isFunction(e)?(t=e,e=["*"]):e=e.split(" ");var n,r=0,i=e.length;for(;r<i;r++)n=e[r],tweeners[n]=tweeners[n]||[],tweeners[n].unshift(t)},prefilter:function(e,t){t?animationPrefilters.unshift(e):animationPrefilters.push(e)}}),jQuery.speed=function(e,t,n){var r=e&&typeof e=="object"?jQuery.extend({},e):{complete:n||!n&&t||jQuery.isFunction(e)&&e,duration:e,easing:n&&t||t&&!jQuery.isFunction(t)&&t};r.duration=jQuery.fx.off?0:typeof r.duration=="number"?r.duration:r.duration in jQuery.fx.speeds?jQuery.fx.speeds[r.duration]:jQuery.fx.speeds._default;if(r.queue==null||r.queue===!0)r.queue="fx";return r.old=r.complete,r.complete=function(){jQuery.isFunction(r.old)&&r.old.call(this),r.queue&&jQuery.dequeue(this,r.queue)},r},jQuery.fn.extend({fadeTo:function(e,t,n,r){return this.filter(isHidden).css("opacity",0).show().end().animate({opacity:t},e,n,r)},animate:function(e,t,n,r){var i=jQuery.isEmptyObject(e),s=jQuery.speed(t,n,r),o=function(){var t=Animation(this,jQuery.extend({},e),s);(i||data_priv.get(this,"finish"))&&t.stop(!0)};return o.finish=o,i||s.queue===!1?this.each(o):this.queue(s.queue,o)},stop:function(e,t,n){var r=function(e){var t=e.stop;delete e.stop,t(n)};return typeof e!="string"&&(n=t,t=e,e=undefined),t&&e!==!1&&this.queue(e||"fx",[]),this.each(function(){var t=!0,i=e!=null&&e+"queueHooks",s=jQuery.timers,o=data_priv.get(this);if(i)o[i]&&o[i].stop&&r(o[i]);else for(i in o)o[i]&&o[i].stop&&rrun.test(i)&&r(o[i]);for(i=s.length;i--;)s[i].elem===this&&(e==null||s[i].queue===e)&&(s[i].anim.stop(n),t=!1,s.splice(i,1));(t||!n)&&jQuery.dequeue(this,e)})},finish:function(e){return e!==!1&&(e=e||"fx"),this.each(function(){var t,n=data_priv.get(this),r=n[e+"queue"],i=n[e+"queueHooks"],s=jQuery.timers,o=r?r.length:0;n.finish=!0,jQuery.queue(this,e,[]),i&&i.stop&&i.stop.call(this,!0);for(t=s.length;t--;)s[t].elem===this&&s[t].queue===e&&(s[t].anim.stop(!0),s.splice(t,1));for(t=0;t<o;t++)r[t]&&r[t].finish&&r[t].finish.call(this);delete n.finish})}}),jQuery.each(["toggle","show","hide"],function(e,t){var n=jQuery.fn[t];jQuery.fn[t]=function(e,r,i){return e==null||typeof e=="boolean"?n.apply(this,arguments):this.animate(genFx(t,!0),e,r,i)}}),jQuery.each({slideDown:genFx("show"),slideUp:genFx("hide"),slideToggle:genFx("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){jQuery.fn[e]=function(e,n,r){return this.animate(t,e,n,r)}}),jQuery.timers=[],jQuery.fx.tick=function(){var e,t=0,n=jQuery.timers;fxNow=jQuery.now();for(;t<n.length;t++)e=n[t],!e()&&n[t]===e&&n.splice(t--,1);n.length||jQuery.fx.stop(),fxNow=undefined},jQuery.fx.timer=function(e){jQuery.timers.push(e),e()?jQuery.fx.start():jQuery.timers.pop()},jQuery.fx.interval=13,jQuery.fx.start=function(){timerId||(timerId=setInterval(jQuery.fx.tick,jQuery.fx.interval))},jQuery.fx.stop=function(){clearInterval(timerId),timerId=null},jQuery.fx.speeds={slow:600,fast:200,_default:400},jQuery.fn.delay=function(e,t){return e=jQuery.fx?jQuery.fx.speeds[e]||e:e,t=t||"fx",this.queue(t,function(t,n){var r=setTimeout(t,e);n.stop=function(){clearTimeout(r)}})},function(){var e=document.createElement("input"),t=document.createElement("select"),n=t.appendChild(document.createElement("option"));e.type="checkbox",support.checkOn=e.value!=="",support.optSelected=n.selected,t.disabled=!0,support.optDisabled=!n.disabled,e=document.createElement("input"),e.value="t",e.type="radio",support.radioValue=e.value==="t"}();var nodeHook,boolHook,attrHandle=jQuery.expr.attrHandle;jQuery.fn.extend({attr:function(e,t){return access(this,jQuery.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){jQuery.removeAttr(this,e)})}}),jQuery.extend({attr:function(e,t,n){var r,i,s=e.nodeType;if(!e||s===3||s===8||s===2)return;if(typeof e.getAttribute===strundefined)return jQuery.prop(e,t,n);if(s!==1||!jQuery.isXMLDoc(e))t=t.toLowerCase(),r=jQuery.attrHooks[t]||(jQuery.expr.match.bool.test(t)?boolHook:nodeHook);if(n===undefined)return r&&"get"in r&&(i=r.get(e,t))!==null?i:(i=jQuery.find.attr(e,t),i==null?undefined:i);if(n!==null)return r&&"set"in r&&(i=r.set(e,n,t))!==undefined?i:(e.setAttribute(t,n+""),n);jQuery.removeAttr(e,t)},removeAttr:function(e,t){var n,r,i=0,s=t&&t.match(rnotwhite);if(s&&e.nodeType===1)while(n=s[i++])r=jQuery.propFix[n]||n,jQuery.expr.match.bool.test(n)&&(e[r]=!1),e.removeAttribute(n)},attrHooks:{type:{set:function(e,t){if(!support.radioValue&&t==="radio"&&jQuery.nodeName(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}}}),boolHook={set:function(e,t,n){return t===!1?jQuery.removeAttr(e,n):e.setAttribute(n,n),n}},jQuery.each(jQuery.expr.match.bool.source.match(/\w+/g),function(e,t){var n=attrHandle[t]||jQuery.find.attr;attrHandle[t]=function(e,t,r){var i,s;return r||(s=attrHandle[t],attrHandle[t]=i,i=n(e,t,r)!=null?t.toLowerCase():null,attrHandle[t]=s),i}});var rfocusable=/^(?:input|select|textarea|button)$/i;jQuery.fn.extend({prop:function(e,t){return access(this,jQuery.prop,e,t,arguments.length>1)},removeProp:function(e){return this.each(function(){delete this[jQuery.propFix[e]||e]})}}),jQuery.extend({propFix:{"for":"htmlFor","class":"className"},prop:function(e,t,n){var r,i,s,o=e.nodeType;if(!e||o===3||o===8||o===2)return;return s=o!==1||!jQuery.isXMLDoc(e),s&&(t=jQuery.propFix[t]||t,i=jQuery.propHooks[t]),n!==undefined?i&&"set"in i&&(r=i.set(e,n,t))!==undefined?r:e[t]=n:i&&"get"in i&&(r=i.get(e,t))!==null?r:e[t]},propHooks:{tabIndex:{get:function(e){return e.hasAttribute("tabindex")||rfocusable.test(e.nodeName)||e.href?e.tabIndex:-1}}}}),support.optSelected||(jQuery.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null}}),jQuery.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){jQuery.propFix[this.toLowerCase()]=this});var rclass=/[\t\r\n\f]/g;jQuery.fn.extend({addClass:function(e){var t,n,r,i,s,o,u=typeof e=="string"&&e,a=0,f=this.length;if(jQuery.isFunction(e))return this.each(function(t){jQuery(this).addClass(e.call(this,t,this.className))});if(u){t=(e||"").match(rnotwhite)||[];for(;a<f;a++){n=this[a],r=n.nodeType===1&&(n.className?(" "+n.className+" ").replace(rclass," "):" ");if(r){s=0;while(i=t[s++])r.indexOf(" "+i+" ")<0&&(r+=i+" ");o=jQuery.trim(r),n.className!==o&&(n.className=o)}}}return this},removeClass:function(e){var t,n,r,i,s,o,u=arguments.length===0||typeof e=="string"&&e,a=0,f=this.length;if(jQuery.isFunction(e))return this.each(function(t){jQuery(this).removeClass(e.call(this,t,this.className))});if(u){t=(e||"").match(rnotwhite)||[];for(;a<f;a++){n=this[a],r=n.nodeType===1&&(n.className?(" "+n.className+" ").replace(rclass," "):"");if(r){s=0;while(i=t[s++])while(r.indexOf(" "+i+" ")>=0)r=r.replace(" "+i+" "," ");o=e?jQuery.trim(r):"",n.className!==o&&(n.className=o)}}}return this},toggleClass:function(e,t){var n=typeof e;return typeof t=="boolean"&&n==="string"?t?this.addClass(e):this.removeClass(e):jQuery.isFunction(e)?this.each(function(n){jQuery(this).toggleClass(e.call(this,n,this.className,t),t)}):this.each(function(){if(n==="string"){var t,r=0,i=jQuery(this),s=e.match(rnotwhite)||[];while(t=s[r++])i.hasClass(t)?i.removeClass(t):i.addClass(t)}else if(n===strundefined||n==="boolean")this.className&&data_priv.set(this,"__className__",this.className),this.className=this.className||e===!1?"":data_priv.get(this,"__className__")||""})},hasClass:function(e){var t=" "+e+" ",n=0,r=this.length;for(;n<r;n++)if(this[n].nodeType===1&&(" "+this[n].className+" ").replace(rclass," ").indexOf(t)>=0)return!0;return!1}});var rreturn=/\r/g;jQuery.fn.extend({val:function(e){var t,n,r,i=this[0];if(!arguments.length){if(i)return t=jQuery.valHooks[i.type]||jQuery.valHooks[i.nodeName.toLowerCase()],t&&"get"in t&&(n=t.get(i,"value"))!==undefined?n:(n=i.value,typeof n=="string"?n.replace(rreturn,""):n==null?"":n);return}return r=jQuery.isFunction(e),this.each(function(n){var i;if(this.nodeType!==1)return;r?i=e.call(this,n,jQuery(this).val()):i=e,i==null?i="":typeof i=="number"?i+="":jQuery.isArray(i)&&(i=jQuery.map(i,function(e){return e==null?"":e+""})),t=jQuery.valHooks[this.type]||jQuery.valHooks[this.nodeName.toLowerCase()];if(!t||!("set"in t)||t.set(this,i,"value")===undefined)this.value=i})}}),jQuery.extend({valHooks:{select:{get:function(e){var t,n,r=e.options,i=e.selectedIndex,s=e.type==="select-one"||i<0,o=s?null:[],u=s?i+1:r.length,a=i<0?u:s?i:0;for(;a<u;a++){n=r[a];if((n.selected||a===i)&&(support.optDisabled?!n.disabled:n.getAttribute("disabled")===null)&&(!n.parentNode.disabled||!jQuery.nodeName(n.parentNode,"optgroup"))){t=jQuery(n).val();if(s)return t;o.push(t)}}return o},set:function(e,t){var n,r,i=e.options,s=jQuery.makeArray(t),o=i.length;while(o--){r=i[o];if(r.selected=jQuery.inArray(jQuery(r).val(),s)>=0)n=!0}return n||(e.selectedIndex=-1),s}}}}),jQuery.each(["radio","checkbox"],function(){jQuery.valHooks[this]={set:function(e,t){if(jQuery.isArray(t))return e.checked=jQuery.inArray(jQuery(e).val(),t)>=0}},support.checkOn||(jQuery.valHooks[this].get=function(e){return e.getAttribute("value")===null?"on":e.value})}),jQuery.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){jQuery.fn[t]=function(e,n){return arguments.length>0?this.on(t,null,e,n):this.trigger(t)}}),jQuery.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)},bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return arguments.length===1?this.off(e,"**"):this.off(t,e||"**",n)}});var nonce=jQuery.now(),rquery=/\?/;jQuery.parseJSON=function(e){return JSON.parse(e+"")},jQuery.parseXML=function(e){var t,n;if(!e||typeof e!="string")return null;try{n=new DOMParser,t=n.parseFromString(e,"text/xml")}catch(r){t=undefined}return(!t||t.getElementsByTagName("parsererror").length)&&jQuery.error("Invalid XML: "+e),t};var ajaxLocParts,ajaxLocation,rhash=/#.*$/,rts=/([?&])_=[^&]*/,rheaders=/^(.*?):[ \t]*([^\r\n]*)$/mg,rlocalProtocol=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,rnoContent=/^(?:GET|HEAD)$/,rprotocol=/^\/\//,rurl=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,prefilters={},transports={},allTypes="*/".concat("*");try{ajaxLocation=location.href}catch(e){ajaxLocation=document.createElement("a"),ajaxLocation.href="",ajaxLocation=ajaxLocation.href}ajaxLocParts=rurl.exec(ajaxLocation.toLowerCase())||[],jQuery.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:ajaxLocation,type:"GET",isLocal:rlocalProtocol.test(ajaxLocParts[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":allTypes,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":jQuery.parseJSON,"text xml":jQuery.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?ajaxExtend(ajaxExtend(e,jQuery.ajaxSettings),t):ajaxExtend(jQuery.ajaxSettings,e)},ajaxPrefilter:addToPrefiltersOrTransports(prefilters),ajaxTransport:addToPrefiltersOrTransports(transports),ajax:function(e,t){function S(e,t,s,u){var f,m,g,b,E,S=t;if(y===2)return;y=2,o&&clearTimeout(o),n=undefined,i=u||"",w.readyState=e>0?4:0,f=e>=200&&e<300||e===304,s&&(b=ajaxHandleResponses(l,w,s)),b=ajaxConvert(l,b,w,f);if(f)l.ifModified&&(E=w.getResponseHeader("Last-Modified"),E&&(jQuery.lastModified[r]=E),E=w.getResponseHeader("etag"),E&&(jQuery.etag[r]=E)),e===204||l.type==="HEAD"?S="nocontent":e===304?S="notmodified":(S=b.state,m=b.data,g=b.error,f=!g);else{g=S;if(e||!S)S="error",e<0&&(e=0)}w.status=e,w.statusText=(t||S)+"",f?p.resolveWith(c,[m,S,w]):p.rejectWith(c,[w,S,g]),w.statusCode(v),v=undefined,a&&h.trigger(f?"ajaxSuccess":"ajaxError",[w,l,f?m:g]),d.fireWith(c,[w,S]),a&&(h.trigger("ajaxComplete",[w,l]),--jQuery.active||jQuery.event.trigger("ajaxStop"))}typeof e=="object"&&(t=e,e=undefined),t=t||{};var n,r,i,s,o,u,a,f,l=jQuery.ajaxSetup({},t),c=l.context||l,h=l.context&&(c.nodeType||c.jquery)?jQuery(c):jQuery.event,p=jQuery.Deferred(),d=jQuery.Callbacks("once memory"),v=l.statusCode||{},m={},g={},y=0,b="canceled",w={readyState:0,getResponseHeader:function(e){var t;if(y===2){if(!s){s={};while(t=rheaders.exec(i))s[t[1].toLowerCase()]=t[2]}t=s[e.toLowerCase()]}return t==null?null:t},getAllResponseHeaders:function(){return y===2?i:null},setRequestHeader:function(e,t){var n=e.toLowerCase();return y||(e=g[n]=g[n]||e,m[e]=t),this},overrideMimeType:function(e){return y||(l.mimeType=e),this},statusCode:function(e){var t;if(e)if(y<2)for(t in e)v[t]=[v[t],e[t]];else w.always(e[w.status]);return this},abort:function(e){var t=e||b;return n&&n.abort(t),S(0,t),this}};p.promise(w).complete=d.add,w.success=w.done,w.error=w.fail,l.url=((e||l.url||ajaxLocation)+"").replace(rhash,"").replace(rprotocol,ajaxLocParts[1]+"//"),l.type=t.method||t.type||l.method||l.type,l.dataTypes=jQuery.trim(l.dataType||"*").toLowerCase().match(rnotwhite)||[""],l.crossDomain==null&&(u=rurl.exec(l.url.toLowerCase()),l.crossDomain=!(!u||u[1]===ajaxLocParts[1]&&u[2]===ajaxLocParts[2]&&(u[3]||(u[1]==="http:"?"80":"443"))===(ajaxLocParts[3]||(ajaxLocParts[1]==="http:"?"80":"443")))),l.data&&l.processData&&typeof l.data!="string"&&(l.data=jQuery.param(l.data,l.traditional)),inspectPrefiltersOrTransports(prefilters,l,t,w);if(y===2)return w;a=l.global,a&&jQuery.active++===0&&jQuery.event.trigger("ajaxStart"),l.type=l.type.toUpperCase(),l.hasContent=!rnoContent.test(l.type),r=l.url,l.hasContent||(l.data&&(r=l.url+=(rquery.test(r)?"&":"?")+l.data,delete l.data),l.cache===!1&&(l.url=rts.test(r)?r.replace(rts,"$1_="+nonce++):r+(rquery.test(r)?"&":"?")+"_="+nonce++)),l.ifModified&&(jQuery.lastModified[r]&&w.setRequestHeader("If-Modified-Since",jQuery.lastModified[r]),jQuery.etag[r]&&w.setRequestHeader("If-None-Match",jQuery.etag[r])),(l.data&&l.hasContent&&l.contentType!==!1||t.contentType)&&w.setRequestHeader("Content-Type",l.contentType),w.setRequestHeader("Accept",l.dataTypes[0]&&l.accepts[l.dataTypes[0]]?l.accepts[l.dataTypes[0]]+(l.dataTypes[0]!=="*"?", "+allTypes+"; q=0.01":""):l.accepts["*"]);for(f in l.headers)w.setRequestHeader(f,l.headers[f]);if(!l.beforeSend||l.beforeSend.call(c,w,l)!==!1&&y!==2){b="abort";for(f in{success:1,error:1,complete:1})w[f](l[f]);n=inspectPrefiltersOrTransports(transports,l,t,w);if(!n)S(-1,"No Transport");else{w.readyState=1,a&&h.trigger("ajaxSend",[w,l]),l.async&&l.timeout>0&&(o=setTimeout(function(){w.abort("timeout")},l.timeout));try{y=1,n.send(m,S)}catch(E){if(!(y<2))throw E;S(-1,E)}}return w}return w.abort()},getJSON:function(e,t,n){return jQuery.get(e,t,n,"json")},getScript:function(e,t){return jQuery.get(e,undefined,t,"script")}}),jQuery.each(["get","post"],function(e,t){jQuery[t]=function(e,n,r,i){return jQuery.isFunction(n)&&(i=i||r,r=n,n=undefined),jQuery.ajax({url:e,type:t,dataType:i,data:n,success:r})}}),jQuery.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){jQuery.fn[t]=function(e){return this.on(t,e)}}),jQuery._evalUrl=function(e){return jQuery.ajax({url:e,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})},jQuery.fn.extend({wrapAll:function(e){var t;return jQuery.isFunction(e)?this.each(function(t){jQuery(this).wrapAll(e.call(this,t))}):(this[0]&&(t=jQuery(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){var e=this;while(e.firstElementChild)e=e.firstElementChild;return e}).append(this)),this)},wrapInner:function(e){return jQuery.isFunction(e)?this.each(function(t){jQuery(this).wrapInner(e.call(this,t))}):this.each(function(){var t=jQuery(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)})},wrap:function(e){var t=jQuery.isFunction(e);return this.each(function(n){jQuery(this).wrapAll(t?e.call(this,n):e)})},unwrap:function(){return this.parent().each(function(){jQuery.nodeName(this,"body")||jQuery(this).replaceWith(this.childNodes)}).end()}}),jQuery.expr.filters.hidden=function(e){return e.offsetWidth<=0&&e.offsetHeight<=0},jQuery.expr.filters.visible=function(e){return!jQuery.expr.filters.hidden(e)};var r20=/%20/g,rbracket=/\[\]$/,rCRLF=/\r?\n/g,rsubmitterTypes=/^(?:submit|button|image|reset|file)$/i,rsubmittable=/^(?:input|select|textarea|keygen)/i;jQuery.param=function(e,t){var n,r=[],i=function(e,t){t=jQuery.isFunction(t)?t():t==null?"":t,r[r.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};t===undefined&&(t=jQuery.ajaxSettings&&jQuery.ajaxSettings.traditional);if(jQuery.isArray(e)||e.jquery&&!jQuery.isPlainObject(e))jQuery.each(e,function(){i(this.name,this.value)});else for(n in e)buildParams(n,e[n],t,i);return r.join("&").replace(r20,"+")},jQuery.fn.extend({serialize:function(){return jQuery.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=jQuery.prop(this,"elements");return e?jQuery.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!jQuery(this).is(":disabled")&&rsubmittable.test(this.nodeName)&&!rsubmitterTypes.test(e)&&(this.checked||!rcheckableType.test(e))}).map(function(e,t){var n=jQuery(this).val();return n==null?null:jQuery.isArray(n)?jQuery.map(n,function(e){return{name:t.name,value:e.replace(rCRLF,"\r\n")}}):{name:t.name,value:n.replace(rCRLF,"\r\n")}}).get()}}),jQuery.ajaxSettings.xhr=function(){try{return new XMLHttpRequest}catch(e){}};var xhrId=0,xhrCallbacks={},xhrSuccessStatus={0:200,1223:204},xhrSupported=jQuery.ajaxSettings.xhr();window.ActiveXObject&&jQuery(window).on("unload",function(){for(var e in xhrCallbacks)xhrCallbacks[e]()}),support.cors=!!xhrSupported&&"withCredentials"in xhrSupported,support.ajax=xhrSupported=!!xhrSupported,jQuery.ajaxTransport(function(e){var t;if(support.cors||xhrSupported&&!e.crossDomain)return{send:function(n,r){var i,s=e.xhr(),o=++xhrId;s.open(e.type,e.url,e.async,e.username,e.password);if(e.xhrFields)for(i in e.xhrFields)s[i]=e.xhrFields[i];e.mimeType&&s.overrideMimeType&&s.overrideMimeType(e.mimeType),!e.crossDomain&&!n["X-Requested-With"]&&(n["X-Requested-With"]="XMLHttpRequest");for(i in n)s.setRequestHeader(i,n[i]);t=function(e){return function(){t&&(delete xhrCallbacks[o],t=s.onload=s.onerror=null,e==="abort"?s.abort():e==="error"?r(s.status,s.statusText):r(xhrSuccessStatus[s.status]||s.status,s.statusText,typeof s.responseText=="string"?{text:s.responseText}:undefined,s.getAllResponseHeaders()))}},s.onload=t(),s.onerror=t("error"),t=xhrCallbacks[o]=t("abort"),s.send(e.hasContent&&e.data||null)},abort:function(){t&&t()}}}),jQuery.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(e){return jQuery.globalEval(e),e}}}),jQuery.ajaxPrefilter("script",function(e){e.cache===undefined&&(e.cache=!1),e.crossDomain&&(e.type="GET")}),jQuery.ajaxTransport("script",function(e){if(e.crossDomain){var t,n;return{send:function(r,i){t=jQuery("<script>").prop({async:!0,charset:e.scriptCharset,src:e.url}).on("load error",n=function(e){t.remove(),n=null,e&&i(e.type==="error"?404:200,e.type)}),document.head.appendChild(t[0])},abort:function(){n&&n()}}}});var oldCallbacks=[],rjsonp=/(=)\?(?=&|$)|\?\?/;jQuery.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=oldCallbacks.pop()||jQuery.expando+"_"+nonce++;return this[e]=!0,e}}),jQuery.ajaxPrefilter("json jsonp",function(e,t,n){var r,i,s,o=e.jsonp!==!1&&(rjsonp.test(e.url)?"url":typeof e.data=="string"&&!(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&rjsonp.test(e.data)&&"data");if(o||e.dataTypes[0]==="jsonp")return r=e.jsonpCallback=jQuery.isFunction(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,o?e[o]=e[o].replace(rjsonp,"$1"+r):e.jsonp!==!1&&(e.url+=(rquery.test(e.url)?"&":"?")+e.jsonp+"="+r),e.converters["script json"]=function(){return s||jQuery.error(r+" was not called"),s[0]},e.dataTypes[0]="json",i=window[r],window[r]=function(){s=arguments},n.always(function(){window[r]=i,e[r]&&(e.jsonpCallback=t.jsonpCallback,oldCallbacks.push(r)),s&&jQuery.isFunction(i)&&i(s[0]),s=i=undefined}),"script"}),jQuery.parseHTML=function(e,t,n){if(!e||typeof e!="string")return null;typeof t=="boolean"&&(n=t,t=!1),t=t||document;var r=rsingleTag.exec(e),i=!n&&[];return r?[t.createElement(r[1])]:(r=jQuery.buildFragment([e],t,i),i&&i.length&&jQuery(i).remove(),jQuery.merge([],r.childNodes))};var _load=jQuery.fn.load;jQuery.fn.load=function(e,t,n){if(typeof e!="string"&&_load)return _load.apply(this,arguments);var r,i,s,o=this,u=e.indexOf(" ");return u>=0&&(r=e.slice(u),e=e.slice(0,u)),jQuery.isFunction(t)?(n=t,t=undefined):t&&typeof t=="object"&&(i="POST"),o.length>0&&jQuery.ajax({url:e,type:i,dataType:"html",data:t}).done(function(e){s=arguments,o.html(r?jQuery("<div>").append(jQuery.parseHTML(e)).find(r):e)}).complete(n&&function(e,t){o.each(n,s||[e.responseText,t,e])}),this},jQuery.expr.filters.animated=function(e){return jQuery.grep(jQuery.timers,function(t){return e===t.elem}).length};var docElem=window.document.documentElement;jQuery.offset={setOffset:function(e,t,n){var r,i,s,o,u,a,f,l=jQuery.css(e,"position"),c=jQuery(e),h={};l==="static"&&(e.style.position="relative"),u=c.offset(),s=jQuery.css(e,"top"),a=jQuery.css(e,"left"),f=(l==="absolute"||l==="fixed")&&(s+a).indexOf("auto")>-1,f?(r=c.position(),o=r.top,i=r.left):(o=parseFloat(s)||0,i=parseFloat(a)||0),jQuery.isFunction(t)&&(t=t.call(e,n,u)),t.top!=null&&(h.top=t.top-u.top+o),t.left!=null&&(h.left=t.left-u.left+i),"using"in t?t.using.call(e,h):c.css(h)}},jQuery.fn.extend({offset:function(e){if(arguments.length)return e===undefined?this:this.each(function(t){jQuery.offset.setOffset(this,e,t)});var t,n,r=this[0],i={top:0,left:0},s=r&&r.ownerDocument;if(!s)return;return t=s.documentElement,jQuery.contains(t,r)?(typeof r.getBoundingClientRect!==strundefined&&(i=r.getBoundingClientRect()),n=getWindow(s),{top:i.top+n.pageYOffset-t.clientTop,left:i.left+n.pageXOffset-t.clientLeft}):i},position:function(){if(!this[0])return;var e,t,n=this[0],r={top:0,left:0};return jQuery.css(n,"position")==="fixed"?t=n.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),jQuery.nodeName(e[0],"html")||(r=e.offset()),r.top+=jQuery.css(e[0],"borderTopWidth",!0),r.left+=jQuery.css(e[0],"borderLeftWidth",!0)),{top:t.top-r.top-jQuery.css(n,"marginTop",!0),left:t.left-r.left-jQuery.css(n,"marginLeft",!0)}},offsetParent:function(){return this.map(function(){var e=this.offsetParent||docElem;while(e&&!jQuery.nodeName(e,"html")&&jQuery.css(e,"position")==="static")e=e.offsetParent;return e||docElem})}}),jQuery.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,t){var n="pageYOffset"===t;jQuery.fn[e]=function(r){return access(this,function(e,r,i){var s=getWindow(e);if(i===undefined)return s?s[t]:e[r];s?s.scrollTo(n?window.pageXOffset:i,n?i:window.pageYOffset):e[r]=i},e,r,arguments.length,null)}}),jQuery.each(["top","left"],function(e,t){jQuery.cssHooks[t]=addGetHookIf(support.pixelPosition,function(e,n){if(n)return n=curCSS(e,t),rnumnonpx.test(n)?jQuery(e).position()[t]+"px":n})}),jQuery.each({Height:"height",Width:"width"},function(e,t){jQuery.each({padding:"inner"+e,content:t,"":"outer"+e},function(n,r){jQuery.fn[r]=function(r,i){var s=arguments.length&&(n||typeof r!="boolean"),o=n||(r===!0||i===!0?"margin":"border");return access(this,function(t,n,r){var i;return jQuery.isWindow(t)?t.document.documentElement["client"+e]:t.nodeType===9?(i=t.documentElement,Math.max(t.body["scroll"+e],i["scroll"+e],t.body["offset"+e],i["offset"+e],i["client"+e])):r===undefined?jQuery.css(t,n,o):jQuery.style(t,n,r,o)},t,s?r:undefined,s,null)}})}),jQuery.fn.size=function(){return this.length},jQuery.fn.andSelf=jQuery.fn.addBack,typeof define=="function"&&define.amd&&define("jquery",[],function(){return jQuery});var _jQuery=window.jQuery,_$=window.$;return jQuery.noConflict=function(e){return window.$===jQuery&&(window.$=_$),e&&window.jQuery===jQuery&&(window.jQuery=_jQuery),jQuery},typeof noGlobal===strundefined&&(window.jQuery=window.$=jQuery),jQuery}),define("message-bus",["jquery"],function(e){function n(e,n){t.trigger(e,n)}function r(e,n){t.bind(e,n)}var t=e({});return{send:n,listen:r}}),define("customization",["module","message-bus"],function(e,t){var n=e.config();return require(n.modules,function(){t.send("modules-loaded")}),n}),define("layers",["jquery","message-bus","customization","module"],function(e,t,n,r){var i=function(e,t,n){var r=e[t];return r!==undefined?r:n},s=function(t,n){return e.grep(t,function(e){return e.id===n})};t.listen("add-portal-layer",function(e,n){var r=n.wmsLayers,i;for(i=0;i<r.length;i++)t.send("add-layer",r[i])}),t.listen("portal-layer-visibility",function(e,n){var r=n.wmsLayers,s;for(s=0;s<r.length;s++)t.send("layer-visibility",[r[s],i(n,"active",!1)])});var o=function(e,r,i){var u,a,f,l,c,h,p,d,v,m,g={id:i.id,name:i.label};i.hasOwnProperty("infoFile")&&(g.infoLink="static/loc/"+n.languageCode+"/html/"+i.infoFile),r!==null&&(g.parentId=r),t.send("add-group",g),u=i.items;for(d=0;d<u.length;d++){a=u[d];if(typeof a=="object")o(e,i.id,a);else{f=s(e.portalLayers,a);if(f.length!==1){t.send("error","One (and only one) portal layer with id '"+a+"' expected");continue}l=f[0],c=l.layers,m=[];for(v=0;v<c.length;v++){h=s(e.wmsLayers,c[v]);if(h.length===0){t.send("error","At least one layer with id '"+c[v]+"' expected");continue}p=h[0],p.hasOwnProperty("wmsTime")&&(p.timestamps=p.wmsTime.split(",")),m.push(p)}l.groupId=i.id,l.wmsLayers=m,t.send("add-portal-layer",l),t.send("portal-layer-visibility",l)}}};t.listen("modules-loaded",function(){var e,n=r.config(),i=n.groups;for(e=0;e<i.length;e++)o(n,null,i[e]);t.send("layers-loaded")})}),define("communication",["jquery","message-bus"],function(e,t){t.listen("ajax",function(n,r){if(r.url.indexOf("proxy")!==0){var i="",s=decodeURIComponent(((new RegExp("[?|&]lang=([^&;]+?)(&|#|;|$)")).exec(location.search)||[,""])[1].replace(/\+/g,"%20"))||null;s!==null&&(i="lang="+s),r.hasOwnProperty("data")?r.data+="&":r.data="",r.data+=i}r.error=function(n,i,s){var o=r.errorMsg+". ",u="Unrecognized error from server.";try{var a=e.parseJSON(n.responseText);a.hasOwnProperty("message")?o+=a.message+".":o+=u}catch(f){console.log(f),o=n.status+": "+u}t.send("error",o)},e.ajax(r)})}),define("iso8601",[],function(){Date.prototype.setISO8601=function(e){var t="([0-9]{4})(-([0-9]{2})(-([0-9]{2})(T([0-9]{2}):([0-9]{2})(:([0-9]{2})(\\.([0-9]+))?)?(Z|(([-+])([0-9]{2}):([0-9]{2})))?)?)?)?",n=e.match(new RegExp(t));if(n){var r=new Date(n[1],0,1),i=0,s;return n[3]&&r.setMonth(n[3]-1),n[5]&&r.setDate(n[5]),n[7]&&r.setHours(n[7]),n[8]&&r.setMinutes(n[8]),n[10]&&r.setSeconds(n[10]),n[12]&&r.setMilliseconds(Number("0."+n[12])*1e3),n[14]&&(i=Number(n[16])*60+Number(n[17]),i*=n[15]==="-"?1:-1),i-=r.getTimezoneOffset(),s=Number(r)+i*60*1e3,this.setTime(Number(s)),!0}return!1},Date.prototype.toISO8601String=function(){function e(e){return e<10?"0"+e:e}return this.getUTCFullYear()+"-"+e(this.getUTCMonth()+1)+"-"+e(this.getUTCDate())+"T"+e(this.getUTCHours())+":"+e(this.getUTCMinutes())+":"+e(this.getUTCSeconds())+"."+e(this.getUTCMilliseconds())+"Z"}}),define("error-management",["message-bus"],function(e){e.listen("error",function(e,t){window.alert(t)})}),define("layout",["jquery"],function(e){var t=e("body"),n=e("<div/>").attr("id","header"),r=e("<div/>").attr("id","banner");n.append(r);var i=e("<div/>").attr("id","toolbar"),s=e("<div/>").attr("id","time_slider_pane");i.append(s),n.append(i),t.append(n);var o=e("<div/>").attr("id","center"),u=e("<div/>").attr("id","map");o.append(u),t.append(o);var a=e("<div/>").attr("id","layers_container");t.append(a);var f=e("<div/>").attr("id","active_layers_container");t.append(f);var l=e("<div/>").attr("id","layer_list_selector_pane");return t.append(l),e(function(){document.body.onselectstart=function(){return!1}}),{banner:r,toolbar:i,timeSlider:s,map:u,layers:a,activeLayers:f,layerListSelector:l}});var OpenLayers={VERSION_NUMBER:"Release 2.12",singleFile:!0,_getScriptLocation:function(){var e=new RegExp("(^|(.*?\\/))(OpenLayers[^\\/]*?\\.js)(\\?|$)"),t=document.getElementsByTagName("script"),n,r,i="";for(var s=0,o=t.length;s<o;s++){n=t[s].getAttribute("src");if(n){r=n.match(e);if(r){i=r[1];break}}}return function(){return i}}(),ImgPath:""};OpenLayers.Class=function(){var e=arguments.length,t=arguments[0],n=arguments[e-1],r=typeof n.initialize=="function"?n.initialize:function(){t.prototype.initialize.apply(this,arguments)};if(e>1){var i=[r,t].concat(Array.prototype.slice.call(arguments).slice(1,e-1),n);OpenLayers.inherit.apply(null,i)}else r.prototype=n;return r},OpenLayers.inherit=function(e,t){var n=function(){};n.prototype=t.prototype,e.prototype=new n;var r,i,s;for(r=2,i=arguments.length;r<i;r++)s=arguments[r],typeof s=="function"&&(s=s.prototype),OpenLayers.Util.extend(e.prototype,s)},OpenLayers.Util=OpenLayers.Util||{},OpenLayers.Util.extend=function(e,t){e=e||{};if(t){for(var n in t){var r=t[n];r!==undefined&&(e[n]=r)}var i=typeof window.Event=="function"&&t instanceof window.Event;!i&&t.hasOwnProperty&&t.hasOwnProperty("toString")&&(e.toString=t.toString)}return e},OpenLayers.String={startsWith:function(e,t){return e.indexOf(t)==0},contains:function(e,t){return e.indexOf(t)!=-1},trim:function(e){return e.replace(/^\s\s*/,"").replace(/\s\s*$/,"")},camelize:function(e){var t=e.split("-"),n=t[0];for(var r=1,i=t.length;r<i;r++){var s=t[r];n+=s.charAt(0).toUpperCase()+s.substring(1)}return n},format:function(e,t,n){t||(t=window);var r=function(e,r){var i,s=r.split(/\.+/);for(var o=0;o<s.length;o++)o==0&&(i=t),i=i[s[o]];return typeof i=="function"&&(i=n?i.apply(null,n):i()),typeof i=="undefined"?"undefined":i};return e.replace(OpenLayers.String.tokenRegEx,r)},tokenRegEx:/\$\{([\w.]+?)\}/g,numberRegEx:/^([+-]?)(?=\d|\.\d)\d*(\.\d*)?([Ee]([+-]?\d+))?$/,isNumeric:function(e){return OpenLayers.String.numberRegEx.test(e)},numericIf:function(e){return OpenLayers.String.isNumeric(e)?parseFloat(e):e}},OpenLayers.Number={decimalSeparator:".",thousandsSeparator:",",limitSigDigs:function(e,t){var n=0;return t>0&&(n=parseFloat(e.toPrecision(t))),n},format:function(e,t,n,r){t=typeof t!="undefined"?t:0,n=typeof n!="undefined"?n:OpenLayers.Number.thousandsSeparator,r=typeof r!="undefined"?r:OpenLayers.Number.decimalSeparator,t!=null&&(e=parseFloat(e.toFixed(t)));var i=e.toString().split(".");i.length==1&&t==null&&(t=0);var s=i[0];if(n){var o=/(-?[0-9]+)([0-9]{3})/;while(o.test(s))s=s.replace(o,"$1"+n+"$2")}var u;if(t==0)u=s;else{var a=i.length>1?i[1]:"0";t!=null&&(a+=(new Array(t-a.length+1)).join("0")),u=s+r+a}return u}},OpenLayers.Function={bind:function(e,t){var n=Array.prototype.slice.apply(arguments,[2]);return function(){var r=n.concat(Array.prototype.slice.apply(arguments,[0]));return e.apply(t,r)}},bindAsEventListener:function(e,t){return function(n){return e.call(t,n||window.event)}},False:function(){return!1},True:function(){return!0},Void:function(){}},OpenLayers.Array={filter:function(e,t,n){var r=[];if(Array.prototype.filter)r=e.filter(t,n);else{var i=e.length;if(typeof t!="function")throw new TypeError;for(var s=0;s<i;s++)if(s in e){var o=e[s];t.call(n,o,s,e)&&r.push(o)}}return r}},OpenLayers.Bounds=OpenLayers.Class({left:null,bottom:null,right:null,top:null,centerLonLat:null,initialize:function(e,t,n,r){OpenLayers.Util.isArray(e)&&(r=e[3],n=e[2],t=e[1],e=e[0]),e!=null&&(this.left=OpenLayers.Util.toFloat(e)),t!=null&&(this.bottom=OpenLayers.Util.toFloat(t)),n!=null&&(this.right=OpenLayers.Util.toFloat(n)),r!=null&&(this.top=OpenLayers.Util.toFloat(r))},clone:function(){return new OpenLayers.Bounds(this.left,this.bottom,this.right,this.top)},equals:function(e){var t=!1;return e!=null&&(t=this.left==e.left&&this.right==e.right&&this.top==e.top&&this.bottom==e.bottom),t},toString:function(){return[this.left,this.bottom,this.right,this.top].join(",")},toArray:function(e){return e===!0?[this.bottom,this.left,this.top,this.right]:[this.left,this.bottom,this.right,this.top]},toBBOX:function(e,t){e==null&&(e=6);var n=Math.pow(10,e),r=Math.round(this.left*n)/n,i=Math.round(this.bottom*n)/n,s=Math.round(this.right*n)/n,o=Math.round(this.top*n)/n;return t===!0?i+","+r+","+o+","+s:r+","+i+","+s+","+o},toGeometry:function(){return new OpenLayers.Geometry.Polygon([new OpenLayers.Geometry.LinearRing([new OpenLayers.Geometry.Point(this.left,this.bottom),new OpenLayers.Geometry.Point(this.right,this.bottom),new OpenLayers.Geometry.Point(this.right,this.top),new OpenLayers.Geometry.Point(this.left,this.top)])])},getWidth:function(){return this.right-this.left},getHeight:function(){return this.top-this.bottom},getSize:function(){return new OpenLayers.Size(this.getWidth(),this.getHeight())},getCenterPixel:function(){return new OpenLayers.Pixel((this.left+this.right)/2,(this.bottom+this.top)/2)},getCenterLonLat:function(){return this.centerLonLat||(this.centerLonLat=new OpenLayers.LonLat((this.left+this.right)/2,(this.bottom+this.top)/2)),this.centerLonLat},scale:function(e,t){t==null&&(t=this.getCenterLonLat());var n,r;t.CLASS_NAME=="OpenLayers.LonLat"?(n=t.lon,r=t.lat):(n=t.x,r=t.y);var i=(this.left-n)*e+n,s=(this.bottom-r)*e+r,o=(this.right-n)*e+n,u=(this.top-r)*e+r;return new OpenLayers.Bounds(i,s,o,u)},add:function(e,t){if(e==null||t==null)throw new TypeError("Bounds.add cannot receive null values");return new OpenLayers.Bounds(this.left+e,this.bottom+t,this.right+e,this.top+t)},extend:function(e){var t=null;if(e){switch(e.CLASS_NAME){case"OpenLayers.LonLat":t=new OpenLayers.Bounds(e.lon,e.lat,e.lon,e.lat);break;case"OpenLayers.Geometry.Point":t=new OpenLayers.Bounds(e.x,e.y,e.x,e.y);break;case"OpenLayers.Bounds":t=e}if(t){this.centerLonLat=null;if(this.left==null||t.left<this.left)this.left=t.left;if(this.bottom==null||t.bottom<this.bottom)this.bottom=t.bottom;if(this.right==null||t.right>this.right)this.right=t.right;if(this.top==null||t.top>this.top)this.top=t.top}}},containsLonLat:function(e,t){typeof t=="boolean"&&(t={inclusive:t}),t=t||{};var n=this.contains(e.lon,e.lat,t.inclusive),r=t.worldBounds;if(r&&!n){var i=r.getWidth(),s=(r.left+r.right)/2,o=Math.round((e.lon-s)/i);n=this.containsLonLat({lon:e.lon-o*i,lat:e.lat},{inclusive:t.inclusive})}return n},containsPixel:function(e,t){return this.contains(e.x,e.y,t)},contains:function(e,t,n){n==null&&(n=!0);if(e==null||t==null)return!1;e=OpenLayers.Util.toFloat(e),t=OpenLayers.Util.toFloat(t);var r=!1;return n?r=e>=this.left&&e<=this.right&&t>=this.bottom&&t<=this.top:r=e>this.left&&e<this.right&&t>this.bottom&&t<this.top,r},intersectsBounds:function(e,t){typeof t=="boolean"&&(t={inclusive:t}),t=t||{};if(t.worldBounds){var n=this.wrapDateLine(t.worldBounds);e=e.wrapDateLine(t.worldBounds)}else n=this;t.inclusive==null&&(t.inclusive=!0);var r=!1,i=n.left==e.right||n.right==e.left||n.top==e.bottom||n.bottom==e.top;if(t.inclusive||!i){var s=e.bottom>=n.bottom&&e.bottom<=n.top||n.bottom>=e.bottom&&n.bottom<=e.top,o=e.top>=n.bottom&&e.top<=n.top||n.top>e.bottom&&n.top<e.top,u=e.left>=n.left&&e.left<=n.right||n.left>=e.left&&n.left<=e.right,a=e.right>=n.left&&e.right<=n.right||n.right>=e.left&&n.right<=e.right;r=(s||o)&&(u||a)}if(t.worldBounds&&!r){var f=t.worldBounds,l=f.getWidth(),c=!f.containsBounds(n),h=!f.containsBounds(e);c&&!h?(e=e.add(-l,0),r=n.intersectsBounds(e,{inclusive:t.inclusive})):h&&!c&&(n=n.add(-l,0),r=e.intersectsBounds(n,{inclusive:t.inclusive}))}return r},containsBounds:function(e,t,n){t==null&&(t=!1),n==null&&(n=!0);var r=this.contains(e.left,e.bottom,n),i=this.contains(e.right,e.bottom,n),s=this.contains(e.left,e.top,n),o=this.contains(e.right,e.top,n);return t?r||i||s||o:r&&i&&s&&o},determineQuadrant:function(e){var t="",n=this.getCenterLonLat();return t+=e.lat<n.lat?"b":"t",t+=e.lon<n.lon?"l":"r",t},transform:function(e,t){this.centerLonLat=null;var n=OpenLayers.Projection.transform({x:this.left,y:this.bottom},e,t),r=OpenLayers.Projection.transform({x:this.right,y:this.bottom},e,t),i=OpenLayers.Projection.transform({x:this.left,y:this.top},e,t),s=OpenLayers.Projection.transform({x:this.right,y:this.top},e,t);return this.left=Math.min(n.x,i.x),this.bottom=Math.min(n.y,r.y),this.right=Math.max(r.x,s.x),this.top=Math.max(i.y,s.y),this},wrapDateLine:function(e,t){t=t||{};var n=t.leftTolerance||0,r=t.rightTolerance||0,i=this.clone();if(e){var s=e.getWidth();while(i.left<e.left&&i.right-r<=e.left)i=i.add(s,0);while(i.left+n>=e.right&&i.right>e.right)i=i.add(-s,0);var o=i.left+n;o<e.right&&o>e.left&&i.right-r>e.right&&(i=i.add(-s,0))}return i},CLASS_NAME:"OpenLayers.Bounds"}),OpenLayers.Bounds.fromString=function(e,t){var n=e.split(",");return OpenLayers.Bounds.fromArray(n,t)},OpenLayers.Bounds.fromArray=function(e,t){return t===!0?new OpenLayers.Bounds(e[1],e[0],e[3],e[2]):new OpenLayers.Bounds(e[0],e[1],e[2],e[3])},OpenLayers.Bounds.fromSize=function(e){return new OpenLayers.Bounds(0,e.h,e.w,0)},OpenLayers.Bounds.oppositeQuadrant=function(e){var t="";return t+=e.charAt(0)=="t"?"b":"t",t+=e.charAt(1)=="l"?"r":"l",t},OpenLayers.Element={visible:function(e){return OpenLayers.Util.getElement(e).style.display!="none"},toggle:function(){for(var e=0,t=arguments.length;e<t;e++){var n=OpenLayers.Util.getElement(arguments[e]),r=OpenLayers.Element.visible(n)?"none":"";n.style.display=r}},remove:function(e){e=OpenLayers.Util.getElement(e),e.parentNode.removeChild(e)},getHeight:function(e){return e=OpenLayers.Util.getElement(e),e.offsetHeight},hasClass:function(e,t){var n=e.className;return!!n&&(new RegExp("(^|\\s)"+t+"(\\s|$)")).test(n)},addClass:function(e,t){return OpenLayers.Element.hasClass(e,t)||(e.className+=(e.className?" ":"")+t),e},removeClass:function(e,t){var n=e.className;return n&&(e.className=OpenLayers.String.trim(n.replace(new RegExp("(^|\\s+)"+t+"(\\s+|$)")," "))),e},toggleClass:function(e,t){return OpenLayers.Element.hasClass(e,t)?OpenLayers.Element.removeClass(e,t):OpenLayers.Element.addClass(e,t),e},getStyle:function(e,t){e=OpenLayers.Util.getElement(e);var n=null;if(e&&e.style){n=e.style[OpenLayers.String.camelize(t)];if(!n)if(document.defaultView&&document.defaultView.getComputedStyle){var r=document.defaultView.getComputedStyle(e,null);n=r?r.getPropertyValue(t):null}else e.currentStyle&&(n=e.currentStyle[OpenLayers.String.camelize(t)]);var i=["left","top","right","bottom"];window.opera&&OpenLayers.Util.indexOf(i,t)!=-1&&OpenLayers.Element.getStyle(e,"position")=="static"&&(n="auto")}return n=="auto"?null:n}},OpenLayers.LonLat=OpenLayers.Class({lon:0,lat:0,initialize:function(e,t){OpenLayers.Util.isArray(e)&&(t=e[1],e=e[0]),this.lon=OpenLayers.Util.toFloat(e),this.lat=OpenLayers.Util.toFloat(t)},toString:function(){return"lon="+this.lon+",lat="+this.lat},toShortString:function(){return this.lon+", "+this.lat},clone:function(){return new OpenLayers.LonLat(this.lon,this.lat)},add:function(e,t){if(e==null||t==null)throw new TypeError("LonLat.add cannot receive null values");return new OpenLayers.LonLat(this.lon+OpenLayers.Util.toFloat(e),this.lat+OpenLayers.Util.toFloat(t))},equals:function(e){var t=!1;return e!=null&&(t=this.lon==e.lon&&this.lat==e.lat||isNaN(this.lon)&&isNaN(this.lat)&&isNaN(e.lon)&&isNaN(e.lat)),t},transform:function(e,t){var n=OpenLayers.Projection.transform({x:this.lon,y:this.lat},e,t);return this.lon=n.x,this.lat=n.y,this},wrapDateLine:function(e){var t=this.clone();if(e){while(t.lon<e.left)t.lon+=e.getWidth();while(t.lon>e.right)t.lon-=e.getWidth()}return t},CLASS_NAME:"OpenLayers.LonLat"}),OpenLayers.LonLat.fromString=function(e){var t=e.split(",");return new OpenLayers.LonLat(t[0],t[1])},OpenLayers.LonLat.fromArray=function(e){var t=OpenLayers.Util.isArray(e),n=t&&e[0],r=t&&e[1];return new OpenLayers.LonLat(n,r)},OpenLayers.Pixel=OpenLayers.Class({x:0,y:0,initialize:function(e,t){this.x=parseFloat(e),this.y=parseFloat(t)},toString:function(){return"x="+this.x+",y="+this.y},clone:function(){return new OpenLayers.Pixel(this.x,this.y)},equals:function(e){var t=!1;return e!=null&&(t=this.x==e.x&&this.y==e.y||isNaN(this.x)&&isNaN(this.y)&&isNaN(e.x)&&isNaN(e.y)),t},distanceTo:function(e){return Math.sqrt(Math.pow(this.x-e.x,2)+Math.pow(this.y-e.y,2))},add:function(e,t){if(e==null||t==null)throw new TypeError("Pixel.add cannot receive null values");return new OpenLayers.Pixel(this.x+e,this.y+t)},offset:function(e){var t=this.clone();return e&&(t=this.add(e.x,e.y)),t},CLASS_NAME:"OpenLayers.Pixel"}),OpenLayers.Size=OpenLayers.Class({w:0,h:0,initialize:function(e,t){this.w=parseFloat(e),this.h=parseFloat(t)},toString:function(){return"w="+this.w+",h="+this.h},clone:function(){return new OpenLayers.Size(this.w,this.h)},equals:function(e){var t=!1;return e!=null&&(t=this.w==e.w&&this.h==e.h||isNaN(this.w)&&isNaN(this.h)&&isNaN(e.w)&&isNaN(e.h)),t},CLASS_NAME:"OpenLayers.Size"}),OpenLayers.Console={log:function(){},debug:function(){},info:function(){},warn:function(){},error:function(){},userError:function(e){alert(e)},assert:function(){},dir:function(){},dirxml:function(){},trace:function(){},group:function(){},groupEnd:function(){},time:function(){},timeEnd:function(){},profile:function(){},profileEnd:function(){},count:function(){},CLASS_NAME:"OpenLayers.Console"},function(){var e=document.getElementsByTagName("script");for(var t=0,n=e.length;t<n;++t)if(e[t].src.indexOf("firebug.js")!=-1&&console){OpenLayers.Util.extend(OpenLayers.Console,console);break}}(),OpenLayers.Lang={code:null,defaultCode:"en",getCode:function(){return OpenLayers.Lang.code||OpenLayers.Lang.setCode(),OpenLayers.Lang.code},setCode:function(e){var t;e||(e=OpenLayers.BROWSER_NAME=="msie"?navigator.userLanguage:navigator.language);var n=e.split("-");n[0]=n[0].toLowerCase(),typeof OpenLayers.Lang[n[0]]=="object"&&(t=n[0]);if(n[1]){var r=n[0]+"-"+n[1].toUpperCase();typeof OpenLayers.Lang[r]=="object"&&(t=r)}t||(OpenLayers.Console.warn("Failed to find OpenLayers.Lang."+n.join("-")+" dictionary, falling back to default language"),t=OpenLayers.Lang.defaultCode),OpenLayers.Lang.code=t},translate:function(e,t){var n=OpenLayers.Lang[OpenLayers.Lang.getCode()],r=n&&n[e];return r||(r=e),t&&(r=OpenLayers.String.format(r,t)),r}},OpenLayers.i18n=OpenLayers.Lang.translate,OpenLayers.Util=OpenLayers.Util||{},OpenLayers.Util.getElement=function(){var e=[];for(var t=0,n=arguments.length;t<n;t++){var r=arguments[t];typeof r=="string"&&(r=document.getElementById(r));if(arguments.length==1)return r;e.push(r)}return e},OpenLayers.Util.isElement=function(e){return!!e&&e.nodeType===1},OpenLayers.Util.isArray=function(e){return Object.prototype.toString.call(e)==="[object Array]"},typeof window.$=="undefined"&&(window.$=OpenLayers.Util.getElement),OpenLayers.Util.removeItem=function(e,t){for(var n=e.length-1;n>=0;n--)e[n]==t&&e.splice(n,1);return e},OpenLayers.Util.indexOf=function(e,t){if(typeof e.indexOf=="function")return e.indexOf(t);for(var n=0,r=e.length;n<r;n++)if(e[n]==t)return n;return-1},OpenLayers.Util.modifyDOMElement=function(e,t,n,r,i,s,o,u){t&&(e.id=t),n&&(e.style.left=n.x+"px",e.style.top=n.y+"px"),r&&(e.style.width=r.w+"px",e.style.height=r.h+"px"),i&&(e.style.position=i),s&&(e.style.border=s),o&&(e.style.overflow=o),parseFloat(u)>=0&&parseFloat(u)<1?(e.style.filter="alpha(opacity="+u*100+")",e.style.opacity=u):parseFloat(u)==1&&(e.style.filter="",e.style.opacity="")},OpenLayers.Util.createDiv=function(e,t,n,r,i,s,o,u){var a=document.createElement("div");return r&&(a.style.backgroundImage="url("+r+")"),e||(e=OpenLayers.Util.createUniqueID("OpenLayersDiv")),i||(i="absolute"),OpenLayers.Util.modifyDOMElement(a,e,t,n,i,s,o,u),a},OpenLayers.Util.createImage=function(e,t,n,r,i,s,o,u){var a=document.createElement("img");e||(e=OpenLayers.Util.createUniqueID("OpenLayersDiv")),i||(i="relative"),OpenLayers.Util.modifyDOMElement(a,e,t,n,i,s,null,o);if(u){a.style.display="none";function f(){a.style.display="",OpenLayers.Event.stopObservingElement(a)}OpenLayers.Event.observe(a,"load",f),OpenLayers.Event.observe(a,"error",f)}return a.style.alt=e,a.galleryImg="no",r&&(a.src=r),a},OpenLayers.IMAGE_RELOAD_ATTEMPTS=0,OpenLayers.Util.alphaHackNeeded=null,OpenLayers.Util.alphaHack=function(){if(OpenLayers.Util.alphaHackNeeded==null){var e=navigator.appVersion.split("MSIE"),t=parseFloat(e[1]),n=!1;try{n=!!document.body.filters}catch(r){}OpenLayers.Util.alphaHackNeeded=n&&t>=5.5&&t<7}return OpenLayers.Util.alphaHackNeeded},OpenLayers.Util.modifyAlphaImageDiv=function(e,t,n,r,i,s,o,u,a){OpenLayers.Util.modifyDOMElement(e,t,n,r,s,null,null,a);var f=e.childNodes[0];i&&(f.src=i),OpenLayers.Util.modifyDOMElement(f,e.id+"_innerImage",null,r,"relative",o),OpenLayers.Util.alphaHack()&&(e.style.display!="none"&&(e.style.display="inline-block"),u==null&&(u="scale"),e.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+f.src+"', "+"sizingMethod='"+u+"')",parseFloat(e.style.opacity)>=0&&parseFloat(e.style.opacity)<1&&(e.style.filter+=" alpha(opacity="+e.style.opacity*100+")"),f.style.filter="alpha(opacity=0)")},OpenLayers.Util.createAlphaImageDiv=function(e,t,n,r,i,s,o,u,a){var f=OpenLayers.Util.createDiv(),l=OpenLayers.Util.createImage(null,null,null,null,null,null,null,a);return l.className="olAlphaImg",f.appendChild(l),OpenLayers.Util.modifyAlphaImageDiv(f,e,t,n,r,i,s,o,u),f},OpenLayers.Util.upperCaseObject=function(e){var t={};for(var n in e)t[n.toUpperCase()]=e[n];return t},OpenLayers.Util.applyDefaults=function(e,t){e=e||{};var n=typeof window.Event=="function"&&t instanceof window.Event;for(var r in t)if(e[r]===undefined||!n&&t.hasOwnProperty&&t.hasOwnProperty(r)&&!e.hasOwnProperty(r))e[r]=t[r];return!n&&t&&t.hasOwnProperty&&t.hasOwnProperty("toString")&&!e.hasOwnProperty("toString")&&(e.toString=t.toString),e},OpenLayers.Util.getParameterString=function(e){var t=[];for(var n in e){var r=e[n];if(r!=null&&typeof r!="function"){var i;if(typeof r=="object"&&r.constructor==Array){var s=[],o;for(var u=0,a=r.length;u<a;u++)o=r[u],s.push(encodeURIComponent(o===null||o===undefined?"":o));i=s.join(",")}else i=encodeURIComponent(r);t.push(encodeURIComponent(n)+"="+i)}}return t.join("&")},OpenLayers.Util.urlAppend=function(e,t){var n=e;if(t){var r=(e+" ").split(/[?&]/);n+=r.pop()===" "?t:r.length?"&"+t:"?"+t}return n},OpenLayers.Util.getImagesLocation=function(){return OpenLayers.ImgPath||OpenLayers._getScriptLocation()+"img/"},OpenLayers.Util.getImageLocation=function(e){return OpenLayers.Util.getImagesLocation()+e},OpenLayers.Util.Try=function(){var e=null;for(var t=0,n=arguments.length;t<n;t++){var r=arguments[t];try{e=r();break}catch(i){}}return e},OpenLayers.Util.getXmlNodeValue=function(e){var t=null;return OpenLayers.Util.Try(function(){t=e.text,t||(t=e.textContent),t||(t=e.firstChild.nodeValue)},function(){t=e.textContent}),t},OpenLayers.Util.mouseLeft=function(e,t){var n=e.relatedTarget?e.relatedTarget:e.toElement;while(n!=t&&n!=null)n=n.parentNode;return n!=t},OpenLayers.Util.DEFAULT_PRECISION=14,OpenLayers.Util.toFloat=function(e,t){return t==null&&(t=OpenLayers.Util.DEFAULT_PRECISION),typeof e!="number"&&(e=parseFloat(e)),t===0?e:parseFloat(e.toPrecision(t))},OpenLayers.Util.rad=function(e){return e*Math.PI/180},OpenLayers.Util.deg=function(e){return e*180/Math.PI},OpenLayers.Util.VincentyConstants={a:6378137,b:6356752.3142,f:1/298.257223563},OpenLayers.Util.distVincenty=function(e,t){var n=OpenLayers.Util.VincentyConstants,r=n.a,i=n.b,s=n.f,o=OpenLayers.Util.rad(t.lon-e.lon),u=Math.atan((1-s)*Math.tan(OpenLayers.Util.rad(e.lat))),a=Math.atan((1-s)*Math.tan(OpenLayers.Util.rad(t.lat))),f=Math.sin(u),l=Math.cos(u),c=Math.sin(a),h=Math.cos(a),p=o,d=2*Math.PI,v=20;while(Math.abs(p-d)>1e-12&&--v>0){var m=Math.sin(p),g=Math.cos(p),y=Math.sqrt(h*m*h*m+(l*c-f*h*g)*(l*c-f*h*g));if(y==0)return 0;var b=f*c+l*h*g,w=Math.atan2(y,b),E=Math.asin(l*h*m/y),S=Math.cos(E)*Math.cos(E),x=b-2*f*c/S,T=s/16*S*(4+s*(4-3*S));d=p,p=o+(1-T)*s*Math.sin(E)*(w+T*y*(x+T*b*(-1+2*x*x)))}if(v==0)return NaN;var N=S*(r*r-i*i)/(i*i),C=1+N/16384*(4096+N*(-768+N*(320-175*N))),k=N/1024*(256+N*(-128+N*(74-47*N))),L=k*y*(x+k/4*(b*(-1+2*x*x)-k/6*x*(-3+4*y*y)*(-3+4*x*x))),A=i*C*(w-L),O=A.toFixed(3)/1e3;return O},OpenLayers.Util.destinationVincenty=function(e,t,n){var r=OpenLayers.Util,i=r.VincentyConstants,s=i.a,o=i.b,u=i.f,a=e.lon,f=e.lat,l=n,c=r.rad(t),h=Math.sin(c),p=Math.cos(c),d=(1-u)*Math.tan(r.rad(f)),v=1/Math.sqrt(1+d*d),m=d*v,g=Math.atan2(d,p),y=v*h,b=1-y*y,w=b*(s*s-o*o)/(o*o),E=1+w/16384*(4096+w*(-768+w*(320-175*w))),S=w/1024*(256+w*(-128+w*(74-47*w))),x=l/(o*E),T=2*Math.PI;while(Math.abs(x-T)>1e-12){var N=Math.cos(2*g+x),C=Math.sin(x),k=Math.cos(x),L=S*C*(N+S/4*(k*(-1+2*N*N)-S/6*N*(-3+4*C*C)*(-3+4*N*N)));T=x,x=l/(o*E)+L}var A=m*C-v*k*p,O=Math.atan2(m*k+v*C*p,(1-u)*Math.sqrt(y*y+A*A)),M=Math.atan2(C*h,v*k-m*C*p),_=u/16*b*(4+u*(4-3*b)),D=M-(1-_)*u*y*(x+_*C*(N+_*k*(-1+2*N*N))),P=Math.atan2(y,-A);return new OpenLayers.LonLat(a+r.deg(D),r.deg(O))},OpenLayers.Util.getParameters=function(e){e=e===null||e===undefined?window.location.href:e;var t="";if(OpenLayers.String.contains(e,"?")){var n=e.indexOf("?")+1,r=OpenLayers.String.contains(e,"#")?e.indexOf("#"):e.length;t=e.substring(n,r)}var i={},s=t.split(/[&;]/);for(var o=0,u=s.length;o<u;++o){var a=s[o].split("=");if(a[0]){var f=a[0];try{f=decodeURIComponent(f)}catch(l){f=unescape(f)}var c=(a[1]||"").replace(/\+/g," ");try{c=decodeURIComponent(c)}catch(l){c=unescape(c)}c=c.split(","),c.length==1&&(c=c[0]),i[f]=c}}return i},OpenLayers.Util.lastSeqID=0,OpenLayers.Util.createUniqueID=function(e){return e==null&&(e="id_"),OpenLayers.Util.lastSeqID+=1,e+OpenLayers.Util.lastSeqID},OpenLayers.INCHES_PER_UNIT={inches:1,ft:12,mi:63360,m:39.3701,km:39370.1,dd:4374754,yd:36},OpenLayers.INCHES_PER_UNIT["in"]=OpenLayers.INCHES_PER_UNIT.inches,OpenLayers.INCHES_PER_UNIT.degrees=OpenLayers.INCHES_PER_UNIT.dd,OpenLayers.INCHES_PER_UNIT.nmi=1852*OpenLayers.INCHES_PER_UNIT.m,OpenLayers.METERS_PER_INCH=.0254000508001016,OpenLayers.Util.extend(OpenLayers.INCHES_PER_UNIT,{Inch:OpenLayers.INCHES_PER_UNIT.inches,Meter:1/OpenLayers.METERS_PER_INCH,Foot:.3048006096012192/OpenLayers.METERS_PER_INCH,IFoot:.3048/OpenLayers.METERS_PER_INCH,ClarkeFoot:.3047972651151/OpenLayers.METERS_PER_INCH,SearsFoot:.30479947153867626/OpenLayers.METERS_PER_INCH,GoldCoastFoot:.3047997101815088/OpenLayers.METERS_PER_INCH,IInch:.0254/OpenLayers.METERS_PER_INCH,MicroInch:254e-7/OpenLayers.METERS_PER_INCH,Mil:2.54e-8/OpenLayers.METERS_PER_INCH,Centimeter:.01/OpenLayers.METERS_PER_INCH,Kilometer:1e3/OpenLayers.METERS_PER_INCH,Yard:.9144018288036576/OpenLayers.METERS_PER_INCH,SearsYard:.914398414616029/OpenLayers.METERS_PER_INCH,IndianYard:.9143985307444408/OpenLayers.METERS_PER_INCH,IndianYd37:.91439523/OpenLayers.METERS_PER_INCH,IndianYd62:.9143988/OpenLayers.METERS_PER_INCH,IndianYd75:.9143985/OpenLayers.METERS_PER_INCH,IndianFoot:.30479951/OpenLayers.METERS_PER_INCH,IndianFt37:.30479841/OpenLayers.METERS_PER_INCH,IndianFt62:.3047996/OpenLayers.METERS_PER_INCH,IndianFt75:.3047995/OpenLayers.METERS_PER_INCH,Mile:1609.3472186944373/OpenLayers.METERS_PER_INCH,IYard:.9144/OpenLayers.METERS_PER_INCH,IMile:1609.344/OpenLayers.METERS_PER_INCH,NautM:1852/OpenLayers.METERS_PER_INCH,"Lat-66":110943.31648893273/OpenLayers.METERS_PER_INCH,"Lat-83":110946.25736872235/OpenLayers.METERS_PER_INCH,Decimeter:.1/OpenLayers.METERS_PER_INCH,Millimeter:.001/OpenLayers.METERS_PER_INCH,Dekameter:10/OpenLayers.METERS_PER_INCH,Decameter:10/OpenLayers.METERS_PER_INCH,Hectometer:100/OpenLayers.METERS_PER_INCH,GermanMeter:1.0000135965/OpenLayers.METERS_PER_INCH,CaGrid:.999738/OpenLayers.METERS_PER_INCH,ClarkeChain:20.1166194976/OpenLayers.METERS_PER_INCH,GunterChain:20.11684023368047/OpenLayers.METERS_PER_INCH,BenoitChain:20.116782494375872/OpenLayers.METERS_PER_INCH,SearsChain:20.11676512155/OpenLayers.METERS_PER_INCH,ClarkeLink:.201166194976/OpenLayers.METERS_PER_INCH,GunterLink:.2011684023368047/OpenLayers.METERS_PER_INCH,BenoitLink:.20116782494375873/OpenLayers.METERS_PER_INCH,SearsLink:.2011676512155/OpenLayers.METERS_PER_INCH,Rod:5.02921005842012/OpenLayers.METERS_PER_INCH,IntnlChain:20.1168/OpenLayers.METERS_PER_INCH,IntnlLink:.201168/OpenLayers.METERS_PER_INCH,Perch:5.02921005842012/OpenLayers.METERS_PER_INCH,Pole:5.02921005842012/OpenLayers.METERS_PER_INCH,Furlong:201.1684023368046/OpenLayers.METERS_PER_INCH,Rood:3.778266898/OpenLayers.METERS_PER_INCH,CapeFoot:.3047972615/OpenLayers.METERS_PER_INCH,Brealey:375/OpenLayers.METERS_PER_INCH,ModAmFt:.304812252984506/OpenLayers.METERS_PER_INCH,Fathom:1.8288/OpenLayers.METERS_PER_INCH,"NautM-UK":1853.184/OpenLayers.METERS_PER_INCH,"50kilometers":5e4/OpenLayers.METERS_PER_INCH,"150kilometers":15e4/OpenLayers.METERS_PER_INCH}),OpenLayers.Util.extend(OpenLayers.INCHES_PER_UNIT,{mm:OpenLayers.INCHES_PER_UNIT.Meter/1e3,cm:OpenLayers.INCHES_PER_UNIT.Meter/100,dm:OpenLayers.INCHES_PER_UNIT.Meter*100,km:OpenLayers.INCHES_PER_UNIT.Meter*1e3,kmi:OpenLayers.INCHES_PER_UNIT.nmi,fath:OpenLayers.INCHES_PER_UNIT.Fathom,ch:OpenLayers.INCHES_PER_UNIT.IntnlChain,link:OpenLayers.INCHES_PER_UNIT.IntnlLink,"us-in":OpenLayers.INCHES_PER_UNIT.inches,"us-ft":OpenLayers.INCHES_PER_UNIT.Foot,"us-yd":OpenLayers.INCHES_PER_UNIT.Yard,"us-ch":OpenLayers.INCHES_PER_UNIT.GunterChain,"us-mi":OpenLayers.INCHES_PER_UNIT.Mile,"ind-yd":OpenLayers.INCHES_PER_UNIT.IndianYd37,"ind-ft":OpenLayers.INCHES_PER_UNIT.IndianFt37,"ind-ch":20.11669506/OpenLayers.METERS_PER_INCH}),OpenLayers.DOTS_PER_INCH=72,OpenLayers.Util.normalizeScale=function(e){var t=e>1?1/e:e;return t},OpenLayers.Util.getResolutionFromScale=function(e,t){var n;if(e){t==null&&(t="degrees");var r=OpenLayers.Util.normalizeScale(e);n=1/(r*OpenLayers.INCHES_PER_UNIT[t]*OpenLayers.DOTS_PER_INCH)}return n},OpenLayers.Util.getScaleFromResolution=function(e,t){t==null&&(t="degrees");var n=e*OpenLayers.INCHES_PER_UNIT[t]*OpenLayers.DOTS_PER_INCH;return n},OpenLayers.Util.pagePosition=function(e){var t=[0,0],n=OpenLayers.Util.getViewportElement();if(!e||e==window||e==n)return t;var r=OpenLayers.IS_GECKO&&document.getBoxObjectFor&&OpenLayers.Element.getStyle(e,"position")=="absolute"&&(e.style.top==""||e.style.left==""),i=null,s;if(e.getBoundingClientRect){s=e.getBoundingClientRect();var o=n.scrollTop,u=n.scrollLeft;t[0]=s.left+u,t[1]=s.top+o}else if(document.getBoxObjectFor&&!r){s=document.getBoxObjectFor(e);var a=document.getBoxObjectFor(n);t[0]=s.screenX-a.screenX,t[1]=s.screenY-a.screenY}else{t[0]=e.offsetLeft,t[1]=e.offsetTop,i=e.offsetParent;if(i!=e)while(i)t[0]+=i.offsetLeft,t[1]+=i.offsetTop,i=i.offsetParent;var f=OpenLayers.BROWSER_NAME;if(f=="opera"||f=="safari"&&OpenLayers.Element.getStyle(e,"position")=="absolute")t[1]-=document.body.offsetTop;i=e.offsetParent;while(i&&i!=document.body){t[0]-=i.scrollLeft;if(f!="opera"||i.tagName!="TR")t[1]-=i.scrollTop;i=i.offsetParent}}return t},OpenLayers.Util.getViewportElement=function(){var e=arguments.callee.viewportElement;return e==undefined&&(e=OpenLayers.BROWSER_NAME=="msie"&&document.compatMode!="CSS1Compat"?document.body:document.documentElement,arguments.callee.viewportElement=e),e},OpenLayers.Util.isEquivalentUrl=function(e,t,n){n=n||{},OpenLayers.Util.applyDefaults(n,{ignoreCase:!0,ignorePort80:!0,ignoreHash:!0});var r=OpenLayers.Util.createUrlObject(e,n),i=OpenLayers.Util.createUrlObject(t,n);for(var s in r)if(s!=="args"&&r[s]!=i[s])return!1;for(var s in r.args){if(r.args[s]!=i.args[s])return!1;delete i.args[s]}for(var s in i.args)return!1;return!0},OpenLayers.Util.createUrlObject=function(e,t){t=t||{};if(!/^\w+:\/\//.test(e)){var n=window.location,r=n.port?":"+n.port:"",i=n.protocol+"//"+n.host.split(":").shift()+r;if(e.indexOf("/")===0)e=i+e;else{var s=n.pathname.split("/");s.pop(),e=i+s.join("/")+"/"+e}}t.ignoreCase&&(e=e.toLowerCase());var o=document.createElement("a");o.href=e;var u={};u.host=o.host.split(":").shift(),u.protocol=o.protocol,t.ignorePort80?u.port=o.port=="80"||o.port=="0"?"":o.port:u.port=o.port==""||o.port=="0"?"80":o.port,u.hash=t.ignoreHash||o.hash==="#"?"":o.hash;var a=o.search;if(!a){var f=e.indexOf("?");a=f!=-1?e.substr(f):""}return u.args=OpenLayers.Util.getParameters(a),u.pathname=o.pathname.charAt(0)=="/"?o.pathname:"/"+o.pathname,u},OpenLayers.Util.removeTail=function(e){var t=null,n=e.indexOf("?"),r=e.indexOf("#");return n==-1?t=r!=-1?e.substr(0,r):e:t=r!=-1?e.substr(0,Math.min(n,r)):e.substr(0,n),t},OpenLayers.IS_GECKO=function(){var e=navigator.userAgent.toLowerCase();return e.indexOf("webkit")==-1&&e.indexOf("gecko")!=-1}(),OpenLayers.CANVAS_SUPPORTED=function(){var e=document.createElement("canvas");return!!e.getContext&&!!e.getContext("2d")}(),OpenLayers.BROWSER_NAME=function(){var e="",t=navigator.userAgent.toLowerCase();return t.indexOf("opera")!=-1?e="opera":t.indexOf("msie")!=-1?e="msie":t.indexOf("safari")!=-1?e="safari":t.indexOf("mozilla")!=-1&&(t.indexOf("firefox")!=-1?e="firefox":e="mozilla"),e}(),OpenLayers.Util.getBrowserName=function(){return OpenLayers.BROWSER_NAME},OpenLayers.Util.getRenderedDimensions=function(e,t,n){var r,i,s=document.createElement("div");s.style.visibility="hidden";var o=n&&n.containerElement?n.containerElement:document.body,u=!1,a=null,f=o;while(f&&f.tagName.toLowerCase()!="body"){var l=OpenLayers.Element.getStyle(f,"position");if(l=="absolute"){u=!0;break}if(l&&l!="static")break;f=f.parentNode}u&&(o.clientHeight===0||o.clientWidth===0)&&(a=document.createElement("div"),a.style.visibility="hidden",a.style.position="absolute",a.style.overflow="visible",a.style.width=document.body.clientWidth+"px",a.style.height=document.body.clientHeight+"px",a.appendChild(s)),s.style.position="absolute",t&&(t.w?(r=t.w,s.style.width=r+"px"):t.h&&(i=t.h,s.style.height=i+"px")),n&&n.displayClass&&(s.className=n.displayClass);var c=document.createElement("div");c.innerHTML=e,c.style.overflow="visible";if(c.childNodes)for(var h=0,p=c.childNodes.length;h<p;h++){if(!c.childNodes[h].style)continue;c.childNodes[h].style.overflow="visible"}return s.appendChild(c),a?o.appendChild(a):o.appendChild(s),r||(r=parseInt(c.scrollWidth),s.style.width=r+"px"),i||(i=parseInt(c.scrollHeight)),s.removeChild(c),a?(a.removeChild(s),o.removeChild(a)):o.removeChild(s),new OpenLayers.Size(r,i)},OpenLayers.Util.getScrollbarWidth=function(){var e=OpenLayers.Util._scrollbarWidth;if(e==null){var t=null,n=null,r=0,i=0;t=document.createElement("div"),t.style.position="absolute",t.style.top="-1000px",t.style.left="-1000px",t.style.width="100px",t.style.height="50px",t.style.overflow="hidden",n=document.createElement("div"),n.style.width="100%",n.style.height="200px",t.appendChild(n),document.body.appendChild(t),r=n.offsetWidth,t.style.overflow="scroll",i=n.offsetWidth,document.body.removeChild(document.body.lastChild),OpenLayers.Util._scrollbarWidth=r-i,e=OpenLayers.Util._scrollbarWidth}return e},OpenLayers.Util.getFormattedLonLat=function(e,t,n){n||(n="dms"),e=(e+540)%360-180;var r=Math.abs(e),i=Math.floor(r),s=(r-i)/(1/60),o=s;s=Math.floor(s);var u=(o-s)/(1/60);u=Math.round(u*10),u/=10,u>=60&&(u-=60,s+=1,s>=60&&(s-=60,i+=1)),i<10&&(i="0"+i);var a=i+"°";return n.indexOf("dm")>=0&&(s<10&&(s="0"+s),a+=s+"'",n.indexOf("dms")>=0&&(u<10&&(u="0"+u),a+=u+'"')),t=="lon"?a+=e<0?OpenLayers.i18n("W"):OpenLayers.i18n("E"):a+=e<0?OpenLayers.i18n("S"):OpenLayers.i18n("N"),a},OpenLayers.Feature=OpenLayers.Class({layer:null,id:null,lonlat:null,data:null,marker:null,popupClass:null,popup:null,initialize:function(e,t,n){this.layer=e,this.lonlat=t,this.data=n!=null?n:{},this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_")},destroy:function(){this.layer!=null&&this.layer.map!=null&&this.popup!=null&&this.layer.map.removePopup(this.popup),this.layer!=null&&this.marker!=null&&this.layer.removeMarker(this.marker),this.layer=null,this.id=null,this.lonlat=null,this.data=null,this.marker!=null&&(this.destroyMarker(this.marker),this.marker=null),this.popup!=null&&(this.destroyPopup(this.popup),this.popup=null)},onScreen:function(){var e=!1;if(this.layer!=null&&this.layer.map!=null){var t=this.layer.map.getExtent();e=t.containsLonLat(this.lonlat)}return e},createMarker:function(){return this.lonlat!=null&&(this.marker=new OpenLayers.Marker(this.lonlat,this.data.icon)),this.marker},destroyMarker:function(){this.marker.destroy()},createPopup:function(e){if(this.lonlat!=null){if(!this.popup){var t=this.marker?this.marker.icon:null,n=this.popupClass?this.popupClass:OpenLayers.Popup.Anchored;this.popup=new n(this.id+"_popup",this.lonlat,this.data.popupSize,this.data.popupContentHTML,t,e)}this.data.overflow!=null&&(this.popup.contentDiv.style.overflow=this.data.overflow),this.popup.feature=this}return this.popup},destroyPopup:function(){this.popup&&(this.popup.feature=null,this.popup.destroy(),this.popup=null)},CLASS_NAME:"OpenLayers.Feature"}),OpenLayers.State={UNKNOWN:"Unknown",INSERT:"Insert",UPDATE:"Update",DELETE:"Delete"},OpenLayers.Feature.Vector=OpenLayers.Class(OpenLayers.Feature,{fid:null,geometry:null,attributes:null,bounds:null,state:null,style:null,url:null,renderIntent:"default",modified:null,initialize:function(e,t,n){OpenLayers.Feature.prototype.initialize.apply(this,[null,null,t]),this.lonlat=null,this.geometry=e?e:null,this.state=null,this.attributes={},t&&(this.attributes=OpenLayers.Util.extend(this.attributes,t)),this.style=n?n:null},destroy:function(){this.layer&&(this.layer.removeFeatures(this),this.layer=null),this.geometry=null,this.modified=null,OpenLayers.Feature.prototype.destroy.apply(this,arguments)},clone:function(){return new OpenLayers.Feature.Vector(this.geometry?this.geometry.clone():null,this.attributes,this.style)},onScreen:function(e){var t=!1;if(this.layer&&this.layer.map){var n=this.layer.map.getExtent();if(e){var r=this.geometry.getBounds();t=n.intersectsBounds(r)}else{var i=n.toGeometry();t=i.intersects(this.geometry)}}return t},getVisibility:function(){return!(this.style&&this.style.display=="none"||!this.layer||this.layer&&this.layer.styleMap&&this.layer.styleMap.createSymbolizer(this,this.renderIntent).display=="none"||this.layer&&!this.layer.getVisibility())},createMarker:function(){return null},destroyMarker:function(){},createPopup:function(){return null},atPoint:function(e,t,n){var r=!1;return this.geometry&&(r=this.geometry.atPoint(e,t,n)),r},destroyPopup:function(){},move:function(e){if(!this.layer||!this.geometry.move)return undefined;var t;e.CLASS_NAME=="OpenLayers.LonLat"?t=this.layer.getViewPortPxFromLonLat(e):t=e;var n=this.layer.getViewPortPxFromLonLat(this.geometry.getBounds().getCenterLonLat()),r=this.layer.map.getResolution();return this.geometry.move(r*(t.x-n.x),r*(n.y-t.y)),this.layer.drawFeature(this),n},toState:function(e){if(e==OpenLayers.State.UPDATE)switch(this.state){case OpenLayers.State.UNKNOWN:case OpenLayers.State.DELETE:this.state=e;break;case OpenLayers.State.UPDATE:case OpenLayers.State.INSERT:}else if(e==OpenLayers.State.INSERT)switch(this.state){case OpenLayers.State.UNKNOWN:break;default:this.state=e}else if(e==OpenLayers.State.DELETE)switch(this.state){case OpenLayers.State.INSERT:break;case OpenLayers.State.DELETE:break;case OpenLayers.State.UNKNOWN:case OpenLayers.State.UPDATE:this.state=e}else e==OpenLayers.State.UNKNOWN&&(this.state=e)},CLASS_NAME:"OpenLayers.Feature.Vector"}),OpenLayers.Feature.Vector.style={"default":{fillColor:"#ee9900",fillOpacity:.4,hoverFillColor:"white",hoverFillOpacity:.8,strokeColor:"#ee9900",strokeOpacity:1,strokeWidth:1,strokeLinecap:"round",strokeDashstyle:"solid",hoverStrokeColor:"red",hoverStrokeOpacity:1,hoverStrokeWidth:.2,pointRadius:6,hoverPointRadius:1,hoverPointUnit:"%",pointerEvents:"visiblePainted",cursor:"inherit",fontColor:"#000000",labelAlign:"cm",labelOutlineColor:"white",labelOutlineWidth:3},select:{fillColor:"blue",fillOpacity:.4,hoverFillColor:"white",hoverFillOpacity:.8,strokeColor:"blue",strokeOpacity:1,strokeWidth:2,strokeLinecap:"round",strokeDashstyle:"solid",hoverStrokeColor:"red",hoverStrokeOpacity:1,hoverStrokeWidth:.2,pointRadius:6,hoverPointRadius:1,hoverPointUnit:"%",pointerEvents:"visiblePainted",cursor:"pointer",fontColor:"#000000",labelAlign:"cm",labelOutlineColor:"white",labelOutlineWidth:3},temporary:{fillColor:"#66cccc",fillOpacity:.2,hoverFillColor:"white",hoverFillOpacity:.8,strokeColor:"#66cccc",strokeOpacity:1,strokeLinecap:"round",strokeWidth:2,strokeDashstyle:"solid",hoverStrokeColor:"red",hoverStrokeOpacity:1,hoverStrokeWidth:.2,pointRadius:6,hoverPointRadius:1,hoverPointUnit:"%",pointerEvents:"visiblePainted",cursor:"inherit",fontColor:"#000000",labelAlign:"cm",labelOutlineColor:"white",labelOutlineWidth:3},"delete":{display:"none"}},OpenLayers.Style=OpenLayers.Class({id:null,name:null,title:null,description:null,layerName:null,isDefault:!1,rules:null,context:null,defaultStyle:null,defaultsPerSymbolizer:!1,propertyStyles:null,initialize:function(e,t){OpenLayers.Util.extend(this,t),this.rules=[],t&&t.rules&&this.addRules(t.rules),this.setDefaultStyle(e||OpenLayers.Feature.Vector.style["default"]),this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_")},destroy:function(){for(var e=0,t=this.rules.length;e<t;e++)this.rules[e].destroy(),this.rules[e]=null;this.rules=null,this.defaultStyle=null},createSymbolizer:function(e){var t=this.defaultsPerSymbolizer?{}:this.createLiterals(OpenLayers.Util.extend({},this.defaultStyle),e),n=this.rules,r,i,s=[],o=!1;for(var u=0,a=n.length;u<a;u++){r=n[u];var f=r.evaluate(e);f&&(r instanceof OpenLayers.Rule&&r.elseFilter?s.push(r):(o=!0,this.applySymbolizer(r,t,e)))}if(o==0&&s.length>0){o=!0;for(var u=0,a=s.length;u<a;u++)this.applySymbolizer(s[u],t,e)}return n.length>0&&o==0&&(t.display="none"),t.label!=null&&typeof t.label!="string"&&(t.label=String(t.label)),t},applySymbolizer:function(e,t,n){var r=n.geometry?this.getSymbolizerPrefix(n.geometry):OpenLayers.Style.SYMBOLIZER_PREFIXES[0],i=e.symbolizer[r]||e.symbolizer;if(this.defaultsPerSymbolizer===!0){var s=this.defaultStyle;OpenLayers.Util.applyDefaults(i,{pointRadius:s.pointRadius}),(i.stroke===!0||i.graphic===!0)&&OpenLayers.Util.applyDefaults(i,{strokeWidth:s.strokeWidth,strokeColor:s.strokeColor,strokeOpacity:s.strokeOpacity,strokeDashstyle:s.strokeDashstyle,strokeLinecap:s.strokeLinecap}),(i.fill===!0||i.graphic===!0)&&OpenLayers.Util.applyDefaults(i,{fillColor:s.fillColor,fillOpacity:s.fillOpacity}),i.graphic===!0&&OpenLayers.Util.applyDefaults(i,{pointRadius:this.defaultStyle.pointRadius,externalGraphic:this.defaultStyle.externalGraphic,graphicName:this.defaultStyle.graphicName,graphicOpacity:this.defaultStyle.graphicOpacity,graphicWidth:this.defaultStyle.graphicWidth,graphicHeight:this.defaultStyle.graphicHeight,graphicXOffset:this.defaultStyle.graphicXOffset,graphicYOffset:this.defaultStyle.graphicYOffset})}return this.createLiterals(OpenLayers.Util.extend(t,i),n)},createLiterals:function(e,t){var n=OpenLayers.Util.extend({},t.attributes||t.data);OpenLayers.Util.extend(n,this.context);for(var r in this.propertyStyles)e[r]=OpenLayers.Style.createLiteral(e[r],n,t,r);return e},findPropertyStyles:function(){var e={},t=this.defaultStyle;this.addPropertyStyles(e,t);var n=this.rules,r,i;for(var s=0,o=n.length;s<o;s++){r=n[s].symbolizer;for(var u in r){i=r[u];if(typeof i!="object"){this.addPropertyStyles(e,r);break}this.addPropertyStyles(e,i)}}return e},addPropertyStyles:function(e,t){var n;for(var r in t)n=t[r],typeof n=="string"&&n.match(/\$\{\w+\}/)&&(e[r]=!0);return e},addRules:function(e){Array.prototype.push.apply(this.rules,e),this.propertyStyles=this.findPropertyStyles()},setDefaultStyle:function(e){this.defaultStyle=e,this.propertyStyles=this.findPropertyStyles()},getSymbolizerPrefix:function(e){var t=OpenLayers.Style.SYMBOLIZER_PREFIXES;for(var n=0,r=t.length;n<r;n++)if(e.CLASS_NAME.indexOf(t[n])!=-1)return t[n]},clone:function(){var e=OpenLayers.Util.extend({},this);if(this.rules){e.rules=[];for(var t=0,n=this.rules.length;t<n;++t)e.rules.push(this.rules[t].clone())}e.context=this.context&&OpenLayers.Util.extend({},this.context);var r=OpenLayers.Util.extend({},this.defaultStyle);return new OpenLayers.Style(r,e)},CLASS_NAME:"OpenLayers.Style"}),OpenLayers.Style.createLiteral=function(e,t,n,r){return typeof e=="string"&&e.indexOf("${")!=-1&&(e=OpenLayers.String.format(e,t,[n,r]),e=isNaN(e)||!e?e:parseFloat(e)),e},OpenLayers.Style.SYMBOLIZER_PREFIXES=["Point","Line","Polygon","Text","Raster"],OpenLayers.Renderer=OpenLayers.Class({container:null,root:null,extent:null,locked:!1,size:null,resolution:null,map:null,featureDx:0,initialize:function(e,t){this.container=OpenLayers.Util.getElement(e),OpenLayers.Util.extend(this,t)},destroy:function(){this.container=null,this.extent=null,this.size=null,this.resolution=null,this.map=null},supported:function(){return!1},setExtent:function(e,t){this.extent=e.clone();if(this.map.baseLayer&&this.map.baseLayer.wrapDateLine){var n=e.getWidth()/this.map.getExtent().getWidth(),e=e.scale(1/n);this.extent=e.wrapDateLine(this.map.getMaxExtent()).scale(n)}return t&&(this.resolution=null),!0},setSize:function(e){this.size=e.clone(),this.resolution=null},getResolution:function(){return this.resolution=this.resolution||this.map.getResolution(),this.resolution},drawFeature:function(e,t){t==null&&(t=e.style);if(e.geometry){var n=e.geometry.getBounds();if(n){var r;this.map.baseLayer&&this.map.baseLayer.wrapDateLine&&(r=this.map.getMaxExtent()),n.intersectsBounds(this.extent,{worldBounds:r})?this.calculateFeatureDx(n,r):t={display:"none"};var i=this.drawGeometry(e.geometry,t,e.id);if(t.display!="none"&&t.label&&i!==!1){var s=e.geometry.getCentroid();if(t.labelXOffset||t.labelYOffset){var o=isNaN(t.labelXOffset)?0:t.labelXOffset,u=isNaN(t.labelYOffset)?0:t.labelYOffset,a=this.getResolution();s.move(o*a,u*a)}this.drawText(e.id,t,s)}else this.removeText(e.id);return i}}},calculateFeatureDx:function(e,t){this.featureDx=0;if(t){var n=t.getWidth(),r=(this.extent.left+this.extent.right)/2,i=(e.left+e.right)/2,s=Math.round((i-r)/n);this.featureDx=s*n}},drawGeometry:function(e,t,n){},drawText:function(e,t,n){},removeText:function(e){},clear:function(){},getFeatureIdFromEvent:function(e){},eraseFeatures:function(e){OpenLayers.Util.isArray(e)||(e=[e]);for(var t=0,n=e.length;t<n;++t){var r=e[t];this.eraseGeometry(r.geometry,r.id),this.removeText(r.id)}},eraseGeometry:function(e,t){},moveRoot:function(e){},getRenderLayerId:function(){return this.container.id},applyDefaultSymbolizer:function(e){var t=OpenLayers.Util.extend({},OpenLayers.Renderer.defaultSymbolizer);return e.stroke===!1&&(delete t.strokeWidth,delete t.strokeColor),e.fill===!1&&delete t.fillColor,OpenLayers.Util.extend(t,e),t},CLASS_NAME:"OpenLayers.Renderer"}),OpenLayers.Renderer.defaultSymbolizer={fillColor:"#000000",strokeColor:"#000000",strokeWidth:2,fillOpacity:1,strokeOpacity:1,pointRadius:0,labelAlign:"cm"},OpenLayers.Renderer.symbol={star:[350,75,379,161,469,161,397,215,423,301,350,250,277,301,303,215,231,161,321,161,350,75],cross:[4,0,6,0,6,4,10,4,10,6,6,6,6,10,4,10,4,6,0,6,0,4,4,4,4,0],x:[0,0,25,0,50,35,75,0,100,0,65,50,100,100,75,100,50,65,25,100,0,100,35,50,0,0],square:[0,0,0,1,1,1,1,0,0,0],triangle:[0,10,10,10,5,0,0,10]},OpenLayers.ElementsIndexer=OpenLayers.Class({maxZIndex:null,order:null,indices:null,compare:null,initialize:function(e){this.compare=e?OpenLayers.ElementsIndexer.IndexingMethods.Z_ORDER_Y_ORDER:OpenLayers.ElementsIndexer.IndexingMethods.Z_ORDER_DRAWING_ORDER,this.clear()},insert:function(e){this.exists(e)&&this.remove(e);var t=e.id;this.determineZIndex(e);var n=-1,r=this.order.length,i;while(r-n>1){i=parseInt((n+r)/2);var s=this.compare(this,e,OpenLayers.Util.getElement(this.order[i]));s>0?n=i:r=i}return this.order.splice(r,0,t),this.indices[t]=this.getZIndex(e),this.getNextElement(r)},remove:function(e){var t=e.id,n=OpenLayers.Util.indexOf(this.order,t);if(n>=0){this.order.splice(n,1),delete this.indices[t];if(this.order.length>0){var r=this.order[this.order.length-1];this.maxZIndex=this.indices[r]}else this.maxZIndex=0}},clear:function(){this.order=[],this.indices={},this.maxZIndex=0},exists:function(e){return this.indices[e.id]!=null},getZIndex:function(e){return e._style.graphicZIndex},determineZIndex:function(e){var t=e._style.graphicZIndex;t==null?(t=this.maxZIndex,e._style.graphicZIndex=t):t>this.maxZIndex&&(this.maxZIndex=t)},getNextElement:function(e){var t=e+1;if(t<this.order.length){var n=OpenLayers.Util.getElement(this.order[t]);return n==undefined&&(n=this.getNextElement(t)),n}return null},CLASS_NAME:"OpenLayers.ElementsIndexer"}),OpenLayers.ElementsIndexer.IndexingMethods={Z_ORDER:function(e,t,n){var r=e.getZIndex(t),i=0;if(n){var s=e.getZIndex(n);i=r-s}return i},Z_ORDER_DRAWING_ORDER:function(e,t,n){var r=OpenLayers.ElementsIndexer.IndexingMethods.Z_ORDER(e,t,n);return n&&r==0&&(r=1),r},Z_ORDER_Y_ORDER:function(e,t,n){var r=OpenLayers.ElementsIndexer.IndexingMethods.Z_ORDER(e,t,n);if(n&&r===0){var i=n._boundsBottom-t._boundsBottom;r=i===0?1:i}return r}},OpenLayers.Renderer.Elements=OpenLayers.Class(OpenLayers.Renderer,{rendererRoot:null,root:null,vectorRoot:null,textRoot:null,xmlns:null,xOffset:0,indexer:null,BACKGROUND_ID_SUFFIX:"_background",LABEL_ID_SUFFIX:"_label",LABEL_OUTLINE_SUFFIX:"_outline",initialize:function(e,t){OpenLayers.Renderer.prototype.initialize.apply(this,arguments),this.rendererRoot=this.createRenderRoot(),this.root=this.createRoot("_root"),this.vectorRoot=this.createRoot("_vroot"),this.textRoot=this.createRoot("_troot"),this.root.appendChild(this.vectorRoot),this.root.appendChild(this.textRoot),this.rendererRoot.appendChild(this.root),this.container.appendChild(this.rendererRoot),t&&(t.zIndexing||t.yOrdering)&&(this.indexer=new OpenLayers.ElementsIndexer(t.yOrdering))},destroy:function(){this.clear(),this.rendererRoot=null,this.root=null,this.xmlns=null,OpenLayers.Renderer.prototype.destroy.apply(this,arguments)},clear:function(){var e,t=this.vectorRoot;if(t)while(e=t.firstChild)t.removeChild(e);t=this.textRoot;if(t)while(e=t.firstChild)t.removeChild(e);this.indexer&&this.indexer.clear()},setExtent:function(e,t){var n=OpenLayers.Renderer.prototype.setExtent.apply(this,arguments),r=this.getResolution();if(this.map.baseLayer&&this.map.baseLayer.wrapDateLine){var i,s=e.getWidth()/this.map.getExtent().getWidth(),e=e.scale(1/s),o=this.map.getMaxExtent();o.right>e.left&&o.right<e.right?i=!0:o.left>e.left&&o.left<e.right&&(i=!1);if(i!==this.rightOfDateLine||t)n=!1,this.xOffset=i===!0?o.getWidth()/r:0;this.rightOfDateLine=i}return n},getNodeType:function(e,t){},drawGeometry:function(e,t,n){var r=e.CLASS_NAME,i=!0;if(r=="OpenLayers.Geometry.Collection"||r=="OpenLayers.Geometry.MultiPoint"||r=="OpenLayers.Geometry.MultiLineString"||r=="OpenLayers.Geometry.MultiPolygon"){for(var s=0,o=e.components.length;s<o;s++)i=this.drawGeometry(e.components[s],t,n)&&i;return i}i=!1;var u=!1;t.display!="none"&&(t.backgroundGraphic?this.redrawBackgroundNode(e.id,e,t,n):u=!0,i=this.redrawNode(e.id,e,t,n));if(i==0){var a=document.getElementById(e.id);a&&(a._style.backgroundGraphic&&(u=!0),a.parentNode.removeChild(a))}if(u){var a=document.getElementById(e.id+this.BACKGROUND_ID_SUFFIX);a&&a.parentNode.removeChild(a)}return i},redrawNode:function(e,t,n,r){n=this.applyDefaultSymbolizer(n);var i=this.nodeFactory(e,this.getNodeType(t,n));i._featureId=r,i._boundsBottom=t.getBounds().bottom,i._geometryClass=t.CLASS_NAME,i._style=n;var s=this.drawGeometryNode(i,t,n);if(s===!1)return!1;i=s.node;if(this.indexer){var o=this.indexer.insert(i);o?this.vectorRoot.insertBefore(i,o):this.vectorRoot.appendChild(i)}else i.parentNode!==this.vectorRoot&&this.vectorRoot.appendChild(i);return this.postDraw(i),s.complete},redrawBackgroundNode:function(e,t,n,r){var i=OpenLayers.Util.extend({},n);return i.externalGraphic=i.backgroundGraphic,i.graphicXOffset=i.backgroundXOffset,i.graphicYOffset=i.backgroundYOffset,i.graphicZIndex=i.backgroundGraphicZIndex,i.graphicWidth=i.backgroundWidth||i.graphicWidth,i.graphicHeight=i.backgroundHeight||i.graphicHeight,i.backgroundGraphic=null,i.backgroundXOffset=null,i.backgroundYOffset=null,i.backgroundGraphicZIndex=null,this.redrawNode(e+this.BACKGROUND_ID_SUFFIX,t,i,null)},drawGeometryNode:function(e,t,n){n=n||e._style;var r={isFilled:n.fill===undefined?!0:n.fill,isStroked:n.stroke===undefined?!!n.strokeWidth:n.stroke},i;switch(t.CLASS_NAME){case"OpenLayers.Geometry.Point":n.graphic===!1&&(r.isFilled=!1,r.isStroked=!1),i=this.drawPoint(e,t);break;case"OpenLayers.Geometry.LineString":r.isFilled=!1,i=this.drawLineString(e,t);break;case"OpenLayers.Geometry.LinearRing":i=this.drawLinearRing(e,t);break;case"OpenLayers.Geometry.Polygon":i=this.drawPolygon(e,t);break;case"OpenLayers.Geometry.Rectangle":i=this.drawRectangle(e,t);break;default:}return e._options=r,i!=0?{node:this.setStyle(e,n,r,t),complete:i}:!1},postDraw:function(e){},drawPoint:function(e,t){},drawLineString:function(e,t){},drawLinearRing:function(e,t){},drawPolygon:function(e,t){},drawRectangle:function(e,t){},drawCircle:function(e,t){},removeText:function(e){var t=document.getElementById(e+this.LABEL_ID_SUFFIX);t&&this.textRoot.removeChild(t);var n=document.getElementById(e+this.LABEL_OUTLINE_SUFFIX);n&&this.textRoot.removeChild(n)},getFeatureIdFromEvent:function(e){var t=e.target,n=t&&t.correspondingUseElement,r=n?n:t||e.srcElement;return r._featureId},eraseGeometry:function(e,t){if(e.CLASS_NAME=="OpenLayers.Geometry.MultiPoint"||e.CLASS_NAME=="OpenLayers.Geometry.MultiLineString"||e.CLASS_NAME=="OpenLayers.Geometry.MultiPolygon"||e.CLASS_NAME=="OpenLayers.Geometry.Collection")for(var n=0,r=e.components.length;n<r;n++)this.eraseGeometry(e.components[n],t);else{var i=OpenLayers.Util.getElement(e.id);if(i&&i.parentNode){i.geometry&&(i.geometry.destroy(),i.geometry=null),i.parentNode.removeChild(i),this.indexer&&this.indexer.remove(i);if(i._style.backgroundGraphic){var s=e.id+this.BACKGROUND_ID_SUFFIX,o=OpenLayers.Util.getElement(s);o&&o.parentNode&&o.parentNode.removeChild(o)}}}},nodeFactory:function(e,t){var n=OpenLayers.Util.getElement(e);return n?this.nodeTypeCompare(n,t)||(n.parentNode.removeChild(n),n=this.nodeFactory(e,t)):n=this.createNode(t,e),n},nodeTypeCompare:function(e,t){},createNode:function(e,t){},moveRoot:function(e){var t=this.root;e.root.parentNode==this.rendererRoot&&(t=e.root),t.parentNode.removeChild(t),e.rendererRoot.appendChild(t)},getRenderLayerId:function(){return this.root.parentNode.parentNode.id},isComplexSymbol:function(e){return e!="circle"&&!!e},CLASS_NAME:"OpenLayers.Renderer.Elements"}),OpenLayers.Renderer.VML=OpenLayers.Class(OpenLayers.Renderer.Elements,{xmlns:"urn:schemas-microsoft-com:vml",symbolCache:{},offset:null,initialize:function(e){if(!this.supported())return;if(!document.namespaces.olv){document.namespaces.add("olv",this.xmlns);var t=document.createStyleSheet(),n=["shape","rect","oval","fill","stroke","imagedata","group","textbox"];for(var r=0,i=n.length;r<i;r++)t.addRule("olv\\:"+n[r],"behavior: url(#default#VML); position: absolute; display: inline-block;")}OpenLayers.Renderer.Elements.prototype.initialize.apply(this,arguments)},supported:function(){return!!document.namespaces},setExtent:function(e,t){var n=OpenLayers.Renderer.Elements.prototype.setExtent.apply(this,arguments),r=this.getResolution(),i=e.left/r|0,s=e.top/r-this.size.h|0;t||!this.offset?(this.offset={x:i,y:s},i=0,s=0):(i-=this.offset.x,s-=this.offset.y);var o=i-this.xOffset+" "+s;this.root.coordorigin=o;var u=[this.root,this.vectorRoot,this.textRoot],a;for(var f=0,l=u.length;f<l;++f){a=u[f];var c=this.size.w+" "+this.size.h;a.coordsize=c}return this.root.style.flip="y",n},setSize:function(e){OpenLayers.Renderer.prototype.setSize.apply(this,arguments);var t=[this.rendererRoot,this.root,this.vectorRoot,this.textRoot],n=this.size.w+"px",r=this.size.h+"px",i;for(var s=0,o=t.length;s<o;++s)i=t[s],i.style.width=n,i.style.height=r},getNodeType:function(e,t){var n=null;switch(e.CLASS_NAME){case"OpenLayers.Geometry.Point":t.externalGraphic?n="olv:rect":this.isComplexSymbol(t.graphicName)?n="olv:shape":n="olv:oval";break;case"OpenLayers.Geometry.Rectangle":n="olv:rect";break;case"OpenLayers.Geometry.LineString":case"OpenLayers.Geometry.LinearRing":case"OpenLayers.Geometry.Polygon":case"OpenLayers.Geometry.Curve":n="olv:shape";break;default:}return n},setStyle:function(e,t,n,r){t=t||e._style,n=n||e._options;var i=t.fillColor;if(e._geometryClass==="OpenLayers.Geometry.Point")if(t.externalGraphic){n.isFilled=!0,t.graphicTitle&&(e.title=t.graphicTitle);var s=t.graphicWidth||t.graphicHeight,o=t.graphicHeight||t.graphicWidth;s=s?s:t.pointRadius*2,o=o?o:t.pointRadius*2;var u=this.getResolution(),a=t.graphicXOffset!=undefined?t.graphicXOffset:-(.5*s),f=t.graphicYOffset!=undefined?t.graphicYOffset:-(.5*o);e.style.left=((r.x-this.featureDx)/u-this.offset.x+a|0)+"px",e.style.top=(r.y/u-this.offset.y-(f+o)|0)+"px",e.style.width=s+"px",e.style.height=o+"px",e.style.flip="y",i="none",n.isStroked=!1}else if(this.isComplexSymbol(t.graphicName)){var l=this.importSymbol(t.graphicName);e.path=l.path,e.coordorigin=l.left+","+l.bottom;var c=l.size;e.coordsize=c+","+c,this.drawCircle(e,r,t.pointRadius),e.style.flip="y"}else this.drawCircle(e,r,t.pointRadius);n.isFilled?e.fillcolor=i:e.filled="false";var h=e.getElementsByTagName("fill"),p=h.length==0?null:h[0];if(!n.isFilled)p&&e.removeChild(p);else{p||(p=this.createNode("olv:fill",e.id+"_fill")),p.opacity=t.fillOpacity;if(e._geometryClass==="OpenLayers.Geometry.Point"&&t.externalGraphic){t.graphicOpacity&&(p.opacity=t.graphicOpacity),p.src=t.externalGraphic,p.type="frame";if(!t.graphicWidth||!t.graphicHeight)p.aspect="atmost"}p.parentNode!=e&&e.appendChild(p)}var d=t.rotation;if(d!==undefined||e._rotation!==undefined)e._rotation=d,t.externalGraphic?(this.graphicRotate(e,a,f,t),p.opacity=0):e._geometryClass==="OpenLayers.Geometry.Point"&&(e.style.rotation=d||0);var v=e.getElementsByTagName("stroke"),m=v.length==0?null:v[0];return n.isStroked?(m||(m=this.createNode("olv:stroke",e.id+"_stroke"),e.appendChild(m)),m.on=!0,m.color=t.strokeColor,m.weight=t.strokeWidth+"px",m.opacity=t.strokeOpacity,m.endcap=t.strokeLinecap=="butt"?"flat":t.strokeLinecap||"round",t.strokeDashstyle&&(m.dashstyle=this.dashStyle(t))):(e.stroked=!1,m&&(m.on=!1)),t.cursor!="inherit"&&t.cursor!=null&&(e.style.cursor=t.cursor),e},graphicRotate:function(e,t,n,r){var r=r||e._style,i=r.rotation||0,s,o;if(!r.graphicWidth||!r.graphicHeight){var u=new Image;u.onreadystatechange=OpenLayers.Function.bind(function(){if(u.readyState=="complete"||u.readyState=="interactive")s=u.width/u.height,o=Math.max(r.pointRadius*2,r.graphicWidth||0,r.graphicHeight||0),t*=s,r.graphicWidth=o*s,r.graphicHeight=o,this.graphicRotate(e,t,n,r)},this),u.src=r.externalGraphic;return}o=Math.max(r.graphicWidth,r.graphicHeight),s=r.graphicWidth/r.graphicHeight;var a=Math.round(r.graphicWidth||o*s),f=Math.round(r.graphicHeight||o);e.style.width=a+"px",e.style.height=f+"px";var l=document.getElementById(e.id+"_image");l||(l=this.createNode("olv:imagedata",e.id+"_image"),e.appendChild(l)),l.style.width=a+"px",l.style.height=f+"px",l.src=r.externalGraphic,l.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='', sizingMethod='scale')";var c=i*Math.PI/180,h=Math.sin(c),p=Math.cos(c),d="progid:DXImageTransform.Microsoft.Matrix(M11="+p+",M12="+ -h+",M21="+h+",M22="+p+",SizingMethod='auto expand')\n",v=r.graphicOpacity||r.fillOpacity;v&&v!=1&&(d+="progid:DXImageTransform.Microsoft.BasicImage(opacity="+v+")\n"),e.style.filter=d;var m=new OpenLayers.Geometry.Point(-t,-n),g=(new OpenLayers.Bounds(0,0,a,f)).toGeometry();g.rotate(r.rotation,m);var y=g.getBounds();e.style.left=Math.round(parseInt(e.style.left)+y.left)+"px",e.style.top=Math.round(parseInt(e.style.top)-y.bottom)+"px"},postDraw:function(e){e.style.visibility="visible";var t=e._style.fillColor,n=e._style.strokeColor;t=="none"&&e.fillcolor!=t&&(e.fillcolor=t),n=="none"&&e.strokecolor!=n&&(e.strokecolor=n)},setNodeDimension:function(e,t){var n=t.getBounds();if(n){var r=this.getResolution(),i=new OpenLayers.Bounds((n.left-this.featureDx)/r-this.offset.x|0,n.bottom/r-this.offset.y|0,(n.right-this.featureDx)/r-this.offset.x|0,n.top/r-this.offset.y|0);e.style.left=i.left+"px",e.style.top=i.top+"px",e.style.width=i.getWidth()+"px",e.style.height=i.getHeight()+"px",e.coordorigin=i.left+" "+i.top,e.coordsize=i.getWidth()+" "+i.getHeight()}},dashStyle:function(e){var t=e.strokeDashstyle;switch(t){case"solid":case"dot":case"dash":case"dashdot":case"longdash":case"longdashdot":return t;default:var n=t.split(/[ ,]/);if(n.length==2)return 1*n[0]>=2*n[1]?"longdash":n[0]==1||n[1]==1?"dot":"dash";if(n.length==4)return 1*n[0]>=2*n[1]?"longdashdot":"dashdot";return"solid"}},createNode:function(e,t){var n=document.createElement(e);return t&&(n.id=t),n.unselectable="on",n.onselectstart=OpenLayers.Function.False,n},nodeTypeCompare:function(e,t){var n=t,r=n.indexOf(":");r!=-1&&(n=n.substr(r+1));var i=e.nodeName;return r=i.indexOf(":"),r!=-1&&(i=i.substr(r+1)),n==i},createRenderRoot:function(){return this.nodeFactory(this.container.id+"_vmlRoot","div")},createRoot:function(e){return this.nodeFactory(this.container.id+e,"olv:group")},drawPoint:function(e,t){return this.drawCircle(e,t,1)},drawCircle:function(e,t,n){if(!isNaN(t.x)&&!isNaN(t.y)){var r=this.getResolution();e.style.left=((t.x-this.featureDx)/r-this.offset.x|0)-n+"px",e.style.top=(t.y/r-this.offset.y|0)-n+"px";var i=n*2;return e.style.width=i+"px",e.style.height=i+"px",e}return!1},drawLineString:function(e,t){return this.drawLine(e,t,!1)},drawLinearRing:function(e,t){return this.drawLine(e,t,!0)},drawLine:function(e,t,n){this.setNodeDimension(e,t);var r=this.getResolution(),i=t.components.length,s=new Array(i),o,u,a;for(var f=0;f<i;f++)o=t.components[f],u=(o.x-this.featureDx)/r-this.offset.x|0,a=o.y/r-this.offset.y|0,s[f]=" "+u+","+a+" l ";var l=n?" x e":" e";return e.path="m"+s.join("")+l,e},drawPolygon:function(e,t){this.setNodeDimension(e,t);var n=this.getResolution(),r=[],i,s,o,u,a,f,l,c,h,p,d,v;for(i=0,s=t.components.length;i<s;i++){r.push("m"),o=t.components[i].components,u=i===0,a=null,f=null;for(l=0,c=o.length;l<c;l++)h=o[l],d=(h.x-this.featureDx)/n-this.offset.x|0,v=h.y/n-this.offset.y|0,p=" "+d+","+v,r.push(p),l==0&&r.push(" l"),u||(a?a!=p&&(f?f!=p&&(u=!0):f=p):a=p);r.push(u?" x ":" ")}return r.push("e"),e.path=r.join(""),e},drawRectangle:function(e,t){var n=this.getResolution();return e.style.left=((t.x-this.featureDx)/n-this.offset.x|0)+"px",e.style.top=(t.y/n-this.offset.y|0)+"px",e.style.width=(t.width/n|0)+"px",e.style.height=(t.height/n|0)+"px",e},drawText:function(e,t,n){var r=this.nodeFactory(e+this.LABEL_ID_SUFFIX,"olv:rect"),i=this.nodeFactory(e+this.LABEL_ID_SUFFIX+"_textbox","olv:textbox"),s=this.getResolution();r.style.left=((n.x-this.featureDx)/s-this.offset.x|0)+"px",r.style.top=(n.y/s-this.offset.y|0)+"px",r.style.flip="y",i.innerText=t.label,t.cursor!="inherit"&&t.cursor!=null&&(i.style.cursor=t.cursor),t.fontColor&&(i.style.color=t.fontColor),t.fontOpacity&&(i.style.filter="alpha(opacity="+t.fontOpacity*100+")"),t.fontFamily&&(i.style.fontFamily=t.fontFamily),t.fontSize&&(i.style.fontSize=t.fontSize),t.fontWeight&&(i.style.fontWeight=t.fontWeight),t.fontStyle&&(i.style.fontStyle=t.fontStyle),t.labelSelect===!0&&(r._featureId=e,i._featureId=e,i._geometry=n,i._geometryClass=n.CLASS_NAME),i.style.whiteSpace="nowrap",i.inset="1px,0px,0px,0px",r.parentNode||(r.appendChild(i),this.textRoot.appendChild(r));var o=t.labelAlign||"cm";o.length==1&&(o+="m");var u=i.clientWidth*OpenLayers.Renderer.VML.LABEL_SHIFT[o.substr(0,1)],a=i.clientHeight*OpenLayers.Renderer.VML.LABEL_SHIFT[o.substr(1,1)];r.style.left=parseInt(r.style.left)-u-1+"px",r.style.top=parseInt(r.style.top)+a+"px"},moveRoot:function(e){var t=this.map.getLayer(e.container.id);t instanceof OpenLayers.Layer.Vector.RootContainer&&(t=this.map.getLayer(this.container.id)),t&&t.renderer.clear(),OpenLayers.Renderer.Elements.prototype.moveRoot.apply(this,arguments),t&&t.redraw()},importSymbol:function(e){var t=this.container.id+"-"+e,n=this.symbolCache[t];if(n)return n;var r=OpenLayers.Renderer.symbol[e];if(!r)throw new Error(e+" is not a valid symbol name");var i=new OpenLayers.Bounds(Number.MAX_VALUE,Number.MAX_VALUE,0,0),s=["m"];for(var o=0;o<r.length;o+=2){var u=r[o],a=r[o+1];i.left=Math.min(i.left,u),i.bottom=Math.min(i.bottom,a),i.right=Math.max(i.right,u),i.top=Math.max(i.top,a),s.push(u),s.push(a),o==0&&s.push("l")}s.push("x e");var f=s.join(" "),l=(i.getWidth()-i.getHeight())/2;return l>0?(i.bottom=i.bottom-l,i.top=i.top+l):(i.left=i.left+l,i.right=i.right-l),n={path:f,size:i.getWidth(),left:i.left,bottom:i.bottom},this.symbolCache[t]=n,n},CLASS_NAME:"OpenLayers.Renderer.VML"}),OpenLayers.Renderer.VML.LABEL_SHIFT={l:0,c:.5,r:1,t:0,m:.5,b:1},OpenLayers.Animation=function(e){function s(e,t,s){t=t>0?t:Number.POSITIVE_INFINITY;var o=++r,u=+(new Date);return i[o]=function(){i[o]&&+(new Date)-u<=t?(e(),i[o]&&n(i[o],s)):delete i[o]},n(i[o],s),o}function o(e){delete i[e]}var t=!!(e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||e.oRequestAnimationFrame||e.msRequestAnimationFrame),n=function(){var t=e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||e.oRequestAnimationFrame||e.msRequestAnimationFrame||function(t,n){e.setTimeout(t,16)};return function(n,r){t.apply(e,[n,r])}}(),r=0,i={};return{isNative:t,requestFrame:n,start:s,stop:o}}(window),OpenLayers.Tween=OpenLayers.Class({easing:null,begin:null,finish:null,duration:null,callbacks:null,time:null,animationId:null,playing:!1,initialize:function(e){this.easing=e?e:OpenLayers.Easing.Expo.easeOut},start:function(e,t,n,r){this.playing=!0,this.begin=e,this.finish=t,this.duration=n,this.callbacks=r.callbacks,this.time=0,OpenLayers.Animation.stop(this.animationId),this.animationId=null,this.callbacks&&this.callbacks.start&&this.callbacks.start.call(this,this.begin),this.animationId=OpenLayers.Animation.start(OpenLayers.Function.bind(this.play,this))},stop:function(){if(!this.playing)return;this.callbacks&&this.callbacks.done&&this.callbacks.done.call(this,this.finish),OpenLayers.Animation.stop(this.animationId),this.animationId=null,this.playing=!1},play:function(){var e={};for(var t in this.begin){var n=this.begin[t],r=this.finish[t];if(n==null||r==null||isNaN(n)||isNaN(r))throw new TypeError("invalid value for Tween");var i=r-n;e[t]=this.easing.apply(this,[this.time,n,i,this.duration])}this.time++,this.callbacks&&this.callbacks.eachStep&&this.callbacks.eachStep.call(this,e),this.time>this.duration&&this.stop()},CLASS_NAME:"OpenLayers.Tween"}),OpenLayers.Easing={CLASS_NAME:"OpenLayers.Easing"},OpenLayers.Easing.Linear={easeIn:function(e,t,n,r){return n*e/r+t},easeOut:function(e,t,n,r){return n*e/r+t},easeInOut:function(e,t,n,r){return n*e/r+t},CLASS_NAME:"OpenLayers.Easing.Linear"},OpenLayers.Easing.Expo={easeIn:function(e,t,n,r){return e==0?t:n*Math.pow(2,10*(e/r-1))+t},easeOut:function(e,t,n,r){return e==r?t+n:n*(-Math.pow(2,-10*e/r)+1)+t},easeInOut:function(e,t,n,r){return e==0?t:e==r?t+n:(e/=r/2)<1?n/2*Math.pow(2,10*(e-1))+t:n/2*(-Math.pow(2,-10*--e)+2)+t},CLASS_NAME:"OpenLayers.Easing.Expo"},OpenLayers.Easing.Quad={easeIn:function(e,t,n,r){return n*(e/=r)*e+t},easeOut:function(e,t,n,r){return-n*(e/=r)*(e-2)+t},easeInOut:function(e,t,n,r){return(e/=r/2)<1?n/2*e*e+t:-n/2*(--e*(e-2)-1)+t},CLASS_NAME:"OpenLayers.Easing.Quad"},OpenLayers.Geometry=OpenLayers.Class({id:null,parent:null,bounds:null,initialize:function(){this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_")},destroy:function(){this.id=null,this.bounds=null},clone:function(){return new OpenLayers.Geometry},setBounds:function(e){e&&(this.bounds=e.clone())},clearBounds:function(){this.bounds=null,this.parent&&this.parent.clearBounds()},extendBounds:function(e){var t=this.getBounds();t?this.bounds.extend(e):this.setBounds(e)},getBounds:function(){return this.bounds==null&&this.calculateBounds(),this.bounds},calculateBounds:function(){},distanceTo:function(e,t){},getVertices:function(e){},atPoint:function(e,t,n){var r=!1,i=this.getBounds();if(i!=null&&e!=null){var s=t!=null?t:0,o=n!=null?n:0,u=new OpenLayers.Bounds(this.bounds.left-s,this.bounds.bottom-o,this.bounds.right+s,this.bounds.top+o);r=u.containsLonLat(e)}return r},getLength:function(){return 0},getArea:function(){return 0},getCentroid:function(){return null},toString:function(){var e;return OpenLayers.Format&&OpenLayers.Format.WKT?e=OpenLayers.Format.WKT.prototype.write(new OpenLayers.Feature.Vector(this)):e=Object.prototype.toString.call(this),e},CLASS_NAME:"OpenLayers.Geometry"}),OpenLayers.Geometry.fromWKT=function(e){var t;if(OpenLayers.Format&&OpenLayers.Format.WKT){var n=OpenLayers.Geometry.fromWKT.format;n||(n=new OpenLayers.Format.WKT,OpenLayers.Geometry.fromWKT.format=n);var r=n.read(e);if(r instanceof OpenLayers.Feature.Vector)t=r.geometry;else if(OpenLayers.Util.isArray(r)){var i=r.length,s=new Array(i);for(var o=0;o<i;++o)s[o]=r[o].geometry;t=new OpenLayers.Geometry.Collection(s)}}return t},OpenLayers.Geometry.segmentsIntersect=function(e,t,n){var r=n&&n.point,i=n&&n.tolerance,s=!1,o=e.x1-t.x1,u=e.y1-t.y1,a=e.x2-e.x1,f=e.y2-e.y1,l=t.y2-t.y1,c=t.x2-t.x1,h=l*a-c*f,p=c*u-l*o,d=a*u-f*o;if(h==0)p==0&&d==0&&(s=!0);else{var v=p/h,m=d/h;if(v>=0&&v<=1&&m>=0&&m<=1)if(!r)s=!0;else{var g=e.x1+v*a,y=e.y1+v*f;s=new OpenLayers.Geometry.Point(g,y)}}if(i){var b;if(s){if(r){var w=[e,t],E,g,y;e:for(var S=0;S<2;++S){E=w[S];for(var x=1;x<3;++x){g=E["x"+x],y=E["y"+x],b=Math.sqrt(Math.pow(g-s.x,2)+Math.pow(y-s.y,2));if(b<i){s.x=g,s.y=y;break e}}}}}else{var w=[e,t],T,N,g,y,C,k;e:for(var S=0;S<2;++S){T=w[S],N=w[(S+1)%2];for(var x=1;x<3;++x){C={x:T["x"+x],y:T["y"+x]},k=OpenLayers.Geometry.distanceToSegment(C,N);if(k.distance<i){r?s=new OpenLayers.Geometry.Point(C.x,C.y):s=!0;break e}}}}}return s},OpenLayers.Geometry.distanceToSegment=function(e,t){var n=e.x,r=e.y,i=t.x1,s=t.y1,o=t.x2,u=t.y2,a=o-i,f=u-s,l=(a*(n-i)+f*(r-s))/(Math.pow(a,2)+Math.pow(f,2)),c,h;return l<=0?(c=i,h=s):l>=1?(c=o,h=u):(c=i+l*a,h=s+l*f),{distance:Math.sqrt(Math.pow(c-n,2)+Math.pow(h-r,2)),x:c,y:h}},OpenLayers.Geometry.Collection=OpenLayers.Class(OpenLayers.Geometry,{components:null,componentTypes:null,initialize:function(e){OpenLayers.Geometry.prototype.initialize.apply(this,arguments),this.components=[],e!=null&&this.addComponents(e)},destroy:function(){this.components.length=0,this.components=null,OpenLayers.Geometry.prototype.destroy.apply(this,arguments)},clone:function(){var geometry=eval("new "+this.CLASS_NAME+"()");for(var i=0,len=this.components.length;i<len;i++)geometry.addComponent(this.components[i].clone());return OpenLayers.Util.applyDefaults(geometry,this),geometry},getComponentsString:function(){var e=[];for(var t=0,n=this.components.length;t<n;t++)e.push(this.components[t].toShortString());return e.join(",")},calculateBounds:function(){this.bounds=null;var e=new OpenLayers.Bounds,t=this.components;if(t)for(var n=0,r=t.length;n<r;n++)e.extend(t[n].getBounds());e.left!=null&&e.bottom!=null&&e.right!=null&&e.top!=null&&this.setBounds(e)},addComponents:function(e){OpenLayers.Util.isArray(e)||(e=[e]);for(var t=0,n=e.length;t<n;t++)this.addComponent(e[t])},addComponent:function(e,t){var n=!1;if(e)if(this.componentTypes==null||OpenLayers.Util.indexOf(this.componentTypes,e.CLASS_NAME)>-1){if(t!=null&&t<this.components.length){var r=this.components.slice(0,t),i=this.components.slice(t,this.components.length);r.push(e),this.components=r.concat(i)}else this.components.push(e);e.parent=this,this.clearBounds(),n=!0}return n},removeComponents:function(e){var t=!1;OpenLayers.Util.isArray(e)||(e=[e]);for(var n=e.length-1;n>=0;--n)t=this.removeComponent(e[n])||t;return t},removeComponent:function(e){return OpenLayers.Util.removeItem(this.components,e),this.clearBounds(),!0},getLength:function(){var e=0;for(var t=0,n=this.components.length;t<n;t++)e+=this.components[t].getLength();return e},getArea:function(){var e=0;for(var t=0,n=this.components.length;t<n;t++)e+=this.components[t].getArea();return e},getGeodesicArea:function(e){var t=0;for(var n=0,r=this.components.length;n<r;n++)t+=this.components[n].getGeodesicArea(e);return t},getCentroid:function(e){if(!e)return this.components.length&&this.components[0].getCentroid();var t=this.components.length;if(!t)return!1;var n=[],r=[],i=0,s=Number.MAX_VALUE,o;for(var u=0;u<t;++u){o=this.components[u];var a=o.getArea(),f=o.getCentroid(!0);if(isNaN(a)||isNaN(f.x)||isNaN(f.y))continue;n.push(a),i+=a,s=a<s&&a>0?a:s,r.push(f)}t=n.length;if(i===0){for(var u=0;u<t;++u)n[u]=1;i=n.length}else{for(var u=0;u<t;++u)n[u]/=s;i/=s}var l=0,c=0,f,a;for(var u=0;u<t;++u)f=r[u],a=n[u],l+=f.x*a,c+=f.y*a;return new OpenLayers.Geometry.Point(l/i,c/i)},getGeodesicLength:function(e){var t=0;for(var n=0,r=this.components.length;n<r;n++)t+=this.components[n].getGeodesicLength(e);return t},move:function(e,t){for(var n=0,r=this.components.length;n<r;n++)this.components[n].move(e,t)},rotate:function(e,t){for(var n=0,r=this.components.length;n<r;++n)this.components[n].rotate(e,t)},resize:function(e,t,n){for(var r=0;r<this.components.length;++r)this.components[r].resize(e,t,n);return this},distanceTo:function(e,t){var n=!t||t.edge!==!1,r=n&&t&&t.details,i,s,o,u=Number.POSITIVE_INFINITY;for(var a=0,f=this.components.length;a<f;++a){i=this.components[a].distanceTo(e,t),o=r?i.distance:i;if(o<u){u=o,s=i;if(u==0)break}}return s},equals:function(e){var t=!0;if(!e||!e.CLASS_NAME||this.CLASS_NAME!=e.CLASS_NAME)t=!1;else if(!OpenLayers.Util.isArray(e.components)||e.components.length!=this.components.length)t=!1;else for(var n=0,r=this.components.length;n<r;++n)if(!this.components[n].equals(e.components[n])){t=!1;break}return t},transform:function(e,t){if(e&&t){for(var n=0,r=this.components.length;n<r;n++){var i=this.components[n];i.transform(e,t)}this.bounds=null}return this},intersects:function(e){var t=!1;for(var n=0,r=this.components.length;n<r;++n){t=e.intersects(this.components[n]);if(t)break}return t},getVertices:function(e){var t=[];for(var n=0,r=this.components.length;n<r;++n)Array.prototype.push.apply(t,this.components[n].getVertices(e));return t},CLASS_NAME:"OpenLayers.Geometry.Collection"}),OpenLayers.Geometry.Point=OpenLayers.Class(OpenLayers.Geometry,{x:null,y:null,initialize:function(e,t){OpenLayers.Geometry.prototype.initialize.apply(this,arguments),this.x=parseFloat(e),this.y=parseFloat(t)},clone:function(e){return e==null&&(e=new OpenLayers.Geometry.Point(this.x,this.y)),OpenLayers.Util.applyDefaults(e,this),e},calculateBounds:function(){this.bounds=new OpenLayers.Bounds(this.x,this.y,this.x,this.y)},distanceTo:function(e,t){var n=!t||t.edge!==!1,r=n&&t&&t.details,i,s,o,u,a,f;return e instanceof OpenLayers.Geometry.Point?(s=this.x,o=this.y,u=e.x,a=e.y,i=Math.sqrt(Math.pow(s-u,2)+Math.pow(o-a,2)),f=r?{x0:s,y0:o,x1:u,y1:a,distance:i}:i):(f=e.distanceTo(this,t),r&&(f={x0:f.x1,y0:f.y1,x1:f.x0,y1:f.y0,distance:f.distance})),f},equals:function(e){var t=!1;return e!=null&&(t=this.x==e.x&&this.y==e.y||isNaN(this.x)&&isNaN(this.y)&&isNaN(e.x)&&isNaN(e.y)),t},toShortString:function(){return this.x+", "+this.y},move:function(e,t){this.x=this.x+e,this.y=this.y+t,this.clearBounds()},rotate:function(e,t){e*=Math.PI/180;var n=this.distanceTo(t),r=e+Math.atan2(this.y-t.y,this.x-t.x);this.x=t.x+n*Math.cos(r),this.y=t.y+n*Math.sin(r),this.clearBounds()},getCentroid:function(){return new OpenLayers.Geometry.Point(this.x,this.y)},resize:function(e,t,n){return n=n==undefined?1:n,this.x=t.x+e*n*(this.x-t.x),this.y=t.y+e*(this.y-t.y),this.clearBounds(),this},intersects:function(e){var t=!1;return e.CLASS_NAME=="OpenLayers.Geometry.Point"?t=this.equals(e):t=e.intersects(this),t},transform:function(e,t){return e&&t&&(OpenLayers.Projection.transform(this,e,t),this.bounds=null),this},getVertices:function(e){return[this]},CLASS_NAME:"OpenLayers.Geometry.Point"}),OpenLayers.Geometry.MultiPoint=OpenLayers.Class(OpenLayers.Geometry.Collection,{componentTypes:["OpenLayers.Geometry.Point"],addPoint:function(e,t){this.addComponent(e,t)},removePoint:function(e){this.removeComponent(e)},CLASS_NAME:"OpenLayers.Geometry.MultiPoint"}),OpenLayers.Geometry.Curve=OpenLayers.Class(OpenLayers.Geometry.MultiPoint,{componentTypes:["OpenLayers.Geometry.Point"],getLength:function(){var e=0;if(this.components&&this.components.length>1)for(var t=1,n=this.components.length;t<n;t++)e+=this.components[t-1].distanceTo(this.components[t]);return e},getGeodesicLength:function(e){var t=this;if(e){var n=new OpenLayers.Projection("EPSG:4326");n.equals(e)||(t=this.clone().transform(e,n))}var r=0;if(t.components&&t.components.length>1){var i,s;for(var o=1,u=t.components.length;o<u;o++)i=t.components[o-1],s=t.components[o],r+=OpenLayers.Util.distVincenty({lon:i.x,lat:i.y},{lon:s.x,lat:s.y})}return r*1e3},CLASS_NAME:"OpenLayers.Geometry.Curve"}),OpenLayers.Geometry.LineString=OpenLayers.Class(OpenLayers.Geometry.Curve,{removeComponent:function(e){var t=this.components&&this.components.length>2;return t&&OpenLayers.Geometry.Collection.prototype.removeComponent.apply(this,arguments),t},intersects:function(e){var t=!1,n=e.CLASS_NAME;if(n=="OpenLayers.Geometry.LineString"||n=="OpenLayers.Geometry.LinearRing"||n=="OpenLayers.Geometry.Point"){var r=this.getSortedSegments(),i;n=="OpenLayers.Geometry.Point"?i=[{x1:e.x,y1:e.y,x2:e.x,y2:e.y}]:i=e.getSortedSegments();var s,o,u,a,f,l,c,h;e:for(var p=0,d=r.length;p<d;++p){s=r[p],o=s.x1,u=s.x2,a=s.y1,f=s.y2;for(var v=0,m=i.length;v<m;++v){l=i[v];if(l.x1>u)break;if(l.x2<o)continue;c=l.y1,h=l.y2;if(Math.min(c,h)>Math.max(a,f))continue;if(Math.max(c,h)<Math.min(a,f))continue;if(OpenLayers.Geometry.segmentsIntersect(s,l)){t=!0;break e}}}}else t=e.intersects(this);return t},getSortedSegments:function(){function s(e,t){return e.x1-t.x1}var e=this.components.length-1,t=new Array(e),n,r;for(var i=0;i<e;++i)n=this.components[i],r=this.components[i+1],n.x<r.x?t[i]={x1:n.x,y1:n.y,x2:r.x,y2:r.y}:t[i]={x1:r.x,y1:r.y,x2:n.x,y2:n.y};return t.sort(s)},splitWithSegment:function(e,t){var n=!t||t.edge!==!1,r=t&&t.tolerance,i=[],s=this.getVertices(),o=[],u=[],a=!1,f,l,c,h,p,d,v={point:!0,tolerance:r},m=null;for(var g=0,y=s.length-2;g<=y;++g){f=s[g],o.push(f.clone()),l=s[g+1],d={x1:f.x,y1:f.y,x2:l.x,y2:l.y},c=OpenLayers.Geometry.segmentsIntersect(e,d,v);if(c instanceof OpenLayers.Geometry.Point){c.x===e.x1&&c.y===e.y1||c.x===e.x2&&c.y===e.y2||c.equals(f)||c.equals(l)?p=!0:p=!1;if(p||n){c.equals(u[u.length-1])||u.push(c.clone());if(g===0&&c.equals(f))continue;if(c.equals(l))continue;a=!0,c.equals(f)||o.push(c),i.push(new OpenLayers.Geometry.LineString(o)),o=[c.clone()]}}}a&&(o.push(l.clone()),i.push(new OpenLayers.Geometry.LineString(o)));if(u.length>0){var b=e.x1<e.x2?1:-1,w=e.y1<e.y2?1:-1;m={lines:i,points:u.sort(function(e,t){return b*e.x-b*t.x||w*e.y-w*t.y})}}return m},split:function(e,t){var n=null,r=t&&t.mutual,i,s,o,u;if(e instanceof OpenLayers.Geometry.LineString){var a=this.getVertices(),f,l,c,h,p,d,v=[];o=[];for(var m=0,g=a.length-2;m<=g;++m){f=a[m],l=a[m+1],c={x1:f.x,y1:f.y,x2:l.x,y2:l.y},u=u||[e],r&&v.push(f.clone());for(var y=0;y<u.length;++y){h=u[y].splitWithSegment(c,t);if(h){p=h.lines,p.length>0&&(p.unshift(y,1),Array.prototype.splice.apply(u,p),y+=p.length-2);if(r)for(var b=0,w=h.points.length;b<w;++b)d=h.points[b],d.equals(f)||(v.push(d),o.push(new OpenLayers.Geometry.LineString(v)),d.equals(l)?v=[]:v=[d.clone()])}}}r&&o.length>0&&v.length>0&&(v.push(l.clone()),o.push(new OpenLayers.Geometry.LineString(v)))}else n=e.splitWith(this,t);u&&u.length>1?s=!0:u=[],o&&o.length>1?i=!0:o=[];if(s||i)r?n=[o,u]:n=u;return n},splitWith:function(e,t){return e.split(this,t)},getVertices:function(e){var t;return e===!0?t=[this.components[0],this.components[this.components.length-1]]:e===!1?t=this.components.slice(1,this.components.length-1):t=this.components.slice(),t},distanceTo:function(e,t){var n=!t||t.edge!==!1,r=n&&t&&t.details,i,s={},o=Number.POSITIVE_INFINITY;if(e instanceof OpenLayers.Geometry.Point){var u=this.getSortedSegments(),a=e.x,f=e.y,l;for(var c=0,h=u.length;c<h;++c){l=u[c],i=OpenLayers.Geometry.distanceToSegment(e,l);if(i.distance<o){o=i.distance,s=i;if(o===0)break}else if(l.x2>a&&(f>l.y1&&f<l.y2||f<l.y1&&f>l.y2))break}r?s={distance:s.distance,x0:s.x,y0:s.y,x1:a,y1:f}:s=s.distance}else if(e instanceof OpenLayers.Geometry.LineString){var p=this.getSortedSegments(),d=e.getSortedSegments(),v,m,g,y,b,w=d.length,E={point:!0};e:for(var c=0,h=p.length;c<h;++c){v=p[c],y=v.x1,b=v.y1;for(var S=0;S<w;++S){m=d[S],g=OpenLayers.Geometry.segmentsIntersect(v,m,E);if(g){o=0,s={distance:0,x0:g.x,y0:g.y,x1:g.x,y1:g.y};break e}i=OpenLayers.Geometry.distanceToSegment({x:y,y:b},m),i.distance<o&&(o=i.distance,s={distance:o,x0:y,y0:b,x1:i.x,y1:i.y})}}r||(s=s.distance);if(o!==0&&v){i=e.distanceTo(new OpenLayers.Geometry.Point(v.x2,v.y2),t);var x=r?i.distance:i;x<o&&(r?s={distance:o,x0:i.x1,y0:i.y1,x1:i.x0,y1:i.y0}:s=x)}}else s=e.distanceTo(this,t),r&&(s={distance:s.distance,x0:s.x1,y0:s.y1,x1:s.x0,y1:s.y0});return s},simplify:function(e){if(this&&this!==null){var t=this.getVertices();if(t.length<3)return this;var n=function(e,t){return e-t},r=function(e,t,n,s){var o=0,a=0;for(var f=t,l;f<n;f++)l=i(e[t],e[n],e[f]),l>o&&(o=l,a=f);o>s&&a!=t&&(u.push(a),r(e,t,a,s),r(e,a,n,s))},i=function(e,t,n){var r=Math.abs(.5*(e.x*t.y+t.x*n.y+n.x*e.y-t.x*e.y-n.x*t.y-e.x*n.y)),i=Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2)),s=r/i*2;return s},s=0,o=t.length-1,u=[];u.push(s),u.push(o);while(t[s].equals(t[o]))o--,u.push(o);r(t,s,o,e);var a=[];u.sort(n);for(var f=0;f<u.length;f++)a.push(t[u[f]]);return new OpenLayers.Geometry.LineString(a)}return this},CLASS_NAME:"OpenLayers.Geometry.LineString"}),OpenLayers.Geometry.LinearRing=OpenLayers.Class(OpenLayers.Geometry.LineString,{componentTypes:["OpenLayers.Geometry.Point"],addComponent:function(e,t){var n=!1,r=this.components.pop();if(t!=null||!e.equals(r))n=OpenLayers.Geometry.Collection.prototype.addComponent.apply(this,arguments);var i=this.components[0];return OpenLayers.Geometry.Collection.prototype.addComponent.apply(this,[i]),n},removeComponent:function(e){var t=this.components&&this.components.length>3;if(t){this.components.pop(),OpenLayers.Geometry.Collection.prototype.removeComponent.apply(this,arguments);var n=this.components[0];OpenLayers.Geometry.Collection.prototype.addComponent.apply(this,[n])}return t},move:function(e,t){for(var n=0,r=this.components.length;n<r-1;n++)this.components[n].move(e,t)},rotate:function(e,t){for(var n=0,r=this.components.length;n<r-1;++n)this.components[n].rotate(e,t)},resize:function(e,t,n){for(var r=0,i=this.components.length;r<i-1;++r)this.components[r].resize(e,t,n);return this},transform:function(e,t){if(e&&t){for(var n=0,r=this.components.length;n<r-1;n++){var i=this.components[n];i.transform(e,t)}this.bounds=null}return this},getCentroid:function(){if(this.components&&this.components.length>2){var e=0,t=0;for(var n=0;n<this.components.length-1;n++){var r=this.components[n],i=this.components[n+1];e+=(r.x+i.x)*(r.x*i.y-i.x*r.y),t+=(r.y+i.y)*(r.x*i.y-i.x*r.y)}var s=-1*this.getArea(),o=e/(6*s),u=t/(6*s);return new OpenLayers.Geometry.Point(o,u)}return null},getArea:function(){var e=0;if(this.components&&this.components.length>2){var t=0;for(var n=0,r=this.components.length;n<r-1;n++){var i=this.components[n],s=this.components[n+1];t+=(i.x+s.x)*(s.y-i.y)}e=-t/2}return e},getGeodesicArea:function(e){var t=this;if(e){var n=new OpenLayers.Projection("EPSG:4326");n.equals(e)||(t=this.clone().transform(e,n))}var r=0,i=t.components&&t.components.length;if(i>2){var s,o;for(var u=0;u<i-1;u++)s=t.components[u],o=t.components[u+1],r+=OpenLayers.Util.rad(o.x-s.x)*(2+Math.sin(OpenLayers.Util.rad(s.y))+Math.sin(OpenLayers.Util.rad(o.y)));r=r*6378137*6378137/2}return r},containsPoint:function(e){function s(e,t,n,r,i){return(e-i)*((r-t)/(i-n))+r}var t=OpenLayers.Number.limitSigDigs,n=14,r=t(e.x,n),i=t(e.y,n),o=this.components.length-1,u,a,f,l,c,h,p,d,v=0;for(var m=0;m<o;++m){u=this.components[m],f=t(u.x,n),l=t(u.y,n),a=this.components[m+1],c=t(a.x,n),h=t(a.y,n);if(l==h){if(i==l)if(f<=c&&r>=f&&r<=c||f>=c&&r<=f&&r>=c){v=-1;break}continue}p=t(s(i,f,l,c,h),n);if(p==r)if(l<h&&i>=l&&i<=h||l>h&&i<=l&&i>=h){v=-1;break}if(p<=r)continue;if(f!=c&&(p<Math.min(f,c)||p>Math.max(f,c)))continue;(l<h&&i>=l&&i<h||l>h&&i<l&&i>=h)&&++v}var g=v==-1?1:!!(v&1);return g},intersects:function(e){var t=!1;if(e.CLASS_NAME=="OpenLayers.Geometry.Point")t=this.containsPoint(e);else if(e.CLASS_NAME=="OpenLayers.Geometry.LineString")t=e.intersects(this);else if(e.CLASS_NAME=="OpenLayers.Geometry.LinearRing")t=OpenLayers.Geometry.LineString.prototype.intersects.apply(this,[e]);else for(var n=0,r=e.components.length;n<r;++n){t=e.components[n].intersects(this);if(t)break}return t},getVertices:function(e){return e===!0?[]:this.components.slice(0,this.components.length-1)},CLASS_NAME:"OpenLayers.Geometry.LinearRing"}),OpenLayers.Geometry.Polygon=OpenLayers.Class(OpenLayers.Geometry.Collection,{componentTypes:["OpenLayers.Geometry.LinearRing"],getArea:function(){var e=0;if(this.components&&this.components.length>0){e+=Math.abs(this.components[0].getArea());for(var t=1,n=this.components.length;t<n;t++)e-=Math.abs(this.components[t].getArea())}return e},getGeodesicArea:function(e){var t=0;if(this.components&&this.components.length>0){t+=Math.abs(this.components[0].getGeodesicArea(e));for(var n=1,r=this.components.length;n<r;n++)t-=Math.abs(this.components[n].getGeodesicArea(e))}return t},containsPoint:function(e){var t=this.components.length,n=!1;if(t>0){n=this.components[0].containsPoint(e);if(n!==1&&n&&t>1){var r;for(var i=1;i<t;++i){r=this.components[i].containsPoint(e);if(r){r===1?n=1:n=!1;break}}}}return n},intersects:function(e){var t=!1,n,r;if(e.CLASS_NAME=="OpenLayers.Geometry.Point")t=this.containsPoint(e);else if(e.CLASS_NAME=="OpenLayers.Geometry.LineString"||e.CLASS_NAME=="OpenLayers.Geometry.LinearRing"){for(n=0,r=this.components.length;n<r;++n){t=e.intersects(this.components[n]);if(t)break}if(!t)for(n=0,r=e.components.length;n<r;++n){t=this.containsPoint(e.components[n]);if(t)break}}else for(n=0,r=e.components.length;n<r;++n){t=this.intersects(e.components[n]);if(t)break}if(!t&&e.CLASS_NAME=="OpenLayers.Geometry.Polygon"){var i=this.components[0];for(n=0,r=i.components.length;n<r;++n){t=e.containsPoint(i.components[n]);if(t)break}}return t},distanceTo:function(e,t){var n=!t||t.edge!==!1,r;return!n&&this.intersects(e)?r=0:r=OpenLayers.Geometry.Collection.prototype.distanceTo.apply(this,[e,t]),r},CLASS_NAME:"OpenLayers.Geometry.Polygon"}),OpenLayers.Geometry.Polygon.createRegularPolygon=function(e,t,n,r){var i=Math.PI*(1/n-.5);r&&(i+=r/180*Math.PI);var s,o,u,a=[];for(var f=0;f<n;++f)s=i+f*2*Math.PI/n,o=e.x+t*Math.cos(s),u=e.y+t*Math.sin(s),a.push(new OpenLayers.Geometry.Point(o,u));var l=new OpenLayers.Geometry.LinearRing(a);return new OpenLayers.Geometry.Polygon([l])},OpenLayers.Event={observers:!1,KEY_SPACE:32,KEY_BACKSPACE:8,KEY_TAB:9,KEY_RETURN:13,KEY_ESC:27,KEY_LEFT:37,KEY_UP:38,KEY_RIGHT:39,KEY_DOWN:40,KEY_DELETE:46,element:function(e){return e.target||e.srcElement},isSingleTouch:function(e){return e.touches&&e.touches.length==1},isMultiTouch:function(e){return e.touches&&e.touches.length>1},isLeftClick:function(e){return e.which&&e.which==1||e.button&&e.button==1},isRightClick:function(e){return e.which&&e.which==3||e.button&&e.button==2},stop:function(e,t){t||(e.preventDefault?e.preventDefault():e.returnValue=!1),e.stopPropagation?e.stopPropagation():e.cancelBubble=!0},findElement:function(e,t){var n=OpenLayers.Event.element(e);while(n.parentNode&&(!n.tagName||n.tagName.toUpperCase()!=t.toUpperCase()))n=n.parentNode;return n},observe:function(e,t,n,r){var i=OpenLayers.Util.getElement(e);r=r||!1,t=="keypress"&&(navigator.appVersion.match(/Konqueror|Safari|KHTML/)||i.attachEvent)&&(t="keydown"),this.observers||(this.observers={});if(!i._eventCacheID){var s="eventCacheID_";i.id&&(s=i.id+"_"+s),i._eventCacheID=OpenLayers.Util.createUniqueID(s)}var o=i._eventCacheID;this.observers[o]||(this.observers[o]=[]),this.observers[o].push({element:i,name:t,observer:n,useCapture:r}),i.addEventListener?i.addEventListener(t,n,r):i.attachEvent&&i.attachEvent("on"+t,n)},stopObservingElement:function(e){var t=OpenLayers.Util.getElement(e),n=t._eventCacheID;this._removeElementObservers(OpenLayers.Event.observers[n])},_removeElementObservers:function(e){if(e)for(var t=e.length-1;t>=0;t--)var n=e[t],r=new Array(n.element,n.name,n.observer,n.useCapture),i=OpenLayers.Event.stopObserving.apply(this,r)},stopObserving:function(e,t,n,r){r=r||!1;var i=OpenLayers.Util.getElement(e),s=i._eventCacheID;t=="keypress"&&(navigator.appVersion.match(/Konqueror|Safari|KHTML/)||i.detachEvent)&&(t="keydown");var o=!1,u=OpenLayers.Event.observers[s];if(u){var a=0;while(!o&&a<u.length){var f=u[a];if(f.name==t&&f.observer==n&&f.useCapture==r){u.splice(a,1),u.length==0&&delete OpenLayers.Event.observers[s],o=!0;break}a++}}return o&&(i.removeEventListener?i.removeEventListener(t,n,r):i&&i.detachEvent&&i.detachEvent("on"+t,n)),o},unloadCache:function(){if(OpenLayers.Event&&OpenLayers.Event.observers){for(var e in OpenLayers.Event.observers){var t=OpenLayers.Event.observers[e];OpenLayers.Event._removeElementObservers.apply(this,[t])}OpenLayers.Event.observers=!1}},CLASS_NAME:"OpenLayers.Event"},OpenLayers.Event.observe(window,"unload",OpenLayers.Event.unloadCache,!1),OpenLayers.Events=OpenLayers.Class({BROWSER_EVENTS:["mouseover","mouseout","mousedown","mouseup","mousemove","click","dblclick","rightclick","dblrightclick","resize","focus","blur","touchstart","touchmove","touchend","keydown"],listeners:null,object:null,element:null,eventHandler:null,fallThrough:null,includeXY:!1,extensions:null,extensionCount:null,clearMouseListener:null,initialize:function(e,t,n,r,i){OpenLayers.Util.extend(this,i),this.object=e,this.fallThrough=r,this.listeners={},this.extensions={},this.extensionCount={},t!=null&&this.attachToElement(t)},destroy:function(){for(var e in this.extensions)typeof this.extensions[e]!="boolean"&&this.extensions[e].destroy();this.extensions=null,this.element&&(OpenLayers.Event.stopObservingElement(this.element),this.element.hasScrollEvent&&OpenLayers.Event.stopObserving(window,"scroll",this.clearMouseListener)),this.element=null,this.listeners=null,this.object=null,this.fallThrough=null,this.eventHandler=null},addEventType:function(e){},attachToElement:function(e){this.element?OpenLayers.Event.stopObservingElement(this.element):(this.eventHandler=OpenLayers.Function.bindAsEventListener(this.handleBrowserEvent,this),this.clearMouseListener=OpenLayers.Function.bind(this.clearMouseCache,this)),this.element=e;for(var t=0,n=this.BROWSER_EVENTS.length;t<n;t++)OpenLayers.Event.observe(e,this.BROWSER_EVENTS[t],this.eventHandler);OpenLayers.Event.observe(e,"dragstart",OpenLayers.Event.stop)},on:function(e){for(var t in e)t!="scope"&&e.hasOwnProperty(t)&&this.register(t,e.scope,e[t])},register:function(e,t,n,r){e in OpenLayers.Events&&!this.extensions[e]&&(this.extensions[e]=new OpenLayers.Events[e](this));if(n!=null){t==null&&(t=this.object);var i=this.listeners[e];i||(i=[],this.listeners[e]=i,this.extensionCount[e]=0);var s={obj:t,func:n};r?(i.splice(this.extensionCount[e],0,s),typeof r=="object"&&r.extension&&this.extensionCount[e]++):i.push(s)}},registerPriority:function(e,t,n){this.register(e,t,n,!0)},un:function(e){for(var t in e)t!="scope"&&e.hasOwnProperty(t)&&this.unregister(t,e.scope,e[t])},unregister:function(e,t,n){t==null&&(t=this.object);var r=this.listeners[e];if(r!=null)for(var i=0,s=r.length;i<s;i++)if(r[i].obj==t&&r[i].func==n){r.splice(i,1);break}},remove:function(e){this.listeners[e]!=null&&(this.listeners[e]=[])},triggerEvent:function(e,t){var n=this.listeners[e];if(!n||n.length==0)return undefined;t==null&&(t={}),t.object=this.object,t.element=this.element,t.type||(t.type=e),n=n.slice();var r;for(var i=0,s=n.length;i<s;i++){var o=n[i];r=o.func.apply(o.obj,[t]);if(r!=undefined&&r==0)break}return this.fallThrough||OpenLayers.Event.stop(t,!0),r},handleBrowserEvent:function(e){var t=e.type,n=this.listeners[t];if(!n||n.length==0)return;var r=e.touches;if(r&&r[0]){var i=0,s=0,o=r.length,u;for(var a=0;a<o;++a)u=r[a],i+=u.clientX,s+=u.clientY;e.clientX=i/o,e.clientY=s/o}this.includeXY&&(e.xy=this.getMousePosition(e)),this.triggerEvent(t,e)},clearMouseCache:function(){this.element.scrolls=null,this.element.lefttop=null;var e=document.body;e&&(e.scrollTop==0&&e.scrollLeft==0||!navigator.userAgent.match(/iPhone/i))&&(this.element.offsets=null)},getMousePosition:function(e){this.includeXY?this.element.hasScrollEvent||(OpenLayers.Event.observe(window,"scroll",this.clearMouseListener),this.element.hasScrollEvent=!0):this.clearMouseCache();if(!this.element.scrolls){var t=OpenLayers.Util.getViewportElement();this.element.scrolls=[t.scrollLeft,t.scrollTop]}return this.element.lefttop||(this.element.lefttop=[document.documentElement.clientLeft||0,document.documentElement.clientTop||0]),this.element.offsets||(this.element.offsets=OpenLayers.Util.pagePosition(this.element)),new OpenLayers.Pixel(e.clientX+this.element.scrolls[0]-this.element.offsets[0]-this.element.lefttop[0],e.clientY+this.element.scrolls[1]-this.element.offsets[1]-this.element.lefttop[1])},CLASS_NAME:"OpenLayers.Events"}),OpenLayers.Projection=OpenLayers.Class({proj:null,projCode:null,titleRegEx:/\+title=[^\+]*/,initialize:function(e,t){OpenLayers.Util.extend(this,t),this.projCode=e,window.Proj4js&&(this.proj=new Proj4js.Proj(e))},getCode:function(){return this.proj?this.proj.srsCode:this.projCode},getUnits:function(){return this.proj?this.proj.units:null},toString:function(){return this.getCode()},equals:function(e){var t=e,n=!1;if(t){t instanceof OpenLayers.Projection||(t=new OpenLayers.Projection(t));if(window.Proj4js&&this.proj.defData&&t.proj.defData)n=this.proj.defData.replace(this.titleRegEx,"")==t.proj.defData.replace(this.titleRegEx,"");else if(t.getCode){var r=this.getCode(),i=t.getCode();n=r==i||!!OpenLayers.Projection.transforms[r]&&OpenLayers.Projection.transforms[r][i]===OpenLayers.Projection.nullTransform}}return n},destroy:function(){delete this.proj,delete this.projCode},CLASS_NAME:"OpenLayers.Projection"}),OpenLayers.Projection.transforms={},OpenLayers.Projection.defaults={"EPSG:4326":{units:"degrees",maxExtent:[-180,-90,180,90],yx:!0},"CRS:84":{units:"degrees",maxExtent:[-180,-90,180,90]},"EPSG:900913":{units:"m",maxExtent:[-20037508.34,-20037508.34,20037508.34,20037508.34]}},OpenLayers.Projection.addTransform=function(e,t,n){if(n===OpenLayers.Projection.nullTransform){var r=OpenLayers.Projection.defaults[e];r&&!OpenLayers.Projection.defaults[t]&&(OpenLayers.Projection.defaults[t]=r)}OpenLayers.Projection.transforms[e]||(OpenLayers.Projection.transforms[e]={}),OpenLayers.Projection.transforms[e][t]=n},OpenLayers.Projection.transform=function(e,t,n){if(t&&n){t instanceof OpenLayers.Projection||(t=new OpenLayers.Projection(t)),n instanceof OpenLayers.Projection||(n=new OpenLayers.Projection(n));if(t.proj&&n.proj)e=Proj4js.transform(t.proj,n.proj,e);else{var r=t.getCode(),i=n.getCode(),s=OpenLayers.Projection.transforms;s[r]&&s[r][i]&&s[r][i](e)}}return e},OpenLayers.Projection.nullTransform=function(e){return e},function(){function t(t){return t.x=180*t.x/e,t.y=180/Math.PI*(2*Math.atan(Math.exp(t.y/e*Math.PI))-Math.PI/2),t}function n(t){return t.x=t.x*e/180,t.y=Math.log(Math.tan((90+t.y)*Math.PI/360))/Math.PI*e,t}function r(e,r){var i=OpenLayers.Projection.addTransform,s=OpenLayers.Projection.nullTransform,o,u,a,f,l;for(o=0,u=r.length;o<u;++o){a=r[o],i(e,a,n),i(a,e,t);for(l=o+1;l<u;++l)f=r[l],i(a,f,s),i(f,a,s)}}var e=20037508.34,i=["EPSG:900913","EPSG:3857","EPSG:102113","EPSG:102100"],s=["CRS:84","urn:ogc:def:crs:EPSG:6.6:4326","EPSG:4326"],o;for(o=i.length-1;o>=0;--o)r(i[o],s);for(o=s.length-1;o>=0;--o)r(s[o],i)}(),OpenLayers.Map=OpenLayers.Class({Z_INDEX_BASE:{BaseLayer:100,Overlay:325,Feature:725,Popup:750,Control:1e3},id:null,fractionalZoom:!1,events:null,allOverlays:!1,div:null,dragging:!1,size:null,viewPortDiv:null,layerContainerOrigin:null,layerContainerDiv:null,layers:null,controls:null,popups:null,baseLayer:null,center:null,resolution:null,zoom:0,panRatio:1.5,options:null,tileSize:null,projection:"EPSG:4326",units:null,resolutions:null,maxResolution:null,minResolution:null,maxScale:null,minScale:null,maxExtent:null,minExtent:null,restrictedExtent:null,numZoomLevels:16,theme:null,displayProjection:null,fallThrough:!0,panTween:null,eventListeners:null,panMethod:OpenLayers.Easing.Expo.easeOut,panDuration:50,paddingForPopups:null,minPx:null,maxPx:null,initialize:function(e,t){arguments.length===1&&typeof e=="object"&&(t=e,e=t&&t.div),this.tileSize=new OpenLayers.Size(OpenLayers.Map.TILE_WIDTH,OpenLayers.Map.TILE_HEIGHT),this.paddingForPopups=new OpenLayers.Bounds(15,15,15,15),this.theme=OpenLayers._getScriptLocation()+"theme/default/style.css",this.options=OpenLayers.Util.extend({},t),OpenLayers.Util.extend(this,t);var n=this.projection instanceof OpenLayers.Projection?this.projection.projCode:this.projection;OpenLayers.Util.applyDefaults(this,OpenLayers.Projection.defaults[n]),this.maxExtent&&!(this.maxExtent instanceof OpenLayers.Bounds)&&(this.maxExtent=new OpenLayers.Bounds(this.maxExtent)),this.minExtent&&!(this.minExtent instanceof OpenLayers.Bounds)&&(this.minExtent=new OpenLayers.Bounds(this.minExtent)),this.restrictedExtent&&!(this.restrictedExtent instanceof OpenLayers.Bounds)&&(this.restrictedExtent=new OpenLayers.Bounds(this.restrictedExtent)),this.center&&!(this.center instanceof OpenLayers.LonLat)&&(this.center=new OpenLayers.LonLat(this.center)),this.layers=[],this.id=OpenLayers.Util.createUniqueID("OpenLayers.Map_"),this.div=OpenLayers.Util.getElement(e),this.div||(this.div=document.createElement("div"),this.div.style.height="1px",this.div.style.width="1px"),OpenLayers.Element.addClass(this.div,"olMap");var r=this.id+"_OpenLayers_ViewPort";this.viewPortDiv=OpenLayers.Util.createDiv(r,null,null,null,"relative",null,"hidden"),this.viewPortDiv.style.width="100%",this.viewPortDiv.style.height="100%",this.viewPortDiv.className="olMapViewport",this.div.appendChild(this.viewPortDiv),this.events=new OpenLayers.Events(this,this.viewPortDiv,null,this.fallThrough,{includeXY:!0}),r=this.id+"_OpenLayers_Container",this.layerContainerDiv=OpenLayers.Util.createDiv(r),this.layerContainerDiv.style.width="100px",this.layerContainerDiv.style.height="100px",this.layerContainerDiv.style.zIndex=this.Z_INDEX_BASE.Popup-1,this.viewPortDiv.appendChild(this.layerContainerDiv),this.updateSize(),this.eventListeners instanceof Object&&this.events.on(this.eventListeners),parseFloat(navigator.appVersion.split("MSIE")[1])<9?this.events.register("resize",this,this.updateSize):(this.updateSizeDestroy=OpenLayers.Function.bind(this.updateSize,this),OpenLayers.Event.observe(window,"resize",this.updateSizeDestroy));if(this.theme){var i=!0,s=document.getElementsByTagName("link");for(var o=0,u=s.length;o<u;++o)if(OpenLayers.Util.isEquivalentUrl(s.item(o).href,this.theme)){i=!1;break}if(i){var a=document.createElement("link");a.setAttribute("rel","stylesheet"),a.setAttribute("type","text/css"),a.setAttribute("href",this.theme),document.getElementsByTagName("head")[0].appendChild(a)}}this.controls==null&&(this.controls=[],OpenLayers.Control!=null&&(OpenLayers.Control.Navigation?this.controls.push(new OpenLayers.Control.Navigation):OpenLayers.Control.TouchNavigation&&this.controls.push(new OpenLayers.Control.TouchNavigation),OpenLayers.Control.Zoom?this.controls.push(new OpenLayers.Control.Zoom):OpenLayers.Control.PanZoom&&this.controls.push(new OpenLayers.Control.PanZoom),OpenLayers.Control.ArgParser&&this.controls.push(new OpenLayers.Control.ArgParser),OpenLayers.Control.Attribution&&this.controls.push(new OpenLayers.Control.Attribution)));for(var o=0,u=this.controls.length;o<u;o++)this.addControlToMap(this.controls[o]);this.popups=[],this.unloadDestroy=OpenLayers.Function.bind(this.destroy,this),OpenLayers.Event.observe(window,"unload",this.unloadDestroy),t&&t.layers&&(delete this.center,this.addLayers(t.layers),t.center&&!this.getCenter()&&this.setCenter(t.center,t.zoom))},getViewport:function(){return this.viewPortDiv},render:function(e){this.div=OpenLayers.Util.getElement(e),OpenLayers.Element.addClass(this.div,"olMap"),this.viewPortDiv.parentNode.removeChild(this.viewPortDiv),this.div.appendChild(this.viewPortDiv),this.updateSize()},unloadDestroy:null,updateSizeDestroy:null,destroy:function(){if(!this.unloadDestroy)return!1;this.panTween&&(this.panTween.stop(),this.panTween=null),OpenLayers.Event.stopObserving(window,"unload",this.unloadDestroy),this.unloadDestroy=null,this.updateSizeDestroy?OpenLayers.Event.stopObserving(window,"resize",this.updateSizeDestroy):this.events.unregister("resize",this,this.updateSize),this.paddingForPopups=null;if(this.controls!=null){for(var e=this.controls.length-1;e>=0;--e)this.controls[e].destroy();this.controls=null}if(this.layers!=null){for(var e=this.layers.length-1;e>=0;--e)this.layers[e].destroy(!1);this.layers=null}this.viewPortDiv&&this.div.removeChild(this.viewPortDiv),this.viewPortDiv=null,this.eventListeners&&(this.events.un(this.eventListeners),this.eventListeners=null),this.events.destroy(),this.events=null,this.options=null},setOptions:function(e){var t=this.minPx&&e.restrictedExtent!=this.restrictedExtent;OpenLayers.Util.extend(this,e),t&&this.moveTo(this.getCachedCenter(),this.zoom,{forceZoomChange:!0})},getTileSize:function(){return this.tileSize},getBy:function(e,t,n){var r=typeof n.test=="function",i=OpenLayers.Array.filter(this[e],function(e){return e[t]==n||r&&n.test(e[t])});return i},getLayersBy:function(e,t){return this.getBy("layers",e,t)},getLayersByName:function(e){return this.getLayersBy("name",e)},getLayersByClass:function(e){return this.getLayersBy("CLASS_NAME",e)},getControlsBy:function(e,t){return this.getBy("controls",e,t)},getControlsByClass:function(e){return this.getControlsBy("CLASS_NAME",e)},getLayer:function(e){var t=null;for(var n=0,r=this.layers.length;n<r;n++){var i=this.layers[n];if(i.id==e){t=i;break}}return t},setLayerZIndex:function(e,t){e.setZIndex(this.Z_INDEX_BASE[e.isBaseLayer?"BaseLayer":"Overlay"]+t*5)},resetLayersZIndex:function(){for(var e=0,t=this.layers.length;e<t;e++){var n=this.layers[e];this.setLayerZIndex(n,e)}},addLayer:function(e){for(var t=0,n=this.layers.length;t<n;t++)if(this.layers[t]==e)return!1;return this.events.triggerEvent("preaddlayer",{layer:e})===!1?!1:(this.allOverlays&&(e.isBaseLayer=!1),e.div.className="olLayerDiv",e.div.style.overflow="",this.setLayerZIndex(e,this.layers.length),e.isFixed?this.viewPortDiv.appendChild(e.div):this.layerContainerDiv.appendChild(e.div),this.layers.push(e),e.setMap(this),e.isBaseLayer||this.allOverlays&&!this.baseLayer?this.baseLayer==null?this.setBaseLayer(e):e.setVisibility(!1):e.redraw(),this.events.triggerEvent("addlayer",{layer:e}),e.events.triggerEvent("added",{map:this,layer:e}),e.afterAdd(),!0)},addLayers:function(e){for(var t=0,n=e.length;t<n;t++)this.addLayer(e[t])},removeLayer:function(e,t){if(this.events.triggerEvent("preremovelayer",{layer:e})===!1)return;t==null&&(t=!0),e.isFixed?this.viewPortDiv.removeChild(e.div):this.layerContainerDiv.removeChild(e.div),OpenLayers.Util.removeItem(this.layers,e),e.removeMap(this),e.map=null;if(this.baseLayer==e){this.baseLayer=null;if(t)for(var n=0,r=this.layers.length;n<r;n++){var i=this.layers[n];if(i.isBaseLayer||this.allOverlays){this.setBaseLayer(i);break}}}this.resetLayersZIndex(),this.events.triggerEvent("removelayer",{layer:e}),e.events.triggerEvent("removed",{map:this,layer:e})},getNumLayers:function(){return this.layers.length},getLayerIndex:function(e){return OpenLayers.Util.indexOf(this.layers,e)},setLayerIndex:function(e,t){var n=this.getLayerIndex(e);t<0?t=0:t>this.layers.length&&(t=this.layers.length);if(n!=t){this.layers.splice(n,1),this.layers.splice(t,0,e);for(var r=0,i=this.layers.length;r<i;r++)this.setLayerZIndex(this.layers[r],r);this.events.triggerEvent("changelayer",{layer:e,property:"order"}),this.allOverlays&&(t===0?this.setBaseLayer(e):this.baseLayer!==this.layers[0]&&this.setBaseLayer(this.layers[0]))}},raiseLayer:function(e,t){var n=this.getLayerIndex(e)+t;this.setLayerIndex(e,n)},setBaseLayer:function(e){if(e!=this.baseLayer&&OpenLayers.Util.indexOf(this.layers,e)!=-1){var t=this.getCachedCenter(),n=OpenLayers.Util.getResolutionFromScale(this.getScale(),e.units);this.baseLayer!=null&&!this.allOverlays&&this.baseLayer.setVisibility(!1),this.baseLayer=e;if(!this.allOverlays||this.baseLayer.visibility)this.baseLayer.setVisibility(!0),this.baseLayer.inRange===!1&&this.baseLayer.redraw();if(t!=null){var r=this.getZoomForResolution(n||this.resolution,!0);this.setCenter(t,r,!1,!0)}this.events.triggerEvent("changebaselayer",{layer:this.baseLayer})}},addControl:function(e,t){this.controls.push(e),this.addControlToMap(e,t)},addControls:function(e,t){var n=arguments.length===1?[]:t;for(var r=0,i=e.length;r<i;r++){var s=e[r],o=n[r]?n[r]:null;this.addControl(s,o)}},addControlToMap:function(e,t){e.outsideViewport=e.div!=null,this.displayProjection&&!e.displayProjection&&(e.displayProjection=this.displayProjection),e.setMap(this);var n=e.draw(t);n&&(e.outsideViewport||(n.style.zIndex=this.Z_INDEX_BASE.Control+this.controls.length,this.viewPortDiv.appendChild(n))),e.autoActivate&&e.activate()},getControl:function(e){var t=null;for(var n=0,r=this.controls.length;n<r;n++){var i=this.controls[n];if(i.id==e){t=i;break}}return t},removeControl:function(e){e&&e==this.getControl(e.id)&&(e.div&&e.div.parentNode==this.viewPortDiv&&this.viewPortDiv.removeChild(e.div),OpenLayers.Util.removeItem(this.controls,e))},addPopup:function(e,t){if(t)for(var n=this.popups.length-1;n>=0;--n)this.removePopup(this.popups[n]);e.map=this,this.popups.push(e);var r=e.draw();r&&(r.style.zIndex=this.Z_INDEX_BASE.Popup+this.popups.length,this.layerContainerDiv.appendChild(r))},removePopup:function(e){OpenLayers.Util.removeItem(this.popups,e);if(e.div)try{this.layerContainerDiv.removeChild(e.div)}catch(t){}e.map=null},getSize:function(){var e=null;return this.size!=null&&(e=this.size.clone()),e},updateSize:function(){var e=this.getCurrentSize();if(e&&!isNaN(e.h)&&!isNaN(e.w)){this.events.clearMouseCache();var t=this.getSize();t==null&&(this.size=t=e);if(!e.equals(t)){this.size=e;for(var n=0,r=this.layers.length;n<r;n++)this.layers[n].onMapResize();var i=this.getCachedCenter();if(this.baseLayer!=null&&i!=null){var s=this.getZoom();this.zoom=null,this.setCenter(i,s)}}}},getCurrentSize:function(){var e=new OpenLayers.Size(this.div.clientWidth,this.div.clientHeight);if(e.w==0&&e.h==0||isNaN(e.w)&&isNaN(e.h))e.w=this.div.offsetWidth,e.h=this.div.offsetHeight;if(e.w==0&&e.h==0||isNaN(e.w)&&isNaN(e.h))e.w=parseInt(this.div.style.width),e.h=parseInt(this.div.style.height);return e},calculateBounds:function(e,t){var n=null;e==null&&(e=this.getCachedCenter()),t==null&&(t=this.getResolution());if(e!=null&&t!=null){var r=this.size.w*t/2,i=this.size.h*t/2;n=new OpenLayers.Bounds(e.lon-r,e.lat-i,e.lon+r,e.lat+i)}return n},getCenter:function(){var e=null,t=this.getCachedCenter();return t&&(e=t.clone()),e},getCachedCenter:function(){return!this.center&&this.size&&(this.center=this.getLonLatFromViewPortPx({x:this.size.w/2,y:this.size.h/2})),this.center},getZoom:function(){return this.zoom},pan:function(e,t,n){n=OpenLayers.Util.applyDefaults(n,{animate:!0,dragging:!1});if(n.dragging)(e!=0||t!=0)&&this.moveByPx(e,t);else{var r=this.getViewPortPxFromLonLat(this.getCachedCenter()),i=r.add(e,t);if(this.dragging||!i.equals(r)){var s=this.getLonLatFromViewPortPx(i);n.animate?this.panTo(s):(this.moveTo(s),this.dragging&&(this.dragging=!1,this.events.triggerEvent("moveend")))}}},panTo:function(e){if(this.panMethod&&this.getExtent().scale(this.panRatio).containsLonLat(e)){this.panTween||(this.panTween=new OpenLayers.Tween(this.panMethod));var t=this.getCachedCenter();if(e.equals(t))return;var n=this.getPixelFromLonLat(t),r=this.getPixelFromLonLat(e),i={x:r.x-n.x,y:r.y-n.y},s={x:0,y:0};this.panTween.start({x:0,y:0},i,this.panDuration,{callbacks:{eachStep:OpenLayers.Function.bind(function(e){var t=e.x-s.x,n=e.y-s.y;this.moveByPx(t,n),s.x=Math.round(e.x),s.y=Math.round(e.y)},this),done:OpenLayers.Function.bind(function(t){this.moveTo(e),this.dragging=!1,this.events.triggerEvent("moveend")},this)}})}else this.setCenter(e)},setCenter:function(e,t,n,r){this.panTween&&this.panTween.stop(),this.moveTo(e,t,{dragging:n,forceZoomChange:r})},moveByPx:function(e,t){var n=this.size.w/2,r=this.size.h/2,i=n+e,s=r+t,o=this.baseLayer.wrapDateLine,u=0,a=0;this.restrictedExtent&&(u=n,a=r,o=!1),e=o||i<=this.maxPx.x-u&&i>=this.minPx.x+u?Math.round(e):0,t=s<=this.maxPx.y-a&&s>=this.minPx.y+a?Math.round(t):0;if(e||t){this.dragging||(this.dragging=!0,this.events.triggerEvent("movestart")),this.center=null,e&&(this.layerContainerDiv.style.left=parseInt(this.layerContainerDiv.style.left)-e+"px",this.minPx.x-=e,this.maxPx.x-=e),t&&(this.layerContainerDiv.style.top=parseInt(this.layerContainerDiv.style.top)-t+"px",this.minPx.y-=t,this.maxPx.y-=t);var f,l,c;for(l=0,c=this.layers.length;l<c;++l)f=this.layers[l],f.visibility&&(f===this.baseLayer||f.inRange)&&(f.moveByPx(e,t),f.events.triggerEvent("move"));this.events.triggerEvent("move")}},adjustZoom:function(e){var t,n=this.baseLayer.resolutions,r=this.getMaxExtent().getWidth()/this.size.w;if(this.getResolutionForZoom(e)>r)for(var i=e|0,s=n.length;i<s;++i)if(n[i]<=r){e=i;break}return e},moveTo:function(e,t,n){e!=null&&!(e instanceof OpenLayers.LonLat)&&(e=new OpenLayers.LonLat(e)),n||(n={}),t!=null&&(t=parseFloat(t),this.fractionalZoom||(t=Math.round(t)));if(this.baseLayer.wrapDateLine){var r=t;t=this.adjustZoom(t),t!==r&&(e=this.getCenter())}var i=n.dragging||this.dragging,s=n.forceZoomChange;!this.getCachedCenter()&&!this.isValidLonLat(e)&&(e=this.maxExtent.getCenterLonLat(),this.center=e.clone());if(this.restrictedExtent!=null){e==null&&(e=this.center),t==null&&(t=this.getZoom());var o=this.getResolutionForZoom(t),u=this.calculateBounds(e,o);if(!this.restrictedExtent.containsBounds(u)){var a=this.restrictedExtent.getCenterLonLat();u.getWidth()>this.restrictedExtent.getWidth()?e=new OpenLayers.LonLat(a.lon,e.lat):u.left<this.restrictedExtent.left?e=e.add(this.restrictedExtent.left-u.left,0):u.right>this.restrictedExtent.right&&(e=e.add(this.restrictedExtent.right-u.right,0)),u.getHeight()>this.restrictedExtent.getHeight()?e=new OpenLayers.LonLat(e.lon,a.lat):u.bottom<this.restrictedExtent.bottom?e=e.add(0,this.restrictedExtent.bottom-u.bottom):u.top>this.restrictedExtent.top&&(e=e.add(0,this.restrictedExtent.top-u.top))}}var f=s||this.isValidZoomLevel(t)&&t!=this.getZoom(),l=this.isValidLonLat(e)&&!e.equals(this.center);if(f||l||i){i||this.events.triggerEvent("movestart"),l&&(!f&&this.center&&this.centerLayerContainer(e),this.center=e.clone());var c=f?this.getResolutionForZoom(t):this.getResolution();if(f||this.layerContainerOrigin==null){this.layerContainerOrigin=this.getCachedCenter(),this.layerContainerDiv.style.left="0px",this.layerContainerDiv.style.top="0px";var h=this.getMaxExtent({restricted:!0}),p=h.getCenterLonLat(),d=this.center.lon-p.lon,v=p.lat-this.center.lat,m=Math.round(h.getWidth()/c),g=Math.round(h.getHeight()/c);this.minPx={x:(this.size.w-m)/2-d/c,y:(this.size.h-g)/2-v/c},this.maxPx={x:this.minPx.x+Math.round(h.getWidth()/c),y:this.minPx.y+Math.round(h.getHeight()/c)}}f&&(this.zoom=t,this.resolution=c);var y=this.getExtent();this.baseLayer.visibility&&(this.baseLayer.moveTo(y,f,n.dragging),n.dragging||this.baseLayer.events.triggerEvent("moveend",{zoomChanged:f})),y=this.baseLayer.getExtent();for(var b=this.layers.length-1;b>=0;--b){var w=this.layers[b];if(w!==this.baseLayer&&!w.isBaseLayer){var E=w.calculateInRange();w.inRange!=E&&(w.inRange=E,E||w.display(!1),this.events.triggerEvent("changelayer",{layer:w,property:"visibility"})),E&&w.visibility&&(w.moveTo(y,f,n.dragging),n.dragging||w.events.triggerEvent("moveend",{zoomChanged:f}))}}this.events.triggerEvent("move"),i||this.events.triggerEvent("moveend");if(f){for(var b=0,S=this.popups.length;b<S;b++)this.popups[b].updatePosition();this.events.triggerEvent("zoomend")}}},centerLayerContainer:function(e){var t=this.getViewPortPxFromLonLat(this.layerContainerOrigin),n=this.getViewPortPxFromLonLat(e);if(t!=null&&n!=null){var r=parseInt(this.layerContainerDiv.style.left),i=parseInt(this.layerContainerDiv.style.top),s=Math.round(t.x-n.x),o=Math.round(t.y-n.y);this.layerContainerDiv.style.left=s+"px",this.layerContainerDiv.style.top=o+"px";var u=r-s,a=i-o;this.minPx.x-=u,this.maxPx.x-=u,this.minPx.y-=a,this.maxPx.y-=a}},isValidZoomLevel:function(e){return e!=null&&e>=0&&e<this.getNumZoomLevels()},isValidLonLat:function(e){var t=!1;if(e!=null){var n=this.getMaxExtent(),r=this.baseLayer.wrapDateLine&&n;t=n.containsLonLat(e,{worldBounds:r})}return t},getProjection:function(){var e=this.getProjectionObject();return e?e.getCode():null},getProjectionObject:function(){var e=null;return this.baseLayer!=null&&(e=this.baseLayer.projection),e},getMaxResolution:function(){var e=null;return this.baseLayer!=null&&(e=this.baseLayer.maxResolution),e},getMaxExtent:function(e){var t=null;return e&&e.restricted&&this.restrictedExtent?t=this.restrictedExtent:this.baseLayer!=null&&(t=this.baseLayer.maxExtent),t},getNumZoomLevels:function(){var e=null;return this.baseLayer!=null&&(e=this.baseLayer.numZoomLevels),e},getExtent:function(){var e=null;return this.baseLayer!=null&&(e=this.baseLayer.getExtent()),e},getResolution:function(){var e=null;return this.baseLayer!=null?e=this.baseLayer.getResolution():this.allOverlays===!0&&this.layers.length>0&&(e=this.layers[0].getResolution()),e},getUnits:function(){var e=null;return this.baseLayer!=null&&(e=this.baseLayer.units),e},getScale:function(){var e=null;if(this.baseLayer!=null){var t=this.getResolution(),n=this.baseLayer.units;e=OpenLayers.Util.getScaleFromResolution(t,n)}return e},getZoomForExtent:function(e,t){var n=null;return this.baseLayer!=null&&(n=this.baseLayer.getZoomForExtent(e,t)),n},getResolutionForZoom:function(e){var t=null;return this.baseLayer&&(t=this.baseLayer.getResolutionForZoom(e)),t},getZoomForResolution:function(e,t){var n=null;return this.baseLayer!=null&&(n=this.baseLayer.getZoomForResolution(e,t)),n},zoomTo:function(e){this.isValidZoomLevel(e)&&this.setCenter(null,e)},zoomIn:function(){this.zoomTo(this.getZoom()+1)},zoomOut:function(){this.zoomTo(this.getZoom()-1)},zoomToExtent:function(e,t){e instanceof OpenLayers.Bounds||(e=new OpenLayers.Bounds(e));var n=e.getCenterLonLat();if(this.baseLayer.wrapDateLine){var r=this.getMaxExtent();e=e.clone();while(e.right<e.left)e.right+=r.getWidth();n=e.getCenterLonLat().wrapDateLine(r)}this.setCenter(n,this.getZoomForExtent(e,t))},zoomToMaxExtent:function(e){var t=e?e.restricted:!0,n=this.getMaxExtent({restricted:t});this.zoomToExtent(n)},zoomToScale:function(e,t){var n=OpenLayers.Util.getResolutionFromScale(e,this.baseLayer.units),r=this.size.w*n/2,i=this.size.h*n/2,s=this.getCachedCenter(),o=new OpenLayers.Bounds(s.lon-r,s.lat-i,s.lon+r,s.lat+i);this.zoomToExtent(o,t)},getLonLatFromViewPortPx:function(e){var t=null;return this.baseLayer!=null&&(t=this.baseLayer.getLonLatFromViewPortPx(e)),t},getViewPortPxFromLonLat:function(e){var t=null;return this.baseLayer!=null&&(t=this.baseLayer.getViewPortPxFromLonLat(e)),t},getLonLatFromPixel:function(e){return this.getLonLatFromViewPortPx(e)},getPixelFromLonLat:function(e){var t=this.getViewPortPxFromLonLat(e);return t.x=Math.round(t.x),t.y=Math.round(t.y),t},getGeodesicPixelSize:function(e){var t=e?this.getLonLatFromPixel(e):this.getCachedCenter()||new OpenLayers.LonLat(0,0),n=this.getResolution(),r=t.add(-n/2,0),i=t.add(n/2,0),s=t.add(0,-n/2),o=t.add(0,n/2),u=new OpenLayers.Projection("EPSG:4326"),a=this.getProjectionObject()||u;return a.equals(u)||(r.transform(a,u),i.transform(a,u),s.transform(a,u),o.transform(a,u)),new OpenLayers.Size(OpenLayers.Util.distVincenty(r,i),OpenLayers.Util.distVincenty(s,o))},getViewPortPxFromLayerPx:function(e){var t=null;if(e!=null){var n=parseInt(this.layerContainerDiv.style.left),r=parseInt(this.layerContainerDiv.style.top);t=e.add(n,r)}return t},getLayerPxFromViewPortPx:function(e){var t=null;if(e!=null){var n=-parseInt(this.layerContainerDiv.style.left),r=-parseInt(this.layerContainerDiv.style.top);t=e.add(n,r);if(isNaN(t.x)||isNaN(t.y))t=null}return t},getLonLatFromLayerPx:function(e){return e=this.getViewPortPxFromLayerPx(e),this.getLonLatFromViewPortPx(e)},getLayerPxFromLonLat:function(e){var t=this.getPixelFromLonLat(e);return this.getLayerPxFromViewPortPx(t)},CLASS_NAME:"OpenLayers.Map"}),OpenLayers.Map.TILE_WIDTH=256,OpenLayers.Map.TILE_HEIGHT=256,OpenLayers.Layer=OpenLayers.Class({id:null,name:null,div:null,opacity:1,alwaysInRange:null,RESOLUTION_PROPERTIES:["scales","resolutions","maxScale","minScale","maxResolution","minResolution","numZoomLevels","maxZoomLevel"],events:null,map:null,isBaseLayer:!1,alpha:!1,displayInLayerSwitcher:!0,visibility:!0,attribution:null,inRange:!1,imageSize:null,options:null,eventListeners:null,gutter:0,projection:null,units:null,scales:null,resolutions:null,maxExtent:null,minExtent:null,maxResolution:null,minResolution:null,numZoomLevels:null,minScale:null,maxScale:null,displayOutsideMaxExtent:!1,wrapDateLine:!1,metadata:null,initialize:function(e,t){this.metadata={},this.addOptions(t),this.name=e,this.id==null&&(this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_"),this.div=OpenLayers.Util.createDiv(this.id),this.div.style.width="100%",this.div.style.height="100%",this.div.dir="ltr",this.events=new OpenLayers.Events(this,this.div),this.eventListeners instanceof Object&&this.events.on(this.eventListeners))},destroy:function(e){e==null&&(e=!0),this.map!=null&&this.map.removeLayer(this,e),this.projection=null,this.map=null,this.name=null,this.div=null,this.options=null,this.events&&(this.eventListeners&&this.events.un(this.eventListeners),this.events.destroy()),this.eventListeners=null,this.events=null},clone:function(e){return e==null&&(e=new OpenLayers.Layer(this.name,this.getOptions())),OpenLayers.Util.applyDefaults(e,this),e.map=null,e},getOptions:function(){var e={};for(var t in this.options)e[t]=this[t];return e},setName:function(e){e!=this.name&&(this.name=e,this.map!=null&&this.map.events.triggerEvent("changelayer",{layer:this,property:"name"}))},addOptions:function(e,t){this.options==null&&(this.options={}),e&&(typeof e.projection=="string"&&(e.projection=new OpenLayers.Projection(e.projection)),e.projection&&OpenLayers.Util.applyDefaults(e,OpenLayers.Projection.defaults[e.projection.getCode()]),e.maxExtent&&!(e.maxExtent instanceof OpenLayers.Bounds)&&(e.maxExtent=new OpenLayers.Bounds(e.maxExtent)),e.minExtent&&!(e.minExtent instanceof OpenLayers.Bounds)&&(e.minExtent=new OpenLayers.Bounds(e.minExtent))),OpenLayers.Util.extend(this.options,e),OpenLayers.Util.extend(this,e),this.projection&&this.projection.getUnits()&&(this.units=this.projection.getUnits());if(this.map){var n=this.map.getResolution(),r=this.RESOLUTION_PROPERTIES.concat(["projection","units","minExtent","maxExtent"]);for(var i in e)if(e.hasOwnProperty(i)&&OpenLayers.Util.indexOf(r,i)>=0){this.initResolutions(),t&&this.map.baseLayer===this&&(this.map.setCenter(this.map.getCenter(),this.map.getZoomForResolution(n),!1,!0),this.map.events.triggerEvent("changebaselayer",{layer:this}));break}}},onMapResize:function(){},redraw:function(){var e=!1;if(this.map){this.inRange=this.calculateInRange();var t=this.getExtent();if(t&&this.inRange&&this.visibility){var n=!0;this.moveTo(t,n,!1),this.events.triggerEvent("moveend",{zoomChanged:n}),e=!0}}return e},moveTo:function(e,t,n){var r=this.visibility;this.isBaseLayer||(r=r&&this.inRange),this.display(r)},moveByPx:function(e,t){},setMap:function(e){if(this.map==null){this.map=e,this.maxExtent=this.maxExtent||this.map.maxExtent,this.minExtent=this.minExtent||this.map.minExtent,this.projection=this.projection||this.map.projection,typeof this.projection=="string"&&(this.projection=new OpenLayers.Projection(this.projection)),this.units=this.projection.getUnits()||this.units||this.map.units,this.initResolutions();if(!this.isBaseLayer){this.inRange=this.calculateInRange();var t=this.visibility&&this.inRange;this.div.style.display=t?"":"none"}this.setTileSize()}},afterAdd:function(){},removeMap:function(e){},getImageSize:function(e){return this.imageSize||this.tileSize},setTileSize:function(e){var t=e?e:this.tileSize?this.tileSize:this.map.getTileSize();this.tileSize=t,this.gutter&&(this.imageSize=new OpenLayers.Size(t.w+2*this.gutter,t.h+2*this.gutter))},getVisibility:function(){return this.visibility},setVisibility:function(e){e!=this.visibility&&(this.visibility=e,this.display(e),this.redraw(),this.map!=null&&this.map.events.triggerEvent("changelayer",{layer:this,property:"visibility"}),this.events.triggerEvent("visibilitychanged"))},display:function(e){e!=(this.div.style.display!="none")&&(this.div.style.display=e&&this.calculateInRange()?"block":"none")},calculateInRange:function(){var e=!1;if(this.alwaysInRange)e=!0;else if(this.map){var t=this.map.getResolution();e=t>=this.minResolution&&t<=this.maxResolution}return e},setIsBaseLayer:function(e){e!=this.isBaseLayer&&(this.isBaseLayer=e,this.map!=null&&this.map.events.triggerEvent("changebaselayer",{layer:this}))},initResolutions:function(){var e,t,n,r={},i=!0;for(e=0,t=this.RESOLUTION_PROPERTIES.length;e<t;e++)n=this.RESOLUTION_PROPERTIES[e],r[n]=this.options[n],i&&this.options[n]&&(i=!1);this.alwaysInRange==null&&(this.alwaysInRange=i),r.resolutions==null&&(r.resolutions=this.resolutionsFromScales(r.scales)),r.resolutions==null&&(r.resolutions=this.calculateResolutions(r));if(r.resolutions==null){for(e=0,t=this.RESOLUTION_PROPERTIES.length;e<t;e++)n=this.RESOLUTION_PROPERTIES[e],r[n]=this.options[n]!=null?this.options[n]:this.map[n];r.resolutions==null&&(r.resolutions=this.resolutionsFromScales(r.scales)),r.resolutions==null&&(r.resolutions=this.calculateResolutions(r))}var s;this.options.maxResolution&&this.options.maxResolution!=="auto"&&(s=this.options.maxResolution),this.options.minScale&&(s=OpenLayers.Util.getResolutionFromScale(this.options.minScale,this.units));var o;this.options.minResolution&&this.options.minResolution!=="auto"&&(o=this.options.minResolution),this.options.maxScale&&(o=OpenLayers.Util.getResolutionFromScale(this.options.maxScale,this.units));if(r.resolutions){r.resolutions.sort(function(e,t){return t-e}),s||(s=r.resolutions[0]);if(!o){var u=r.resolutions.length-1;o=r.resolutions[u]}}this.resolutions=r.resolutions;if(this.resolutions){t=this.resolutions.length,this.scales=new Array(t);for(e=0;e<t;e++)this.scales[e]=OpenLayers.Util.getScaleFromResolution(this.resolutions[e],this.units);this.numZoomLevels=t}this.minResolution=o,o&&(this.maxScale=OpenLayers.Util.getScaleFromResolution(o,this.units)),this.maxResolution=s,s&&(this.minScale=OpenLayers.Util.getScaleFromResolution(s,this.units))},resolutionsFromScales:function(e){if(e==null)return;var t,n,r;r=e.length,t=new Array(r);for(n=0;n<r;n++)t[n]=OpenLayers.Util.getResolutionFromScale(e[n],this.units);return t},calculateResolutions:function(e){var t,n,r,i=e.maxResolution;e.minScale!=null?i=OpenLayers.Util.getResolutionFromScale(e.minScale,this.units):i=="auto"&&this.maxExtent!=null&&(t=this.map.getSize(),n=this.maxExtent.getWidth()/t.w,r=this.maxExtent.getHeight()/t.h,i=Math.max(n,r));var s=e.minResolution;e.maxScale!=null?s=OpenLayers.Util.getResolutionFromScale(e.maxScale,this.units):e.minResolution=="auto"&&this.minExtent!=null&&(t=this.map.getSize(),n=this.minExtent.getWidth()/t.w,r=this.minExtent.getHeight()/t.h,s=Math.max(n,r));if(typeof i!="number"&&typeof s!="number"&&this.maxExtent!=null){var o=this.map.getTileSize();i=Math.max(this.maxExtent.getWidth()/o.w,this.maxExtent.getHeight()/o.h)}var u=e.maxZoomLevel,a=e.numZoomLevels;if(typeof s=="number"&&typeof i=="number"&&a===undefined){var f=i/s;a=Math.floor(Math.log(f)/Math.log(2))+1}else a===undefined&&u!=null&&(a=u+1);if(typeof a!="number"||a<=0||typeof i!="number"&&typeof s!="number")return;var l=new Array(a),c=2;typeof s=="number"&&typeof i=="number"&&(c=Math.pow(i/s,1/(a-1)));var h;if(typeof i=="number")for(h=0;h<a;h++)l[h]=i/Math.pow(c,h);else for(h=0;h<a;h++)l[a-1-h]=s*Math.pow(c,h);return l},getResolution:function(){var e=this.map.getZoom();return this.getResolutionForZoom(e)},getExtent:function(){return this.map.calculateBounds()},getZoomForExtent:function(e,t){var n=this.map.getSize(),r=Math.max(e.getWidth()/n.w,e.getHeight()/n.h);return this.getZoomForResolution(r,t)},getDataExtent:function(){},getResolutionForZoom:function(e){e=Math.max(0,Math.min(e,this.resolutions.length-1));var t;if(this.map.fractionalZoom){var n=Math.floor(e),r=Math.ceil(e);t=this.resolutions[n]-(e-n)*(this.resolutions[n]-this.resolutions[r])}else t=this.resolutions[Math.round(e)];return t},getZoomForResolution:function(e,t){var n,r,i;if(this.map.fractionalZoom){var s=0,o=this.resolutions.length-1,u=this.resolutions[s],a=this.resolutions[o],f;for(r=0,i=this.resolutions.length;r<i;++r){f=this.resolutions[r],f>=e&&(u=f,s=r);if(f<=e){a=f,o=r;break}}var l=u-a;l>0?n=s+(u-e)/l:n=s}else{var c,h=Number.POSITIVE_INFINITY;for(r=0,i=this.resolutions.length;r<i;r++)if(t){c=Math.abs(this.resolutions[r]-e);if(c>h)break;h=c}else if(this.resolutions[r]<e)break;n=Math.max(0,r-1)}return n},getLonLatFromViewPortPx:function(e){var t=null,n=this.map;if(e!=null&&n.minPx){var r=n.getResolution(),i=n.getMaxExtent({restricted:!0}),s=(e.x-n.minPx.x)*r+i.left,o=(n.minPx.y-e.y)*r+i.top;t=new OpenLayers.LonLat(s,o),this.wrapDateLine&&(t=t.wrapDateLine(this.maxExtent))}return t},getViewPortPxFromLonLat:function(e,t){var n=null;if(e!=null){t=t||this.map.getResolution();var r=this.map.calculateBounds(null,t);n=new OpenLayers.Pixel(1/t*(e.lon-r.left),1/t*(r.top-e.lat))}return n},setOpacity:function(e){if(e!=this.opacity){this.opacity=e;var t=this.div.childNodes;for(var n=0,r=t.length;n<r;++n){var i=t[n].firstChild||t[n],s=t[n].lastChild;s&&s.nodeName.toLowerCase()==="iframe"&&(i=s.parentNode),OpenLayers.Util.modifyDOMElement(i,null,null,null,null,null,null,e)}this.map!=null&&this.map.events.triggerEvent("changelayer",{layer:this,property:"opacity"})}},getZIndex:function(){return this.div.style.zIndex},setZIndex:function(e){this.div.style.zIndex=e},adjustBounds:function(e){if(this.gutter){var t=this.gutter*this.map.getResolution();e=new OpenLayers.Bounds(e.left-t,e.bottom-t,e.right+t,e.top+t)}if(this.wrapDateLine){var n={rightTolerance:this.getResolution(),leftTolerance:this.getResolution()};e=e.wrapDateLine(this.maxExtent,n)}return e},CLASS_NAME:"OpenLayers.Layer"}),OpenLayers.Layer.HTTPRequest=OpenLayers.Class(OpenLayers.Layer,{URL_HASH_FACTOR:(Math.sqrt(5)-1)/2,url:null,params:null,reproject:!1,initialize:function(e,t,n,r){OpenLayers.Layer.prototype.initialize.apply(this,[e,r]),this.url=t,this.params||(this.params=OpenLayers.Util.extend({},n))},destroy:function(){this.url=null,this.params=null,OpenLayers.Layer.prototype.destroy.apply(this,arguments)},clone:function(e){return e==null&&(e=new OpenLayers.Layer.HTTPRequest(this.name,this.url,this.params,this.getOptions())),e=OpenLayers.Layer.prototype.clone.apply(this,[e]),e},setUrl:function(e){this.url=e},mergeNewParams:function(e){this.params=OpenLayers.Util.extend(this.params,e);var t=this.redraw();return this.map!=null&&this.map.events.triggerEvent("changelayer",{layer:this,property:"params"}),t},redraw:function(e){return e?this.mergeNewParams({_olSalt:Math.random()}):OpenLayers.Layer.prototype.redraw.apply(this,[])},selectUrl:function(e,t){var n=1;for(var r=0,i=e.length;r<i;r++)n*=e.charCodeAt(r)*this.URL_HASH_FACTOR,n-=Math.floor(n);return t[Math.floor(n*t.length)]},getFullRequestString:function(e,t){var n=t||this.url,r=OpenLayers.Util.extend({},this.params);r=OpenLayers.Util.extend(r,e);var i=OpenLayers.Util.getParameterString(r);OpenLayers.Util.isArray(n)&&(n=this.selectUrl(i,n));var s=OpenLayers.Util.upperCaseObject(OpenLayers.Util.getParameters(n));for(var o in r)o.toUpperCase()in s&&delete r[o];return i=OpenLayers.Util.getParameterString(r),OpenLayers.Util.urlAppend(n,i)},CLASS_NAME:"OpenLayers.Layer.HTTPRequest"}),OpenLayers.Tile=OpenLayers.Class({events:null,eventListeners:null,id:null,layer:null,url:null,bounds:null,size:null,position:null,isLoading:!1,initialize:function(e,t,n,r,i,s){this.layer=e,this.position=t.clone(),this.setBounds(n),this.url=r,i&&(this.size=i.clone()),this.id=OpenLayers.Util.createUniqueID("Tile_"),OpenLayers.Util.extend(this,s),this.events=new OpenLayers.Events(this),this.eventListeners instanceof Object&&this.events.on(this.eventListeners)},unload:function(){this.isLoading&&(this.isLoading=!1,this.events.triggerEvent("unload"))},destroy:function(){this.layer=null,this.bounds=null,this.size=null,this.position=null,this.eventListeners&&this.events.un(this.eventListeners),this.events.destroy(),this.eventListeners=null,this.events=null},draw:function(e){e||this.clear();var t=this.shouldDraw();return t&&!e&&(t=this.events.triggerEvent("beforedraw")!==!1),t},shouldDraw:function(){var e=!1,t=this.layer.maxExtent;if(t){var n=this.layer.map,r=n.baseLayer.wrapDateLine&&n.getMaxExtent();this.bounds.intersectsBounds(t,{inclusive:!1,worldBounds:r})&&(e=!0)}return e||this.layer.displayOutsideMaxExtent},setBounds:function(e){e=e.clone();if(this.layer.map.baseLayer.wrapDateLine){var t=this.layer.map.getMaxExtent(),n=this.layer.map.getResolution();e=e.wrapDateLine(t,{leftTolerance:n,rightTolerance:n})}this.bounds=e},moveTo:function(e,t,n){n==null&&(n=!0),this.setBounds(e),this.position=t.clone(),n&&this.draw()},clear:function(e){},CLASS_NAME:"OpenLayers.Tile"}),OpenLayers.Tile.Image=OpenLayers.Class(OpenLayers.Tile,{url:null,imgDiv:null,frame:null,imageReloadAttempts:null,layerAlphaHack:null,asyncRequestId:null,blankImageUrl:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAQAIBRAA7",maxGetUrlLength:null,canvasContext:null,crossOriginKeyword:null,initialize:function(e,t,n,r,i,s){OpenLayers.Tile.prototype.initialize.apply(this,arguments),this.url=r,this.layerAlphaHack=this.layer.alpha&&OpenLayers.Util.alphaHack();if(this.maxGetUrlLength!=null||this.layer.gutter||this.layerAlphaHack)this.frame=document.createElement("div"),this.frame.style.position="absolute",this.frame.style.overflow="hidden";this.maxGetUrlLength!=null&&OpenLayers.Util.extend(this,OpenLayers.Tile.Image.IFrame)},destroy:function(){this.imgDiv&&(this.clear(),this.imgDiv=null,this.frame=null),this.asyncRequestId=null,OpenLayers.Tile.prototype.destroy.apply(this,arguments)},draw:function(){var e=OpenLayers.Tile.prototype.draw.apply(this,arguments);return e?(this.layer!=this.layer.map.baseLayer&&this.layer.reproject&&(this.bounds=this.getBoundsFromBaseLayer(this.position)),this.isLoading?this._loadEvent="reload":(this.isLoading=!0,this._loadEvent="loadstart"),this.positionTile(),this.renderTile()):this.unload(),e},renderTile:function(){this.layer.div.appendChild(this.getTile());if(this.layer.async){var e=this.asyncRequestId=(this.asyncRequestId||0)+1;this.layer.getURLasync(this.bounds,function(t){e==this.asyncRequestId&&(this.url=t,this.initImage())},this)}else this.url=this.layer.getURL(this.bounds),this.initImage()},positionTile:function(){var e=this.getTile().style,t=this.frame?this.size:this.layer.getImageSize(this.bounds);e.left=this.position.x+"%",e.top=this.position.y+"%",e.width=t.w+"%",e.height=t.h+"%"},clear:function(){OpenLayers.Tile.prototype.clear.apply(this,arguments);var e=this.imgDiv;if(e){OpenLayers.Event.stopObservingElement(e);var t=this.getTile();t.parentNode===this.layer.div&&this.layer.div.removeChild(t),this.setImgSrc(),this.layerAlphaHack===!0&&(e.style.filter=""),OpenLayers.Element.removeClass(e,"olImageLoadError")}this.canvasContext=null},getImage:function(){if(!this.imgDiv){this.imgDiv=document.createElement("img"),this.imgDiv.className="olTileImage",this.imgDiv.galleryImg="no";var e=this.imgDiv.style;if(this.frame){var t=0,n=0;this.layer.gutter&&(t=this.layer.gutter/this.layer.tileSize.w*100,n=this.layer.gutter/this.layer.tileSize.h*100),e.left=-t+"%",e.top=-n+"%",e.width=2*t+100+"%",e.height=2*n+100+"%"}e.visibility="hidden",e.opacity=0,this.layer.opacity<1&&(e.filter="alpha(opacity="+this.layer.opacity*100+")"),e.position="absolute",this.layerAlphaHack&&(e.paddingTop=e.height,e.height="0",e.width="100%"),this.frame&&this.frame.appendChild(this.imgDiv)}return this.imgDiv},initImage:function(){this.events.triggerEvent(this._loadEvent);var e=this.getImage();if(this.url&&e.getAttribute("src")==this.url)this.onImageLoad();else{var t=OpenLayers.Function.bind(function(){OpenLayers.Event.stopObservingElement(e),OpenLayers.Event.observe(e,"load",OpenLayers.Function.bind(this.onImageLoad,this)),OpenLayers.Event.observe(e,"error",OpenLayers.Function.bind(this.onImageError,this)),this.imageReloadAttempts=0,this.setImgSrc(this.url)},this);e.getAttribute("src")==this.blankImageUrl?t():(OpenLayers.Event.observe(e,"load",t),OpenLayers.Event.observe(e,"error",t),this.crossOriginKeyword&&e.removeAttribute("crossorigin"),e.src=this.blankImageUrl)}},setImgSrc:function(e){var t=this.imgDiv;t.style.visibility="hidden",t.style.opacity=0,e&&(this.crossOriginKeyword&&(e.substr(0,5)!=="data:"?t.setAttribute("crossorigin",this.crossOriginKeyword):t.removeAttribute("crossorigin")),t.src=e)},getTile:function(){return this.frame?this.frame:this.getImage()},createBackBuffer:function(){if(!this.imgDiv||this.isLoading)return;var e;return this.frame?(e=this.frame.cloneNode(!1),e.appendChild(this.imgDiv)):e=this.imgDiv,this.imgDiv=null,e},onImageLoad:function(){var e=this.imgDiv;OpenLayers.Event.stopObservingElement(e),e.style.visibility="inherit",e.style.opacity=this.layer.opacity,this.isLoading=!1,this.canvasContext=null,this.events.triggerEvent("loadend");if(parseFloat(navigator.appVersion.split("MSIE")[1])<7&&this.layer&&this.layer.div){var t=document.createElement("span");t.style.display="none";var n=this.layer.div;n.appendChild(t),window.setTimeout(function(){t.parentNode===n&&t.parentNode.removeChild(t)},0)}this.layerAlphaHack===!0&&(e.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+e.src+"', sizingMethod='scale')")},onImageError:function(){var e=this.imgDiv;e.src!=null&&(this.imageReloadAttempts++,this.imageReloadAttempts<=OpenLayers.IMAGE_RELOAD_ATTEMPTS?this.setImgSrc(this.layer.getURL(this.bounds)):(OpenLayers.Element.addClass(e,"olImageLoadError"),this.events.triggerEvent("loaderror"),this.onImageLoad()))},getCanvasContext:function(){if(OpenLayers.CANVAS_SUPPORTED&&this.imgDiv&&!this.isLoading){if(!this.canvasContext){var e=document.createElement("canvas");e.width=this.size.w,e.height=this.size.h,this.canvasContext=e.getContext("2d"),this.canvasContext.drawImage(this.imgDiv,0,0)}return this.canvasContext}},CLASS_NAME:"OpenLayers.Tile.Image"}),OpenLayers.Layer.Grid=OpenLayers.Class(OpenLayers.Layer.HTTPRequest,{tileSize:null,tileOriginCorner:"bl",tileOrigin:null,tileOptions:null,tileClass:OpenLayers.Tile.Image,grid:null,singleTile:!1,ratio:1.5,buffer:0,transitionEffect:null,numLoadingTiles:0,tileLoadingDelay:85,serverResolutions:null,moveTimerId:null,deferMoveGriddedTiles:null,tileQueueId:null,tileQueue:null,loading:!1,backBuffer:null,gridResolution:null,backBufferResolution:null,backBufferLonLat:null,backBufferTimerId:null,removeBackBufferDelay:null,className:null,initialize:function(e,t,n,r){OpenLayers.Layer.HTTPRequest.prototype.initialize.apply(this,arguments),this.grid=[],this.tileQueue=[],this.removeBackBufferDelay===null&&(this.removeBackBufferDelay=this.singleTile?0:2500),this.className===null&&(this.className=this.singleTile?"olLayerGridSingleTile":"olLayerGrid"),OpenLayers.Animation.isNative||(this.deferMoveGriddedTiles=OpenLayers.Function.bind(function(){this.moveGriddedTiles(!0),this.moveTimerId=null},this))},setMap:function(e){OpenLayers.Layer.HTTPRequest.prototype.setMap.call(this,e),OpenLayers.Element.addClass(this.div,this.className)},removeMap:function(e){this.moveTimerId!==null&&(window.clearTimeout(this.moveTimerId),this.moveTimerId=null),this.clearTileQueue(),this.backBufferTimerId!==null&&(window.clearTimeout(this.backBufferTimerId),this.backBufferTimerId=null)},destroy:function(){this.removeBackBuffer(),this.clearGrid(),this.grid=null,this.tileSize=null,OpenLayers.Layer.HTTPRequest.prototype.destroy.apply(this,arguments)},clearGrid:function(){this.clearTileQueue();if(this.grid){for(var e=0,t=this.grid.length;e<t;e++){var n=this.grid[e];for(var r=0,i=n.length;r<i;r++){var s=n[r];this.destroyTile(s)}}this.grid=[],this.gridResolution=null}},clone:function(e){return e==null&&(e=new OpenLayers.Layer.Grid(this.name,this.url,this.params,this.getOptions())),e=OpenLayers.Layer.HTTPRequest.prototype.clone.apply(this,[e]),this.tileSize!=null&&(e.tileSize=this.tileSize.clone()),e.grid=[],e.gridResolution=null,e.backBuffer=null,e.backBufferTimerId=null,e.tileQueue=[],e.tileQueueId=null,e.loading=!1,e.moveTimerId=null,e},moveTo:function(e,t,n){OpenLayers.Layer.HTTPRequest.prototype.moveTo.apply(this,arguments),e=e||this.map.getExtent();if(e!=null){var r=!this.grid.length||t,i=this.getTilesBounds(),s=this.map.getResolution(),o=this.getServerResolution(s);if(this.singleTile){if(r||!n&&!i.containsBounds(e))t&&this.transitionEffect!=="resize"&&this.removeBackBuffer(),(!t||this.transitionEffect==="resize")&&this.applyBackBuffer(o),this.initSingleTile(e)}else{r=r||!i.intersectsBounds(e,{worldBounds:this.map.baseLayer.wrapDateLine&&this.map.getMaxExtent()});if(s!==o){e=this.map.calculateBounds(null,o);if(r){var u=o/s;this.transformDiv(u)}}else this.div.style.width="100%",this.div.style.height="100%",this.div.style.left="0%",this.div.style.top="0%";r?(t&&this.transitionEffect==="resize"&&this.applyBackBuffer(o),this.initGriddedTiles(e)):this.moveGriddedTiles()}}},getTileData:function(e){var t=null,n=e.lon,r=e.lat,i=this.grid.length;if(this.map&&i){var s=this.map.getResolution(),o=this.tileSize.w,u=this.tileSize.h,a=this.grid[0][0].bounds,f=a.left,l=a.top;if(n<f&&this.map.baseLayer.wrapDateLine){var c=this.map.getMaxExtent().getWidth(),h=Math.ceil((f-n)/c);n+=c*h}var p=(n-f)/(s*o),d=(l-r)/(s*u),v=Math.floor(p),m=Math.floor(d);if(m>=0&&m<i){var g=this.grid[m][v];g&&(t={tile:g,i:Math.floor((p-v)*o),j:Math.floor((d-m)*u)})}}return t},queueTileDraw:function(e){var t=e.object;return~OpenLayers.Util.indexOf(this.tileQueue,t)||this.tileQueue.push(t),this.tileQueueId||(this.tileQueueId=OpenLayers.Animation.start(OpenLayers.Function.bind(this.drawTileFromQueue,this),null,this.div)),!1},drawTileFromQueue:function(){this.tileQueue.length===0?this.clearTileQueue():this.tileQueue.shift().draw(!0)},clearTileQueue:function(){OpenLayers.Animation.stop(this.tileQueueId),this.tileQueueId=null,this.tileQueue=[]},destroyTile:function(e){this.removeTileMonitoringHooks(e),e.destroy()},getServerResolution:function(e){e=e||this.map.getResolution();if(this.serverResolutions&&OpenLayers.Util.indexOf(this.serverResolutions,e)===-1){var t,n;for(t=this.serverResolutions.length-1;t>=0;t--){n=this.serverResolutions[t];if(n>e){e=n;break}}if(t===-1)throw"no appropriate resolution in serverResolutions"}return e},getServerZoom:function(){var e=this.getServerResolution();return this.serverResolutions?OpenLayers.Util.indexOf(this.serverResolutions,e):this.map.getZoomForResolution(e)+(this.zoomOffset||0)},transformDiv:function(e){this.div.style.width=100*e+"%",this.div.style.height=100*e+"%";var t=this.map.getSize(),n=parseInt(this.map.layerContainerDiv.style.left,10),r=parseInt(this.map.layerContainerDiv.style.top,10),i=(n-t.w/2)*(e-1),s=(r-t.h/2)*(e-1);this.div.style.left=i+"%",this.div.style.top=s+"%"},getResolutionScale:function(){return parseInt(this.div.style.width,10)/100},applyBackBuffer:function(e){this.backBufferTimerId!==null&&this.removeBackBuffer();var t=this.backBuffer;if(!t){t=this.createBackBuffer();if(!t)return;this.div.insertBefore(t,this.div.firstChild),this.backBuffer=t;var n=this.grid[0][0].bounds;this.backBufferLonLat={lon:n.left,lat:n.top},this.backBufferResolution=this.gridResolution}var r=t.style,i=this.backBufferResolution/e;r.width=100*i+"%",r.height=100*i+"%";var s=this.getViewPortPxFromLonLat(this.backBufferLonLat,e),o=parseInt(this.map.layerContainerDiv.style.left,10),u=parseInt(this.map.layerContainerDiv.style.top,10);t.style.left=Math.round(s.x-o)+"%",t.style.top=Math.round(s.y-u)+"%"},createBackBuffer:function(){var e;if(this.grid.length>0){e=document.createElement("div"),e.id=this.div.id+"_bb",e.className="olBackBuffer",e.style.position="absolute",e.style.width="100%",e.style.height="100%";for(var t=0,n=this.grid.length;t<n;t++)for(var r=0,i=this.grid[t].length;r<i;r++){var s=this.grid[t][r].createBackBuffer();if(!s)continue;s.style.top=t*this.tileSize.h+"%",s.style.left=r*this.tileSize.w+"%",e.appendChild(s)}}return e},removeBackBuffer:function(){this.backBuffer&&(this.div.removeChild(this.backBuffer),this.backBuffer=null,this.backBufferResolution=null,this.backBufferTimerId!==null&&(window.clearTimeout(this.backBufferTimerId),this.backBufferTimerId=null))},moveByPx:function(e,t){this.singleTile||this.moveGriddedTiles()},setTileSize:function(e){this.singleTile&&(e=this.map.getSize(),e.h=parseInt(e.h*this.ratio),e.w=parseInt(e.w*this.ratio)),OpenLayers.Layer.HTTPRequest.prototype.setTileSize.apply(this,[e])},getTilesBounds:function(){var e=null,t=this.grid.length;if(t){var n=this.grid[t-1][0].bounds,r=this.grid[0].length*n.getWidth(),i=this.grid.length*n.getHeight();e=new OpenLayers.Bounds(n.left,n.bottom,n.left+r,n.bottom+i)}return e},initSingleTile:function(e){this.clearTileQueue();var t=e.getCenterLonLat(),n=e.getWidth()*this.ratio,r=e.getHeight()*this.ratio,i=new OpenLayers.Bounds(t.lon-n/2,t.lat-r/2,t.lon+n/2,t.lat+r/2),s=this.map.getLayerPxFromLonLat({lon:i.left,lat:i.top});this.grid.length||(this.grid[0]=[]);var o=this.grid[0][0];o?o.moveTo(i,s):(o=this.addTile(i,s),this.addTileMonitoringHooks(o),o.draw(),this.grid[0][0]=o),this.removeExcessTiles(1,1),this.gridResolution=this.getServerResolution()},calculateGridLayout:function(e,t,n){var r=n*this.tileSize.w,i=n*this.tileSize.h,s=e.left-t.lon,o=Math.floor(s/r)-this.buffer,u=s/r-o,a=-u*this.tileSize.w,f=t.lon+o*r,l=e.top-(t.lat+i),c=Math.ceil(l/i)+this.buffer,h=c-l/i,p=-h*this.tileSize.h,d=t.lat+c*i;return{tilelon:r,tilelat:i,tileoffsetlon:f,tileoffsetlat:d,tileoffsetx:a,tileoffsety:p}},getTileOrigin:function(){var e=this.tileOrigin;if(!e){var t=this.getMaxExtent(),n={tl:["left","top"],tr:["right","top"],bl:["left","bottom"],br:["right","bottom"]}[this.tileOriginCorner];e=new OpenLayers.LonLat(t[n[0]],t[n[1]])}return e},initGriddedTiles:function(e){this.clearTileQueue();var t=this.map.getSize(),n=Math.ceil(t.h/this.tileSize.h)+Math.max(1,2*this.buffer),r=Math.ceil(t.w/this.tileSize.w)+Math.max(1,2*this.buffer),i=this.getTileOrigin(),s=this.getServerResolution(),o=this.calculateGridLayout(e,i,s),u=Math.round(o.tileoffsetx),a=Math.round(o.tileoffsety),f=o.tileoffsetlon,l=o.tileoffsetlat,c=o.tilelon,h=o.tilelat,p=u,d=f,v=0,m=parseInt(this.map.layerContainerDiv.style.left),g=parseInt(this.map.layerContainerDiv.style.top),y=[],b=this.map.getCenter();do{var w=this.grid[v++];w||(w=[],this.grid.push(w)),f=d,u=p;var E=0;do{var S=new OpenLayers.Bounds(f,l,f+c,l+h),x=u;x-=m;var T=a;T-=g;var N=new OpenLayers.Pixel(x,T),C=w[E++];C?C.moveTo(S,N,!1):(C=this.addTile(S,N),this.addTileMonitoringHooks(C),w.push(C));var k=S.getCenterLonLat();y.push({tile:C,distance:Math.pow(k.lon-b.lon,2)+Math.pow(k.lat-b.lat,2)}),f+=c,u+=this.tileSize.w}while(f<=e.right+c*this.buffer||E<r);l-=h,a+=this.tileSize.h}while(l>=e.bottom-h*this.buffer||v<n);this.removeExcessTiles(v,E),this.gridResolution=this.getServerResolution(),y.sort(function(e,t){return e.distance-t.distance});for(var L=0,A=y.length;L<A;++L)y[L].tile.draw()},getMaxExtent:function(){return this.maxExtent},addTile:function(e,t){var n=new this.tileClass(this,t,e,null,this.tileSize,this.tileOptions);return n.events.register("beforedraw",this,this.queueTileDraw),n},addTileMonitoringHooks:function(e){e.onLoadStart=function(){this.loading===!1&&(this.loading=!0,this.events.triggerEvent("loadstart")),this.events.triggerEvent("tileloadstart",{tile:e}),this.numLoadingTiles++},e.onLoadEnd=function(){this.numLoadingTiles--,this.events.triggerEvent("tileloaded",{tile:e}),this.tileQueue.length===0&&this.numLoadingTiles===0&&(this.loading=!1,this.events.triggerEvent("loadend"),this.backBuffer&&(this.backBufferTimerId=window.setTimeout(OpenLayers.Function.bind(this.removeBackBuffer,this),this.removeBackBufferDelay)))},e.onLoadError=function(){this.events.triggerEvent("tileerror",{tile:e})},e.events.on({loadstart:e.onLoadStart,loadend:e.onLoadEnd,unload:e.onLoadEnd,loaderror:e.onLoadError,scope:this})},removeTileMonitoringHooks:function(e){e.unload(),e.events.un({loadstart:e.onLoadStart,loadend:e.onLoadEnd,unload:e.onLoadEnd,loaderror:e.onLoadError,scope:this})},moveGriddedTiles:function(e){if(!e&&!OpenLayers.Animation.isNative){this.moveTimerId!=null&&window.clearTimeout(this.moveTimerId),this.moveTimerId=window.setTimeout(this.deferMoveGriddedTiles,this.tileLoadingDelay);return}var t=this.buffer||1,n=this.getResolutionScale();for(;;){var r={x:this.grid[0][0].position.x*n+parseInt(this.div.style.left,10)+parseInt(this.map.layerContainerDiv.style.left),y:this.grid[0][0].position.y*n+parseInt(this.div.style.top,10)+parseInt(this.map.layerContainerDiv.style.top)},i={w:this.tileSize.w*n,h:this.tileSize.h*n};if(r.x>-i.w*(t-1))this.shiftColumn(!0);else if(r.x<-i.w*t)this.shiftColumn(!1);else if(r.y>-i.h*(t-1))this.shiftRow(!0);else{if(!(r.y<-i.h*t))break;this.shiftRow(!1)}}},shiftRow:function(e){var t=e?0:this.grid.length-1,n=this.grid,r=n[t],i=this.getServerResolution(),s=e?-this.tileSize.h:this.tileSize.h,o=i*-s,u=e?n.pop():n.shift();for(var a=0,f=r.length;a<f;a++){var l=r[a],c=l.bounds.clone(),h=l.position.clone();c.bottom=c.bottom+o,c.top=c.top+o,h.y=h.y+s,u[a].moveTo(c,h)}e?n.unshift(u):n.push(u)},shiftColumn:function(e){var t=e?-this.tileSize.w:this.tileSize.w,n=this.getServerResolution(),r=n*t;for(var i=0,s=this.grid.length;i<s;i++){var o=this.grid[i],u=e?0:o.length-1,a=o[u],f=a.bounds.clone(),l=a.position.clone();f.left=f.left+r,f.right=f.right+r,l.x=l.x+t;var c=e?this.grid[i].pop():this.grid[i].shift();c.moveTo(f,l),e?o.unshift(c):o.push(c)}},removeExcessTiles:function(e,t){var n,r;while(this.grid.length>e){var i=this.grid.pop();for(n=0,r=i.length;n<r;n++){var s=i[n];this.destroyTile(s)}}for(n=0,r=this.grid.length;n<r;n++)while(this.grid[n].length>t){var i=this.grid[n],s=i.pop();this.destroyTile(s)}},onMapResize:function(){this.singleTile&&(this.clearGrid(),this.setTileSize())},getTileBounds:function(e){var t=this.maxExtent,n=this.getResolution(),r=n*this.tileSize.w,i=n*this.tileSize.h,s=this.getLonLatFromViewPortPx(e),o=t.left+r*Math.floor((s.lon-t.left)/r),u=t.bottom+i*Math.floor((s.lat-t.bottom)/i);return new OpenLayers.Bounds(o,u,o+r,u+i)},CLASS_NAME:"OpenLayers.Layer.Grid"}),OpenLayers.Protocol=OpenLayers.Class({format:null,options:null,autoDestroy:!0,defaultFilter:null,initialize:function(e){e=e||{},OpenLayers.Util.extend(this,e),this.options=e},mergeWithDefaultFilter:function(e){var t;return e&&this.defaultFilter?t=new OpenLayers.Filter.Logical({type:OpenLayers.Filter.Logical.AND,filters:[this.defaultFilter,e]}):t=e||this.defaultFilter||undefined,t},destroy:function(){this.options=null,this.format=null},read:function(e){e=e||{},e.filter=this.mergeWithDefaultFilter(e.filter)},create:function(){},update:function(){},"delete":function(){},commit:function(){},abort:function(e){},createCallback:function(e,t,n){return OpenLayers.Function.bind(function(){e.apply(this,[t,n])},this)},CLASS_NAME:"OpenLayers.Protocol"}),OpenLayers.Protocol.Response=OpenLayers.Class({code:null,requestType:null,last:!0,features:null,data:null,reqFeatures:null,priv:null,error:null,initialize:function(e){OpenLayers.Util.extend(this,e)},success:function(){return this.code>0},CLASS_NAME:"OpenLayers.Protocol.Response"}),OpenLayers.Protocol.Response.SUCCESS=1,OpenLayers.Protocol.Response.FAILURE=0,OpenLayers.ProxyHost="",OpenLayers.Request={DEFAULT_CONFIG:{method:"GET",url:window.location.href,async:!0,user:undefined,password:undefined,params:null,proxy:OpenLayers.ProxyHost,headers:{},data:null,callback:function(){},success:null,failure:null,scope:null},URL_SPLIT_REGEX:/([^:]*:)\/\/([^:]*:?[^@]*@)?([^:\/\?]*):?([^\/\?]*)/,events:new OpenLayers.Events(this),makeSameOrigin:function(e,t){var n=e.indexOf("http")!==0,r=!n&&e.match(this.URL_SPLIT_REGEX);if(r){var i=window.location;n=r[1]==i.protocol&&r[3]==i.hostname;var s=r[4],o=i.port;if(s!=80&&s!=""||o!="80"&&o!="")n=n&&s==o}return n||(t?typeof t=="function"?e=t(e):e=t+encodeURIComponent(e):OpenLayers.Console.warn(OpenLayers.i18n("proxyNeeded"),{url:e})),e},issue:function(e){var t=OpenLayers.Util.extend(this.DEFAULT_CONFIG,{proxy:OpenLayers.ProxyHost});e=OpenLayers.Util.applyDefaults(e,t);var n=!1,r;for(r in e.headers)e.headers.hasOwnProperty(r)&&r.toLowerCase()==="x-requested-with"&&(n=!0);n===!1&&(e.headers["X-Requested-With"]="XMLHttpRequest");var i=new OpenLayers.Request.XMLHttpRequest,s=OpenLayers.Util.urlAppend(e.url,OpenLayers.Util.getParameterString(e.params||{}));s=OpenLayers.Request.makeSameOrigin(s,e.proxy),i.open(e.method,s,e.async,e.user,e.password);for(var o in e.headers)i.setRequestHeader(o,e.headers[o]);var u=this.events,a=this;return i.onreadystatechange=function(){if(i.readyState==OpenLayers.Request.XMLHttpRequest.DONE){var t=u.triggerEvent("complete",{request:i,config:e,requestUrl:s});t!==!1&&a.runCallbacks({request:i,config:e,requestUrl:s})}},e.async===!1?i.send(e.data):window.setTimeout(function(){i.readyState!==0&&i.send(e.data)},0),i},runCallbacks:function(e){var t=e.request,n=e.config,r=n.scope?OpenLayers.Function.bind(n.callback,n.scope):n.callback,i;n.success&&(i=n.scope?OpenLayers.Function.bind(n.success,n.scope):n.success);var s;n.failure&&(s=n.scope?OpenLayers.Function.bind(n.failure,n.scope):n.failure),OpenLayers.Util.createUrlObject(n.url).protocol=="file:"&&t.responseText&&(t.status=200),r(t);if(!t.status||t.status>=200&&t.status<300)this.events.triggerEvent("success",e),i&&i(t);t.status&&(t.status<200||t.status>=300)&&(this.events.triggerEvent("failure",e),s&&s(t))},GET:function(e){return e=OpenLayers.Util.extend(e,{method:"GET"}),OpenLayers.Request.issue(e)},POST:function(e){return e=OpenLayers.Util.extend(e,{method:"POST"}),e.headers=e.headers?e.headers:{},"CONTENT-TYPE"in OpenLayers.Util.upperCaseObject(e.headers)||(e.headers["Content-Type"]="application/xml"),OpenLayers.Request.issue(e)},PUT:function(e){return e=OpenLayers.Util.extend(e,{method:"PUT"}),e.headers=e.headers?e.headers:{},"CONTENT-TYPE"in OpenLayers.Util.upperCaseObject(e.headers)||(e.headers["Content-Type"]="application/xml"),OpenLayers.Request.issue(e)},DELETE:function(e){return e=OpenLayers.Util.extend(e,{method:"DELETE"}),OpenLayers.Request.issue(e)},HEAD:function(e){return e=OpenLayers.Util.extend(e,{method:"HEAD"}),OpenLayers.Request.issue(e)},OPTIONS:function(e){return e=OpenLayers.Util.extend(e,{method:"OPTIONS"}),OpenLayers.Request.issue(e)}},function(){function i(){this._object=e&&!r?new e:new window.ActiveXObject("Microsoft.XMLHTTP"),this._listeners=[]}function s(){return new i}function o(e){e._object.send(e._data);if(t&&!e._async){e.readyState=s.OPENED,f(e);while(e.readyState<s.DONE){e.readyState++,u(e);if(e._aborted)return}}}function u(e){s.onreadystatechange&&s.onreadystatechange.apply(e),e.dispatchEvent({type:"readystatechange",bubbles:!1,cancelable:!1,timeStamp:new Date+0})}function a(e){var t=e.responseXML,r=e.responseText;n&&r&&t&&!t.documentElement&&e.getResponseHeader("Content-Type").match(/[^\/]+\/[^\+]+\+xml/)&&(t=new window.ActiveXObject("Microsoft.XMLDOM"),t.async=!1,t.validateOnParse=!1,t.loadXML(r));if(t)if(n&&t.parseError!=0||!t.documentElement||t.documentElement&&t.documentElement.tagName=="parsererror")return null;return t}function f(e){try{e.responseText=e._object.responseText}catch(t){}try{e.responseXML=a(e._object)}catch(t){}try{e.status=e._object.status}catch(t){}try{e.statusText=e._object.statusText}catch(t){}}function l(e){e._object.onreadystatechange=new window.Function}var e=window.XMLHttpRequest,t=!!window.controllers,n=window.document.all&&!window.opera,r=n&&window.navigator.userAgent.match(/MSIE 7.0/);s.prototype=i.prototype,t&&e.wrapped&&(s.wrapped=e.wrapped),s.UNSENT=0,s.OPENED=1,s.HEADERS_RECEIVED=2,s.LOADING=3,s.DONE=4,s.prototype.readyState=s.UNSENT,s.prototype.responseText="",s.prototype.responseXML=null,s.prototype.status=0,s.prototype.statusText="",s.prototype.priority="NORMAL",s.prototype.onreadystatechange=null,s.onreadystatechange=null,s.onopen=null,s.onsend=null,s.onabort=null,s.prototype.open=function(e,r,i,o,a){delete this._headers,arguments.length<3&&(i=!0),this._async=i;var c=this,h=this.readyState,p;n&&i&&(p=function(){h!=s.DONE&&(l(c),c.abort())},window.attachEvent("onunload",p)),s.onopen&&s.onopen.apply(this,arguments),arguments.length>4?this._object.open(e,r,i,o,a):arguments.length>3?this._object.open(e,r,i,o):this._object.open(e,r,i),this.readyState=s.OPENED,u(this),this._object.onreadystatechange=function(){if(t&&!i)return;c.readyState=c._object.readyState,f(c);if(c._aborted){c.readyState=s.UNSENT;return}c.readyState==s.DONE&&(delete c._data,l(c),n&&i&&window.detachEvent("onunload",p)),h!=c.readyState&&u(c),h=c.readyState}},s.prototype.send=function(e){s.onsend&&s.onsend.apply(this,arguments),arguments.length||(e=null),e&&e.nodeType&&(e=window.XMLSerializer?(new window.XMLSerializer).serializeToString(e):e.xml,this._headers["Content-Type"]||this._object.setRequestHeader("Content-Type","application/xml")),this._data=e,o(this)},s.prototype.abort=function(){s.onabort&&s.onabort.apply(this,arguments),this.readyState>s.UNSENT&&(this._aborted=!0),this._object.abort(),l(this),this.readyState=s.UNSENT,delete this._data},s.prototype.getAllResponseHeaders=function(){return this._object.getAllResponseHeaders()},s.prototype.getResponseHeader=function(e){return this._object.getResponseHeader(e)},s.prototype.setRequestHeader=function(e,t){return this._headers||(this._headers={}),this._headers[e]=t,this._object.setRequestHeader(e,t)},s.prototype.addEventListener=function(e,t,n){for(var r=0,i;i=this._listeners[r];r++)if(i[0]==e&&i[1]==t&&i[2]==n)return;this._listeners.push([e,t,n])},s.prototype.removeEventListener=function(e,t,n){for(var r=0,i;i=this._listeners[r];r++)if(i[0]==e&&i[1]==t&&i[2]==n)break;i&&this._listeners.splice(r,1)},s.prototype.dispatchEvent=function(e){var t={type:e.type,target:this,currentTarget:this,eventPhase:2,bubbles:e.bubbles,cancelable:e.cancelable,timeStamp:e.timeStamp,stopPropagation:function(){},preventDefault:function(){},initEvent:function(){}};t.type=="readystatechange"&&this.onreadystatechange&&(this.onreadystatechange.handleEvent||this.onreadystatechange).apply(this,[t]);for(var n=0,r;r=this._listeners[n];n++)r[0]==t.type&&!r[2]&&(r[1].handleEvent||r[1]).apply(this,[t])},s.prototype.toString=function(){return"[object XMLHttpRequest]"},s.toString=function(){return"[XMLHttpRequest]"},window.Function.prototype.apply||(window.Function.prototype.apply=function(e,t){t||(t=[]),e.__func=this,e.__func(t[0],t[1],t[2],t[3],t[4]),delete e.__func}),OpenLayers.Request.XMLHttpRequest=s}(),OpenLayers.Protocol.HTTP=OpenLayers.Class(OpenLayers.Protocol,{url:null,headers:null,params:null,callback:null,scope:null,readWithPOST:!1,updateWithPOST:!1,deleteWithPOST:!1,wildcarded:!1,srsInBBOX:!1,initialize:function(e){e=e||{},this.params={},this.headers={},OpenLayers.Protocol.prototype.initialize.apply(this,arguments);if(!this.filterToParams&&OpenLayers.Format.QueryStringFilter){var t=new OpenLayers.Format.QueryStringFilter({wildcarded:this.wildcarded,srsInBBOX:this.srsInBBOX});this.filterToParams=function(e,n){return t.write(e,n)}}},destroy:function(){this.params=null,this.headers=null,OpenLayers.Protocol.prototype.destroy.apply(this)},read:function(e){OpenLayers.Protocol.prototype.read.apply(this,arguments),e=e||{},e.params=OpenLayers.Util.applyDefaults(e.params,this.options.params),e=OpenLayers.Util.applyDefaults(e,this.options),e.filter&&this.filterToParams&&(e.params=this.filterToParams(e.filter,e.params));var t=e.readWithPOST!==undefined?e.readWithPOST:this.readWithPOST,n=new OpenLayers.Protocol.Response({requestType:"read"});if(t){var r=e.headers||{};r["Content-Type"]="application/x-www-form-urlencoded",n.priv=OpenLayers.Request.POST({url:e.url,callback:this.createCallback(this.handleRead,n,e),data:OpenLayers.Util.getParameterString(e.params),headers:r})}else n.priv=OpenLayers.Request.GET({url:e.url,callback:this.createCallback(this.handleRead,n,e),params:e.params,headers:e.headers});return n},handleRead:function(e,t){this.handleResponse(e,t)},create:function(e,t){t=OpenLayers.Util.applyDefaults(t,this.options);var n=new OpenLayers.Protocol.Response({reqFeatures:e,requestType:"create"});return n.priv=OpenLayers.Request.POST({url:t.url,callback:this.createCallback(this.handleCreate,n,t),headers:t.headers,data:this.format.write(e)}),n},handleCreate:function(e,t){this.handleResponse(e,t)},update:function(e,t){t=t||{};var n=t.url||e.url||this.options.url+"/"+e.fid;t=OpenLayers.Util.applyDefaults(t,this.options);var r=new OpenLayers.Protocol.Response({reqFeatures:e,requestType:"update"}),i=this.updateWithPOST?"POST":"PUT";return r.priv=OpenLayers.Request[i]({url:n,callback:this.createCallback(this.handleUpdate,r,t),headers:t.headers,data:this.format.write(e)}),r},handleUpdate:function(e,t){this.handleResponse(e,t)},"delete":function(e,t){t=t||{};var n=t.url||e.url||this.options.url+"/"+e.fid;t=OpenLayers.Util.applyDefaults(t,this.options);var r=new OpenLayers.Protocol.Response({reqFeatures:e,requestType:"delete"}),i=this.deleteWithPOST?"POST":"DELETE",s={url:n,callback:this.createCallback(this.handleDelete,r,t),headers:t.headers};return this.deleteWithPOST&&(s.data=this.format.write(e)),r.priv=OpenLayers.Request[i](s),r},handleDelete:function(e,t){this.handleResponse(e,t)},handleResponse:function(e,t){var n=e.priv;t.callback&&(n.status>=200&&n.status<300?(e.requestType!="delete"&&(e.features=this.parseFeatures(n)),e.code=OpenLayers.Protocol.Response.SUCCESS):e.code=OpenLayers.Protocol.Response.FAILURE,t.callback.call(t.scope,e))},parseFeatures:function(e){var t=e.responseXML;if(!t||!t.documentElement)t=e.responseText;return!t||t.length<=0?null:this.format.read(t)},commit:function(e,t){function p(e){var t=e.features?e.features.length:0,n=new Array(t);for(var r=0;r<t;++r)n[r]=e.features[r].fid;h.insertIds=n,d.apply(this,[e])}function d(e){this.callUserCallback(e,t),c=c&&e.success(),r++,r>=l&&t.callback&&(h.code=c?OpenLayers.Protocol.Response.SUCCESS:OpenLayers.Protocol.Response.FAILURE,t.callback.apply(t.scope,[h]))}t=OpenLayers.Util.applyDefaults(t,this.options);var n=[],r=0,i={};i[OpenLayers.State.INSERT]=[],i[OpenLayers.State.UPDATE]=[],i[OpenLayers.State.DELETE]=[];var s,o,u=[];for(var a=0,f=e.length;a<f;++a)s=e[a],o=i[s.state],o&&(o.push(s),u.push(s));var l=(i[OpenLayers.State.INSERT].length>0?1:0)+i[OpenLayers.State.UPDATE].length+i[OpenLayers.State.DELETE].length,c=!0,h=new OpenLayers.Protocol.Response({reqFeatures:u}),v=i[OpenLayers.State.INSERT];v.length>0&&n.push(this.create(v,OpenLayers.Util.applyDefaults({callback:p,scope:this},t.create))),v=i[OpenLayers.State.UPDATE];for(var a=v.length-1;a>=0;--a)n.push(this.update(v[a],OpenLayers.Util.applyDefaults({callback:d,scope:this},t.update)));v=i[OpenLayers.State.DELETE];for(var a=v.length-1;a>=0;--a)n.push(this["delete"](v[a],OpenLayers.Util.applyDefaults({callback:d,scope:this},t["delete"])));return n},abort:function(e){e&&e.priv.abort()},callUserCallback:function(e,t){var n=t[e.requestType];n&&n.callback&&n.callback.call(n.scope,e)},CLASS_NAME:"OpenLayers.Protocol.HTTP"}),OpenLayers.Handler=OpenLayers.Class({id:null,control:null,map:null,keyMask:null,active:!1,evt:null,initialize:function(e,t,n){OpenLayers.Util.extend(this,n),this.control=e,this.callbacks=t;var r=this.map||e.map;r&&this.setMap(r),this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_")},setMap:function(e){this.map=e},checkModifiers:function(e){if(this.keyMask==null)return!0;var t=(e.shiftKey?OpenLayers.Handler.MOD_SHIFT:0)|(e.ctrlKey?OpenLayers.Handler.MOD_CTRL:0)|(e.altKey?OpenLayers.Handler.MOD_ALT:0);return t==this.keyMask},activate:function(){if(this.active)return!1;var e=OpenLayers.Events.prototype.BROWSER_EVENTS;for(var t=0,n=e.length;t<n;t++)this[e[t]]&&this.register(e[t],this[e[t]]);return this.active=!0,!0},deactivate:function(){if(!this.active)return!1;var e=OpenLayers.Events.prototype.BROWSER_EVENTS;for(var t=0,n=e.length;t<n;t++)this[e[t]]&&this.unregister(e[t],this[e[t]]);return this.active=!1,!0},callback:function(e,t){e&&this.callbacks[e]&&this.callbacks[e].apply(this.control,t)},register:function(e,t){this.map.events.registerPriority(e,this,t),this.map.events.registerPriority(e,this,this.setEvent)},unregister:function(e,t){this.map.events.unregister(e,this,t),this.map.events.unregister(e,this,this.setEvent)},setEvent:function(e){return this.evt=e,!0},destroy:function(){this.deactivate(),this.control=this.map=null},CLASS_NAME:"OpenLayers.Handler"}),OpenLayers.Handler.MOD_NONE=0,OpenLayers.Handler.MOD_SHIFT=1,OpenLayers.Handler.MOD_CTRL=2,OpenLayers.Handler.MOD_ALT=4,OpenLayers.Handler.Click=OpenLayers.Class(OpenLayers.Handler,{delay:300,single:!0,"double":!1,pixelTolerance:0,dblclickTolerance:13,stopSingle:!1,stopDouble:!1,timerId:null,touch:!1,down:null,last:null,first:null,rightclickTimerId:null,touchstart:function(e){return this.touch||(this.unregisterMouseListeners(),this.touch=!0),this.down=this.getEventInfo(e),this.last=this.getEventInfo(e),!0},touchmove:function(e){return this.last=this.getEventInfo(e),!0},touchend:function(e){return this.down&&(e.xy=this.last.xy,e.lastTouches=this.last.touches,this.handleSingle(e),this.down=null),!0},unregisterMouseListeners:function(){this.map.events.un({mousedown:this.mousedown,mouseup:this.mouseup,click:this.click,dblclick:this.dblclick,scope:this})},mousedown:function(e){return this.down=this.getEventInfo(e),this.last=this.getEventInfo(e),!0},mouseup:function(e){var t=!0;return this.checkModifiers(e)&&this.control.handleRightClicks&&OpenLayers.Event.isRightClick(e)&&(t=this.rightclick(e)),t},rightclick:function(e){if(this.passesTolerance(e)){if(this.rightclickTimerId!=null)return this.clearTimer(),this.callback("dblrightclick",[e]),!this.stopDouble;var t=this["double"]?OpenLayers.Util.extend({},e):this.callback("rightclick",[e]),n=OpenLayers.Function.bind(this.delayedRightCall,this,t);this.rightclickTimerId=window.setTimeout(n,this.delay)}return!this.stopSingle},delayedRightCall:function(e){this.rightclickTimerId=null,e&&this.callback("rightclick",[e])},click:function(e){return this.last||(this.last=this.getEventInfo(e)),this.handleSingle(e),!this.stopSingle},dblclick:function(e){return this.handleDouble(e),!this.stopDouble},handleDouble:function(e){this.passesDblclickTolerance(e)&&(this["double"]&&this.callback("dblclick",[e]),this.clearTimer())},handleSingle:function(e){if(this.passesTolerance(e))if(this.timerId!=null)this.last.touches&&this.last.touches.length===1&&(this["double"]&&OpenLayers.Event.stop(e),this.handleDouble(e)),(!this.last.touches||this.last.touches.length!==2)&&this.clearTimer();else{this.first=this.getEventInfo(e);var t=this.single?OpenLayers.Util.extend({},e):null;this.queuePotentialClick(t)}},queuePotentialClick:function(e){this.timerId=window.setTimeout(OpenLayers.Function.bind(this.delayedCall,this,e),this.delay)},passesTolerance:function(e){var t=!0;if(this.pixelTolerance!=null&&this.down&&this.down.xy){t=this.pixelTolerance>=this.down.xy.distanceTo(e.xy);if(t&&this.touch&&this.down.touches.length===this.last.touches.length)for(var n=0,r=this.down.touches.length;n<r;++n)if(this.getTouchDistance(this.down.touches[n],this.last.touches[n])>this.pixelTolerance){t=!1;break}}return t},getTouchDistance:function(e,t){return Math.sqrt(Math.pow(e.clientX-t.clientX,2)+Math.pow(e.clientY-t.clientY,2))},passesDblclickTolerance:function(e){var t=!0;return this.down&&this.first&&(t=this.down.xy.distanceTo(this.first.xy)<=this.dblclickTolerance),t},clearTimer:function(){this.timerId!=null&&(window.clearTimeout(this.timerId),this.timerId=null),this.rightclickTimerId!=null&&(window.clearTimeout(this.rightclickTimerId),this.rightclickTimerId=null)},delayedCall:function(e){this.timerId=null,e&&this.callback("click",[e])},getEventInfo:function(e){var t;if(e.touches){var n=e.touches.length;t=new Array(n);var r;for(var i=0;i<n;i++)r=e.touches[i],t[i]={clientX:r.clientX,clientY:r.clientY}}return{xy:e.xy,touches:t}},deactivate:function(){var e=!1;return OpenLayers.Handler.prototype.deactivate.apply(this,arguments)&&(this.clearTimer(),this.down=null,this.first=null,this.last=null,this.touch=!1,e=!0),e},CLASS_NAME:"OpenLayers.Handler.Click"}),OpenLayers.Format=OpenLayers.Class({options:null,externalProjection:null,internalProjection:null,data:null,keepData:!1,initialize:function(e){OpenLayers.Util.extend(this,e),this.options=e},destroy:function(){},read:function(e){throw new Error("Read not implemented.")},write:function(e){throw new Error("Write not implemented.")},CLASS_NAME:"OpenLayers.Format"}),OpenLayers.Format.XML=OpenLayers.Class(OpenLayers.Format,{namespaces:null,namespaceAlias:null,defaultPrefix:null,readers:{},writers:{},xmldom:null,initialize:function(e){window.ActiveXObject&&(this.xmldom=new ActiveXObject("Microsoft.XMLDOM")),OpenLayers.Format.prototype.initialize.apply(this,[e]),this.namespaces=OpenLayers.Util.extend({},this.namespaces),this.namespaceAlias={};for(var t in this.namespaces)this.namespaceAlias[this.namespaces[t]]=t},destroy:function(){this.xmldom=null,OpenLayers.Format.prototype.destroy.apply(this,arguments)},setNamespace:function(e,t){this.namespaces[e]=t,this.namespaceAlias[t]=e},read:function(e){var t=e.indexOf("<");t>0&&(e=e.substring(t));var n=OpenLayers.Util.Try(OpenLayers.Function.bind(function(){var t;return window.ActiveXObject&&!this.xmldom?t=new ActiveXObject("Microsoft.XMLDOM"):t=this.xmldom,t.loadXML(e),t},this),function(){return(new DOMParser).parseFromString(e,"text/xml")},function(){var t=new XMLHttpRequest;return t.open("GET","data:text/xml;charset=utf-8,"+encodeURIComponent(e),!1),t.overrideMimeType&&t.overrideMimeType("text/xml"),t.send(null),t.responseXML});return this.keepData&&(this.data=n),n},write:function(e){var t;if(this.xmldom)t=e.xml;else{var n=new XMLSerializer;if(e.nodeType==1){var r=document.implementation.createDocument("","",null);r.importNode&&(e=r.importNode(e,!0)),r.appendChild(e),t=n.serializeToString(r)}else t=n.serializeToString(e)}return t},createElementNS:function(e,t){var n;return this.xmldom?typeof e=="string"?n=this.xmldom.createNode(1,t,e):n=this.xmldom.createNode(1,t,""):n=document.createElementNS(e,t),n},createTextNode:function(e){var t;return typeof e!="string"&&(e=String(e)),this.xmldom?t=this.xmldom.createTextNode(e):t=document.createTextNode(e),t},getElementsByTagNameNS:function(e,t,n){var r=[];if(e.getElementsByTagNameNS)r=e.getElementsByTagNameNS(t,n);else{var i=e.getElementsByTagName("*"),s,o;for(var u=0,a=i.length;u<a;++u)s=i[u],o=s.prefix?s.prefix+":"+n:n,(n=="*"||o==s.nodeName)&&(t=="*"||t==s.namespaceURI)&&r.push(s)}return r},getAttributeNodeNS:function(e,t,n){var r=null;if(e.getAttributeNodeNS)r=e.getAttributeNodeNS(t,n);else{var i=e.attributes,s,o;for(var u=0,a=i.length;u<a;++u){s=i[u];if(s.namespaceURI==t){o=s.prefix?s.prefix+":"+n:n;if(o==s.nodeName){r=s;break}}}}return r},getAttributeNS:function(e,t,n){var r="";if(e.getAttributeNS)r=e.getAttributeNS(t,n)||"";else{var i=this.getAttributeNodeNS(e,t,n);i&&(r=i.nodeValue)}return r},getChildValue:function(e,t){var n=t||"";if(e)for(var r=e.firstChild;r;r=r.nextSibling)switch(r.nodeType){case 3:case 4:n+=r.nodeValue}return n},isSimpleContent:function(e){var t=!0;for(var n=e.firstChild;n;n=n.nextSibling)if(n.nodeType===1){t=!1;break}return t},contentType:function(e){var t=!1,n=!1,r=OpenLayers.Format.XML.CONTENT_TYPE.EMPTY;for(var i=e.firstChild;i;i=i.nextSibling){switch(i.nodeType){case 1:n=!0;break;case 8:break;default:t=!0}if(n&&t)break}if(n&&t)r=OpenLayers.Format.XML.CONTENT_TYPE.MIXED;else{if(n)return OpenLayers.Format.XML.CONTENT_TYPE.COMPLEX;if(t)return OpenLayers.Format.XML.CONTENT_TYPE.SIMPLE}return r},hasAttributeNS:function(e,t,n){var r=!1;return e.hasAttributeNS?r=e.hasAttributeNS(t,n):r=!!this.getAttributeNodeNS(e,t,n),r},setAttributeNS:function(e,t,n,r){if(e.setAttributeNS)e.setAttributeNS(t,n,r);else{if(!this.xmldom)throw"setAttributeNS not implemented";if(t){var i=e.ownerDocument.createNode(2,n,t);i.nodeValue=r,e.setAttributeNode(i)}else e.setAttribute(n,r)}},createElementNSPlus:function(e,t){t=t||{};var n=t.uri||this.namespaces[t.prefix];if(!n){var r=e.indexOf(":");n=this.namespaces[e.substring(0,r)]}n||(n=this.namespaces[this.defaultPrefix]);var i=this.createElementNS(n,e);t.attributes&&this.setAttributes(i,t.attributes);var s=t.value;return s!=null&&i.appendChild(this.createTextNode(s)),i},setAttributes:function(e,t){var n,r;for(var i in t)t[i]!=null&&t[i].toString&&(n=t[i].toString(),r=this.namespaces[i.substring(0,i.indexOf(":"))]||null,this.setAttributeNS(e,r,i,n))},readNode:function(e,t){t||(t={});var n=this.readers[e.namespaceURI?this.namespaceAlias[e.namespaceURI]:this.defaultPrefix];if(n){var r=e.localName||e.nodeName.split(":").pop(),i=n[r]||n["*"];i&&i.apply(this,[e,t])}return t},readChildNodes:function(e,t){t||(t={});var n=e.childNodes,r;for(var i=0,s=n.length;i<s;++i)r=n[i],r.nodeType==1&&this.readNode(r,t);return t},writeNode:function(e,t,n){var r,i,s=e.indexOf(":");s>0?(r=e.substring(0,s),i=e.substring(s+1)):(n?r=this.namespaceAlias[n.namespaceURI]:r=this.defaultPrefix,i=e);var o=this.writers[r][i].apply(this,[t]);return n&&n.appendChild(o),o},getChildEl:function(e,t,n){return e&&this.getThisOrNextEl(e.firstChild,t,n)},getNextEl:function(e,t,n){return e&&this.getThisOrNextEl(e.nextSibling,t,n)},getThisOrNextEl:function(e,t,n){e:for(var r=e;r;r=r.nextSibling)switch(r.nodeType){case 1:if((!t||t===(r.localName||r.nodeName.split(":").pop()))&&(!n||n===r.namespaceURI))break e;r=null;break e;case 3:if(/^\s*$/.test(r.nodeValue))break;case 4:case 6:case 12:case 10:case 11:r=null;break e}return r||null},lookupNamespaceURI:function(e,t){var n=null;if(e)if(e.lookupNamespaceURI)n=e.lookupNamespaceURI(t);else e:switch(e.nodeType){case 1:if(e.namespaceURI!==null&&e.prefix===t){n=e.namespaceURI;break e}var r=e.attributes.length;if(r){var i;for(var s=0;s<r;++s){i=e.attributes[s];if(i.prefix==="xmlns"&&i.name==="xmlns:"+t){n=i.value||null;break e}if(i.name==="xmlns"&&t===null){n=i.value||null;break e}}}n=this.lookupNamespaceURI(e.parentNode,t);break e;case 2:n=this.lookupNamespaceURI(e.ownerElement,t);break e;case 9:n=this.lookupNamespaceURI(e.documentElement,t);break e;case 6:case 12:case 10:case 11:break e;default:n=this.lookupNamespaceURI(e.parentNode,t);break e}return n},getXMLDoc:function(){return!OpenLayers.Format.XML.document&&!this.xmldom&&(document.implementation&&document.implementation.createDocument?OpenLayers.Format.XML.document=document.implementation.createDocument("","",null):!this.xmldom&&window.ActiveXObject&&(this.xmldom=new ActiveXObject("Microsoft.XMLDOM"))),OpenLayers.Format.XML.document||this.xmldom},CLASS_NAME:"OpenLayers.Format.XML"}),OpenLayers.Format.XML.CONTENT_TYPE={EMPTY:0,SIMPLE:1,COMPLEX:2,MIXED:3},OpenLayers.Format.XML.lookupNamespaceURI=OpenLayers.Function.bind(OpenLayers.Format.XML.prototype.lookupNamespaceURI,OpenLayers.Format.XML.prototype),OpenLayers.Format.XML.document=null,OpenLayers.Control=OpenLayers.Class({id:null,map:null,div:null,type:null,allowSelection:!1,displayClass:"",title:"",autoActivate:!1,active:null,handler:null,eventListeners:null,events:null,initialize:function(e){this.displayClass=this.CLASS_NAME.replace("OpenLayers.","ol").replace(/\./g,""),OpenLayers.Util.extend(this,e),this.events=new OpenLayers.Events(this),this.eventListeners instanceof Object&&this.events.on(this.eventListeners),this.id==null&&(this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_"))},destroy:function(){this.events&&(this.eventListeners&&this.events.un(this.eventListeners),this.events.destroy(),this.events=null),this.eventListeners=null,this.handler&&(this.handler.destroy(),this.handler=null);if(this.handlers){for(var e in this.handlers)this.handlers.hasOwnProperty(e)&&typeof this.handlers[e].destroy=="function"&&this.handlers[e].destroy();this.handlers=null}this.map&&(this.map.removeControl(this),this.map=null),this.div=null},setMap:function(e){this.map=e,this.handler&&this.handler.setMap(e)},draw:function(e){return this.div==null&&(this.div=OpenLayers.Util.createDiv(this.id),this.div.className=this.displayClass,this.allowSelection||(this.div.className+=" olControlNoSelect",this.div.setAttribute("unselectable","on",0),this.div.onselectstart=OpenLayers.Function.False),this.title!=""&&(this.div.title=this.title)),e!=null&&(this.position=e.clone()),this.moveTo(this.position),this.div},moveTo:function(e){e!=null&&this.div!=null&&(this.div.style.left=e.x+"px",this.div.style.top=e.y+"px")},activate:function(){return this.active?!1:(this.handler&&this.handler.activate(),this.active=!0,this.map&&OpenLayers.Element.addClass(this.map.viewPortDiv,this.displayClass.replace(/ /g,"")+"Active"),this.events.triggerEvent("activate"),!0)},deactivate:function(){return this.active?(this.handler&&this.handler.deactivate(),this.active=!1,this.map&&OpenLayers.Element.removeClass(this.map.viewPortDiv,this.displayClass.replace(/ /g,"")+"Active"),this.events.triggerEvent("deactivate"),!0):!1},CLASS_NAME:"OpenLayers.Control"}),OpenLayers.Control.TYPE_BUTTON=1,OpenLayers.Control.TYPE_TOGGLE=2,OpenLayers.Control.TYPE_TOOL=3,OpenLayers.Handler.Drag=OpenLayers.Class(OpenLayers.Handler,{started:!1,stopDown:!0,dragging:!1,touch:!1,last:null,start:null,lastMoveEvt:null,oldOnselectstart:null,interval:0,timeoutId:null,documentDrag:!1,documentEvents:null,initialize:function(e,t,n){OpenLayers.Handler.prototype.initialize.apply(this,arguments);if(this.documentDrag===!0){var r=this;this._docMove=function(e){r.mousemove({xy:{x:e.clientX,y:e.clientY},element:document})},this._docUp=function(e){r.mouseup({xy:{x:e.clientX,y:e.clientY}})}}},dragstart:function(e){var t=!0;return this.dragging=!1,this.checkModifiers(e)&&(OpenLayers.Event.isLeftClick(e)||OpenLayers.Event.isSingleTouch(e))?(this.started=!0,this.start=e.xy,this.last=e.xy,OpenLayers.Element.addClass(this.map.viewPortDiv,"olDragDown"),this.down(e),this.callback("down",[e.xy]),OpenLayers.Event.stop(e),this.oldOnselectstart||(this.oldOnselectstart=document.onselectstart?document.onselectstart:OpenLayers.Function.True),document.onselectstart=OpenLayers.Function.False,t=!this.stopDown):(this.started=!1,this.start=null,this.last=null),t},dragmove:function(e){return this.lastMoveEvt=e,this.started&&!this.timeoutId&&(e.xy.x!=this.last.x||e.xy.y!=this.last.y)&&(this.documentDrag===!0&&this.documentEvents&&(e.element===document?(this.adjustXY(e),this.setEvent(e)):this.removeDocumentEvents()),this.interval>0&&(this.timeoutId=setTimeout(OpenLayers.Function.bind(this.removeTimeout,this),this.interval)),this.dragging=!0,this.move(e),this.callback("move",[e.xy]),this.oldOnselectstart||(this.oldOnselectstart=document.onselectstart,document.onselectstart=OpenLayers.Function.False),this.last=e.xy),!0},dragend:function(e){if(this.started){this.documentDrag===!0&&this.documentEvents&&(this.adjustXY(e),this.removeDocumentEvents());var t=this.start!=this.last;this.started=!1,this.dragging=!1,OpenLayers.Element.removeClass(this.map.viewPortDiv,"olDragDown"),this.up(e),this.callback("up",[e.xy]),t&&this.callback("done",[e.xy]),document.onselectstart=this.oldOnselectstart}return!0},down:function(e){},move:function(e){},up:function(e){},out:function(e){},mousedown:function(e){return this.dragstart(e)},touchstart:function(e){return this.touch||(this.touch=!0,this.map.events.un({mousedown:this.mousedown,mouseup:this.mouseup,mousemove:this.mousemove,click:this.click,scope:this})),this.dragstart(e)},mousemove:function(e){return this.dragmove(e)},touchmove:function(e){return this.dragmove(e)},removeTimeout:function(){this.timeoutId=null,this.dragging&&this.mousemove(this.lastMoveEvt)},mouseup:function(e){return this.dragend(e)},touchend:function(e){return e.xy=this.last,this.dragend(e)},mouseout:function(e){if(this.started&&OpenLayers.Util.mouseLeft(e,this.map.viewPortDiv))if(this.documentDrag===!0)this.addDocumentEvents();else{var t=this.start!=this.last;this.started=!1,this.dragging=!1,OpenLayers.Element.removeClass(this.map.viewPortDiv,"olDragDown"),this.out(e),this.callback("out",[]),t&&this.callback("done",[e.xy]),document.onselectstart&&(document.onselectstart=this.oldOnselectstart)}return!0},click:function(e){return this.start==this.last},activate:function(){var e=!1;return OpenLayers.Handler.prototype.activate.apply(this,arguments)&&(this.dragging=!1,e=!0),e},deactivate:function(){var e=!1;return OpenLayers.Handler.prototype.deactivate.apply(this,arguments)&&(this.touch=!1,this.started=!1,this.dragging=!1,this.start=null,this.last=null,e=!0,OpenLayers.Element.removeClass(this.map.viewPortDiv,"olDragDown")),e},adjustXY:function(e){var t=OpenLayers.Util.pagePosition(this.map.viewPortDiv);e.xy.x-=t[0],e.xy.y-=t[1]},addDocumentEvents:function(){OpenLayers.Element.addClass(document.body,"olDragDown"),this.documentEvents=!0,OpenLayers.Event.observe(document,"mousemove",this._docMove),OpenLayers.Event.observe(document,"mouseup",this._docUp)},removeDocumentEvents:function(){OpenLayers.Element.removeClass(document.body,"olDragDown"),this.documentEvents=!1,OpenLayers.Event.stopObserving(document,"mousemove",this._docMove),OpenLayers.Event.stopObserving(document,"mouseup",this._docUp)},CLASS_NAME:"OpenLayers.Handler.Drag"}),OpenLayers.Handler.Feature=OpenLayers.Class(OpenLayers.Handler,{EVENTMAP:{click:{"in":"click",out:"clickout"},mousemove:{"in":"over",out:"out"},dblclick:{"in":"dblclick",out:null},mousedown:{"in":null,out:null},mouseup:{"in":null,out:null},touchstart:{"in":"click",out:"clickout"}},feature:null,lastFeature:null,down:null,up:null,touch:!1,clickTolerance:4,geometryTypes:null,stopClick:!0,stopDown:!0,stopUp:!1,initialize:function(e,t,n,r){OpenLayers.Handler.prototype.initialize.apply(this,[e,n,r]),this.layer=t},touchstart:function(e){return this.touch||(this.touch=!0,this.map.events.un({mousedown:this.mousedown,mouseup:this.mouseup,mousemove:this.mousemove,click:this.click,dblclick:this.dblclick,scope:this})),OpenLayers.Event.isMultiTouch(e)?!0:this.mousedown(e)},touchmove:function(e){OpenLayers.Event.stop(e)},mousedown:function(e){if(OpenLayers.Event.isLeftClick(e)||OpenLayers.Event.isSingleTouch(e))this.down=e.xy;return this.handle(e)?!this.stopDown:!0},mouseup:function(e){return this.up=e.xy,this.handle(e)?!this.stopUp:!0},click:function(e){return this.handle(e)?!this.stopClick:!0},mousemove:function(e){return!this.callbacks.over&&!this.callbacks.out?!0:(this.handle(e),!0)},dblclick:function(e){return!this.handle(e)},geometryTypeMatches:function(e){return this.geometryTypes==null||OpenLayers.Util.indexOf(this.geometryTypes,e.geometry.CLASS_NAME)>-1},handle:function(e){this.feature&&!this.feature.layer&&(this.feature=null);var t=e.type,n=!1,r=!!this.feature,i=t=="click"||t=="dblclick"||t=="touchstart";this.feature=this.layer.getFeatureFromEvent(e),this.feature&&!this.feature.layer&&(this.feature=null),this.lastFeature&&!this.lastFeature.layer&&(this.lastFeature=null);if(this.feature){t==="touchstart"&&OpenLayers.Event.stop(e);var s=this.feature!=this.lastFeature;this.geometryTypeMatches(this.feature)?(r&&s?(this.lastFeature&&this.triggerCallback(t,"out",[this.lastFeature]),this.triggerCallback(t,"in",[this.feature])):(!r||i)&&this.triggerCallback(t,"in",[this.feature]),this.lastFeature=this.feature,n=!0):(this.lastFeature&&(r&&s||i)&&this.triggerCallback(t,"out",[this.lastFeature]),this.feature=null)}else this.lastFeature&&(r||i)&&this.triggerCallback(t,"out",[this.lastFeature]);return n},triggerCallback:function(e,t,n){var r=this.EVENTMAP[e][t];if(r)if(e=="click"&&this.up&&this.down){var i=Math.sqrt(Math.pow(this.up.x-this.down.x,2)+Math.pow(this.up.y-this.down.y,2));i<=this.clickTolerance&&this.callback(r,n)}else this.callback(r,n)},activate:function(){var e=!1;return OpenLayers.Handler.prototype.activate.apply(this,arguments)&&(this.moveLayerToTop(),this.map.events.on({removelayer:this.handleMapEvents,changelayer:this.handleMapEvents,scope:this}),e=!0),e},deactivate:function(){var e=!1;return OpenLayers.Handler.prototype.deactivate.apply(this,arguments)&&(this.moveLayerBack(),this.feature=null,this.lastFeature=null,this.down=null,this.up=null,this.touch=!1,this.map.events.un({removelayer:this.handleMapEvents,changelayer:this.handleMapEvents,scope:this}),e=!0),e},handleMapEvents:function(e){(e.type=="removelayer"||e.property=="order")&&this.moveLayerToTop()},moveLayerToTop:function(){var e=Math.max(this.map.Z_INDEX_BASE.Feature-1,this.layer.getZIndex())+1;this.layer.setZIndex(e)},moveLayerBack:function(){var e=this.layer.getZIndex()-1;e>=this.map.Z_INDEX_BASE.Feature?this.layer.setZIndex(e):this.map.setLayerZIndex(this.layer,this.map.getLayerIndex(this.layer))},CLASS_NAME:"OpenLayers.Handler.Feature"}),OpenLayers.Control.DragFeature=OpenLayers.Class(OpenLayers.Control,{geometryTypes:null,onStart:function(e,t){},onDrag:function(e,t){},onComplete:function(e,t){},onEnter:function(e){},onLeave:function(e){},documentDrag:!1,layer:null,feature:null,dragCallbacks:{},featureCallbacks:{},lastPixel:null,initialize:function(e,t){OpenLayers.Control.prototype.initialize.apply(this,[t]),this.layer=e,this.handlers={drag:new OpenLayers.Handler.Drag(this,OpenLayers.Util.extend({down:this.downFeature,move:this.moveFeature,up:this.upFeature,out:this.cancel,done:this.doneDragging},this.dragCallbacks),{documentDrag:this.documentDrag}),feature:new OpenLayers.Handler.Feature(this,this.layer,OpenLayers.Util.extend({click:this.clickFeature,clickout:this.clickoutFeature,over:this.overFeature,out:this.outFeature},this.featureCallbacks),{geometryTypes:this.geometryTypes})}},clickFeature:function(e){this.handlers.feature.touch&&!this.over&&this.overFeature(e)&&(this.handlers.drag.dragstart(this.handlers.feature.evt),this.handlers.drag.stopDown=!1)},clickoutFeature:function(e){this.handlers.feature.touch&&this.over&&(this.outFeature(e),this.handlers.drag.stopDown=!0)},destroy:function(){this.layer=null,OpenLayers.Control.prototype.destroy.apply(this,[])},activate:function(){return this.handlers.feature.activate()&&OpenLayers.Control.prototype.activate.apply(this,arguments)},deactivate:function(){return this.handlers.drag.deactivate(),this.handlers.feature.deactivate(),this.feature=null,this.dragging=!1,this.lastPixel=null,OpenLayers.Element.removeClass(this.map.viewPortDiv,this.displayClass+"Over"),OpenLayers.Control.prototype.deactivate.apply(this,arguments)},overFeature:function(e){var t=!1;return this.handlers.drag.dragging?this.feature.id==e.id?this.over=!0:this.over=!1:(this.feature=e,this.handlers.drag.activate(),t=!0,this.over=!0,OpenLayers.Element.addClass(this.map.viewPortDiv,this.displayClass+"Over"),this.onEnter(e)),t},downFeature:function(e){this.lastPixel=e,this.onStart(this.feature,e)},moveFeature:function(e){var t=this.map.getResolution();this.feature.geometry.move(t*(e.x-this.lastPixel.x),t*(this.lastPixel.y-e.y)),this.layer.drawFeature(this.feature),this.lastPixel=e,this.onDrag(this.feature,e)},upFeature:function(e){this.over||this.handlers.drag.deactivate()},doneDragging:function(e){this.onComplete(this.feature,e)},outFeature:function(e){this.handlers.drag.dragging?this.feature.id==e.id&&(this.over=!1):(this.over=!1,this.handlers.drag.deactivate(),OpenLayers.Element.removeClass(this.map.viewPortDiv,this.displayClass+"Over"),this.onLeave(e),this.feature=null)},cancel:function(){this.handlers.drag.deactivate(),this.over=!1},setMap:function(e){this.handlers.drag.setMap(e),this.handlers.feature.setMap(e),OpenLayers.Control.prototype.setMap.apply(this,arguments)},CLASS_NAME:"OpenLayers.Control.DragFeature"}),OpenLayers.Handler.Box=OpenLayers.Class(OpenLayers.Handler,{dragHandler:null,boxDivClassName:"olHandlerBoxZoomBox",boxOffsets:null,initialize:function(e,t,n){OpenLayers.Handler.prototype.initialize.apply(this,arguments),this.dragHandler=new OpenLayers.Handler.Drag(this,{down:this.startBox,move:this.moveBox,out:this.removeBox,up:this.endBox},{keyMask:this.keyMask})},destroy:function(){OpenLayers.Handler.prototype.destroy.apply(this,arguments),this.dragHandler&&(this.dragHandler.destroy(),this.dragHandler=null)},setMap:function(e){OpenLayers.Handler.prototype.setMap.apply(this,arguments),this.dragHandler&&this.dragHandler.setMap(e)},startBox:function(e){this.callback("start",[]),this.zoomBox=OpenLayers.Util.createDiv("zoomBox",{x:-9999,y:-9999}),this.zoomBox.className=this.boxDivClassName,this.zoomBox.style.zIndex=this.map.Z_INDEX_BASE.Popup-1,this.map.viewPortDiv.appendChild(this.zoomBox),OpenLayers.Element.addClass(this.map.viewPortDiv,"olDrawBox")},moveBox:function(e){var t=this.dragHandler.start.x,n=this.dragHandler.start.y,r=Math.abs(t-e.x),i=Math.abs(n-e.y),s=this.getBoxOffsets();this.zoomBox.style.width=r+s.width+1+"px",this.zoomBox.style.height=i+s.height+1+"px",this.zoomBox.style.left=(e.x<t?t-r-s.left:t-s.left)+"px",this.zoomBox.style.top=(e.y<n?n-i-s.top:n-s.top)+"px"},endBox:function(e){var t;if(Math.abs(this.dragHandler.start.x-e.x)>5||Math.abs(this.dragHandler.start.y-e.y)>5){var n=this.dragHandler.start,r=Math.min(n.y,e.y),i=Math.max(n.y,e.y),s=Math.min(n.x,e.x),o=Math.max(n.x,e.x);t=new OpenLayers.Bounds(s,i,o,r)}else t=this.dragHandler.start.clone();this.removeBox(),this.callback("done",[t])},removeBox:function(){this.map.viewPortDiv.removeChild(this.zoomBox),this.zoomBox=null,this.boxOffsets=null,OpenLayers.Element.removeClass(this.map.viewPortDiv,"olDrawBox")},activate:function(){return OpenLayers.Handler.prototype.activate.apply(this,arguments)?(this.dragHandler.activate(),!0):!1},deactivate:function(){return OpenLayers.Handler.prototype.deactivate.apply(this,arguments)?(this.dragHandler.deactivate()&&this.zoomBox&&this.removeBox(),!0):!1},getBoxOffsets:function(){if(!this.boxOffsets){var e=document.createElement("div");e.style.position="absolute",e.style.border="1px solid black",e.style.width="3px",document.body.appendChild(e);var t=e.clientWidth==3;document.body.removeChild(e);var n=parseInt(OpenLayers.Element.getStyle(this.zoomBox,"border-left-width")),r=parseInt(OpenLayers.Element.getStyle(this.zoomBox,"border-right-width")),i=parseInt(OpenLayers.Element.getStyle(this.zoomBox,"border-top-width")),s=parseInt(OpenLayers.Element.getStyle(this.zoomBox,"border-bottom-width"));this.boxOffsets={left:n,right:r,top:i,bottom:s,width:t===!1?n+r:0,height:t===!1?i+s:0}}return this.boxOffsets},CLASS_NAME:"OpenLayers.Handler.Box"}),OpenLayers.Control.ZoomBox=OpenLayers.Class(OpenLayers.Control,{type:OpenLayers.Control.TYPE_TOOL,out:!1,keyMask:null,alwaysZoom:!1,draw:function(){this.handler=new OpenLayers.Handler.Box(this,{done:this.zoomBox},{keyMask:this.keyMask})},zoomBox:function(e){if(e instanceof OpenLayers.Bounds){var t;if(!this.out){var n=this.map.getLonLatFromPixel({x:e.left,y:e.bottom}),r=this.map.getLonLatFromPixel({x:e.right,y:e.top});t=new OpenLayers.Bounds(n.lon,n.lat,r.lon,r.lat)}else{var i=Math.abs(e.right-e.left),s=Math.abs(e.top-e.bottom),o=Math.min(this.map.size.h/s,this.map.size.w/i),u=this.map.getExtent(),a=this.map.getLonLatFromPixel(e.getCenterPixel()),f=a.lon-u.getWidth()/2*o,l=a.lon+u.getWidth()/2*o,c=a.lat-u.getHeight()/2*o,h=a.lat+u.getHeight()/2*o;t=new OpenLayers.Bounds(f,c,l,h)}var p=this.map.getZoom();this.map.zoomToExtent(t),p==this.map.getZoom()&&this.alwaysZoom==1&&this.map.zoomTo(p+(this.out?-1:1))}else this.out?this.map.setCenter(this.map.getLonLatFromPixel(e),this.map.getZoom()-1):this.map.setCenter(this.map.getLonLatFromPixel(e),this.map.getZoom()+1)},CLASS_NAME:"OpenLayers.Control.ZoomBox"}),OpenLayers.Control.DragPan=OpenLayers.Class(OpenLayers.Control,{type:OpenLayers.Control.TYPE_TOOL,panned:!1,interval:1,documentDrag:!1,kinetic:null,enableKinetic:!1,kineticInterval:10,draw:function(){if(this.enableKinetic){var e={interval:this.kineticInterval};typeof this.enableKinetic=="object"&&(e=OpenLayers.Util.extend(e,this.enableKinetic)),this.kinetic=new OpenLayers.Kinetic(e)}this.handler=new OpenLayers.Handler.Drag(this,{move:this.panMap,done:this.panMapDone,down:this.panMapStart},{interval:this.interval,documentDrag:this.documentDrag})},panMapStart:function(){this.kinetic&&this.kinetic.begin()},panMap:function(e){this.kinetic&&this.kinetic.update(e),this.panned=!0,this.map.pan(this.handler.last.x-e.x,this.handler.last.y-e.y,{dragging:!0,animate:!1})},panMapDone:function(e){if(this.panned){var t=null;this.kinetic&&(t=this.kinetic.end(e)),this.map.pan(this.handler.last.x-e.x,this.handler.last.y-e.y,{dragging:!!t,animate:!1});if(t){var n=this;this.kinetic.move(t,function(e,t,r){n.map.pan(e,t,{dragging:!r,animate:!1})})}this.panned=!1}},CLASS_NAME:"OpenLayers.Control.DragPan"}),OpenLayers.Handler.MouseWheel=OpenLayers.Class(OpenLayers.Handler,{wheelListener:null,mousePosition:null,interval:0,delta:0,cumulative:!0,initialize:function(e,t,n){OpenLayers.Handler.prototype.initialize.apply(this,arguments),this.wheelListener=OpenLayers.Function.bindAsEventListener(this.onWheelEvent,this)},destroy:function(){OpenLayers.Handler.prototype.destroy.apply(this,arguments),this.wheelListener=null},onWheelEvent:function(e){if(!this.map||!this.checkModifiers(e))return;var t=!1,n=!1,r=!1,i=OpenLayers.Event.element(e);while(i!=null&&!r&&!t){if(!t)try{if(i.currentStyle)o=i.currentStyle.overflow;else var s=document.defaultView.getComputedStyle(i,null),o=s.getPropertyValue("overflow");t=o&&o=="auto"||o=="scroll"}catch(u){}if(!n)for(var a=0,f=this.map.layers.length;a<f;a++)if(i==this.map.layers[a].div||i==this.map.layers[a].pane){n=!0;break}r=i==this.map.div,i=i.parentNode}if(!t&&r){if(n){var l=0;e||(e=window.event),e.wheelDelta?(l=e.wheelDelta/120,window.opera&&window.opera.version()<9.2&&(l=-l)):e.detail&&(l=-e.detail/3),this.delta=this.delta+l,this.interval?(window.clearTimeout(this._timeoutId),this._timeoutId=window.setTimeout(OpenLayers.Function.bind(function(){this.wheelZoom(e)},this),this.interval)):this.wheelZoom(e)}OpenLayers.Event.stop(e)}},wheelZoom:function(e){var t=this.delta;this.delta=0,t&&(this.mousePosition&&(e.xy=this.mousePosition),e.xy||(e.xy=this.map.getPixelFromLonLat(this.map.getCenter())),t<0?this.callback("down",[e,this.cumulative?t:-1]):this.callback("up",[e,this.cumulative?t:1]))},mousemove:function(e){this.mousePosition=e.xy},activate:function(e){if(OpenLayers.Handler.prototype.activate.apply(this,arguments)){var t=this.wheelListener;return OpenLayers.Event.observe(window,"DOMMouseScroll",t),OpenLayers.Event.observe(window,"mousewheel",t),OpenLayers.Event.observe(document,"mousewheel",t),!0}return!1},deactivate:function(e){if(OpenLayers.Handler.prototype.deactivate.apply(this,arguments)){var t=this.wheelListener;return OpenLayers.Event.stopObserving(window,"DOMMouseScroll",t),OpenLayers.Event.stopObserving(window,"mousewheel",t),OpenLayers.Event.stopObserving(document,"mousewheel",t),!0}return!1},CLASS_NAME:"OpenLayers.Handler.MouseWheel"}),OpenLayers.Control.Navigation=OpenLayers.Class(OpenLayers.Control,{dragPan:null,dragPanOptions:null,pinchZoom:null,pinchZoomOptions:null,documentDrag:!1,zoomBox:null,zoomBoxEnabled:!0,zoomWheelEnabled:!0,mouseWheelOptions:null,handleRightClicks:!1,zoomBoxKeyMask:OpenLayers.Handler.MOD_SHIFT,autoActivate:!0,initialize:function(e){this.handlers={},OpenLayers.Control.prototype.initialize.apply(this,arguments)},destroy:function(){this.deactivate(),this.dragPan&&this.dragPan.destroy(),this.dragPan=null,this.zoomBox&&this.zoomBox.destroy(),this.zoomBox=null,this.pinchZoom&&this.pinchZoom.destroy(),this.pinchZoom=null,OpenLayers.Control.prototype.destroy.apply(this,arguments)},activate:function(){return this.dragPan.activate(),this.zoomWheelEnabled&&this.handlers.wheel.activate(),this.handlers.click.activate(),this.zoomBoxEnabled&&this.zoomBox.activate(),this.pinchZoom&&this.pinchZoom.activate(),OpenLayers.Control.prototype.activate.apply(this,arguments)},deactivate:function(){return this.pinchZoom&&this.pinchZoom.deactivate(),this.zoomBox.deactivate(),this.dragPan.deactivate(),this.handlers.click.deactivate(),this.handlers.wheel.deactivate(),OpenLayers.Control.prototype.deactivate.apply(this,arguments)},draw:function(){this.handleRightClicks&&(this.map.viewPortDiv.oncontextmenu=OpenLayers.Function.False);var e={click:this.defaultClick,dblclick:this.defaultDblClick,dblrightclick:this.defaultDblRightClick},t={"double":!0,stopDouble:!0};this.handlers.click=new OpenLayers.Handler.Click(this,e,t),this.dragPan=new OpenLayers.Control.DragPan(OpenLayers.Util.extend({map:this.map,documentDrag:this.documentDrag},this.dragPanOptions)),this.zoomBox=new OpenLayers.Control.ZoomBox({map:this.map,keyMask:this.zoomBoxKeyMask}),this.dragPan.draw(),this.zoomBox.draw(),this.handlers.wheel=new OpenLayers.Handler.MouseWheel(this,{up:this.wheelUp,down:this.wheelDown},this.mouseWheelOptions),OpenLayers.Control.PinchZoom&&(this.pinchZoom=new OpenLayers.Control.PinchZoom(OpenLayers.Util.extend({map:this.map},this.pinchZoomOptions)))},defaultClick:function(e){e.lastTouches&&e.lastTouches.length==2&&this.map.zoomOut()},defaultDblClick:function(e){var t=this.map.getLonLatFromViewPortPx(e.xy);this.map.setCenter(t,this.map.zoom+1)},defaultDblRightClick:function(e){var t=this.map.getLonLatFromViewPortPx(e.xy);this.map.setCenter(t,this.map.zoom-1)},wheelChange:function(e,t){var n=this.map.getZoom(),r=this.map.getZoom()+Math.round(t);r=Math.max(r,0),r=Math.min(r,this.map.getNumZoomLevels());if(r===n)return;var i=this.map.getSize(),s=i.w/2-e.xy.x,o=e.xy.y-i.h/2,u=this.map.baseLayer.getResolutionForZoom(r),a=this.map.getLonLatFromPixel(e.xy),f=new OpenLayers.LonLat(a.lon+s*u,a.lat+o*u);this.map.setCenter(f,r)},wheelUp:function(e,t){this.wheelChange(e,t||1)},wheelDown:function(e,t){this.wheelChange(e,t||-1)},disableZoomBox:function(){this.zoomBoxEnabled=!1,this.zoomBox.deactivate()},enableZoomBox:function(){this.zoomBoxEnabled=!0,this.active&&this.zoomBox.activate()},disableZoomWheel:function(){this.zoomWheelEnabled=!1,this.handlers.wheel.deactivate()},enableZoomWheel:function(){this.zoomWheelEnabled=!0,this.active&&this.handlers.wheel.activate()},CLASS_NAME:"OpenLayers.Control.Navigation"}),OpenLayers.Handler.Hover=OpenLayers.Class(OpenLayers.Handler,{delay:500,pixelTolerance:null,stopMove:!1,px:null,timerId:null,mousemove:function(e){return this.passesTolerance(e.xy)&&(this.clearTimer(),this.callback("move",[e]),this.px=e.xy,e=OpenLayers.Util.extend({},e),this.timerId=window.setTimeout(OpenLayers.Function.bind(this.delayedCall,this,e),this.delay)),!this.stopMove},mouseout:function(e){return OpenLayers.Util.mouseLeft(e,this.map.viewPortDiv)&&(this.clearTimer(),this.callback("move",[e])),!0},passesTolerance:function(e){var t=!0;if(this.pixelTolerance&&this.px){var n=Math.sqrt(Math.pow(this.px.x-e.x,2)+Math.pow(this.px.y-e.y,2));n<this.pixelTolerance&&(t=!1)}return t},clearTimer:function(){this.timerId!=null&&(window.clearTimeout(this.timerId),this.timerId=null)},delayedCall:function(e){this.callback("pause",[e])},deactivate:function(){var e=!1;return OpenLayers.Handler.prototype.deactivate.apply(this,arguments)&&(this.clearTimer(),e=!0),e},CLASS_NAME:"OpenLayers.Handler.Hover"}),OpenLayers.Format.WKT=OpenLayers.Class(OpenLayers.Format,{initialize:function(e){this.regExes={typeStr:/^\s*(\w+)\s*\(\s*(.*)\s*\)\s*$/,spaces:/\s+/,parenComma:/\)\s*,\s*\(/,doubleParenComma:/\)\s*\)\s*,\s*\(\s*\(/,trimParens:/^\s*\(?(.*?)\)?\s*$/},OpenLayers.Format.prototype.initialize.apply(this,[e])},read:function(e){var t,n,r;e=e.replace(/[\n\r]/g," ");var i=this.regExes.typeStr.exec(e);if(i){n=i[1].toLowerCase(),r=i[2],this.parse[n]&&(t=this.parse[n].apply(this,[r]));if(this.internalProjection&&this.externalProjection)if(t&&t.CLASS_NAME=="OpenLayers.Feature.Vector")t.geometry.transform(this.externalProjection,this.internalProjection);else if(t&&n!="geometrycollection"&&typeof t=="object")for(var s=0,o=t.length;s<o;s++){var u=t[s];u.geometry.transform(this.externalProjection,this.internalProjection)}}return t},write:function(e){var t,n,r,i,s;e.constructor==Array?(t=e,s=!0):(t=[e],s=!1);var o=[];s&&o.push("GEOMETRYCOLLECTION(");for(var u=0,a=t.length;u<a;++u)s&&u>0&&o.push(","),n=t[u].geometry,o.push(this.extractGeometry(n));return s&&o.push(")"),o.join("")},extractGeometry:function(e){var t=e.CLASS_NAME.split(".")[2].toLowerCase();if(!this.extract[t])return null;this.internalProjection&&this.externalProjection&&(e=e.clone(),e.transform(this.internalProjection,this.externalProjection));var n=t=="collection"?"GEOMETRYCOLLECTION":t.toUpperCase(),r=n+"("+this.extract[t].apply(this,[e])+")";return r},extract:{point:function(e){return e.x+" "+e.y},multipoint:function(e){var t=[];for(var n=0,r=e.components.length;n<r;++n)t.push("("+this.extract.point.apply(this,[e.components[n]])+")");return t.join(",")},linestring:function(e){var t=[];for(var n=0,r=e.components.length;n<r;++n)t.push(this.extract.point.apply(this,[e.components[n]]));return t.join(",")},multilinestring:function(e){var t=[];for(var n=0,r=e.components.length;n<r;++n)t.push("("+this.extract.linestring.apply(this,[e.components[n]])+")");return t.join(",")},polygon:function(e){var t=[];for(var n=0,r=e.components.length;n<r;++n)t.push("("+this.extract.linestring.apply(this,[e.components[n]])+")");return t.join(",")},multipolygon:function(e){var t=[];for(var n=0,r=e.components.length;n<r;++n)t.push("("+this.extract.polygon.apply(this,[e.components[n]])+")");return t.join(",")},collection:function(e){var t=[];for(var n=0,r=e.components.length;n<r;++n)t.push(this.extractGeometry.apply(this,[e.components[n]]));return t.join(",")}},parse:{point:function(e){var t=OpenLayers.String.trim(e).split(this.regExes.spaces);return new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Point(t[0],t[1]))},multipoint:function(e){var t,n=OpenLayers.String.trim(e).split(","),r=[];for(var i=0,s=n.length;i<s;++i)t=n[i].replace(this.regExes.trimParens,"$1"),r.push(this.parse.point.apply(this,[t]).geometry);return new OpenLayers.Feature.Vector(new OpenLayers.Geometry.MultiPoint(r))},linestring:function(e){var t=OpenLayers.String.trim(e).split(","),n=[];for(var r=0,i=t.length;r<i;++r)n.push(this.parse.point.apply(this,[t[r]]).geometry);return new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString(n))},multilinestring:function(e){var t,n=OpenLayers.String.trim(e).split(this.regExes.parenComma),r=[];for(var i=0,s=n.length;i<s;++i)t=n[i].replace(this.regExes.trimParens,"$1"),r.push(this.parse.linestring.apply(this,[t]).geometry);return new OpenLayers.Feature.Vector(new OpenLayers.Geometry.MultiLineString(r))},polygon:function(e){var t,n,r,i=OpenLayers.String.trim(e).split(this.regExes.parenComma),s=[];for(var o=0,u=i.length;o<u;++o)t=i[o].replace(this.regExes.trimParens,"$1"),n=this.parse.linestring.apply(this,[t]).geometry,r=new OpenLayers.Geometry.LinearRing(n.components),s.push(r);return new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Polygon(s))},multipolygon:function(e){var t,n=OpenLayers.String.trim(e).split(this.regExes.doubleParenComma),r=[];for(var i=0,s=n.length;i<s;++i)t=n[i].replace(this.regExes.trimParens,"$1"),r.push(this.parse.polygon.apply(this,[t]).geometry);return new OpenLayers.Feature.Vector(new OpenLayers.Geometry.MultiPolygon(r))},geometrycollection:function(e){e=e.replace(/,\s*([A-Za-z])/g,"|$1");var t=OpenLayers.String.trim(e).split("|"),n=[];for(var r=0,i=t.length;r<i;++r)n.push(OpenLayers.Format.WKT.prototype.read.apply(this,[t[r]]));return n}},CLASS_NAME:"OpenLayers.Format.WKT"}),OpenLayers.Layer.WMS=OpenLayers.Class(OpenLayers.Layer.Grid,{DEFAULT_PARAMS:{service:"WMS",version:"1.1.1",request:"GetMap",styles:"",format:"image/jpeg"},isBaseLayer:!0,encodeBBOX:!1,noMagic:!1,yx:{},initialize:function(e,t,n,r){var i=[];n=OpenLayers.Util.upperCaseObject(n),parseFloat(n.VERSION)>=1.3&&!n.EXCEPTIONS&&(n.EXCEPTIONS="INIMAGE"),i.push(e,t,n,r),OpenLayers.Layer.Grid.prototype.initialize.apply(this,i),OpenLayers.Util.applyDefaults(this.params,OpenLayers.Util.upperCaseObject(this.DEFAULT_PARAMS));if(!this.noMagic&&this.params.TRANSPARENT&&this.params.TRANSPARENT.toString().toLowerCase()=="true"){if(r==null||!r.isBaseLayer)this.isBaseLayer=!1;this.params.FORMAT=="image/jpeg"&&(this.params.FORMAT=OpenLayers.Util.alphaHack()?"image/gif":"image/png")}},clone:function(e){return e==null&&(e=new OpenLayers.Layer.WMS(this.name,this.url,this.params,this.getOptions())),e=OpenLayers.Layer.Grid.prototype.clone.apply(this,[e]),e},reverseAxisOrder:function(){var e=this.projection.getCode();return parseFloat(this.params.VERSION)>=1.3&&(!!this.yx[e]||!!OpenLayers.Projection.defaults[e].yx)},getURL:function(e){e=this.adjustBounds(e);var t=this.getImageSize(),n={},r=this.reverseAxisOrder();n.BBOX=this.encodeBBOX?e.toBBOX(null,r):e.toArray(r),n.WIDTH=t.w,n.HEIGHT=t.h;var i=this.getFullRequestString(n);return i},mergeNewParams:function(e){var t=OpenLayers.Util.upperCaseObject(e),n=[t];return OpenLayers.Layer.Grid.prototype.mergeNewParams.apply(this,n)},getFullRequestString:function(e,t){var n=this.map.getProjectionObject(),r=this.projection&&this.projection.equals(n)?this.projection.getCode():n.getCode(),i=r=="none"?null:r;return parseFloat(this.params.VERSION)>=1.3?this.params.CRS=i:this.params.SRS=i,typeof this.params.TRANSPARENT=="boolean"&&(e.TRANSPARENT=this.params.TRANSPARENT?"TRUE":"FALSE"),OpenLayers.Layer.Grid.prototype.getFullRequestString.apply(this,arguments)},CLASS_NAME:"OpenLayers.Layer.WMS"}),OpenLayers.StyleMap=OpenLayers.Class({styles:null,extendDefault:!0,initialize:function(e,t){this.styles={"default":new OpenLayers.Style(OpenLayers.Feature.Vector.style["default"]),select:new OpenLayers.Style(OpenLayers.Feature.Vector.style.select),temporary:new OpenLayers.Style(OpenLayers.Feature.Vector.style.temporary),"delete":new OpenLayers.Style(OpenLayers.Feature.Vector.style["delete"])};if(e instanceof OpenLayers.Style)this.styles["default"]=e,this.styles.select=e,this.styles.temporary=e,this.styles["delete"]=e;else if(typeof e=="object")for(var n in e)if(e[n]instanceof OpenLayers.Style)this.styles[n]=e[n];else{if(typeof e[n]!="object"){this.styles["default"]=new OpenLayers.Style(e),this.styles.select=new OpenLayers.Style(e),this.styles.temporary=new OpenLayers.Style(e),this.styles["delete"]=new OpenLayers.Style(e);break}this.styles[n]=new OpenLayers.Style(e[n])}OpenLayers.Util.extend(this,t)},destroy:function(){for(var e in this.styles)this.styles[e].destroy();this.styles=null},createSymbolizer:function(e,t){e||(e=new OpenLayers.Feature.Vector),this.styles[t]||(t="default"),e.renderIntent=t;var n={};return this.extendDefault&&t!="default"&&(n=this.styles["default"].createSymbolizer(e)),OpenLayers.Util.extend(n,this.styles[t].createSymbolizer(e))},addUniqueValueRules:function(e,t,n,r){var i=[];for(var s in n)i.push(new OpenLayers.Rule({symbolizer:n[s],context:r,filter:new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.EQUAL_TO,property:t,value:s})}));this.styles[e].addRules(i)},CLASS_NAME:"OpenLayers.StyleMap"}),OpenLayers.Layer.Vector=OpenLayers.Class(OpenLayers.Layer,{isBaseLayer:!1,isFixed:!1,features:null,filter:null,selectedFeatures:null,unrenderedFeatures:null,reportError:!0,style:null,styleMap:null,strategies:null,protocol:null,renderers:["SVG","VML","Canvas"],renderer:null,rendererOptions:null,geometryType:null,drawn:!1,ratio:1,initialize:function(e,t){OpenLayers.Layer.prototype.initialize.apply(this,arguments),(!this.renderer||!this.renderer.supported())&&this.assignRenderer();if(!this.renderer||!this.renderer.supported())this.renderer=null,this.displayError();this.styleMap||(this.styleMap=new OpenLayers.StyleMap),this.features=[],this.selectedFeatures=[],this.unrenderedFeatures={};if(this.strategies)for(var n=0,r=this.strategies.length;n<r;n++)this.strategies[n].setLayer(this)},destroy:function(){if(this.strategies){var e,t,n;for(t=0,n=this.strategies.length;t<n;t++)e=this.strategies[t],e.autoDestroy&&e.destroy();this.strategies=null}this.protocol&&(this.protocol.autoDestroy&&this.protocol.destroy(),this.protocol=null),this.destroyFeatures(),this.features=null,this.selectedFeatures=null,this.unrenderedFeatures=null,this.renderer&&this.renderer.destroy(),this.renderer=null,this.geometryType=null,this.drawn=null,OpenLayers.Layer.prototype.destroy.apply(this,arguments)},clone:function(e){e==null&&(e=new OpenLayers.Layer.Vector(this.name,this.getOptions())),e=OpenLayers.Layer.prototype.clone.apply(this,[e]);var t=this.features,n=t.length,r=new Array(n);for(var i=0;i<n;++i)r[i]=t[i].clone();return e.features=r,e},refresh:function(e){this.calculateInRange()&&this.visibility&&this.events.triggerEvent("refresh",e)},assignRenderer:function(){for(var e=0,t=this.renderers.length;e<t;e++){var n=this.renderers[e],r=typeof n=="function"?n:OpenLayers.Renderer[n];if(r&&r.prototype.supported()){this.renderer=new r(this.div,this.rendererOptions);break}}},displayError:function(){this.reportError&&OpenLayers.Console.userError(OpenLayers.i18n("browserNotSupported",{renderers:this.renderers.join("\n")}))},setMap:function(e){OpenLayers.Layer.prototype.setMap.apply(this,arguments);if(!this.renderer)this.map.removeLayer(this);else{this.renderer.map=this.map;var t=this.map.getSize();t.w=t.w*this.ratio,t.h=t.h*this.ratio,this.renderer.setSize(t)}},afterAdd:function(){if(this.strategies){var e,t,n;for(t=0,n=this.strategies.length;t<n;t++)e=this.strategies[t],e.autoActivate&&e.activate()}},removeMap:function(e){this.drawn=!1;if(this.strategies){var t,n,r;for(n=0,r=this.strategies.length;n<r;n++)t=this.strategies[n],t.autoActivate&&t.deactivate()}},onMapResize:function(){OpenLayers.Layer.prototype.onMapResize.apply(this,arguments);var e=this.map.getSize();e.w=e.w*this.ratio,e.h=e.h*this.ratio,this.renderer.setSize(e)},moveTo:function(e,t,n){OpenLayers.Layer.prototype.moveTo.apply(this,arguments);var r=!0;if(!n){this.renderer.root.style.visibility="hidden";var i=this.map.getSize(),s=i.w,o=i.h,u=s/2*this.ratio-s/2,a=o/2*this.ratio-o/2;u+=parseInt(this.map.layerContainerDiv.style.left,10),u=-Math.round(u),a+=parseInt(this.map.layerContainerDiv.style.top,10),a=-Math.round(a),this.div.style.left=u+"px",this.div.style.top=a+"px";var f=this.map.getExtent().scale(this.ratio);r=this.renderer.setExtent(f,t),this.renderer.root.style.visibility="visible",OpenLayers.IS_GECKO===!0&&(this.div.scrollLeft=this.div.scrollLeft);if(!t&&r)for(var l in this.unrenderedFeatures){var c=this.unrenderedFeatures[l];this.drawFeature(c)}}if(!this.drawn||t||!r){this.drawn=!0;var c;for(var l=0,h=this.features.length;l<h;l++)this.renderer.locked=l!==h-1,c=this.features[l],this.drawFeature(c)}},display:function(e){OpenLayers.Layer.prototype.display.apply(this,arguments);var t=this.div.style.display;t!=this.renderer.root.style.display&&(this.renderer.root.style.display=t)},addFeatures:function(e,t){OpenLayers.Util.isArray(e)||(e=[e]);var n=!t||!t.silent;if(n){var r={features:e},i=this.events.triggerEvent("beforefeaturesadded",r);if(i===!1)return;e=r.features}var s=[];for(var o=0,u=e.length;o<u;o++){o!=e.length-1?this.renderer.locked=!0:this.renderer.locked=!1;var a=e[o];if(!(!this.geometryType||a.geometry instanceof this.geometryType))throw new TypeError("addFeatures: component should be an "+this.geometryType.prototype.CLASS_NAME);a.layer=this,!a.style&&this.style&&(a.style=OpenLayers.Util.extend({},this.style));if(n){if(this.events.triggerEvent("beforefeatureadded",{feature:a})===!1)continue;this.preFeatureInsert(a)}s.push(a),this.features.push(a),this.drawFeature(a),n&&(this.events.triggerEvent("featureadded",{feature:a}),this.onFeatureInsert(a))}n&&this.events.triggerEvent("featuresadded",{features:s})},removeFeatures:function(e,t){if(!e||e.length===0)return;if(e===this.features)return this.removeAllFeatures(t);OpenLayers.Util.isArray(e)||(e=[e]),e===this.selectedFeatures&&(e=e.slice());var n=!t||!t.silent;n&&this.events.triggerEvent("beforefeaturesremoved",{features:e});for(var r=e.length-1;r>=0;r--){r!=0&&e[r-1].geometry?this.renderer.locked=!0:this.renderer.locked=!1;var i=e[r];delete this.unrenderedFeatures[i.id],n&&this.events.triggerEvent("beforefeatureremoved",{feature:i}),this.features=OpenLayers.Util.removeItem(this.features,i),i.layer=null,i.geometry&&this.renderer.eraseFeatures(i),OpenLayers.Util.indexOf(this.selectedFeatures,i)!=-1&&OpenLayers.Util.removeItem(this.selectedFeatures,i),n&&this.events.triggerEvent("featureremoved",{feature:i})}n&&this.events.triggerEvent("featuresremoved",{features:e})},removeAllFeatures:function(e){var t=!e||!e.silent,n=this.features;t&&this.events.triggerEvent("beforefeaturesremoved",{features:n});var r;for(var i=n.length-1;i>=0;i--)r=n[i],t&&this.events.triggerEvent("beforefeatureremoved",{feature:r}),r.layer=null,t&&this.events.triggerEvent("featureremoved",{feature:r});this.renderer.clear(),this.features=[],this.unrenderedFeatures={},this.selectedFeatures=[],t&&this.events.triggerEvent("featuresremoved",{features:n})},destroyFeatures:function(e,t){var n=e==undefined;n&&(e=this.features);if(e){this.removeFeatures(e,t);for(var r=e.length-1;r>=0;r--)e[r].destroy()}},drawFeature:function(e,t){if(!this.drawn)return;if(typeof t!="object"){!t&&e.state===OpenLayers.State.DELETE&&(t="delete");var n=t||e.renderIntent;t=e.style||this.style,t||(t=this.styleMap.createSymbolizer(e,n))}var r=this.renderer.drawFeature(e,t);r===!1||r===null?this.unrenderedFeatures[e.id]=e:delete this.unrenderedFeatures[e.id]},eraseFeatures:function(e){this.renderer.eraseFeatures(e)},getFeatureFromEvent:function(e){if(!this.renderer)throw new Error("getFeatureFromEvent called on layer with no renderer. This usually means you destroyed a layer, but not some handler which is associated with it.");var t=null,n=this.renderer.getFeatureIdFromEvent(e);return n&&(typeof n=="string"?t=this.getFeatureById(n):t=n),t},getFeatureBy:function(e,t){var n=null;for(var r=0,i=this.features.length;r<i;++r)if(this.features[r][e]==t){n=this.features[r];break}return n},getFeatureById:function(e){return this.getFeatureBy("id",e)},getFeatureByFid:function(e){return this.getFeatureBy("fid",e)},getFeaturesByAttribute:function(e,t){var n,r,i=this.features.length,s=[];for(n=0;n<i;n++)r=this.features[n],r&&r.attributes&&r.attributes[e]===t&&s.push(r);return s},onFeatureInsert:function(e){},preFeatureInsert:function(e){},getDataExtent:function(){var e=null,t=this.features;if(t&&t.length>0){var n=null;for(var r=0,i=t.length;r<i;r++)n=t[r].geometry,n&&(e===null&&(e=new OpenLayers.Bounds),e.extend(n.getBounds()))}return e},CLASS_NAME:"OpenLayers.Layer.Vector"}),OpenLayers.Handler.Point=OpenLayers.Class(OpenLayers.Handler,{point:null,layer:null,multi:!1,citeCompliant:!1,mouseDown:!1,stoppedDown:null,lastDown:null,lastUp:null,persist:!1,stopDown:!1,stopUp:!1,layerOptions:null,pixelTolerance:5,touch:!1,lastTouchPx:null,initialize:function(e,t,n){n&&n.layerOptions&&n.layerOptions.styleMap||(this.style=OpenLayers.Util.extend(OpenLayers.Feature.Vector.style["default"],{})),OpenLayers.Handler.prototype.initialize.apply(this,arguments)},activate:function(){if(!OpenLayers.Handler.prototype.activate.apply(this,arguments))return!1;var e=OpenLayers.Util.extend({displayInLayerSwitcher:!1,calculateInRange:OpenLayers.Function.True,wrapDateLine:this.citeCompliant},this.layerOptions);return this.layer=new OpenLayers.Layer.Vector(this.CLASS_NAME,e),this.map.addLayer(this.layer),!0},createFeature:function(e){var t=this.layer.getLonLatFromViewPortPx(e),n=new OpenLayers.Geometry.Point(t.lon,t.lat);this.point=new OpenLayers.Feature.Vector(n),this.callback("create",[this.point.geometry,this.point]),this.point.geometry.clearBounds(),this.layer.addFeatures([this.point],{silent:!0})},deactivate:function(){return OpenLayers.Handler.prototype.deactivate.apply(this,arguments)?(this.cancel(),this.layer.map!=null&&(this.destroyFeature(!0),this.layer.destroy(!1)),this.layer=null,this.touch=!1,!0):!1},destroyFeature:function(e){this.layer&&(e||!this.persist)&&this.layer.destroyFeatures(),this.point=null},destroyPersistedFeature:function(){var e=this.layer;e&&e.features.length>1&&this.layer.features[0].destroy()},finalize:function(e){var t=e?"cancel":"done";this.mouseDown=!1,this.lastDown=null,this.lastUp=null,this.lastTouchPx=null,this.callback(t,[this.geometryClone()]),this.destroyFeature(e)},cancel:function(){this.finalize(!0)},click:function(e){return OpenLayers.Event.stop(e),!1},dblclick:function(e){return OpenLayers.Event.stop(e),!1},modifyFeature:function(e){this.point||this.createFeature(e);var t=this.layer.getLonLatFromViewPortPx(e);this.point.geometry.x=t.lon,this.point.geometry.y=t.lat,this.callback("modify",[this.point.geometry,this.point,!1]),this.point.geometry.clearBounds(),this.drawFeature()},drawFeature:function(){this.layer.drawFeature(this.point,this.style)},getGeometry:function(){var e=this.point&&this.point.geometry;return e&&this.multi&&(e=new OpenLayers.Geometry.MultiPoint([e])),e},geometryClone:function(){var e=this.getGeometry();return e&&e.clone()},mousedown:function(e){return this.down(e)},touchstart:function(e){return this.touch||(this.touch=!0,this.map.events.un({mousedown:this.mousedown,mouseup:this.mouseup,mousemove:this.mousemove,click:this.click,dblclick:this.dblclick,scope:this})),this.lastTouchPx=e.xy,this.down(e)},mousemove:function(e){return this.move(e)},touchmove:function(e){return this.lastTouchPx=e.xy,this.move(e)},mouseup:function(e){return this.up(e)},touchend:function(e){return e.xy=this.lastTouchPx,this.up(e)},down:function(e){return this.mouseDown=!0,this.lastDown=e.xy,this.touch||this.modifyFeature(e.xy),this.stoppedDown=this.stopDown,!this.stopDown},move:function(e){return!this.touch&&(!this.mouseDown||this.stoppedDown)&&this.modifyFeature(e.xy),!0},up:function(e){return this.mouseDown=!1,this.stoppedDown=this.stopDown,this.checkModifiers(e)?this.lastUp&&this.lastUp.equals(e.xy)?!0:this.lastDown&&this.passesTolerance(this.lastDown,e.xy,this.pixelTolerance)?(this.touch&&this.modifyFeature(e.xy),this.persist&&this.destroyPersistedFeature(),this.lastUp=e.xy,this.finalize(),!this.stopUp):!0:!0},mouseout:function(e){OpenLayers.Util.mouseLeft(e,this.map.viewPortDiv)&&(this.stoppedDown=this.stopDown,this.mouseDown=!1)},passesTolerance:function(e,t,n){var r=!0;if(n!=null&&e&&t){var i=e.distanceTo(t);i>n&&(r=!1)}return r},CLASS_NAME:"OpenLayers.Handler.Point"}),OpenLayers.Handler.Path=OpenLayers.Class(OpenLayers.Handler.Point,{line:null,maxVertices:null,doubleTouchTolerance:20,freehand:!1,freehandToggle:"shiftKey",timerId:null,redoStack:null,createFeature:function(e){var t=this.layer.getLonLatFromViewPortPx(e),n=new OpenLayers.Geometry.Point(t.lon,t.lat);this.point=new OpenLayers.Feature.Vector(n),this.line=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString([this.point.geometry])),this.callback("create",[this.point.geometry,this.getSketch()]),this.point.geometry.clearBounds(),this.layer.addFeatures([this.line,this.point],{silent:!0})},destroyFeature:function(e){OpenLayers.Handler.Point.prototype.destroyFeature.call(this,e),this.line=null},destroyPersistedFeature:function(){var e=this.layer;e&&e.features.length>2&&this.layer.features[0].destroy()},removePoint:function(){this.point&&this.layer.removeFeatures([this.point])},addPoint:function(e){this.layer.removeFeatures([this.point]);var t=this.layer.getLonLatFromViewPortPx(e);this.point=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Point(t.lon,t.lat)),this.line.geometry.addComponent(this.point.geometry,this.line.geometry.components.length),this.layer.addFeatures([this.point]),this.callback("point",[this.point.geometry,this.getGeometry()]),this.callback("modify",[this.point.geometry,this.getSketch()]),this.drawFeature(),delete this.redoStack},insertXY:function(e,t){this.line.geometry.addComponent(new OpenLayers.Geometry.Point(e,t),this.getCurrentPointIndex()),this.drawFeature(),delete this.redoStack},insertDeltaXY:function(e,t){var n=this.getCurrentPointIndex()-1,r=this.line.geometry.components[n];r&&!isNaN(r.x)&&!isNaN(r.y)&&this.insertXY(r.x+e,r.y+t)},insertDirectionLength:function(e,t){e*=Math.PI/180;var n=t*Math.cos(e),r=t*Math.sin(e);this.insertDeltaXY(n,r)},insertDeflectionLength:function(e,t){var n=this.getCurrentPointIndex()-1;if(n>0){var r=this.line.geometry.components[n],i=this.line.geometry.components[n-1],s=Math.atan2(r.y-i.y,r.x-i.x);this.insertDirectionLength(s*180/Math.PI+e,t)}},getCurrentPointIndex:function(){return this.line.geometry.components.length-1},undo:function(){var e=this.line.geometry,t=e.components,n=this.getCurrentPointIndex()-1,r=t[n],i=e.removeComponent(r);return i&&(this.redoStack||(this.redoStack=[]),this.redoStack.push(r),this.drawFeature()),i},redo:function(){var e=this.redoStack&&this.redoStack.pop();return e&&(this.line.geometry.addComponent(e,this.getCurrentPointIndex()),this.drawFeature()),!!e},freehandMode:function(e){return this.freehandToggle&&e[this.freehandToggle]?!this.freehand:this.freehand},modifyFeature:function(e,t){this.line||this.createFeature(e);var n=this.layer.getLonLatFromViewPortPx(e);this.point.geometry.x=n.lon,this.point.geometry.y=n.lat,this.callback("modify",[this.point.geometry,this.getSketch(),t]),this.point.geometry.clearBounds(),this.drawFeature()},drawFeature:function(){this.layer.drawFeature(this.line,this.style),this.layer.drawFeature(this.point,this.style)},getSketch:function(){return this.line},getGeometry:function(){var e=this.line&&this.line.geometry;return e&&this.multi&&(e=new OpenLayers.Geometry.MultiLineString([e])),e},touchstart:function(e){return this.timerId&&this.passesTolerance(this.lastTouchPx,e.xy,this.doubleTouchTolerance)?(this.finishGeometry(),window.clearTimeout(this.timerId),this.timerId=null,!1):(this.timerId&&(window.clearTimeout(this.timerId),this.timerId=null),this.timerId=window.setTimeout(OpenLayers.Function.bind(function(){this.timerId=null},this),300),OpenLayers.Handler.Point.prototype.touchstart.call(this,e))},down:function(e){var t=this.stopDown;return this.freehandMode(e)&&(t=!0,this.touch&&(this.modifyFeature(e.xy,!!this.lastUp),OpenLayers.Event.stop(e))),!this.touch&&(!this.lastDown||!this.passesTolerance(this.lastDown,e.xy,this.pixelTolerance))&&this.modifyFeature(e.xy,!!this.lastUp),this.mouseDown=!0,this.lastDown=e.xy,this.stoppedDown=t,!t},move:function(e){return this.stoppedDown&&this.freehandMode(e)?(this.persist&&this.destroyPersistedFeature(),this.maxVertices&&this.line&&this.line.geometry.components.length===this.maxVertices?(this.removePoint(),this.finalize()):this.addPoint(e.xy),!1):(!this.touch&&(!this.mouseDown||this.stoppedDown)&&this.modifyFeature(e.xy,!!this.lastUp),!0)},up:function(e){return this.mouseDown&&(!this.lastUp||!this.lastUp.equals(e.xy))&&(this.stoppedDown&&this.freehandMode(e)?(this.persist&&this.destroyPersistedFeature(),this.removePoint(),this.finalize()):this.passesTolerance(this.lastDown,e.xy,this.pixelTolerance)&&(this.touch&&this.modifyFeature(e.xy),this.lastUp==null&&this.persist&&this.destroyPersistedFeature(),this.addPoint(e.xy),this.lastUp=e.xy,this.line.geometry.components.length===this.maxVertices+1&&this.finishGeometry())),this.stoppedDown=this.stopDown,this.mouseDown=!1,!this.stopUp},finishGeometry:function(){var e=this.line.geometry.components.length-1;this.line.geometry.removeComponent(this.line.geometry.components[e]),this.removePoint(),this.finalize()},dblclick:function(e){return this.freehandMode(e)||this.finishGeometry(),!1},CLASS_NAME:"OpenLayers.Handler.Path"}),OpenLayers.Handler.Polygon=OpenLayers.Class(OpenLayers.Handler.Path,{holeModifier:null,drawingHole:!1,polygon:null,createFeature:function(e){var t=this.layer.getLonLatFromViewPortPx(e),n=new OpenLayers.Geometry.Point(t.lon,t.lat);this.point=new OpenLayers.Feature.Vector(n),this.line=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LinearRing([this.point.geometry])),this.polygon=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Polygon([this.line.geometry])),this.callback("create",[this.point.geometry,this.getSketch()]),this.point.geometry.clearBounds(),this.layer.addFeatures([this.polygon,this.point],{silent:!0})},addPoint:function(e){if(!this.drawingHole&&this.holeModifier&&this.evt&&this.evt[this.holeModifier]){var t=this.point.geometry,n=this.control.layer.features,r,i;for(var s=n.length-1;s>=0;--s){r=n[s].geometry;if((r instanceof OpenLayers.Geometry.Polygon||r instanceof OpenLayers.Geometry.MultiPolygon)&&r.intersects(t)){i=n[s],this.control.layer.removeFeatures([i],{silent:!0}),this.control.layer.events.registerPriority("sketchcomplete",this,this.finalizeInteriorRing),this.control.layer.events.registerPriority("sketchmodified",this,this.enforceTopology),i.geometry.addComponent(this.line.geometry),this.polygon=i,this.drawingHole=!0;break}}}OpenLayers.Handler.Path.prototype.addPoint.apply(this,arguments)},getCurrentPointIndex:function(){return this.line.geometry.components.length-2},enforceTopology:function(e){var t=e.vertex,n=this.line.geometry.components;if(!this.polygon.geometry.intersects(t)){var r=n[n.length-3];t.x=r.x,t.y=r.y}},finishGeometry:function(){var e=this.line.geometry.components.length-2;this.line.geometry.removeComponent(this.line.geometry.components[e]),this.removePoint(),this.finalize()},finalizeInteriorRing:function(){var e=this.line.geometry,t=e.getArea()!==0;if(t){var n=this.polygon.geometry.components;for(var r=n.length-2;r>=0;--r)if(e.intersects(n[r])){t=!1;break}if(t){var i;e:for(var r=n.length-2;r>0;--r){var s=n[r].components;for(var o=0,u=s.length;o<u;++o)if(e.containsPoint(s[o])){t=!1;break e}}}}return t?this.polygon.state!==OpenLayers.State.INSERT&&(this.polygon.state=OpenLayers.State.UPDATE):this.polygon.geometry.removeComponent(e),this.restoreFeature(),!1},cancel:function(){return this.drawingHole&&(this.polygon.geometry.removeComponent(this.line.geometry),this.restoreFeature(!0)),OpenLayers.Handler.Path.prototype.cancel.apply(this,arguments)},restoreFeature:function(e){this.control.layer.events.unregister("sketchcomplete",this,this.finalizeInteriorRing),this.control.layer.events.unregister("sketchmodified",this,this.enforceTopology),this.layer.removeFeatures([this.polygon],{silent:!0}),this.control.layer.addFeatures([this.polygon],{silent:!0}),this.drawingHole=!1,e||this.control.layer.events.triggerEvent("sketchcomplete",{feature:this.polygon})},destroyFeature:function(e){OpenLayers.Handler.Path.prototype.destroyFeature.call(this,e),this.polygon=null},drawFeature:function(){this.layer.drawFeature(this.polygon,this.style),this.layer.drawFeature(this.point,this.style)},getSketch:function(){return this.polygon},getGeometry:function(){var e=this.polygon&&this.polygon.geometry;return e&&this.multi&&(e=new OpenLayers.Geometry.MultiPolygon([e])),e},CLASS_NAME:"OpenLayers.Handler.Polygon"}),OpenLayers.Renderer.SVG=OpenLayers.Class(OpenLayers.Renderer.Elements,{xmlns:"http://www.w3.org/2000/svg",xlinkns:"http://www.w3.org/1999/xlink",MAX_PIXEL:15e3,translationParameters:null,symbolMetrics:null,initialize:function(e){if(!this.supported())return;OpenLayers.Renderer.Elements.prototype.initialize.apply(this,arguments),this.translationParameters={x:0,y:0},this.symbolMetrics={}},supported:function(){var e="http://www.w3.org/TR/SVG11/feature#";return document.implementation&&(document.implementation.hasFeature("org.w3c.svg","1.0")||document.implementation.hasFeature(e+"SVG","1.1")||document.implementation.hasFeature(e+"BasicStructure","1.1"))},inValidRange:function(e,t,n){var r=e+(n?0:this.translationParameters.x),i=t+(n?0:this.translationParameters.y);return r>=-this.MAX_PIXEL&&r<=this.MAX_PIXEL&&i>=-this.MAX_PIXEL&&i<=this.MAX_PIXEL},setExtent:function(e,t){var n=OpenLayers.Renderer.Elements.prototype.setExtent.apply(this,arguments),r=this.getResolution(),i=-e.left/r,s=e.top/r;if(t){this.left=i,this.top=s;var o="0 0 "+this.size.w+" "+this.size.h;return this.rendererRoot.setAttributeNS(null,"viewBox",o),this.translate(this.xOffset,0),!0}var u=this.translate(i-this.left+this.xOffset,s-this.top);return u||this.setExtent(e,!0),n&&u},translate:function(e,t){if(!this.inValidRange(e,t,!0))return!1;var n="";if(e||t)n="translate("+e+","+t+")";return this.root.setAttributeNS(null,"transform",n),this.translationParameters={x:e,y:t},!0},setSize:function(e){OpenLayers.Renderer.prototype.setSize.apply(this,arguments),this.rendererRoot.setAttributeNS(null,"width",this.size.w),this.rendererRoot.setAttributeNS(null,"height",this.size.h)},getNodeType:function(e,t){var n=null;switch(e.CLASS_NAME){case"OpenLayers.Geometry.Point":t.externalGraphic?n="image":this.isComplexSymbol(t.graphicName)?n="svg":n="circle";break;case"OpenLayers.Geometry.Rectangle":n="rect";break;case"OpenLayers.Geometry.LineString":n="polyline";break;case"OpenLayers.Geometry.LinearRing":n="polygon";break;case"OpenLayers.Geometry.Polygon":case"OpenLayers.Geometry.Curve":n="path";break;default:}return n},setStyle:function(e,t,n){t=t||e._style,n=n||e._options;var r=parseFloat(e.getAttributeNS(null,"r")),i=1,s;if(e._geometryClass=="OpenLayers.Geometry.Point"&&r){e.style.visibility="";if(t.graphic===!1)e.style.visibility="hidden";else if(t.externalGraphic){s=this.getPosition(e);if(t.graphicTitle){e.setAttributeNS(null,"title",t.graphicTitle);var o=e.getElementsByTagName("title");if(o.length>0)o[0].firstChild.textContent=t.graphicTitle;else{var u=this.nodeFactory(null,"title");u.textContent=t.graphicTitle,e.appendChild(u)}}t.graphicWidth&&t.graphicHeight&&e.setAttributeNS(null,"preserveAspectRatio","none");var a=t.graphicWidth||t.graphicHeight,f=t.graphicHeight||t.graphicWidth;a=a?a:t.pointRadius*2,f=f?f:t.pointRadius*2;var l=t.graphicXOffset!=undefined?t.graphicXOffset:-(.5*a),c=t.graphicYOffset!=undefined?t.graphicYOffset:-(.5*f),h=t.graphicOpacity||t.fillOpacity;e.setAttributeNS(null,"x",(s.x+l).toFixed()),e.setAttributeNS(null,"y",(s.y+c).toFixed()),e.setAttributeNS(null,"width",a),e.setAttributeNS(null,"height",f),e.setAttributeNS(this.xlinkns,"href",t.externalGraphic),e.setAttributeNS(null,"style","opacity: "+h),e.onclick=OpenLayers.Renderer.SVG.preventDefault}else if(this.isComplexSymbol(t.graphicName)){var p=t.pointRadius*3,d=p*2,v=this.importSymbol(t.graphicName);s=this.getPosition(e),i=this.symbolMetrics[v.id][0]*3/d;var m=e.parentNode,g=e.nextSibling;m&&m.removeChild(e),e.firstChild&&e.removeChild(e.firstChild),e.appendChild(v.firstChild.cloneNode(!0)),e.setAttributeNS(null,"viewBox",v.getAttributeNS(null,"viewBox")),e.setAttributeNS(null,"width",d),e.setAttributeNS(null,"height",d),e.setAttributeNS(null,"x",s.x-p),e.setAttributeNS(null,"y",s.y-p),g?m.insertBefore(e,g):m&&m.appendChild(e)}else e.setAttributeNS(null,"r",t.pointRadius);var y=t.rotation;if((y!==undefined||e._rotation!==undefined)&&s){e._rotation=y,y|=0;if(e.nodeName!=="svg")e.setAttributeNS(null,"transform","rotate("+y+" "+s.x+" "+s.y+")");else{var b=this.symbolMetrics[v.id];e.firstChild.setAttributeNS(null,"transform","rotate("+y+" "+b[1]+" "+b[2]+")")}}}return n.isFilled?(e.setAttributeNS(null,"fill",t.fillColor),e.setAttributeNS(null,"fill-opacity",t.fillOpacity)):e.setAttributeNS(null,"fill","none"),n.isStroked?(e.setAttributeNS(null,"stroke",t.strokeColor),e.setAttributeNS(null,"stroke-opacity",t.strokeOpacity),e.setAttributeNS(null,"stroke-width",t.strokeWidth*i),e.setAttributeNS(null,"stroke-linecap",t.strokeLinecap||"round"),e.setAttributeNS(null,"stroke-linejoin","round"),t.strokeDashstyle&&e.setAttributeNS(null,"stroke-dasharray",this.dashStyle(t,i))):e.setAttributeNS(null,"stroke","none"),t.pointerEvents&&e.setAttributeNS(null,"pointer-events",t.pointerEvents),t.cursor!=null&&e.setAttributeNS(null,"cursor",t.cursor),e},dashStyle:function(e,t){var n=e.strokeWidth*t,r=e.strokeDashstyle;switch(r){case"solid":return"none";case"dot":return[1,4*n].join();case"dash":return[4*n,4*n].join();case"dashdot":return[4*n,4*n,1,4*n].join();case"longdash":return[8*n,4*n].join();case"longdashdot":return[8*n,4*n,1,4*n].join();default:return OpenLayers.String.trim(r).replace(/\s+/g,",")}},createNode:function(e,t){var n=document.createElementNS(this.xmlns,e);return t&&n.setAttributeNS(null,"id",t),n},nodeTypeCompare:function(e,t){return t==e.nodeName},createRenderRoot:function(){var e=this.nodeFactory(this.container.id+"_svgRoot","svg");return e.style.display="block",e},createRoot:function(e){return this.nodeFactory(this.container.id+e,"g")},createDefs:function(){var e=this.nodeFactory(this.container.id+"_defs","defs");return this.rendererRoot.appendChild(e),e},drawPoint:function(e,t){return this.drawCircle(e,t,1)},drawCircle:function(e,t,n){var r=this.getResolution(),i=(t.x-this.featureDx)/r+this.left,s=this.top-t.y/r;return this.inValidRange(i,s)?(e.setAttributeNS(null,"cx",i),e.setAttributeNS(null,"cy",s),e.setAttributeNS(null,"r",n),e):!1},drawLineString:function(e,t){var n=this.getComponentsString(t.components);return n.path?(e.setAttributeNS(null,"points",n.path),n.complete?e:null):!1},drawLinearRing:function(e,t){var n=this.getComponentsString(t.components);return n.path?(e.setAttributeNS(null,"points",n.path),n.complete?e:null):!1},drawPolygon:function(e,t){var n="",r=!0,i=!0,s,o;for(var u=0,a=t.components.length;u<a;u++)n+=" M",s=this.getComponentsString(t.components[u].components," "),o=s.path,o?(n+=" "+o,i=s.complete&&i):r=!1;return n+=" z",r?(e.setAttributeNS(null,"d",n),e.setAttributeNS(null,"fill-rule","evenodd"),i?e:null):!1},drawRectangle:function(e,t){var n=this.getResolution(),r=(t.x-this.featureDx)/n+this.left,i=this.top-t.y/n;return this.inValidRange(r,i)?(e.setAttributeNS(null,"x",r),e.setAttributeNS(null,"y",i),e.setAttributeNS(null,"width",t.width/n),e.setAttributeNS(null,"height",t.height/n),e):!1},drawText:function(e,t,n){var r=!!t.labelOutlineWidth;if(r){var i=OpenLayers.Util.extend({},t);i.fontColor=i.labelOutlineColor,i.fontStrokeColor=i.labelOutlineColor,i.fontStrokeWidth=t.labelOutlineWidth,delete i.labelOutlineWidth,this.drawText(e,i,n)}var s=this.getResolution(),o=(n.x-this.featureDx)/s+this.left,u=n.y/s-this.top,a=r?this.LABEL_OUTLINE_SUFFIX:this.LABEL_ID_SUFFIX,f=this.nodeFactory(e+a,"text");f.setAttributeNS(null,"x",o),f.setAttributeNS(null,"y",-u),t.fontColor&&f.setAttributeNS(null,"fill",t.fontColor),t.fontStrokeColor&&f.setAttributeNS(null,"stroke",t.fontStrokeColor),t.fontStrokeWidth&&f.setAttributeNS(null,"stroke-width",t.fontStrokeWidth),t.fontOpacity&&f.setAttributeNS(null,"opacity",t.fontOpacity),t.fontFamily&&f.setAttributeNS(null,"font-family",t.fontFamily),t.fontSize&&f.setAttributeNS(null,"font-size",t.fontSize),t.fontWeight&&f.setAttributeNS(null,"font-weight",t.fontWeight),t.fontStyle&&f.setAttributeNS(null,"font-style",t.fontStyle),t.labelSelect===!0?(f.setAttributeNS(null,"pointer-events","visible"),f._featureId=e):f.setAttributeNS(null,"pointer-events","none");var l=t.labelAlign||OpenLayers.Renderer.defaultSymbolizer.labelAlign;f.setAttributeNS(null,"text-anchor",OpenLayers.Renderer.SVG.LABEL_ALIGN[l[0]]||"middle"),OpenLayers.IS_GECKO===!0&&f.setAttributeNS(null,"dominant-baseline",OpenLayers.Renderer.SVG.LABEL_ALIGN[l[1]]||"central");var c=t.label.split("\n"),h=c.length;while(f.childNodes.length>h)f.removeChild(f.lastChild);for(var p=0;p<h;p++){var d=this.nodeFactory(e+a+"_tspan_"+p,"tspan");t.labelSelect===!0&&(d._featureId=e,d._geometry=n,d._geometryClass=n.CLASS_NAME),OpenLayers.IS_GECKO===!1&&d.setAttributeNS(null,"baseline-shift",OpenLayers.Renderer.SVG.LABEL_VSHIFT[l[1]]||"-35%"),d.setAttribute("x",o);if(p==0){var v=OpenLayers.Renderer.SVG.LABEL_VFACTOR[l[1]];v==null&&(v=-0.5),d.setAttribute("dy",v*(h-1)+"em")}else d.setAttribute("dy","1em");d.textContent=c[p]===""?" ":c[p],d.parentNode||f.appendChild(d)}f.parentNode||this.textRoot.appendChild(f)},getComponentsString:function(e,t){var n=[],r=!0,i=e.length,s=[],o,u;for(var a=0;a<i;a++)u=e[a],n.push(u),o=this.getShortString(u),o?s.push(o):(a>0&&this.getShortString(e[a-1])&&s.push(this.clipLine(e[a],e[a-1])),a<i-1&&this.getShortString(e[a+1])&&s.push(this.clipLine(e[a],e[a+1])),r=!1);return{path:s.join(t||","),complete:r}},clipLine:function(e,t){if(t.equals(e))return"";var n=this.getResolution(),r=this.MAX_PIXEL-this.translationParameters.x,i=this.MAX_PIXEL-this.translationParameters.y,s=(t.x-this.featureDx)/n+this.left,o=this.top-t.y/n,u=(e.x-this.featureDx)/n+this.left,a=this.top-e.y/n,f;if(u<-r||u>r)f=(a-o)/(u-s),u=u<0?-r:r,a=o+(u-s)*f;if(a<-i||a>i)f=(u-s)/(a-o),a=a<0?-i:i,u=s+(a-o)*f;return u+","+a},getShortString:function(e){var t=this.getResolution(),n=(e.x-this.featureDx)/t+this.left,r=this.top-e.y/t;return this.inValidRange(n,r)?n+","+r:!1},getPosition:function(e){return{x:parseFloat(e.getAttributeNS(null,"cx")),y:parseFloat(e.getAttributeNS(null,"cy"))}},importSymbol:function(e){this.defs||(this.defs=this.createDefs());var t=this.container.id+"-"+e,n=document.getElementById(t);if(n!=null)return n;var r=OpenLayers.Renderer.symbol[e];if(!r)throw new Error(e+" is not a valid symbol name");var i=this.nodeFactory(t,"symbol"),s=this.nodeFactory(null,"polygon");i.appendChild(s);var o=new OpenLayers.Bounds(Number.MAX_VALUE,Number.MAX_VALUE,0,0),u=[],a,f;for(var l=0;l<r.length;l+=2)a=r[l],f=r[l+1],o.left=Math.min(o.left,a),o.bottom=Math.min(o.bottom,f),o.right=Math.max(o.right,a),o.top=Math.max(o.top,f),u.push(a,",",f);s.setAttributeNS(null,"points",u.join(" "));var c=o.getWidth(),h=o.getHeight(),p=[o.left-c,o.bottom-h,c*3,h*3];return i.setAttributeNS(null,"viewBox",p.join(" ")),this.symbolMetrics[t]=[Math.max(c,h),o.getCenterLonLat().lon,o.getCenterLonLat().lat],this.defs.appendChild(i),i},getFeatureIdFromEvent:function(e){var t=OpenLayers.Renderer.Elements.prototype.getFeatureIdFromEvent.apply(this,arguments);if(!t){var n=e.target;t=n.parentNode&&n!=this.rendererRoot?n.parentNode._featureId:undefined}return t},CLASS_NAME:"OpenLayers.Renderer.SVG"}),OpenLayers.Renderer.SVG.LABEL_ALIGN={l:"start",r:"end",b:"bottom",t:"hanging"},OpenLayers.Renderer.SVG.LABEL_VSHIFT={t:"-70%",b:"0"},OpenLayers.Renderer.SVG.LABEL_VFACTOR={t:0,b:-1},OpenLayers.Renderer.SVG.preventDefault=function(e){e.preventDefault&&e.preventDefault()},OpenLayers.Control.DrawFeature=OpenLayers.Class(OpenLayers.Control,{layer:null,callbacks:null,multi:!1,featureAdded:function(){},handlerOptions:null,initialize:function(e,t,n){OpenLayers.Control.prototype.initialize.apply(this,[n]),this.callbacks=OpenLayers.Util.extend({done:this.drawFeature,modify:function(e,t){this.layer.events.triggerEvent("sketchmodified",{vertex:e,feature:t})},create:function(e,t){this.layer.events.triggerEvent("sketchstarted",{vertex:e,feature:t})}},this.callbacks),this.layer=e,this.handlerOptions=this.handlerOptions||{},this.handlerOptions.layerOptions=OpenLayers.Util.applyDefaults(this.handlerOptions.layerOptions,{renderers:e.renderers,rendererOptions:e.rendererOptions}),"multi"in this.handlerOptions||(this.handlerOptions.multi=this.multi);var r=this.layer.styleMap&&this.layer.styleMap.styles.temporary;r&&(this.handlerOptions.layerOptions=OpenLayers.Util.applyDefaults(this.handlerOptions.layerOptions,{styleMap:new OpenLayers.StyleMap({"default":r})})),this.handler=new t(this,this.callbacks,this.handlerOptions)},drawFeature:function(e){var t=new OpenLayers.Feature.Vector(e),n=this.layer.events.triggerEvent("sketchcomplete",{feature:t});n!==!1&&(t.state=OpenLayers.State.INSERT,this.layer.addFeatures([t]),this.featureAdded(t),this.events.triggerEvent("featureadded",{feature:t}))},insertXY:function(e,t){this.handler&&this.handler.line&&this.handler.insertXY(e,t)},insertDeltaXY:function(e,t){this.handler&&this.handler.line&&this.handler.insertDeltaXY(e,t)},insertDirectionLength:function(e,t){this.handler&&this.handler.line&&this.handler.insertDirectionLength(e,t)},insertDeflectionLength:function(e,t){this.handler&&this.handler.line&&this.handler.insertDeflectionLength(e,t)},undo:function(){return this.handler.undo&&this.handler.undo()},redo:function(){return this.handler.redo&&this.handler.redo()},finishSketch:function(){this.handler.finishGeometry()},cancel:function(){this.handler.cancel()},CLASS_NAME:"OpenLayers.Control.DrawFeature"}),OpenLayers.Format.WMSGetFeatureInfo=OpenLayers.Class(OpenLayers.Format.XML,{layerIdentifier:"_layer",featureIdentifier:"_feature",regExes:{trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g},gmlFormat:null,read:function(e){var t;typeof e=="string"&&(e=OpenLayers.Format.XML.prototype.read.apply(this,[e]));var n=e.documentElement;if(n){var r=this,i=this["read_"+n.nodeName];i?t=i.call(this,n):t=(new OpenLayers.Format.GML(this.options?this.options:{})).read(e)}else t=e;return t},read_msGMLOutput:function(e){var t=[],n=this.getSiblingNodesByTagCriteria(e,this.layerIdentifier);if(n)for(var r=0,i=n.length;r<i;++r){var s=n[r],o=s.nodeName;s.prefix&&(o=o.split(":")[1]);var o=o.replace(this.layerIdentifier,""),u=this.getSiblingNodesByTagCriteria(s,this.featureIdentifier);if(u)for(var a=0;a<u.length;a++){var f=u[a],l=this.parseGeometry(f),c=this.parseAttributes(f),h=new OpenLayers.Feature.Vector(l.geometry,c,null);h.bounds=l.bounds,h.type=o,t.push(h)}}return t},read_FeatureInfoResponse:function(e){var t=[],n=this.getElementsByTagNameNS(e,"*","FIELDS");for(var r=0,i=n.length;r<i;r++){var s=n[r],o=null,u={},a,f=s.attributes.length;if(f>0)for(a=0;a<f;a++){var l=s.attributes[a];u[l.nodeName]=l.nodeValue}else{var c=s.childNodes;for(a=0,f=c.length;a<f;++a){var h=c[a];h.nodeType!=3&&(u[h.getAttribute("name")]=h.getAttribute("value"))}}t.push(new OpenLayers.Feature.Vector(o,u,null))}return t},getSiblingNodesByTagCriteria:function(e,t){var n=[],r,i,s,o,u;if(e&&e.hasChildNodes()){r=e.childNodes,s=r.length;for(var a=0;a<s;a++){u=r[a];while(u&&u.nodeType!=1)u=u.nextSibling,a++;i=u?u.nodeName:"",i.length>0&&i.indexOf(t)>-1?n.push(u):(o=this.getSiblingNodesByTagCriteria(u,t),o.length>0&&(n.length==0?n=o:n.push(o)))}}return n},parseAttributes:function(e){var t={};if(e.nodeType==1){var n=e.childNodes,r=n.length;for(var i=0;i<r;++i){var s=n[i];if(s.nodeType==1){var o=s.childNodes,u=s.prefix?s.nodeName.split(":")[1]:s.nodeName;if(o.length==0)t[u]=null;else if(o.length==1){var a=o[0];if(a.nodeType==3||a.nodeType==4){var f=a.nodeValue.replace(this.regExes.trimSpace,"");t[u]=f}}}}}return t},parseGeometry:function(e){this.gmlFormat||(this.gmlFormat=new OpenLayers.Format.GML);var t=this.gmlFormat.parseFeature(e),n,r=null;return t&&(n=t.geometry&&t.geometry.clone(),r=t.bounds&&t.bounds.clone(),t.destroy()),{geometry:n,bounds:r}},CLASS_NAME:"OpenLayers.Format.WMSGetFeatureInfo"}),OpenLayers.Control.WMSGetFeatureInfo=OpenLayers.Class(OpenLayers.Control,{hover:!1,drillDown:!1,maxFeatures:10,clickCallback:"click",output:"features",layers:null,queryVisible:!1,url:null,layerUrls:null,infoFormat:"text/html",vendorParams:{},format:null,formatOptions:null,handlerOptions:null,handler:null,hoverRequest:null,initialize:function(e){e=e||{},e.handlerOptions=e.handlerOptions||{},OpenLayers.Control.prototype.initialize.apply(this,[e]),this.format||(this.format=new OpenLayers.Format.WMSGetFeatureInfo(e.formatOptions)),this.drillDown===!0&&(this.hover=!1);if(this.hover)this.handler=new OpenLayers.Handler.Hover(this,{move:this.cancelHover,pause:this.getInfoForHover},OpenLayers.Util.extend(this.handlerOptions.hover||{},{delay:250}));else{var t={};t[this.clickCallback]=this.getInfoForClick,this.handler=new OpenLayers.Handler.Click(this,t,this.handlerOptions.click||{})}},getInfoForClick:function(e){this.events.triggerEvent("beforegetfeatureinfo",{xy:e.xy}),OpenLayers.Element.addClass(this.map.viewPortDiv,"olCursorWait"),this.request(e.xy,{})},getInfoForHover:function(e){this.events.triggerEvent("beforegetfeatureinfo",{xy:e.xy}),this.request(e.xy,{hover:!0})},cancelHover:function(){this.hoverRequest&&(this.hoverRequest.abort(),this.hoverRequest=null)},findLayers:function(){var e=this.layers||this.map.layers,t=[],n,r;for(var i=e.length-1;i>=0;--i)n=e[i],n instanceof OpenLayers.Layer.WMS&&(!this.queryVisible||n.getVisibility())&&(r=OpenLayers.Util.isArray(n.url)?n.url[0]:n.url,this.drillDown===!1&&!this.url&&(this.url=r),(this.drillDown===!0||this.urlMatches(r))&&t.push(n));return t},urlMatches:function(e){var t=OpenLayers.Util.isEquivalentUrl(this.url,e);if(!t&&this.layerUrls)for(var n=0,r=this.layerUrls.length;n<r;++n)if(OpenLayers.Util.isEquivalentUrl(this.layerUrls[n],e)){t=!0;break}return t},buildWMSOptions:function(e,t,n,r){var i=[],s=[];for(var o=0,u=t.length;o<u;o++)t[o].params.LAYERS!=null&&(i=i.concat(t[o].params.LAYERS),s=s.concat(this.getStyleNames(t[o])));var a=t[0],f=this.map.getProjection(),l=a.projection;l&&l.equals(this.map.getProjectionObject())&&(f=l.getCode());var c=OpenLayers.Util.extend({service:"WMS",version:a.params.VERSION,request:"GetFeatureInfo",exceptions:a.params.EXCEPTIONS,bbox:this.map.getExtent().toBBOX(null,a.reverseAxisOrder()),feature_count:this.maxFeatures,height:this.map.getSize().h,width:this.map.getSize().w,format:r,info_format:a.params.INFO_FORMAT||this.infoFormat},parseFloat(a.params.VERSION)>=1.3?{crs:f,i:parseInt(n.x),j:parseInt(n.y)}:{srs:f,x:parseInt(n.x),y:parseInt(n.y)});return i.length!=0&&(c=OpenLayers.Util.extend({layers:i,query_layers:i,styles:s},c)),OpenLayers.Util.applyDefaults(c,this.vendorParams),{url:e,params:OpenLayers.Util.upperCaseObject(c),callback:function(t){this.handleResponse(n,t,e)},scope:this}},getStyleNames:function(e){var t;return e.params.STYLES?t=e.params.STYLES:OpenLayers.Util.isArray(e.params.LAYERS)?t=new Array(e.params.LAYERS.length):t=e.params.LAYERS.replace(/[^,]/g,""),t},request:function(e,t){var n=this.findLayers();if(n.length==0){this.events.triggerEvent("nogetfeatureinfo"),OpenLayers.Element.removeClass(this.map.viewPortDiv,"olCursorWait");return}t=t||{};if(this.drillDown===!1){var r=this.buildWMSOptions(this.url,n,e,n[0].params.FORMAT),i=OpenLayers.Request.GET(r);t.hover===!0&&(this.hoverRequest=i)}else{this._requestCount=0,this._numRequests=0,this.features=[];var s={},o;for(var u=0,a=n.length;u<a;u++){var f=n[u],l,c=!1;o=OpenLayers.Util.isArray(f.url)?f.url[0]:f.url,o in s?s[o].push(f):(this._numRequests++,s[o]=[f])}var n;for(var o in s){n=s[o];var r=this.buildWMSOptions(o,n,e,n[0].params.FORMAT);OpenLayers.Request.GET(r)}}},triggerGetFeatureInfo:function(e,t,n){this.events.triggerEvent("getfeatureinfo",{text:e.responseText,features:n,request:e,xy:t}),OpenLayers.Element.removeClass(this.map.viewPortDiv,"olCursorWait")},handleResponse:function(e,t,n){var r=t.responseXML;if(!r||!r.documentElement)r=t.responseText;var i=this.format.read(r);this.drillDown===!1?this.triggerGetFeatureInfo(t,e,i):(this._requestCount++,this.output==="object"?this._features=(this._features||[]).concat({url:n,features:i}):this._features=(this._features||[]).concat(i),this._requestCount===this._numRequests&&(this.triggerGetFeatureInfo(t,e,this._features.concat()),delete this._features,delete this._requestCount,delete this._numRequests))},CLASS_NAME:"OpenLayers.Control.WMSGetFeatureInfo"}),OpenLayers.Layer.Vector.RootContainer=OpenLayers.Class(OpenLayers.Layer.Vector,{displayInLayerSwitcher:!1,layers:null,display:function(){},getFeatureFromEvent:function(e){var t=this.layers,n;for(var r=0;r<t.length;r++){n=t[r].getFeatureFromEvent(e);if(n)return n}},setMap:function(e){OpenLayers.Layer.Vector.prototype.setMap.apply(this,arguments),this.collectRoots(),e.events.register("changelayer",this,this.handleChangeLayer)},removeMap:function(e){e.events.unregister("changelayer",this,this.handleChangeLayer),this.resetRoots(),OpenLayers.Layer.Vector.prototype.removeMap.apply(this,arguments)},collectRoots:function(){var e;for(var t=0;t<this.map.layers.length;++t)e=this.map.layers[t],OpenLayers.Util.indexOf(this.layers,e)!=-1&&e.renderer.moveRoot(this.renderer)},resetRoots:function(){var e;for(var t=0;t<this.layers.length;++t)e=this.layers[t],this.renderer&&e.renderer.getRenderLayerId()==this.id&&this.renderer.moveRoot(e.renderer)},handleChangeLayer:function(e){var t=e.layer;e.property=="order"&&OpenLayers.Util.indexOf(this.layers,t)!=-1&&(this.resetRoots(),this.collectRoots())},CLASS_NAME:"OpenLayers.Layer.Vector.RootContainer"}),OpenLayers.Control.SelectFeature=OpenLayers.Class(OpenLayers.Control,{multipleKey:null,toggleKey:null,multiple:!1,clickout:!0,toggle:!1,hover:!1,highlightOnly:!1,box:!1,onBeforeSelect:function(){},onSelect:function(){},onUnselect:function(){},scope:null,geometryTypes:null,layer:null,layers:null,callbacks:null,selectStyle:null,renderIntent:"select",handlers:null,initialize:function(e,t){OpenLayers.Control.prototype.initialize.apply(this,[t]),this.scope===null&&(this.scope=this),this.initLayer(e);var n={click:this.clickFeature,clickout:this.clickoutFeature};this.hover&&(n.over=this.overFeature,n.out=this.outFeature),this.callbacks=OpenLayers.Util.extend(n,this.callbacks),this.handlers={feature:new OpenLayers.Handler.Feature(this,this.layer,this.callbacks,{geometryTypes:this.geometryTypes})},this.box&&(this.handlers.box=new OpenLayers.Handler.Box(this,{done:this.selectBox},{boxDivClassName:"olHandlerBoxSelectFeature"}))},initLayer:function(e){OpenLayers.Util.isArray(e)?(this.layers=e,this.layer=new OpenLayers.Layer.Vector.RootContainer(this.id+"_container",{layers:e})):this.layer=e},destroy:function(){this.active&&this.layers&&this.map.removeLayer(this.layer),OpenLayers.Control.prototype.destroy.apply(this,arguments),this.layers&&this.layer.destroy()},activate:function(){return this.active||(this.layers&&this.map.addLayer(this.layer),this.handlers.feature.activate(),this.box&&this.handlers.box&&this.handlers.box.activate()),OpenLayers.Control.prototype.activate.apply(this,arguments)},deactivate:function(){return this.active&&(this.handlers.feature.deactivate(),this.handlers.box&&this.handlers.box.deactivate(),this.layers&&this.map.removeLayer(this.layer)),OpenLayers.Control.prototype.deactivate.apply(this,arguments)},unselectAll:function(e){var t=this.layers||[this.layer],n,r;for(var i=0;i<t.length;++i){n=t[i];for(var s=n.selectedFeatures.length-1;s>=0;--s)r=n.selectedFeatures[s],(!e||e.except!=r)&&this.unselect(r)}},clickFeature:function(e){if(!this.hover){var t=OpenLayers.Util.indexOf(e.layer.selectedFeatures,e)>-1;t?this.toggleSelect()?this.unselect(e):this.multipleSelect()||this.unselectAll({except:e}):(this.multipleSelect()||this.unselectAll({except:e}),this.select(e))}},multipleSelect:function(){return this.multiple||this.handlers.feature.evt&&this.handlers.feature.evt[this.multipleKey]},toggleSelect:function(){return this.toggle||this.handlers.feature.evt&&this.handlers.feature.evt[this.toggleKey]},clickoutFeature:function(e){!this.hover&&this.clickout&&this.unselectAll()},overFeature:function(e){var t=e.layer;this.hover&&(this.highlightOnly?this.highlight(e):OpenLayers.Util.indexOf(t.selectedFeatures,e)==-1&&this.select(e))},outFeature:function(e){if(this.hover)if(this.highlightOnly){if(e._lastHighlighter==this.id)if(e._prevHighlighter&&e._prevHighlighter!=this.id){delete e._lastHighlighter;var t=this.map.getControl(e._prevHighlighter);t&&t.highlight(e)}else this.unhighlight(e)}else this.unselect(e)},highlight:function(e){var t=e.layer,n=this.events.triggerEvent("beforefeaturehighlighted",{feature:e});if(n!==!1){e._prevHighlighter=e._lastHighlighter,e._lastHighlighter=this.id;var r=this.selectStyle||this.renderIntent;t.drawFeature(e,r),this.events.triggerEvent("featurehighlighted",{feature:e})}},unhighlight:function(e){var t=e.layer;e._prevHighlighter==undefined?delete e._lastHighlighter:e._prevHighlighter==this.id?delete e._prevHighlighter:(e._lastHighlighter=e._prevHighlighter,delete e._prevHighlighter),t.drawFeature(e,e.style||e.layer.style||"default"),this.events.triggerEvent("featureunhighlighted",{feature:e})},select:function(e){var t=this.onBeforeSelect.call(this.scope,e),n=e.layer;t!==!1&&(t=n.events.triggerEvent("beforefeatureselected",{feature:e}),t!==!1&&(n.selectedFeatures.push(e),this.highlight(e),this.handlers.feature.lastFeature||(this.handlers.feature.lastFeature=n.selectedFeatures[0]),n.events.triggerEvent("featureselected",{feature:e}),this.onSelect.call(this.scope,e)))},unselect:function(e){var t=e.layer;this.unhighlight(e),OpenLayers.Util.removeItem(t.selectedFeatures,e),t.events.triggerEvent("featureunselected",{feature:e}),this.onUnselect.call(this.scope,e)},selectBox:function(e){if(e instanceof OpenLayers.Bounds){var t=this.map.getLonLatFromPixel({x:e.left,y:e.bottom}),n=this.map.getLonLatFromPixel({x:e.right,y:e.top}),r=new OpenLayers.Bounds(t.lon,t.lat,n.lon,n.lat);this.multipleSelect()||this.unselectAll();var i=this.multiple;this.multiple=!0;var s=this.layers||[this.layer];this.events.triggerEvent("boxselectionstart",{layers:s});var o;for(var u=0;u<s.length;++u){o=s[u];for(var a=0,f=o.features.length;a<f;++a){var l=o.features[a];if(!l.getVisibility())continue;(this.geometryTypes==null||OpenLayers.Util.indexOf(this.geometryTypes,l.geometry.CLASS_NAME)>-1)&&r.toGeometry().intersects(l.geometry)&&OpenLayers.Util.indexOf(o.selectedFeatures,l)==-1&&this.select(l)}}this.multiple=i,this.events.triggerEvent("boxselectionend",{layers:s})}},setMap:function(e){this.handlers.feature.setMap(e),this.box&&this.handlers.box.setMap(e),OpenLayers.Control.prototype.setMap.apply(this,arguments)},setLayer:function(e){var t=this.active;this.unselectAll(),this.deactivate(),this.layers&&(this.layer.destroy(),this.layers=null),this.initLayer(e),this.handlers.feature.layer=this.layer,t&&this.activate()},CLASS_NAME:"OpenLayers.Control.SelectFeature"}),OpenLayers.Handler.Keyboard=OpenLayers.Class(OpenLayers.Handler,{KEY_EVENTS:["keydown","keyup"],eventListener:null,observeElement:null,initialize:function(e,t,n){OpenLayers.Handler.prototype.initialize.apply(this,arguments),this.eventListener=OpenLayers.Function.bindAsEventListener(this.handleKeyEvent,this)},destroy:function(){this.deactivate(),this.eventListener=null,OpenLayers.Handler.prototype.destroy.apply(this,arguments)},activate:function(){if(OpenLayers.Handler.prototype.activate.apply(this,arguments)){this.observeElement=this.observeElement||document;for(var e=0,t=this.KEY_EVENTS.length;e<t;e++)OpenLayers.Event.observe(this.observeElement,this.KEY_EVENTS[e],this.eventListener);return!0}return!1},deactivate:function(){var e=!1;if(OpenLayers.Handler.prototype.deactivate.apply(this,arguments)){for(var t=0,n=this.KEY_EVENTS.length;t<n;t++)OpenLayers.Event.stopObserving(this.observeElement,this.KEY_EVENTS[t],this.eventListener);e=!0}return e},handleKeyEvent:function(e){this.checkModifiers(e)&&this.callback(e.type,[e])},CLASS_NAME:"OpenLayers.Handler.Keyboard"}),OpenLayers.Control.ModifyFeature=OpenLayers.Class(OpenLayers.Control,{geometryTypes:null,clickout:!0,toggle:!0,standalone:!1,layer:null,feature:null,vertices:null,virtualVertices:null,selectControl:null,dragControl:null,handlers:null,deleteCodes:null,virtualStyle:null,vertexRenderIntent:null,mode:null,createVertices:!0,modified:!1,radiusHandle:null,dragHandle:null,onModificationStart:function(){},onModification:function(){},onModificationEnd:function(){},initialize:function(e,t){t=t||{},this.layer=e,this.vertices=[],this.virtualVertices=[],this.virtualStyle=OpenLayers.Util.extend({},this.layer.style||this.layer.styleMap.createSymbolizer(null,t.vertexRenderIntent)),this.virtualStyle.fillOpacity=.3,this.virtualStyle.strokeOpacity=.3,this.deleteCodes=[46,68],this.mode=OpenLayers.Control.ModifyFeature.RESHAPE,OpenLayers.Control.prototype.initialize.apply(this,[t]),OpenLayers.Util.isArray(this.deleteCodes)||(this.deleteCodes=[this.deleteCodes]);var n=this,r={geometryTypes:this.geometryTypes,clickout:this.clickout,toggle:this.toggle,onBeforeSelect:this.beforeSelectFeature,onSelect:this.selectFeature,onUnselect:this.unselectFeature,scope:this};this.standalone===!1&&(this.selectControl=new OpenLayers.Control.SelectFeature(e,r));var i={geometryTypes:["OpenLayers.Geometry.Point"],onStart:function(e,t){n.dragStart.apply(n,[e,t])},onDrag:function(e,t){n.dragVertex.apply(n,[e,t])},onComplete:function(e){n.dragComplete.apply(n,[e])},featureCallbacks:{over:function(e){(n.standalone!==!0||e._sketch||n.feature===e)&&n.dragControl.overFeature.apply(n.dragControl,[e])}}};this.dragControl=new OpenLayers.Control.DragFeature(e,i);var s={keydown:this.handleKeypress};this.handlers={keyboard:new OpenLayers.Handler.Keyboard(this,s)}},destroy:function(){this.layer=null,this.standalone||this.selectControl.destroy(),this.dragControl.destroy(),OpenLayers.Control.prototype.destroy.apply(this,[])},activate:function(){return(this.standalone||this.selectControl.activate())&&this.handlers.keyboard.activate()&&OpenLayers.Control.prototype.activate.apply(this,arguments)},deactivate:function(){var e=!1;if(OpenLayers.Control.prototype.deactivate.apply(this,arguments)){this.layer.removeFeatures(this.vertices,{silent:!0}),this.layer.removeFeatures(this.virtualVertices,{silent:!0}),this.vertices=[],this.dragControl.deactivate();var t=this.feature,n=t&&t.geometry&&t.layer;this.standalone===!1?(n&&this.selectControl.unselect.apply(this.selectControl,[t]),this.selectControl.deactivate()):n&&this.unselectFeature(t),this.handlers.keyboard.deactivate(),e=!0}return e},beforeSelectFeature:function(e){return this.layer.events.triggerEvent("beforefeaturemodified",{feature:e})},selectFeature:function(e){if(!this.standalone||this.beforeSelectFeature(e)!==!1)this.feature=e,this.modified=!1,this.resetVertices(),this.dragControl.activate(),this.onModificationStart(this.feature);var t=e.modified;e.geometry&&(!t||!t.geometry)&&(this._originalGeometry=e.geometry.clone())},unselectFeature:function(e){this.layer.removeFeatures(this.vertices,{silent:!0}),this.vertices=[],this.layer.destroyFeatures(this.virtualVertices,{silent:!0}),this.virtualVertices=[],this.dragHandle&&(this.layer.destroyFeatures([this.dragHandle],{silent:!0}),delete this.dragHandle),this.radiusHandle&&(this.layer.destroyFeatures([this.radiusHandle],{silent:!0}),delete this.radiusHandle),this.feature=null,this.dragControl.deactivate(),this.onModificationEnd(e),this.layer.events.triggerEvent("afterfeaturemodified",{feature:e,modified:this.modified}),this.modified=!1},dragStart:function(e,t){if(e!=this.feature&&!e.geometry.parent&&e!=this.dragHandle&&e!=this.radiusHandle){this.standalone===!1&&this.feature&&this.selectControl.clickFeature.apply(this.selectControl,[this.feature]);if(this.geometryTypes==null||OpenLayers.Util.indexOf(this.geometryTypes,e.geometry.CLASS_NAME)!=-1)this.standalone||this.selectControl.clickFeature.apply(this.selectControl,[e]),this.dragControl.overFeature.apply(this.dragControl,[e]),this.dragControl.lastPixel=t,this.dragControl.handlers.drag.started=!0,this.dragControl.handlers.drag.start=t,this.dragControl.handlers.drag.last=t}},dragVertex:function(e,t){this.modified=!0,this.feature.geometry.CLASS_NAME=="OpenLayers.Geometry.Point"?(this.feature!=e&&(this.feature=e),this.layer.events.triggerEvent("vertexmodified",{vertex:e.geometry,feature:this.feature,pixel:t})):(e._index?(e.geometry.parent.addComponent(e.geometry,e._index),delete e._index,OpenLayers.Util.removeItem(this.virtualVertices,e),this.vertices.push(e)):e==this.dragHandle?(this.layer.removeFeatures(this.vertices,{silent:!0}),this.vertices=[],this.radiusHandle&&(this.layer.destroyFeatures([this.radiusHandle],{silent:!0}),this.radiusHandle=null)):e!==this.radiusHandle&&this.layer.events.triggerEvent("vertexmodified",{vertex:e.geometry,feature:this.feature,pixel:t}),this.virtualVertices.length>0&&(this.layer.destroyFeatures(this.virtualVertices,{silent:!0}),this.virtualVertices=[]),this.layer.drawFeature(this.feature,this.standalone?undefined:this.selectControl.renderIntent)),this.layer.drawFeature(e)},dragComplete:function(e){this.resetVertices(),this.setFeatureState(),this.onModification(this.feature),this.layer.events.triggerEvent("featuremodified",{feature:this.feature})},setFeatureState:function(){if(this.feature.state!=OpenLayers.State.INSERT&&this.feature.state!=OpenLayers.State.DELETE){this.feature.state=OpenLayers.State.UPDATE;if(this.modified&&this._originalGeometry){var e=this.feature;e.modified=OpenLayers.Util.extend(e.modified,{geometry:this._originalGeometry}),delete this._originalGeometry}}},resetVertices:function(){this.dragControl.feature&&this.dragControl.outFeature(this.dragControl.feature),this.vertices.length>0&&(this.layer.removeFeatures(this.vertices,{silent:!0}),this.vertices=[]),this.virtualVertices.length>0&&(this.layer.removeFeatures(this.virtualVertices,{silent:!0}),this.virtualVertices=[]),this.dragHandle&&(this.layer.destroyFeatures([this.dragHandle],{silent:!0}),this.dragHandle=null),this.radiusHandle&&(this.layer.destroyFeatures([this.radiusHandle],{silent:!0}),this.radiusHandle=null),this.feature&&this.feature.geometry.CLASS_NAME!="OpenLayers.Geometry.Point"&&(this.mode&OpenLayers.Control.ModifyFeature.DRAG&&this.collectDragHandle(),this.mode&(OpenLayers.Control.ModifyFeature.ROTATE|OpenLayers.Control.ModifyFeature.RESIZE)&&this.collectRadiusHandle(),this.mode&OpenLayers.Control.ModifyFeature.RESHAPE&&(this.mode&OpenLayers.Control.ModifyFeature.RESIZE||this.collectVertices()))},handleKeypress:function(e){var t=e.keyCode;if(this.feature&&OpenLayers.Util.indexOf(this.deleteCodes,t)!=-1){var n=this.dragControl.feature;n&&OpenLayers.Util.indexOf(this.vertices,n)!=-1&&!this.dragControl.handlers.drag.dragging&&n.geometry.parent&&(n.geometry.parent.removeComponent(n.geometry),this.layer.events.triggerEvent("vertexremoved",{vertex:n.geometry,feature:this.feature,pixel:e.xy}),this.layer.drawFeature(this.feature,this.standalone?undefined:this.selectControl.renderIntent),this.modified=!0,this.resetVertices(),this.setFeatureState(),this.onModification(this.feature),this.layer.events.triggerEvent("featuremodified",{feature:this.feature}))}},collectVertices:function(){function t(n){var r,i,s,o;if(n.CLASS_NAME=="OpenLayers.Geometry.Point")i=new OpenLayers.Feature.Vector(n),i._sketch=!0,i.renderIntent=e.vertexRenderIntent,e.vertices.push(i);else{var u=n.components.length;n.CLASS_NAME=="OpenLayers.Geometry.LinearRing"&&(u-=1);for(r=0;r<u;++r)s=n.components[r],s.CLASS_NAME=="OpenLayers.Geometry.Point"?(i=new OpenLayers.Feature.Vector(s),i._sketch=!0,i.renderIntent=e.vertexRenderIntent,e.vertices.push(i)):t(s);if(e.createVertices&&n.CLASS_NAME!="OpenLayers.Geometry.MultiPoint")for(r=0,o=n.components.length;r<o-1;++r){var a=n.components[r],f=n.components[r+1];if(a.CLASS_NAME=="OpenLayers.Geometry.Point"&&f.CLASS_NAME=="OpenLayers.Geometry.Point"){var l=(a.x+f.x)/2,c=(a.y+f.y)/2,h=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Point(l,c),null,e.virtualStyle);h.geometry.parent=n,h._index=r+1,h._sketch=!0,e.virtualVertices.push(h)}}}}this.vertices=[],this.virtualVertices=[];var e=this;t.call(this,this.feature.geometry),this.layer.addFeatures(this.virtualVertices,{silent:!0}),this.layer.addFeatures(this.vertices,{silent:!0})},collectDragHandle:function(){var e=this.feature.geometry,t=e.getBounds().getCenterLonLat(),n=new OpenLayers.Geometry.Point(t.lon,t.lat),r=new OpenLayers.Feature.Vector(n);n.move=function(t,n){OpenLayers.Geometry.Point.prototype.move.call(this,t,n),e.move(t,n)},r._sketch=!0,this.dragHandle=r,this.dragHandle.renderIntent=this.vertexRenderIntent,this.layer.addFeatures([this.dragHandle],{silent:!0})},collectRadiusHandle:function(){var e=this.feature.geometry,t=e.getBounds(),n=t.getCenterLonLat(),r=new OpenLayers.Geometry.Point(n.lon,n.lat),i=new OpenLayers.Geometry.Point(t.right,t.bottom),s=new OpenLayers.Feature.Vector(i),o=this.mode&OpenLayers.Control.ModifyFeature.RESIZE,u=this.mode&OpenLayers.Control.ModifyFeature.RESHAPE,a=this.mode&OpenLayers.Control.ModifyFeature.ROTATE;i.move=function(t,n){OpenLayers.Geometry.Point.prototype.move.call(this,t,n);var i=this.x-r.x,s=this.y-r.y,f=i-t,l=s-n;if(a){var c=Math.atan2(l,f),h=Math.atan2(s,i),p=h-c;p*=180/Math.PI,e.rotate(p,r)}if(o){var d,v;if(u)d=s/l,v=i/f/d;else{var m=Math.sqrt(f*f+l*l),g=Math.sqrt(i*i+s*s);d=g/m}e.resize(d,r,v)}},s._sketch=!0,this.radiusHandle=s,this.radiusHandle.renderIntent=this.vertexRenderIntent,this.layer.addFeatures([this.radiusHandle],{silent:!0})},setMap:function(e){this.standalone||this.selectControl.setMap(e),this.dragControl.setMap(e),OpenLayers.Control.prototype.setMap.apply(this,arguments)},CLASS_NAME:"OpenLayers.Control.ModifyFeature"}),OpenLayers.Control.ModifyFeature.RESHAPE=1,OpenLayers.Control.ModifyFeature.RESIZE=2,OpenLayers.Control.ModifyFeature.ROTATE=4,OpenLayers.Control.ModifyFeature.DRAG=8,OpenLayers.Geometry.MultiLineString=OpenLayers.Class(OpenLayers.Geometry.Collection,{componentTypes:["OpenLayers.Geometry.LineString"],split:function(e,t){var n=null,r=t&&t.mutual,i,s,o,u,a,f=[],l=[e];for(var c=0,h=this.components.length;c<h;++c){s=this.components[c],u=!1;for(var p=0;p<l.length;++p){i=s.split(l[p],t);if(i){if(r){o=i[0];for(var d=0,v=o.length;d<v;++d)d===0&&f.length?f[f.length-1].addComponent(o[d]):f.push(new OpenLayers.Geometry.MultiLineString([o[d]]));u=!0,i=i[1]}if(i.length){i.unshift(p,1),Array.prototype.splice.apply(l,i);break}}}u||(f.length?f[f.length-1].addComponent(s.clone()):f=[new OpenLayers.Geometry.MultiLineString(s.clone())])}f&&f.length>1?u=!0:f=[],l&&l.length>1?a=!0:l=[];if(u||a)r?n=[f,l]:n=l;return n},splitWith:function(e,t){var n=null,r=t&&t.mutual,i,s,o,u,a,f,l;if(e instanceof OpenLayers.Geometry.LineString){l=[],f=[e];for(var c=0,h=this.components.length;c<h;++c){a=!1,s=this.components[c];for(var p=0;p<f.length;++p){i=f[p].split(s,t);if(i){r&&(o=i[0],o.length&&(o.unshift(p,1),Array.prototype.splice.apply(f,o),p+=o.length-2),i=i[1],i.length===0&&(i=[s.clone()]));for(var d=0,v=i.length;d<v;++d)d===0&&l.length?l[l.length-1].addComponent(i[d]):l.push(new OpenLayers.Geometry.MultiLineString([i[d]]));a=!0}}a||(l.length?l[l.length-1].addComponent(s.clone()):l=[new OpenLayers.Geometry.MultiLineString([s.clone()])])}}else n=e.split(this);f&&f.length>1?u=!0:f=[],l&&l.length>1?a=!0:l=[];if(u||a)r?n=[f,l]:n=l;return n},CLASS_NAME:"OpenLayers.Geometry.MultiLineString"}),OpenLayers.Geometry.MultiPolygon=OpenLayers.Class(OpenLayers.Geometry.Collection,{componentTypes:["OpenLayers.Geometry.Polygon"],CLASS_NAME:"OpenLayers.Geometry.MultiPolygon"}),OpenLayers.Format.GML=OpenLayers.Class(OpenLayers.Format.XML,{featureNS:"http://mapserver.gis.umn.edu/mapserver",featurePrefix:"feature",featureName:"featureMember",layerName:"features",geometryName:"geometry",collectionName:"FeatureCollection",gmlns:"http://www.opengis.net/gml",extractAttributes:!0,xy:!0,initialize:function(e){this.regExes={trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g},OpenLayers.Format.XML.prototype.initialize.apply(this,[e])},read:function(e){typeof e=="string"&&(e=OpenLayers.Format.XML.prototype.read.apply(this,[e]));var t=this.getElementsByTagNameNS(e.documentElement,this.gmlns,this.featureName),n=[];for(var r=0;r<t.length;r++){var i=this.parseFeature(t[r]);i&&n.push(i)}return n},parseFeature:function(e){var t=["MultiPolygon","Polygon","MultiLineString","LineString","MultiPoint","Point","Envelope"],n,r,i,s;for(var o=0;o<t.length;++o){n=t[o],r=this.getElementsByTagNameNS(e,this.gmlns,n);if(r.length>0){s=this.parseGeometry[n.toLowerCase()];if(!s)throw new TypeError("Unsupported geometry type: "+n);i=s.apply(this,[r[0]]),this.internalProjection&&this.externalProjection&&i.transform(this.externalProjection,this.internalProjection);break}}var u,a=this.getElementsByTagNameNS(e,this.gmlns,"Box");for(o=0;o<a.length;++o){var f=a[o],l=this.parseGeometry.box.apply(this,[f]),c=f.parentNode,h=c.localName||c.nodeName.split(":").pop();h==="boundedBy"?u=l:i=l.toGeometry()}var p;this.extractAttributes&&(p=this.parseAttributes(e));var d=new OpenLayers.Feature.Vector(i,p);d.bounds=u,d.gml={featureType:e.firstChild.nodeName.split(":")[1],featureNS:e.firstChild.namespaceURI,featureNSPrefix:e.firstChild.prefix};var v=e.firstChild,m;while(v){if(v.nodeType==1){m=v.getAttribute("fid")||v.getAttribute("id");if(m)break}v=v.nextSibling}return d.fid=m,d},parseGeometry:{point:function(e){var t,n,r=[],t=this.getElementsByTagNameNS(e,this.gmlns,"pos");t.length>0&&(n=t[0].firstChild.nodeValue,n=n.replace(this.regExes.trimSpace,""),r=n.split(this.regExes.splitSpace)),r.length==0&&(t=this.getElementsByTagNameNS(e,this.gmlns,"coordinates"),t.length>0&&(n=t[0].firstChild.nodeValue,n=n.replace(this.regExes.removeSpace,""),r=n.split(",")));if(r.length==0){t=this.getElementsByTagNameNS(e,this.gmlns,"coord");if(t.length>0){var i=this.getElementsByTagNameNS(t[0],this.gmlns,"X"),s=this.getElementsByTagNameNS(t[0],this.gmlns,"Y");i.length>0&&s.length>0&&(r=[i[0].firstChild.nodeValue,s[0].firstChild.nodeValue])}}return r.length==2&&(r[2]=null),this.xy?new OpenLayers.Geometry.Point(r[0],r[1],r[2]):new OpenLayers.Geometry.Point(r[1],r[0],r[2])},multipoint:function(e){var t=this.getElementsByTagNameNS(e,this.gmlns,"Point"),n=[];if(t.length>0){var r;for(var i=0;i<t.length;++i)r=this.parseGeometry.point.apply(this,[t[i]]),r&&n.push(r)}return new OpenLayers.Geometry.MultiPoint(n)},linestring:function(e,t){var n,r,i=[],s=[];n=this.getElementsByTagNameNS(e,this.gmlns,"posList");if(n.length>0){r=this.getChildValue(n[0]),r=r.replace(this.regExes.trimSpace,""),i=r.split(this.regExes.splitSpace);var o=parseInt(n[0].getAttribute("dimension")),u,a,f,l;for(var c=0;c<i.length/o;++c)u=c*o,a=i[u],f=i[u+1],l=o==2?null:i[u+2],this.xy?s.push(new OpenLayers.Geometry.Point(a,f,l)):s.push(new OpenLayers.Geometry.Point(f,a,l))}if(i.length==0){n=this.getElementsByTagNameNS(e,this.gmlns,"coordinates");if(n.length>0){r=this.getChildValue(n[0]),r=r.replace(this.regExes.trimSpace,""),r=r.replace(this.regExes.trimComma,",");var h=r.split(this.regExes.splitSpace);for(var c=0;c<h.length;++c)i=h[c].split(","),i.length==2&&(i[2]=null),this.xy?s.push(new OpenLayers.Geometry.Point(i[0],i[1],i[2])):s.push(new OpenLayers.Geometry.Point(i[1],i[0],i[2]))}}var p=null;return s.length!=0&&(t?p=new OpenLayers.Geometry.LinearRing(s):p=new OpenLayers.Geometry.LineString(s)),p},multilinestring:function(e){var t=this.getElementsByTagNameNS(e,this.gmlns,"LineString"),n=[];if(t.length>0){var r;for(var i=0;i<t.length;++i)r=this.parseGeometry.linestring.apply(this,[t[i]]),r&&n.push(r)}return new OpenLayers.Geometry.MultiLineString(n)},polygon:function(e){var t=this.getElementsByTagNameNS(e,this.gmlns,"LinearRing"),n=[];if(t.length>0){var r;for(var i=0;i<t.length;++i)r=this.parseGeometry.linestring.apply(this,[t[i],!0]),r&&n.push(r)}return new OpenLayers.Geometry.Polygon(n)},multipolygon:function(e){var t=this.getElementsByTagNameNS(e,this.gmlns,"Polygon"),n=[];if(t.length>0){var r;for(var i=0;i<t.length;++i)r=this.parseGeometry.polygon.apply(this,[t[i]]),r&&n.push(r)}return new OpenLayers.Geometry.MultiPolygon(n)},envelope:function(e){var t=[],n,r,i=this.getElementsByTagNameNS(e,this.gmlns,"lowerCorner");if(i.length>0){var s=[];i.length>0&&(n=i[0].firstChild.nodeValue,n=n.replace(this.regExes.trimSpace,""),s=n.split(this.regExes.splitSpace)),s.length==2&&(s[2]=null);if(this.xy)var o=new OpenLayers.Geometry.Point(s[0],s[1],s[2]);else var o=new OpenLayers.Geometry.Point(s[1],s[0],s[2])}var u=this.getElementsByTagNameNS(e,this.gmlns,"upperCorner");if(u.length>0){var s=[];u.length>0&&(n=u[0].firstChild.nodeValue,n=n.replace(this.regExes.trimSpace,""),s=n.split(this.regExes.splitSpace)),s.length==2&&(s[2]=null);if(this.xy)var a=new OpenLayers.Geometry.Point(s[0],s[1],s[2]);else var a=new OpenLayers.Geometry.Point(s[1],s[0],s[2])}if(o&&a){t.push(new OpenLayers.Geometry.Point(o.x,o.y)),t.push(new OpenLayers.Geometry.Point(a.x,o.y)),t.push(new OpenLayers.Geometry.Point(a.x,a.y)),t.push(new OpenLayers.Geometry.Point(o.x,a.y)),t.push(new OpenLayers.Geometry.Point(o.x,o.y));var f=new OpenLayers.Geometry.LinearRing(t);r=new OpenLayers.Geometry.Polygon([f])}return r},box:function(e){var t=this.getElementsByTagNameNS(e,this.gmlns,"coordinates"),n,r,i=null,s=null;t.length>0&&(n=t[0].firstChild.nodeValue,r=n.split(" "),r.length==2&&(i=r[0].split(","),s=r[1].split(",")));if(i!==null&&s!==null)return new OpenLayers.Bounds(parseFloat(i[0]),parseFloat(i[1]),parseFloat(s[0]),parseFloat(s[1]))}},parseAttributes:function(e){var t={},n=e.firstChild,r,i,s,o,u,a,f;while(n){if(n.nodeType==1){r=n.childNodes;for(i=0;i<r.length;++i){s=r[i];if(s.nodeType==1){o=s.childNodes;if(o.length==1){u=o[0];if(u.nodeType==3||u.nodeType==4)a=s.prefix?s.nodeName.split(":")[1]:s.nodeName,f=u.nodeValue.replace(this.regExes.trimSpace,""),t[a]=f}else t[s.nodeName.split(":").pop()]=null}}break}n=n.nextSibling}return t},write:function(e){OpenLayers.Util.isArray(e)||(e=[e]);var t=this.createElementNS("http://www.opengis.net/wfs","wfs:"+this.collectionName);for(var n=0;n<e.length;n++)t.appendChild(this.createFeatureXML(e[n]));return OpenLayers.Format.XML.prototype.write.apply(this,[t])},createFeatureXML:function(e){var t=e.geometry,n=this.buildGeometryNode(t),r=this.createElementNS(this.featureNS,this.featurePrefix+":"+this.geometryName);r.appendChild(n);var i=this.createElementNS(this.gmlns,"gml:"+this.featureName),s=this.createElementNS(this.featureNS,this.featurePrefix+":"+this.layerName),o=e.fid||e.id;s.setAttribute("fid",o),s.appendChild(r);for(var u in e.attributes){var a=this.createTextNode(e.attributes[u]),f=u.substring(u.lastIndexOf(":")+1),l=this.createElementNS(this.featureNS,this.featurePrefix+":"+f);l.appendChild(a),s.appendChild(l)}return i.appendChild(s),i},buildGeometryNode:function(e){this.externalProjection&&this.internalProjection&&(e=e.clone(),e.transform(this.internalProjection,this.externalProjection));var t=e.CLASS_NAME,n=t.substring(t.lastIndexOf(".")+1),r=this.buildGeometry[n.toLowerCase()];return r.apply(this,[e])},buildGeometry:{point:function(e){var t=this.createElementNS(this.gmlns,"gml:Point");return t.appendChild(this.buildCoordinatesNode(e)),t},multipoint:function(e){var t=this.createElementNS(this.gmlns,"gml:MultiPoint"),n=e.components,r,i;for(var s=0;s<n.length;s++)r=this.createElementNS(this.gmlns,"gml:pointMember"),i=this.buildGeometry.point.apply(this,[n[s]]),r.appendChild(i),t.appendChild(r);return t},linestring:function(e){var t=this.createElementNS(this.gmlns,"gml:LineString");return t.appendChild(this.buildCoordinatesNode(e)),t},multilinestring:function(e){var t=this.createElementNS(this.gmlns,"gml:MultiLineString"),n=e.components,r,i;for(var s=0;s<n.length;++s)r=this.createElementNS(this.gmlns,"gml:lineStringMember"),i=this.buildGeometry.linestring.apply(this,[n[s]]),r.appendChild(i),t.appendChild(r);return t},linearring:function(e){var t=this.createElementNS(this.gmlns,"gml:LinearRing");return t.appendChild(this.buildCoordinatesNode(e)),t},polygon:function(e){var t=this.createElementNS(this.gmlns,"gml:Polygon"),n=e.components,r,i,s;for(var o=0;o<n.length;++o)s=o==0?"outerBoundaryIs":"innerBoundaryIs",r=this.createElementNS(this.gmlns,"gml:"+s),i=this.buildGeometry.linearring.apply(this,[n[o]]),r.appendChild(i),t.appendChild(r);return t},multipolygon:function(e){var t=this.createElementNS(this.gmlns,"gml:MultiPolygon"),n=e.components,r,i;for(var s=0;s<n.length;++s)r=this.createElementNS(this.gmlns,"gml:polygonMember"),i=this.buildGeometry.polygon.apply(this,[n[s]]),r.appendChild(i),t.appendChild(r);return t},bounds:function(e){var t=this.createElementNS(this.gmlns,"gml:Box");return t.appendChild(this.buildCoordinatesNode(e)),t}},buildCoordinatesNode:function(e){var t=this.createElementNS(this.gmlns,"gml:coordinates");t.setAttribute("decimal","."),t.setAttribute("cs",","),t.setAttribute("ts"," ");var n=[];if(e instanceof OpenLayers.Bounds)n.push(e.left+","+e.bottom),n.push(e.right+","+e.top);else{var r=e.components?e.components:[e];for(var i=0;i<r.length;i++)n.push(r[i].x+","+r[i].y)}var s=this.createTextNode(n.join(" "));return t.appendChild(s),t},CLASS_NAME:"OpenLayers.Format.GML"}),OpenLayers.Format.JSON=OpenLayers.Class(OpenLayers.Format,{indent:"    ",space:" ",newline:"\n",level:0,pretty:!1,nativeJSON:function(){return!!window.JSON&&typeof JSON.parse=="function"&&typeof JSON.stringify=="function"}(),read:function(json,filter){var object;if(this.nativeJSON)object=JSON.parse(json,filter);else try{if(/^[\],:{}\s]*$/.test(json.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){object=eval("("+json+")");if(typeof filter=="function"){function walk(e,t){if(t&&typeof t=="object")for(var n in t)t.hasOwnProperty(n)&&(t[n]=walk(n,t[n]));return filter(e,t)}object=walk("",object)}}}catch(e){}return this.keepData&&(this.data=object),object},write:function(e,t){this.pretty=!!t;var n=null,r=typeof e;if(this.serialize[r])try{n=!this.pretty&&this.nativeJSON?JSON.stringify(e):this.serialize[r].apply(this,[e])}catch(i){OpenLayers.Console.error("Trouble serializing: "+i)}return n},writeIndent:function(){var e=[];if(this.pretty)for(var t=0;t<this.level;++t)e.push(this.indent);return e.join("")},writeNewline:function(){return this.pretty?this.newline:""},writeSpace:function(){return this.pretty?this.space:""},serialize:{object:function(e){if(e==null)return"null";if(e.constructor==Date)return this.serialize.date.apply(this,[e]);if(e.constructor==Array)return this.serialize.array.apply(this,[e]);var t=["{"];this.level+=1;var n,r,i,s=!1;for(n in e)e.hasOwnProperty(n)&&(r=OpenLayers.Format.JSON.prototype.write.apply(this,[n,this.pretty]),i=OpenLayers.Format.JSON.prototype.write.apply(this,[e[n],this.pretty]),r!=null&&i!=null&&(s&&t.push(","),t.push(this.writeNewline(),this.writeIndent(),r,":",this.writeSpace(),i),s=!0));return this.level-=1,t.push(this.writeNewline(),this.writeIndent(),"}"),t.join("")},array:function(e){var t,n=["["];this.level+=1;for(var r=0,i=e.length;r<i;++r)t=OpenLayers.Format.JSON.prototype.write.apply(this,[e[r],this.pretty]),t!=null&&(r>0&&n.push(","),n.push(this.writeNewline(),this.writeIndent(),t));return this.level-=1,n.push(this.writeNewline(),this.writeIndent(),"]"),n.join("")},string:function(e){var t={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};return/["\\\x00-\x1f]/.test(e)?'"'+e.replace(/([\x00-\x1f\\"])/g,function(e,n){var r=t[n];return r?r:(r=n.charCodeAt(),"\\u00"+Math.floor(r/16).toString(16)+(r%16).toString(16))})+'"':'"'+e+'"'},number:function(e){return isFinite(e)?String(e):"null"},"boolean":function(e){return String(e)},date:function(e){function t(e){return e<10?"0"+e:e}return'"'+e.getFullYear()+"-"+t(e.getMonth()+1)+"-"+t(e.getDate())+"T"+t(e.getHours())+":"+t(e.getMinutes())+":"+t(e.getSeconds())+'"'}},CLASS_NAME:"OpenLayers.Format.JSON"}),OpenLayers.Format.GeoJSON=OpenLayers.Class(OpenLayers.Format.JSON,{ignoreExtraDims:!1,read:function(e,t,n){t=t?t:"FeatureCollection";var r=null,i=null;typeof e=="string"?i=OpenLayers.Format.JSON.prototype.read.apply(this,[e,n]):i=e;if(!i)OpenLayers.Console.error("Bad JSON: "+e);else if(typeof i.type!="string")OpenLayers.Console.error("Bad GeoJSON - no type: "+e);else if(this.isValidType(i,t))switch(t){case"Geometry":try{r=this.parseGeometry(i)}catch(s){OpenLayers.Console.error(s)}break;case"Feature":try{r=this.parseFeature(i),r.type="Feature"}catch(s){OpenLayers.Console.error(s)}break;case"FeatureCollection":r=[];switch(i.type){case"Feature":try{r.push(this.parseFeature(i))}catch(s){r=null,OpenLayers.Console.error(s)}break;case"FeatureCollection":for(var o=0,u=i.features.length;o<u;++o)try{r.push(this.parseFeature(i.features[o]))}catch(s){r=null,OpenLayers.Console.error(s)}break;default:try{var a=this.parseGeometry(i);r.push(new OpenLayers.Feature.Vector(a))}catch(s){r=null,OpenLayers.Console.error(s)}}}return r},isValidType:function(e,t){var n=!1;switch(t){case"Geometry":OpenLayers.Util.indexOf(["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon","Box","GeometryCollection"],e.type)==-1?OpenLayers.Console.error("Unsupported geometry type: "+e.type):n=!0;break;case"FeatureCollection":n=!0;break;default:e.type==t?n=!0:OpenLayers.Console.error("Cannot convert types from "+e.type+" to "+t)}return n},parseFeature:function(e){var t,n,r,i;r=e.properties?e.properties:{},i=e.geometry&&e.geometry.bbox||e.bbox;try{n=this.parseGeometry(e.geometry)}catch(s){throw s}return t=new OpenLayers.Feature.Vector(n,r),i&&(t.bounds=OpenLayers.Bounds.fromArray(i)),e.id&&(t.fid=e.id),t},parseGeometry:function(e){if(e==null)return null;var t,n=!1;if(e.type=="GeometryCollection"){if(!OpenLayers.Util.isArray(e.geometries))throw"GeometryCollection must have geometries array: "+e;var r=e.geometries.length,i=new Array(r);for(var s=0;s<r;++s)i[s]=this.parseGeometry.apply(this,[e.geometries[s]]);t=new OpenLayers.Geometry.Collection(i),n=!0}else{if(!OpenLayers.Util.isArray(e.coordinates))throw"Geometry must have coordinates array: "+e;if(!this.parseCoords[e.type.toLowerCase()])throw"Unsupported geometry type: "+e.type;try{t=this.parseCoords[e.type.toLowerCase()].apply(this,[e.coordinates])}catch(o){throw o}}return this.internalProjection&&this.externalProjection&&!n&&t.transform(this.externalProjection,this.internalProjection),t},parseCoords:{point:function(e){if(this.ignoreExtraDims==0&&e.length!=2)throw"Only 2D points are supported: "+e;return new OpenLayers.Geometry.Point(e[0],e[1])},multipoint:function(e){var t=[],n=null;for(var r=0,i=e.length;r<i;++r){try{n=this.parseCoords.point.apply(this,[e[r]])}catch(s){throw s}t.push(n)}return new OpenLayers.Geometry.MultiPoint(t)},linestring:function(e){var t=[],n=null;for(var r=0,i=e.length;r<i;++r){try{n=this.parseCoords.point.apply(this,[e[r]])}catch(s){throw s}t.push(n)}return new OpenLayers.Geometry.LineString(t)},multilinestring:function(e){var t=[],n=null;for(var r=0,i=e.length;r<i;++r){try{n=this.parseCoords.linestring.apply(this,[e[r]])}catch(s){throw s}t.push(n)}return new OpenLayers.Geometry.MultiLineString(t)},polygon:function(e){var t=[],n,r;for(var i=0,s=e.length;i<s;++i){try{r=this.parseCoords.linestring.apply(this,[e[i]])}catch(o){throw o}n=new OpenLayers.Geometry.LinearRing(r.components),t.push(n)}return new OpenLayers.Geometry.Polygon(t)},multipolygon:function(e){var t=[],n=null;for(var r=0,i=e.length;r<i;++r){try{n=this.parseCoords.polygon.apply(this,[e[r]])}catch(s){throw s}t.push(n)}return new OpenLayers.Geometry.MultiPolygon(t)},box:function(e){if(e.length!=2)throw"GeoJSON box coordinates must have 2 elements";return new OpenLayers.Geometry.Polygon([new OpenLayers.Geometry.LinearRing([new OpenLayers.Geometry.Point(e[0][0],e[0][1]),new OpenLayers.Geometry.Point(e[1][0],e[0][1]),new OpenLayers.Geometry.Point(e[1][0],e[1][1]),new OpenLayers.Geometry.Point(e[0][0],e[1][1]),new OpenLayers.Geometry.Point(e[0][0],e[0][1])])])}},write:function(e,t){var n={type:null};if(OpenLayers.Util.isArray(e)){n.type="FeatureCollection";var r=e.length;n.features=new Array(r);for(var i=0;i<r;++i){var s=e[i];if(!s instanceof OpenLayers.Feature.Vector){var o="FeatureCollection only supports collections of features: "+s;throw o}n.features[i]=this.extract.feature.apply(this,[s])}}else e.CLASS_NAME.indexOf("OpenLayers.Geometry")==0?n=this.extract.geometry.apply(this,[e]):e instanceof OpenLayers.Feature.Vector&&(n=this.extract.feature.apply(this,[e]),e.layer&&e.layer.projection&&(n.crs=this.createCRSObject(e)));return OpenLayers.Format.JSON.prototype.write.apply(this,[n,t])},createCRSObject:function(e){var t=e.layer.projection.toString(),n={};if(t.match(/epsg:/i)){var r=parseInt(t.substring(t.indexOf(":")+1));r==4326?n={type:"name",properties:{name:"urn:ogc:def:crs:OGC:1.3:CRS84"}}:n={type:"name",properties:{name:"EPSG:"+r}}}return n},extract:{feature:function(e){var t=this.extract.geometry.apply(this,[e.geometry]),n={type:"Feature",properties:e.attributes,geometry:t};return e.fid!=null&&(n.id=e.fid),n},geometry:function(e){if(e==null)return null;this.internalProjection&&this.externalProjection&&(e=e.clone(),e.transform(this.internalProjection,this.externalProjection));var t=e.CLASS_NAME.split(".")[2],n=this.extract[t.toLowerCase()].apply(this,[e]),r;return t=="Collection"?r={type:"GeometryCollection",geometries:n}:r={type:t,coordinates:n},r},point:function(e){return[e.x,e.y]},multipoint:function(e){var t=[];for(var n=0,r=e.components.length;n<r;++n)t.push(this.extract.point.apply(this,[e.components[n]]));return t},linestring:function(e){var t=[];for(var n=0,r=e.components.length;n<r;++n)t.push(this.extract.point.apply(this,[e.components[n]]));return t},multilinestring:function(e){var t=[];for(var n=0,r=e.components.length;n<r;++n)t.push(this.extract.linestring.apply(this,[e.components[n]]));return t},polygon:function(e){var t=[];for(var n=0,r=e.components.length;n<r;++n)t.push(this.extract.linestring.apply(this,[e.components[n]]));return t},multipolygon:function(e){var t=[];for(var n=0,r=e.components.length;n<r;++n)t.push(this.extract.polygon.apply(this,[e.components[n]]));return t},collection:function(e){var t=e.components.length,n=new Array(t);for(var r=0;r<t;++r)n[r]=this.extract.geometry.apply(this,[e.components[r]]);return n}},CLASS_NAME:"OpenLayers.Format.GeoJSON"}),OpenLayers.Events.buttonclick=OpenLayers.Class({target:null,events:["mousedown","mouseup","click","dblclick","touchstart","touchmove","touchend","keydown"],startRegEx:/^mousedown|touchstart$/,cancelRegEx:/^touchmove$/,completeRegEx:/^mouseup|touchend$/,initialize:function(e){this.target=e;for(var t=this.events.length-1;t>=0;--t)this.target.register(this.events[t],this,this.buttonClick,{extension:!0})},destroy:function(){for(var e=this.events.length-1;e>=0;--e)this.target.unregister(this.events[e],this,this.buttonClick);delete this.target},getPressedButton:function(e){var t=3,n;do{if(OpenLayers.Element.hasClass(e,"olButton")){n=e;break}e=e.parentNode}while(--t>0&&e);return n},buttonClick:function(e){var t=!0,n=OpenLayers.Event.element(e);if(n&&(OpenLayers.Event.isLeftClick(e)||!~e.type.indexOf("mouse"))){var r=this.getPressedButton(n);if(r){if(e.type==="keydown")switch(e.keyCode){case OpenLayers.Event.KEY_RETURN:case OpenLayers.Event.KEY_SPACE:this.target.triggerEvent("buttonclick",{buttonElement:r}),OpenLayers.Event.stop(e),t=!1}else if(this.startEvt){if(this.completeRegEx.test(e.type)){var i=OpenLayers.Util.pagePosition(r);this.target.triggerEvent("buttonclick",{buttonElement:r,buttonXY:{x:this.startEvt.clientX-i[0],y:this.startEvt.clientY-i[1]}})}this.cancelRegEx.test(e.type)&&delete this.startEvt,OpenLayers.Event.stop(e),t=!1}this.startRegEx.test(e.type)&&(this.startEvt=e,OpenLayers.Event.stop(e),t=!1)}else delete this.startEvt}return t}}),OpenLayers.Control.Panel=OpenLayers.Class(OpenLayers.Control,{controls:null,autoActivate:!0,defaultControl:null,saveState:!1,allowDepress:!1,activeState:null,initialize:function(e){OpenLayers.Control.prototype.initialize.apply(this,[e]),this.controls=[],this.activeState={}},destroy:function(){this.map&&this.map.events.unregister("buttonclick",this,this.onButtonClick),OpenLayers.Control.prototype.destroy.apply(this,arguments);for(var e,t=this.controls.length-1;t>=0;t--)e=this.controls[t],e.events&&e.events.un({activate:this.iconOn,deactivate:this.iconOff}),e.panel_div=null;this.activeState=null},activate:function(){if(OpenLayers.Control.prototype.activate.apply(this,arguments)){var e;for(var t=0,n=this.controls.length;t<n;t++)e=this.controls[t],(e===this.defaultControl||this.saveState&&this.activeState[e.id])&&e.activate();return this.saveState===!0&&(this.defaultControl=null),this.redraw(),!0}return!1},deactivate:function(){if(OpenLayers.Control.prototype.deactivate.apply(this,arguments)){var e;for(var t=0,n=this.controls.length;t<n;t++)e=this.controls[t],this.activeState[e.id]=e.deactivate();return this.redraw(),!0}return!1},draw:function(){return OpenLayers.Control.prototype.draw.apply(this,arguments),this.outsideViewport?(this.events.attachToElement(this.div),this.events.register("buttonclick",this,this.onButtonClick)):this.map.events.register("buttonclick",this,this.onButtonClick),this.addControlsToMap(this.controls),this.div},redraw:function(){for(var e=this.div.childNodes.length,t=e-1;t>=0;t--)this.div.removeChild(this.div.childNodes[t]);this.div.innerHTML="";if(this.active)for(var t=0,n=this.controls.length;t<n;t++)this.div.appendChild(this.controls[t].panel_div)},activateControl:function(e){if(!this.active)return!1;if(e.type==OpenLayers.Control.TYPE_BUTTON){e.trigger();return}if(e.type==OpenLayers.Control.TYPE_TOGGLE){e.active?e.deactivate():e.activate();return}if(this.allowDepress&&e.active)e.deactivate();else{var t;for(var n=0,r=this.controls.length;n<r;n++)t=this.controls[n],t!=e&&(t.type===OpenLayers.Control.TYPE_TOOL||t.type==null)&&t.deactivate();e.activate()}},addControls:function(e){OpenLayers.Util.isArray(e)||(e=[e]),this.controls=this.controls.concat(e);for(var t=0,n=e.length;t<n;t++){var r=e[t],i=this.createControlMarkup(r);OpenLayers.Element.addClass(i,r.displayClass+"ItemInactive"),OpenLayers.Element.addClass(i,"olButton"),r.title!=""&&!i.title&&(i.title=r.title),r.panel_div=i}this.map&&(this.addControlsToMap(e),this.redraw())},createControlMarkup:function(e){return document.createElement("div")},addControlsToMap:function(e){var t;for(var n=0,r=e.length;n<r;n++)t=e[n],t.autoActivate===!0?(t.autoActivate=!1,this.map.addControl(t),t.autoActivate=!0):(this.map.addControl(t),t.deactivate()),t.events.on({activate:this.iconOn,deactivate:this.iconOff})},iconOn:function(){var e=this.panel_div,t=new RegExp("\\b("+this.displayClass+"Item)Inactive\\b");e.className=e.className.replace(t,"$1Active")},iconOff:function(){var e=this.panel_div,t=new RegExp("\\b("+this.displayClass+"Item)Active\\b");e.className=e.className.replace(t,"$1Inactive")},onButtonClick:function(e){var t=this.controls,n=e.buttonElement;for(var r=t.length-1;r>=0;--r)if(t[r].panel_div===n){this.activateControl(t[r]);break}},getControlsBy:function(e,t){var n=typeof t.test=="function",r=OpenLayers.Array.filter(this.controls,function(r){return r[e]==t||n&&t.test(r[e])});return r},getControlsByName:function(e){return this.getControlsBy("name",e)},getControlsByClass:function(e){return this.getControlsBy("CLASS_NAME",e)},CLASS_NAME:"OpenLayers.Control.Panel"}),OpenLayers.Strategy=OpenLayers.Class({layer:null,options:null,active:null,autoActivate:!0,autoDestroy:!0,initialize:function(e){OpenLayers.Util.extend(this,e),this.options=e,this.active=!1},destroy:function(){this.deactivate(),this.layer=null,this.options=null},setLayer:function(e){this.layer=e},activate:function(){return this.active?!1:(this.active=!0,!0)},deactivate:function(){return this.active?(this.active=!1,!0):!1},CLASS_NAME:"OpenLayers.Strategy"}),OpenLayers.Strategy.Fixed=OpenLayers.Class(OpenLayers.Strategy,{preload:!1,activate:function(){return OpenLayers.Strategy.prototype.activate.apply(this,arguments)?(this.layer.events.on({refresh:this.load,scope:this}),this.layer.visibility==1||this.preload?this.load():this.layer.events.on({visibilitychanged:this.load,scope:this}),!0):!1},deactivate:function(){var e=OpenLayers.Strategy.prototype.deactivate.call(this);return e&&this.layer.events.un({refresh:this.load,visibilitychanged:this.load,scope:this}),e},load:function(e){var t=this.layer;t.events.triggerEvent("loadstart"),t.protocol.read(OpenLayers.Util.applyDefaults({callback:OpenLayers.Function.bind(this.merge,this,t.map.getProjectionObject()),filter:t.filter},e)),t.events.un({visibilitychanged:this.load,scope:this})},merge:function(e,t){var n=this.layer;n.destroyFeatures();var r=t.features;if(r&&r.length>0){if(!e.equals(n.projection)){var i;for(var s=0,o=r.length;s<o;++s)i=r[s].geometry,i&&i.transform(n.projection,e)}n.addFeatures(r)}n.events.triggerEvent("loadend")},CLASS_NAME:"OpenLayers.Strategy.Fixed"}),OpenLayers.Icon=OpenLayers.Class({url:null,size:null,offset:null,calculateOffset:null,imageDiv:null,px:null,initialize:function(e,t,n,r){this.url=e,this.size=t||{w:20,h:20},this.offset=n||{x:-(this.size.w/2),y:-(this.size.h/2)},this.calculateOffset=r;var i=OpenLayers.Util.createUniqueID("OL_Icon_");this.imageDiv=OpenLayers.Util.createAlphaImageDiv(i)},destroy:function(){this.erase(),OpenLayers.Event.stopObservingElement(this.imageDiv.firstChild),this.imageDiv.innerHTML="",this.imageDiv=null},clone:function(){return new OpenLayers.Icon(this.url,this.size,this.offset,this.calculateOffset)},setSize:function(e){e!=null&&(this.size=e),this.draw()},setUrl:function(e){e!=null&&(this.url=e),this.draw()},draw:function(e){return OpenLayers.Util.modifyAlphaImageDiv(this.imageDiv,null,null,this.size,this.url,"absolute"),this.moveTo(e),this.imageDiv},erase:function(){this.imageDiv!=null&&this.imageDiv.parentNode!=null&&OpenLayers.Element.remove(this.imageDiv)},setOpacity:function(e){OpenLayers.Util.modifyAlphaImageDiv(this.imageDiv,null,null,null,null,null,null,null,e)},moveTo:function(e){e!=null&&(this.px=e),this.imageDiv!=null&&(this.px==null?this.display(!1):(this.calculateOffset&&(this.offset=this.calculateOffset(this.size)),OpenLayers.Util.modifyAlphaImageDiv(this.imageDiv,null,{x:this.px.x+this.offset.x,y:this.px.y+this.offset.y})))},display:function(e){this.imageDiv.style.display=e?"":"none"},isDrawn:function(){var e=this.imageDiv&&this.imageDiv.parentNode&&this.imageDiv.parentNode.nodeType!=11;return e},CLASS_NAME:"OpenLayers.Icon"}),OpenLayers.Renderer.Canvas=OpenLayers.Class(OpenLayers.Renderer,{hitDetection:!0,hitOverflow:0,canvas:null,features:null,pendingRedraw:!1,cachedSymbolBounds:{},initialize:function(e,t){OpenLayers.Renderer.prototype.initialize.apply(this,arguments),this.root=document.createElement("canvas"),this.container.appendChild(this.root),this.canvas=this.root.getContext("2d"),this.features={},this.hitDetection&&(this.hitCanvas=document.createElement("canvas"),this.hitContext=this.hitCanvas.getContext("2d"))},setExtent:function(){return OpenLayers.Renderer.prototype.setExtent.apply(this,arguments),!1},eraseGeometry:function(e,t){this.eraseFeatures(this.features[t][0])},supported:function(){return OpenLayers.CANVAS_SUPPORTED},setSize:function(e){this.size=e.clone();var t=this.root;t.style.width=e.w+"px",t.style.height=e.h+"px",t.width=e.w,t.height=e.h,this.resolution=null;if(this.hitDetection){var n=this.hitCanvas;n.style.width=e.w+"px",n.style.height=e.h+"px",n.width=e.w,n.height=e.h}},drawFeature:function(e,t){var n;if(e.geometry){t=this.applyDefaultSymbolizer(t||e.style);var r=e.geometry.getBounds(),i;this.map.baseLayer&&this.map.baseLayer.wrapDateLine&&(i=this.map.getMaxExtent());var s=r&&r.intersectsBounds(this.extent,{worldBounds:i});n=t.display!=="none"&&!!r&&s,n?this.features[e.id]=[e,t]:delete this.features[e.id],this.pendingRedraw=!0}return this.pendingRedraw&&!this.locked&&(this.redraw(),this.pendingRedraw=!1),n},drawGeometry:function(e,t,n){var r=e.CLASS_NAME;if(r=="OpenLayers.Geometry.Collection"||r=="OpenLayers.Geometry.MultiPoint"||r=="OpenLayers.Geometry.MultiLineString"||r=="OpenLayers.Geometry.MultiPolygon"){for(var i=0;i<e.components.length;i++)this.drawGeometry(e.components[i],t,n);return}switch(e.CLASS_NAME){case"OpenLayers.Geometry.Point":this.drawPoint(e,t,n);break;case"OpenLayers.Geometry.LineString":this.drawLineString(e,t,n);break;case"OpenLayers.Geometry.LinearRing":this.drawLinearRing(e,t,n);break;case"OpenLayers.Geometry.Polygon":this.drawPolygon(e,t,n);break;default:}},drawExternalGraphic:function(e,t,n){var r=new Image;t.graphicTitle&&(r.title=t.graphicTitle);var i=t.graphicWidth||t.graphicHeight,s=t.graphicHeight||t.graphicWidth;i=i?i:t.pointRadius*2,s=s?s:t.pointRadius*2;var o=t.graphicXOffset!=undefined?t.graphicXOffset:-(.5*i),u=t.graphicYOffset!=undefined?t.graphicYOffset:-(.5*s),a=t.graphicOpacity||t.fillOpacity,f=function(){if(!this.features[n])return;var t=this.getLocalXY(e),f=t[0],l=t[1];if(!isNaN(f)&&!isNaN(l)){var c=f+o|0,h=l+u|0,p=this.canvas;p.globalAlpha=a;var d=OpenLayers.Renderer.Canvas.drawImageScaleFactor||(OpenLayers.Renderer.Canvas.drawImageScaleFactor=/android 2.1/.test(navigator.userAgent.toLowerCase())?320/window.screen.width:1);p.drawImage(r,c*d,h*d,i*d,s*d),this.hitDetection&&(this.setHitContextStyle("fill",n),this.hitContext.fillRect(c,h,i,s))}};r.onload=OpenLayers.Function.bind(f,this),r.src=t.externalGraphic},drawNamedSymbol:function(e,t,n){var r,i,s,o,u,a,f,l,c,h=Math.PI/180,p=OpenLayers.Renderer.symbol[t.graphicName];if(!p)throw new Error(t.graphicName+" is not a valid symbol name");if(!p.length||p.length<2)return;var d=this.getLocalXY(e),v=d[0],m=d[1];if(isNaN(v)||isNaN(m))return;this.canvas.lineCap="round",this.canvas.lineJoin="round",this.hitDetection&&(this.hitContext.lineCap="round",this.hitContext.lineJoin="round");if(t.graphicName in this.cachedSymbolBounds)a=this.cachedSymbolBounds[t.graphicName];else{a=new OpenLayers.Bounds;for(u=0;u<p.length;u+=2)a.extend(new OpenLayers.LonLat(p[u],p[u+1]));this.cachedSymbolBounds[t.graphicName]=a}this.canvas.save(),this.hitDetection&&this.hitContext.save(),this.canvas.translate(v,m),this.hitDetection&&this.hitContext.translate(v,m),l=h*t.rotation,isNaN(l)||(this.canvas.rotate(l),this.hitDetection&&this.hitContext.rotate(l)),f=2*t.pointRadius/Math.max(a.getWidth(),a.getHeight()),this.canvas.scale(f,f),this.hitDetection&&this.hitContext.scale(f,f),s=a.getCenterLonLat().lon,o=a.getCenterLonLat().lat,this.canvas.translate(-s,-o),this.hitDetection&&this.hitContext.translate(-s,-o),c=t.strokeWidth,t.strokeWidth=c/f;if(t.fill!==!1){this.setCanvasStyle("fill",t),this.canvas.beginPath();for(u=0;u<p.length;u+=2)r=p[u],i=p[u+1],u==0&&this.canvas.moveTo(r,i),this.canvas.lineTo(r,i);this.canvas.closePath(),this.canvas.fill();if(this.hitDetection){this.setHitContextStyle("fill",n,t),this.hitContext.beginPath();for(u=0;u<p.length;u+=2)r=p[u],i=p[u+1],u==0&&this.canvas.moveTo(r,i),this.hitContext.lineTo(r,i);this.hitContext.closePath(),this.hitContext.fill()}}if(t.stroke!==!1){this.setCanvasStyle("stroke",t),this.canvas.beginPath();for(u=0;u<p.length;u+=2)r=p[u],i=p[u+1],u==0&&this.canvas.moveTo(r,i),this.canvas.lineTo(r,i);this.canvas.closePath(),this.canvas.stroke();if(this.hitDetection){this.setHitContextStyle("stroke",n,t,f),this.hitContext.beginPath();for(u=0;u<p.length;u+=2)r=p[u],i=p[u+1],u==0&&this.hitContext.moveTo(r,i),this.hitContext.lineTo(r,i);this.hitContext.closePath(),this.hitContext.stroke()}}t.strokeWidth=c,this.canvas.restore(),this.hitDetection&&this.hitContext.restore(),this.setCanvasStyle("reset")},setCanvasStyle:function(e,t){e==="fill"?(this.canvas.globalAlpha=t.fillOpacity,this.canvas.fillStyle=t.fillColor):e==="stroke"?(this.canvas.globalAlpha=t.strokeOpacity,this.canvas.strokeStyle=t.strokeColor,this.canvas.lineWidth=t.strokeWidth):(this.canvas.globalAlpha=0,this.canvas.lineWidth=1)},featureIdToHex:function(e){var t=Number(e.split("_").pop())+1;t>=16777216&&(this.hitOverflow=t-16777215,t=t%16777216+1);var n="000000"+t.toString(16),r=n.length;return n="#"+n.substring(r-6,r),n},setHitContextStyle:function(e,t,n,r){var i=this.featureIdToHex(t);e=="fill"?(this.hitContext.globalAlpha=1,this.hitContext.fillStyle=i):e=="stroke"?(this.hitContext.globalAlpha=1,this.hitContext.strokeStyle=i,typeof r=="undefined"?this.hitContext.lineWidth=n.strokeWidth+2:isNaN(r)||(this.hitContext.lineWidth=n.strokeWidth+2/r)):(this.hitContext.globalAlpha=0,this.hitContext.lineWidth=1)},drawPoint:function(e,t,n){if(t.graphic!==!1)if(t.externalGraphic)this.drawExternalGraphic(e,t,n);else if(t.graphicName&&t.graphicName!="circle")this.drawNamedSymbol(e,t,n);else{var r=this.getLocalXY(e),i=r[0],s=r[1];if(!isNaN(i)&&!isNaN(s)){var o=Math.PI*2,u=t.pointRadius;t.fill!==!1&&(this.setCanvasStyle("fill",t),this.canvas.beginPath(),this.canvas.arc(i,s,u,0,o,!0),this.canvas.fill(),this.hitDetection&&(this.setHitContextStyle("fill",n,t),this.hitContext.beginPath(),this.hitContext.arc(i,s,u,0,o,!0),this.hitContext.fill())),t.stroke!==!1&&(this.setCanvasStyle("stroke",t),this.canvas.beginPath(),this.canvas.arc(i,s,u,0,o,!0),this.canvas.stroke(),this.hitDetection&&(this.setHitContextStyle("stroke",n,t),this.hitContext.beginPath(),this.hitContext.arc(i,s,u,0,o,!0),this.hitContext.stroke()),this.setCanvasStyle("reset"))}}},drawLineString:function(e,t,n){t=OpenLayers.Util.applyDefaults({fill:!1},t),this.drawLinearRing(e,t,n)},drawLinearRing:function(e,t,n){t.fill!==!1&&(this.setCanvasStyle("fill",t),this.renderPath(this.canvas,e,t,n,"fill"),this.hitDetection&&(this.setHitContextStyle("fill",n,t),this.renderPath(this.hitContext,e,t,n,"fill"))),t.stroke!==!1&&(this.setCanvasStyle("stroke",t),this.renderPath(this.canvas,e,t,n,"stroke"),this.hitDetection&&(this.setHitContextStyle("stroke",n,t),this.renderPath(this.hitContext,e,t,n,"stroke"))),this.setCanvasStyle("reset")},renderPath:function(e,t,n,r,i){var s=t.components,o=s.length;e.beginPath();var u=this.getLocalXY(s[0]),a=u[0],f=u[1];if(!isNaN(a)&&!isNaN(f)){e.moveTo(u[0],u[1]);for(var l=1;l<o;++l){var c=this.getLocalXY(s[l]);e.lineTo(c[0],c[1])}i==="fill"?e.fill():e.stroke()}},drawPolygon:function(e,t,n){var r=e.components,i=r.length;this.drawLinearRing(r[0],t,n);for(var s=1;s<i;++s)this.canvas.globalCompositeOperation="destination-out",this.hitDetection&&(this.hitContext.globalCompositeOperation="destination-out"),this.drawLinearRing(r[s],OpenLayers.Util.applyDefaults({stroke:!1,fillOpacity:1},t),n),this.canvas.globalCompositeOperation="source-over",this.hitDetection&&(this.hitContext.globalCompositeOperation="source-over"),this.drawLinearRing(r[s],OpenLayers.Util.applyDefaults({fill:!1},t),n)},drawText:function(e,t){var n=this.getLocalXY(e);this.setCanvasStyle("reset"),this.canvas.fillStyle=t.fontColor,this.canvas.globalAlpha=t.fontOpacity||1;var r=[t.fontStyle?t.fontStyle:"normal","normal",t.fontWeight?t.fontWeight:"normal",t.fontSize?t.fontSize:"1em",t.fontFamily?t.fontFamily:"sans-serif"].join(" "),i=t.label.split("\n"),s=i.length;if(this.canvas.fillText){this.canvas.font=r,this.canvas.textAlign=OpenLayers.Renderer.Canvas.LABEL_ALIGN[t.labelAlign[0]]||"center",this.canvas.textBaseline=OpenLayers.Renderer.Canvas.LABEL_ALIGN[t.labelAlign[1]]||"middle";var o=OpenLayers.Renderer.Canvas.LABEL_FACTOR[t.labelAlign[1]];o==null&&(o=-0.5);var u=this.canvas.measureText("Mg").height||this.canvas.measureText("xx").width;n[1]+=u*o*(s-1);for(var a=0;a<s;a++)t.labelOutlineWidth&&(this.canvas.save(),this.canvas.strokeStyle=t.labelOutlineColor,this.canvas.lineWidth=t.labelOutlineWidth,this.canvas.strokeText(i[a],n[0],n[1]+u*a+1),this.canvas.restore()),this.canvas.fillText(i[a],n[0],n[1]+u*a)}else if(this.canvas.mozDrawText){this.canvas.mozTextStyle=r;var f=OpenLayers.Renderer.Canvas.LABEL_FACTOR[t.labelAlign[0]];f==null&&(f=-0.5);var o=OpenLayers.Renderer.Canvas.LABEL_FACTOR[t.labelAlign[1]];o==null&&(o=-0.5);var u=this.canvas.mozMeasureText("xx");n[1]+=u*(1+o*s);for(var a=0;a<s;a++){var l=n[0]+f*this.canvas.mozMeasureText(i[a]),c=n[1]+a*u;this.canvas.translate(l,c),this.canvas.mozDrawText(i[a]),this.canvas.translate(-l,-c)}}this.setCanvasStyle("reset")},getLocalXY:function(e){var t=this.getResolution(),n=this.extent,r=(e.x-this.featureDx)/t+ -n.left/t,i=n.top/t-e.y/t;return[r,i]},clear:function(){var e=this.root.height,t=this.root.width;this.canvas.clearRect(0,0,t,e),this.features={},this.hitDetection&&this.hitContext.clearRect(0,0,t,e)},getFeatureIdFromEvent:function(e){var t,n;if(this.hitDetection&&this.root.style.display!=="none"&&!this.map.dragging){var r=e.xy,i=r.x|0,s=r.y|0,o=this.hitContext.getImageData(i,s,1,1).data;if(o[3]===255){var u=o[2]+256*(o[1]+256*o[0]);if(u){t="OpenLayers.Feature.Vector_"+(u-1+this.hitOverflow);try{n=this.features[t][0]}catch(a){}}}}return n},eraseFeatures:function(e){OpenLayers.Util.isArray(e)||(e=[e]);for(var t=0;t<e.length;++t)delete this.features[e[t].id];this.redraw()},redraw:function(){if(!this.locked){var e=this.root.height,t=this.root.width;this.canvas.clearRect(0,0,t,e),this.hitDetection&&this.hitContext.clearRect(0,0,t,e);var n=[],r,i,s,o=this.map.baseLayer&&this.map.baseLayer.wrapDateLine&&this.map.getMaxExtent();for(var u in this.features){if(!this.features.hasOwnProperty(u))continue;r=this.features[u][0],i=r.geometry,this.calculateFeatureDx(i.getBounds(),o),s=this.features[u][1],this.drawGeometry(i,s,r.id),s.label&&n.push([r,s])}var a;for(var f=0,l=n.length;f<l;++f)a=n[f],this.drawText(a[0].geometry.getCentroid(),a[1])}},CLASS_NAME:"OpenLayers.Renderer.Canvas"}),OpenLayers.Renderer.Canvas.LABEL_ALIGN={l:"left",r:"right",t:"top",b:"bottom"},OpenLayers.Renderer.Canvas.LABEL_FACTOR={l:0,r:-1,t:0,b:-1},OpenLayers.Renderer.Canvas.drawImageScaleFactor=null,OpenLayers.Control.Scale=OpenLayers.Class(OpenLayers.Control,{element:null,geodesic:!1,initialize:function(e,t){OpenLayers.Control.prototype.initialize.apply(this,[t]),this.element=OpenLayers.Util.getElement(e)},draw:function(){return OpenLayers.Control.prototype.draw.apply(this,arguments),this.element||(this.element=document.createElement("div"),this.div.appendChild(this.element)),this.map.events.register("moveend",this,this.updateScale),this.updateScale(),this.div},updateScale:function(){var e;if(this.geodesic===!0){var t=this.map.getUnits();if(!t)return;var n=OpenLayers.INCHES_PER_UNIT;e=(this.map.getGeodesicPixelSize().w||1e-6)*n.km*OpenLayers.DOTS_PER_INCH}else e=this.map.getScale();if(!e)return;e>=9500&&e<=95e4?e=Math.round(e/1e3)+"K":e>=95e4?e=Math.round(e/1e6)+"M":e=Math.round(e),this.element.innerHTML=OpenLayers.i18n("Scale = 1 : ${scaleDenom}",{scaleDenom:e})},CLASS_NAME:"OpenLayers.Control.Scale"}),define("openlayers",function(){}),define("map",["message-bus","layout","openlayers"],function(e,t){var n=null,r=null,i=null,s=function(e,t){r!=null&&(r.deactivate(),n.removeControl(r)),n.addControl(t),t.activate(),r=t};return OpenLayers.ProxyHost="proxy?url=",n=new OpenLayers.Map(t.map.attr("id"),{theme:null,projection:new OpenLayers.Projection("EPSG:900913"),displayProjection:new OpenLayers.Projection("EPSG:4326"),units:"m",allOverlays:!0,controls:[]}),n.addControl(new OpenLayers.Control.Navigation),n.addControl(new OpenLayers.Control.Scale),e.listen("add-layer",function(t,r){var i=new OpenLayers.Layer.WMS("WMS layer",r.baseUrl,{layers:r.wmsName,buffer:0,transitionEffect:"resize",removeBackBufferDelay:0,isBaseLayer:!1,transparent:!0});i.id=r.id,n!==null&&n.addLayer(i),e.send("maplayer-added",[i,r])}),e.listen("layers-loaded",function(){var e=new OpenLayers.StyleMap({strokeWidth:5,fillOpacity:0,strokeColor:"#ee4400",strokeOpacity:.5,strokeLinecap:"round"}),t=new OpenLayers.Layer.Vector("Highlighted Features",{styleMap:e});t.id="Highlighted Features",n.addLayer(t)}),e.listen("layer-visibility",function(e,t,r){var i=n.getLayer(t.id);i.setVisibility(r)}),e.listen("activate-exclusive-control",function(e,t){s(e,t)}),e.listen("activate-default-exclusive-control",function(e){s(e,i)}),e.listen("set-default-exclusive-control",function(e,t){i=t}),e.listen("layer-timestamp-selected",function(e,t,r){var i=n.getLayer(t);i!==null&&r!==null&&i.mergeNewParams({time:r.toISO8601String()})}),e.listen("zoom-in",function(e){n.zoomIn()}),e.listen("zoom-out",function(e){n.zoomOut()}),e.listen("zoom-to",function(e,t){n.zoomToExtent(t)}),e.listen("transparency-slider-changed",function(e,t,r){var i=n.getLayer(t.id);i.setOpacity(r)}),n}),define("i18n",["module"],function(e){return e.config()}),define("banner",["jquery","layout","i18n","message-bus"],function(e,t,n,r){var i=e("<div/>").attr("id","flag"),s=e("<div/>").attr("id","logos"),o=e("<span/>").attr("id","title").html(n.title);return t.banner.append(i).append(s).append(o),t.banner}),function(e){(function(e,t){if(typeof exports=="object"&&exports)t(exports);else{var n={};t(n),typeof define=="function"&&define.amd?define("mustache",n):e.Mustache=n}})(this,function(e){function a(e,t){return u.call(e,t)}function f(e){return!a(r,e)}function h(e){return typeof e=="function"}function p(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function v(e){return String(e).replace(/[&<>"'\/]/g,function(e){return d[e]})}function m(e){this.string=e,this.tail=e,this.pos=0}function g(e,t){this.view=e==null?{}:e,this.parent=t,this._cache={".":this.view}}function y(){this.clearCache()}function b(t,n,r,i){function o(e){return n.render(e,r)}var s="",u,a,f;for(var l=0,p=t.length;l<p;++l){u=t[l],a=u[1];switch(u[0]){case"#":f=r.lookup(a);if(typeof f=="object"||typeof f=="string")if(c(f))for(var d=0,v=f.length;d<v;++d)s+=b(u[4],n,r.push(f[d]),i);else f&&(s+=b(u[4],n,r.push(f),i));else if(h(f)){var m=i==null?null:i.slice(u[3],u[5]);f=f.call(r.view,m,o),f!=null&&(s+=f)}else f&&(s+=b(u[4],n,r,i));break;case"^":f=r.lookup(a);if(!f||c(f)&&f.length===0)s+=b(u[4],n,r,i);break;case">":f=n.getPartial(a),h(f)&&(s+=f(r));break;case"&":f=r.lookup(a),f!=null&&(s+=f);break;case"name":f=r.lookup(a),f!=null&&(s+=e.escape(f));break;case"text":s+=a}}return s}function w(e){var t=[],n=t,r=[],i;for(var s=0,o=e.length;s<o;++s){i=e[s];switch(i[0]){case"#":case"^":r.push(i),n.push(i),n=i[4]=[];break;case"/":var u=r.pop();u[5]=i[2],n=r.length>0?r[r.length-1][4]:t;break;default:n.push(i)}}return t}function E(e){var t=[],n,r;for(var i=0,s=e.length;i<s;++i)n=e[i],n&&(n[0]==="text"&&r&&r[0]==="text"?(r[1]+=n[1],r[3]=n[3]):(r=n,t.push(n)));return t}function S(e){return[new RegExp(p(e[0])+"\\s*"),new RegExp("\\s*"+p(e[1]))]}function x(r,u){function y(){if(v&&!g)while(d.length)delete h[d.pop()];else d=[];v=!1,g=!1}r=r||"",u=u||e.tags,typeof u=="string"&&(u=u.split(n));if(u.length!==2)throw new Error("Invalid tags: "+u.join(", "));var a=S(u),l=new m(r),c=[],h=[],d=[],v=!1,g=!1,b,x,T,N,C,k;while(!l.eos()){b=l.pos,T=l.scanUntil(a[0]);if(T)for(var L=0,A=T.length;L<A;++L)N=T.charAt(L),f(N)?d.push(h.length):g=!0,h.push(["text",N,b,b+1]),b+=1,N=="\n"&&y();if(!l.scan(a[0]))break;v=!0,x=l.scan(o)||"name",l.scan(t),x==="="?(T=l.scanUntil(i),l.scan(i),l.scanUntil(a[1])):x==="{"?(T=l.scanUntil(new RegExp("\\s*"+p("}"+u[1]))),l.scan(s),l.scanUntil(a[1]),x="&"):T=l.scanUntil(a[1]);if(!l.scan(a[1]))throw new Error("Unclosed tag at "+l.pos);C=[x,T,b,l.pos],h.push(C);if(x==="#"||x==="^")c.push(C);else if(x==="/"){k=c.pop();if(!k)throw new Error('Unopened section "'+T+'" at '+b);if(k[1]!==T)throw new Error('Unclosed section "'+k[1]+'" at '+b)}else if(x==="name"||x==="{"||x==="&")g=!0;else if(x==="="){u=T.split(n);if(u.length!==2)throw new Error("Invalid tags at "+b+": "+u.join(", "));a=S(u)}}k=c.pop();if(k)throw new Error('Unclosed section "'+k[1]+'" at '+l.pos);return w(E(h))}var t=/\s*/,n=/\s+/,r=/\S/,i=/\s*=/,s=/\s*\}/,o=/#|\^|\/|>|\{|&|=|!/,u=RegExp.prototype.test,l=Object.prototype.toString,c=Array.isArray||function(e){return l.call(e)==="[object Array]"},d={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};m.prototype.eos=function(){return this.tail===""},m.prototype.scan=function(e){var t=this.tail.match(e);if(t&&t.index===0){var n=t[0];return this.tail=this.tail.substring(n.length),this.pos+=n.length,n}return""},m.prototype.scanUntil=function(e){var t=this.tail.search(e),n;switch(t){case-1:n=this.tail,this.tail="";break;case 0:n="";break;default:n=this.tail.substring(0,t),this.tail=this.tail.substring(t)}return this.pos+=n.length,n},g.make=function(e){return e instanceof g?e:new g(e)},g.prototype.push=function(e){return new g(e,this)},g.prototype.lookup=function(e){var t;if(e in this._cache)t=this._cache[e];else{var n=this;while(n){if(e.indexOf(".")>0){t=n.view;var r=e.split("."),i=0;while(t!=null&&i<r.length)t=t[r[i++]]}else t=n.view[e];if(t!=null)break;n=n.parent}this._cache[e]=t}return h(t)&&(t=t.call(this.view)),t},y.prototype.clearCache=function(){this._cache={},this._partialCache={}},y.prototype.compile=function(t,n){var r=this._cache[t];if(!r){var i=e.parse(t,n);r=this._cache[t]=this.compileTokens(i,t)}return r},y.prototype.compilePartial=function(e,t,n){var r=this.compile(t,n);return this._partialCache[e]=r,r},y.prototype.getPartial=function(e){return!(e in this._partialCache)&&this._loadPartial&&this.compilePartial(e,this._loadPartial(e)),this._partialCache[e]},y.prototype.compileTokens=function(e,t){var n=this;return function(r,i){if(i)if(h(i))n._loadPartial=i;else for(var s in i)n.compilePartial(s,i[s]);return b(e,n,g.make(r),t)}},y.prototype.render=function(e,t,n){return this.compile(e)(t,n)},e.name="mustache.js",e.version="0.7.3",e.tags=["{{","}}"],e.Scanner=m,e.Context=g,e.Writer=y,e.parse=x,e.escape=v;var T=new y;e.clearCache=function(){return T.clearCache()},e.compile=function(e,t){return T.compile(e,t)},e.compilePartial=function(e,t,n){return T.compilePartial(e,t,n)},e.compileTokens=function(e,t){return T.compileTokens(e,t)},e.render=function(e,t,n){return T.render(e,t,n)},e.to_html=function(t,n,r,i){var s=e.render(t,n,r);if(!h(i))return s;i(s)}}),e.mustache=function(e,t,n){return Mustache.render(e,t,n)},e.fn.mustache=function(t,n){return e(this).map(function(r,i){var s=e.trim(e(i).html()),o=e.mustache(s,t,n);return e(o).get()})}}(jQuery),define("toolbar",["jquery","message-bus","layout","customization","i18n","mustache"],function(e,t,n,r,i,s){var o={lang_codes:r.languages,lang_name:function(){return i[this]},selectedClass:function(){return this==r.languageCode?"selected":""}},u='{{#lang_codes}}<a class="blue_button lang_button {{selectedClass}}" href="?lang={{.}}" id="button_{{.}}">{{lang_name}}</a>{{/lang_codes}}',a=s.render(u,o),f=n.toolbar;return f.append(a),f}),function(e,t){function i(t,n){var r,i,o,u=t.nodeName.toLowerCase();return"area"===u?(r=t.parentNode,i=r.name,!t.href||!i||r.nodeName.toLowerCase()!=="map"?!1:(o=e("img[usemap=#"+i+"]")[0],!!o&&s(o))):(/input|select|textarea|button|object/.test(u)?!t.disabled:"a"===u?t.href||n:n)&&s(t)}function s(t){return e.expr.filters.visible(t)&&!e(t).parents().addBack().filter(function(){return e.css(this,"visibility")==="hidden"}).length}var n=0,r=/^ui-id-\d+$/;e.ui=e.ui||{},e.extend(e.ui,{version:"1.10.4",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),e.fn.extend({focus:function(t){return function(n,r){return typeof n=="number"?this.each(function(){var t=this;setTimeout(function(){e(t).focus(),r&&r.call(t)},n)}):t.apply(this,arguments)}}(e.fn.focus),scrollParent:function(){var t;return e.ui.ie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?t=this.parents().filter(function(){return/(relative|absolute|fixed)/.test(e.css(this,"position"))&&/(auto|scroll)/.test(e.css(this,"overflow")+e.css(this,"overflow-y")+e.css(this,"overflow-x"))}).eq(0):t=this.parents().filter(function(){return/(auto|scroll)/.test(e.css(this,"overflow")+e.css(this,"overflow-y")+e.css(this,"overflow-x"))}).eq(0),/fixed/.test(this.css("position"))||!t.length?e(document):t},zIndex:function(n){if(n!==t)return this.css("zIndex",n);if(this.length){var r=e(this[0]),i,s;while(r.length&&r[0]!==document){i=r.css("position");if(i==="absolute"||i==="relative"||i==="fixed"){s=parseInt(r.css("zIndex"),10);if(!isNaN(s)&&s!==0)return s}r=r.parent()}}return 0},uniqueId:function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++n)})},removeUniqueId:function(){return this.each(function(){r.test(this.id)&&e(this).removeAttr("id")})}}),e.extend(e.expr[":"],{data:e.expr.createPseudo?e.expr.createPseudo(function(t){return function(n){return!!e.data(n,t)}}):function(t,n,r){return!!e.data(t,r[3])},focusable:function(t){return i(t,!isNaN(e.attr(t,"tabindex")))},tabbable:function(t){var n=e.attr(t,"tabindex"),r=isNaN(n);return(r||n>=0)&&i(t,!r)}}),e("<a>").outerWidth(1).jquery||e.each(["Width","Height"],function(n,r){function u(t,n,r,s){return e.each(i,function(){n-=parseFloat(e.css(t,"padding"+this))||0,r&&(n-=parseFloat(e.css(t,"border"+this+"Width"))||0),s&&(n-=parseFloat(e.css(t,"margin"+this))||0)}),n}var i=r==="Width"?["Left","Right"]:["Top","Bottom"],s=r.toLowerCase(),o={innerWidth:e.fn.innerWidth,innerHeight:e.fn.innerHeight,outerWidth:e.fn.outerWidth,outerHeight:e.fn.outerHeight};e.fn["inner"+r]=function(n){return n===t?o["inner"+r].call(this):this.each(function(){e(this).css(s,u(this,n)+"px")})},e.fn["outer"+r]=function(t,n){return typeof t!="number"?o["outer"+r].call(this,t):this.each(function(){e(this).css(s,u(this,t,!0,n)+"px")})}}),e.fn.addBack||(e.fn.addBack=function(e){return this.add(e==null?this.prevObject:this.prevObject.filter(e))}),e("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(e.fn.removeData=function(t){return function(n){return arguments.length?t.call(this,e.camelCase(n)):t.call(this)}}(e.fn.removeData)),e.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),e.support.selectstart="onselectstart"in document.createElement("div"),e.fn.extend({disableSelection:function(){return this.bind((e.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(e){e.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),e.extend(e.ui,{plugin:{add:function(t,n,r){var i,s=e.ui[t].prototype;for(i in r)s.plugins[i]=s.plugins[i]||[],s.plugins[i].push([n,r[i]])},call:function(e,t,n){var r,i=e.plugins[t];if(!i||!e.element[0].parentNode||e.element[0].parentNode.nodeType===11)return;for(r=0;r<i.length;r++)e.options[i[r][0]]&&i[r][1].apply(e.element,n)}},hasScroll:function(t,n){if(e(t).css("overflow")==="hidden")return!1;var r=n&&n==="left"?"scrollLeft":"scrollTop",i=!1;return t[r]>0?!0:(t[r]=1,i=t[r]>0,t[r]=0,i)}})}(jQuery),function(e,t){var n=0,r=Array.prototype.slice,i=e.cleanData;e.cleanData=function(t){for(var n=0,r;(r=t[n])!=null;n++)try{e(r).triggerHandler("remove")}catch(s){}i(t)},e.widget=function(t,n,r){var i,s,o,u,a={},f=t.split(".")[0];t=t.split(".")[1],i=f+"-"+t,r||(r=n,n=e.Widget),e.expr[":"][i.toLowerCase()]=function(t){return!!e.data(t,i)},e[f]=e[f]||{},s=e[f][t],o=e[f][t]=function(e,t){if(!this._createWidget)return new o(e,t);arguments.length&&this._createWidget(e,t)},e.extend(o,s,{version:r.version,_proto:e.extend({},r),_childConstructors:[]}),u=new n,u.options=e.widget.extend({},u.options),e.each(r,function(t,r){if(!e.isFunction(r)){a[t]=r;return}a[t]=function(){var e=function(){return n.prototype[t].apply(this,arguments)},i=function(e){return n.prototype[t].apply(this,e)};return function(){var t=this._super,n=this._superApply,s;return this._super=e,this._superApply=i,s=r.apply(this,arguments),this._super=t,this._superApply=n,s}}()}),o.prototype=e.widget.extend(u,{widgetEventPrefix:s?u.widgetEventPrefix||t:t},a,{constructor:o,namespace:f,widgetName:t,widgetFullName:i}),s?(e.each(s._childConstructors,function(t,n){var r=n.prototype;e.widget(r.namespace+"."+r.widgetName,o,n._proto)}),delete s._childConstructors):n._childConstructors.push(o),e.widget.bridge(t,o)},e.widget.extend=function(n){var i=r.call(arguments,1),s=0,o=i.length,u,a;for(;s<o;s++)for(u in i[s])a=i[s][u],i[s].hasOwnProperty(u)&&a!==t&&(e.isPlainObject(a)?n[u]=e.isPlainObject(n[u])?e.widget.extend({},n[u],a):e.widget.extend({},a):n[u]=a);return n},e.widget.bridge=function(n,i){var s=i.prototype.widgetFullName||n;e.fn[n]=function(o){var u=typeof o=="string",a=r.call(arguments,1),f=this;return o=!u&&a.length?e.widget.extend.apply(null,[o].concat(a)):o,u?this.each(function(){var r,i=e.data(this,s);if(!i)return e.error("cannot call methods on "+n+" prior to initialization; "+"attempted to call method '"+o+"'");if(!e.isFunction(i[o])||o.charAt(0)==="_")return e.error("no such method '"+o+"' for "+n+" widget instance");r=i[o].apply(i,a);if(r!==i&&r!==t)return f=r&&r.jquery?f.pushStack(r.get()):r,!1}):this.each(function(){var t=e.data(this,s);t?t.option(o||{})._init():e.data(this,s,new i(o,this))}),f}},e.Widget=function(){},e.Widget._childConstructors=[],e.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(t,r){r=e(r||this.defaultElement||this)[0],this.element=e(r),this.uuid=n++,this.eventNamespace="."+this.widgetName+this.uuid,this.options=e.widget.extend({},this.options,this._getCreateOptions(),t),this.bindings=e(),this.hoverable=e(),this.focusable=e(),r!==this&&(e.data(r,this.widgetFullName,this),this._on(!0,this.element,{remove:function(e){e.target===r&&this.destroy()}}),this.document=e(r.style?r.ownerDocument:r.document||r),this.window=e(this.document[0].defaultView||this.document[0].parentWindow)),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:e.noop,_getCreateEventData:e.noop,_create:e.noop,_init:e.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(e.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled "+"ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:e.noop,widget:function(){return this.element},option:function(n,r){var i=n,s,o,u;if(arguments.length===0)return e.widget.extend({},this.options);if(typeof n=="string"){i={},s=n.split("."),n=s.shift();if(s.length){o=i[n]=e.widget.extend({},this.options[n]);for(u=0;u<s.length-1;u++)o[s[u]]=o[s[u]]||{},o=o[s[u]];n=s.pop();if(arguments.length===1)return o[n]===t?null:o[n];o[n]=r}else{if(arguments.length===1)return this.options[n]===t?null:this.options[n];i[n]=r}}return this._setOptions(i),this},_setOptions:function(e){var t;for(t in e)this._setOption(t,e[t]);return this},_setOption:function(e,t){return this.options[e]=t,e==="disabled"&&(this.widget().toggleClass(this.widgetFullName+"-disabled ui-state-disabled",!!t).attr("aria-disabled",t),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")),this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_on:function(t,n,r){var i,s=this;typeof t!="boolean"&&(r=n,n=t,t=!1),r?(n=i=e(n),this.bindings=this.bindings.add(n)):(r=n,n=this.element,i=this.widget()),e.each(r,function(r,o){function u(){if(!t&&(s.options.disabled===!0||e(this).hasClass("ui-state-disabled")))return;return(typeof o=="string"?s[o]:o).apply(s,arguments)}typeof o!="string"&&(u.guid=o.guid=o.guid||u.guid||e.guid++);var a=r.match(/^(\w+)\s*(.*)$/),f=a[1]+s.eventNamespace,l=a[2];l?i.delegate(l,f,u):n.bind(f,u)})},_off:function(e,t){t=(t||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,e.unbind(t).undelegate(t)},_delay:function(e,t){function n(){return(typeof e=="string"?r[e]:e).apply(r,arguments)}var r=this;return setTimeout(n,t||0)},_hoverable:function(t){this.hoverable=this.hoverable.add(t),this._on(t,{mouseenter:function(t){e(t.currentTarget).addClass("ui-state-hover")},mouseleave:function(t){e(t.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(t){this.focusable=this.focusable.add(t),this._on(t,{focusin:function(t){e(t.currentTarget).addClass("ui-state-focus")},focusout:function(t){e(t.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(t,n,r){var i,s,o=this.options[t];r=r||{},n=e.Event(n),n.type=(t===this.widgetEventPrefix?t:this.widgetEventPrefix+t).toLowerCase(),n.target=this.element[0],s=n.originalEvent;if(s)for(i in s)i in n||(n[i]=s[i]);return this.element.trigger(n,r),!(e.isFunction(o)&&o.apply(this.element[0],[n].concat(r))===!1||n.isDefaultPrevented())}},e.each({show:"fadeIn",hide:"fadeOut"},function(t,n){e.Widget.prototype["_"+t]=function(r,i,s){typeof i=="string"&&(i={effect:i});var o,u=i?i===!0||typeof i=="number"?n:i.effect||n:t;i=i||{},typeof i=="number"&&(i={duration:i}),o=!e.isEmptyObject(i),i.complete=s,i.delay&&r.delay(i.delay),o&&e.effects&&e.effects.effect[u]?r[t](i):u!==t&&r[u]?r[u](i.duration,i.easing,s):r.queue(function(n){e(this)[t](),s&&s.call(r[0]),n()})}})}(jQuery),function(e,t){var n=!1;e(document).mouseup(function(){n=!1}),e.widget("ui.mouse",{version:"1.10.4",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var t=this;this.element.bind("mousedown."+this.widgetName,function(e){return t._mouseDown(e)}).bind("click."+this.widgetName,function(n){if(!0===e.data(n.target,t.widgetName+".preventClickEvent"))return e.removeData(n.target,t.widgetName+".preventClickEvent"),n.stopImmediatePropagation(),!1}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&e(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(t){if(n)return;this._mouseStarted&&this._mouseUp(t),this._mouseDownEvent=t;var r=this,i=t.which===1,s=typeof this.options.cancel=="string"&&t.target.nodeName?e(t.target).closest(this.options.cancel).length:!1;if(!i||s||!this._mouseCapture(t))return!0;this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){r.mouseDelayMet=!0},this.options.delay));if(this._mouseDistanceMet(t)&&this._mouseDelayMet(t)){this._mouseStarted=this._mouseStart(t)!==!1;if(!this._mouseStarted)return t.preventDefault(),!0}return!0===e.data(t.target,this.widgetName+".preventClickEvent")&&e.removeData(t.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(e){return r._mouseMove(e)},this._mouseUpDelegate=function(e){return r._mouseUp(e)},e(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),t.preventDefault(),n=!0,!0},_mouseMove:function(t){return e.ui.ie&&(!document.documentMode||document.documentMode<9)&&!t.button?this._mouseUp(t):this._mouseStarted?(this._mouseDrag(t),t.preventDefault()):(this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,t)!==!1,this._mouseStarted?this._mouseDrag(t):this._mouseUp(t)),!this._mouseStarted)},_mouseUp:function(t){return e(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,t.target===this._mouseDownEvent.target&&e.data(t.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(t)),!1},_mouseDistanceMet:function(e){return Math.max(Math.abs(this._mouseDownEvent.pageX-e.pageX),Math.abs(this._mouseDownEvent.pageY-e.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}})}(jQuery),function(e,t){function h(e,t,n){return[parseFloat(e[0])*(l.test(e[0])?t/100:1),parseFloat(e[1])*(l.test(e[1])?n/100:1)]}function p(t,n){return parseInt(e.css(t,n),10)||0}function d(t){var n=t[0];return n.nodeType===9?{width:t.width(),height:t.height(),offset:{top:0,left:0}}:e.isWindow(n)?{width:t.width(),height:t.height(),offset:{top:t.scrollTop(),left:t.scrollLeft()}}:n.preventDefault?{width:0,height:0,offset:{top:n.pageY,left:n.pageX}}:{width:t.outerWidth(),height:t.outerHeight(),offset:t.offset()}}e.ui=e.ui||{};var n,r=Math.max,i=Math.abs,s=Math.round,o=/left|center|right/,u=/top|center|bottom/,a=/[\+\-]\d+(\.[\d]+)?%?/,f=/^\w+/,l=/%$/,c=e.fn.position;e.position={scrollbarWidth:function(){if(n!==t)return n;var r,i,s=e("<div style='display:block;position:absolute;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),o=s.children()[0];return e("body").append(s),r=o.offsetWidth,s.css("overflow","scroll"),i=o.offsetWidth,r===i&&(i=s[0].clientWidth),s.remove(),n=r-i},getScrollInfo:function(t){var n=t.isWindow||t.isDocument?"":t.element.css("overflow-x"),r=t.isWindow||t.isDocument?"":t.element.css("overflow-y"),i=n==="scroll"||n==="auto"&&t.width<t.element[0].scrollWidth,s=r==="scroll"||r==="auto"&&t.height<t.element[0].scrollHeight;return{width:s?e.position.scrollbarWidth():0,height:i?e.position.scrollbarWidth():0}},getWithinInfo:function(t){var n=e(t||window),r=e.isWindow(n[0]),i=!!n[0]&&n[0].nodeType===9;return{element:n,isWindow:r,isDocument:i,offset:n.offset()||{left:0,top:0},scrollLeft:n.scrollLeft(),scrollTop:n.scrollTop(),width:r?n.width():n.outerWidth(),height:r?n.height():n.outerHeight()}}},e.fn.position=function(t){if(!t||!t.of)return c.apply(this,arguments);t=e.extend({},t);var n,l,v,m,g,y,b=e(t.of),w=e.position.getWithinInfo(t.within),E=e.position.getScrollInfo(w),S=(t.collision||"flip").split(" "),x={};return y=d(b),b[0].preventDefault&&(t.at="left top"),l=y.width,v=y.height,m=y.offset,g=e.extend({},m),e.each(["my","at"],function(){var e=(t[this]||"").split(" "),n,r;e.length===1&&(e=o.test(e[0])?e.concat(["center"]):u.test(e[0])?["center"].concat(e):["center","center"]),e[0]=o.test(e[0])?e[0]:"center",e[1]=u.test(e[1])?e[1]:"center",n=a.exec(e[0]),r=a.exec(e[1]),x[this]=[n?n[0]:0,r?r[0]:0],t[this]=[f.exec(e[0])[0],f.exec(e[1])[0]]}),S.length===1&&(S[1]=S[0]),t.at[0]==="right"?g.left+=l:t.at[0]==="center"&&(g.left+=l/2),t.at[1]==="bottom"?g.top+=v:t.at[1]==="center"&&(g.top+=v/2),n=h(x.at,l,v),g.left+=n[0],g.top+=n[1],this.each(function(){var o,u,a=e(this),f=a.outerWidth(),c=a.outerHeight(),d=p(this,"marginLeft"),y=p(this,"marginTop"),T=f+d+p(this,"marginRight")+E.width,N=c+y+p(this,"marginBottom")+E.height,C=e.extend({},g),k=h(x.my,a.outerWidth(),a.outerHeight());t.my[0]==="right"?C.left-=f:t.my[0]==="center"&&(C.left-=f/2),t.my[1]==="bottom"?C.top-=c:t.my[1]==="center"&&(C.top-=c/2),C.left+=k[0],C.top+=k[1],e.support.offsetFractions||(C.left=s(C.left),C.top=s(C.top)),o={marginLeft:d,marginTop:y},e.each(["left","top"],function(r,i){e.ui.position[S[r]]&&e.ui.position[S[r]][i](C,{targetWidth:l,targetHeight:v,elemWidth:f,elemHeight:c,collisionPosition:o,collisionWidth:T,collisionHeight:N,offset:[n[0]+k[0],n[1]+k[1]],my:t.my,at:t.at,within:w,elem:a})}),t.using&&(u=function(e){var n=m.left-C.left,s=n+l-f,o=m.top-C.top,u=o+v-c,h={target:{element:b,left:m.left,top:m.top,width:l,height:v},element:{element:a,left:C.left,top:C.top,width:f,height:c},horizontal:s<0?"left":n>0?"right":"center",vertical:u<0?"top":o>0?"bottom":"middle"};l<f&&i(n+s)<l&&(h.horizontal="center"),v<c&&i(o+u)<v&&(h.vertical="middle"),r(i(n),i(s))>r(i(o),i(u))?h.important="horizontal":h.important="vertical",t.using.call(this,e,h)}),a.offset(e.extend(C,{using:u}))})},e.ui.position={fit:{left:function(e,t){var n=t.within,i=n.isWindow?n.scrollLeft:n.offset.left,s=n.width,o=e.left-t.collisionPosition.marginLeft,u=i-o,a=o+t.collisionWidth-s-i,f;t.collisionWidth>s?u>0&&a<=0?(f=e.left+u+t.collisionWidth-s-i,e.left+=u-f):a>0&&u<=0?e.left=i:u>a?e.left=i+s-t.collisionWidth:e.left=i:u>0?e.left+=u:a>0?e.left-=a:e.left=r(e.left-o,e.left)},top:function(e,t){var n=t.within,i=n.isWindow?n.scrollTop:n.offset.top,s=t.within.height,o=e.top-t.collisionPosition.marginTop,u=i-o,a=o+t.collisionHeight-s-i,f;t.collisionHeight>s?u>0&&a<=0?(f=e.top+u+t.collisionHeight-s-i,e.top+=u-f):a>0&&u<=0?e.top=i:u>a?e.top=i+s-t.collisionHeight:e.top=i:u>0?e.top+=u:a>0?e.top-=a:e.top=r(e.top-o,e.top)}},flip:{left:function(e,t){var n=t.within,r=n.offset.left+n.scrollLeft,s=n.width,o=n.isWindow?n.scrollLeft:n.offset.left,u=e.left-t.collisionPosition.marginLeft,a=u-o,f=u+t.collisionWidth-s-o,l=t.my[0]==="left"?-t.elemWidth:t.my[0]==="right"?t.elemWidth:0,c=t.at[0]==="left"?t.targetWidth:t.at[0]==="right"?-t.targetWidth:0,h=-2*t.offset[0],p,d;if(a<0){p=e.left+l+c+h+t.collisionWidth-s-r;if(p<0||p<i(a))e.left+=l+c+h}else if(f>0){d=e.left-t.collisionPosition.marginLeft+l+c+h-o;if(d>0||i(d)<f)e.left+=l+c+h}},top:function(e,t){var n=t.within,r=n.offset.top+n.scrollTop,s=n.height,o=n.isWindow?n.scrollTop:n.offset.top,u=e.top-t.collisionPosition.marginTop,a=u-o,f=u+t.collisionHeight-s-o,l=t.my[1]==="top",c=l?-t.elemHeight:t.my[1]==="bottom"?t.elemHeight:0,h=t.at[1]==="top"?t.targetHeight:t.at[1]==="bottom"?-t.targetHeight:0,p=-2*t.offset[1],d,v;a<0?(v=e.top+c+h+p+t.collisionHeight-s-r,e.top+c+h+p>a&&(v<0||v<i(a))&&(e.top+=c+h+p)):f>0&&(d=e.top-t.collisionPosition.marginTop+c+h+p-o,e.top+c+h+p>f&&(d>0||i(d)<f)&&(e.top+=c+h+p))}},flipfit:{left:function(){e.ui.position.flip.left.apply(this,arguments),e.ui.position.fit.left.apply(this,arguments)},top:function(){e.ui.position.flip.top.apply(this,arguments),e.ui.position.fit.top.apply(this,arguments)}}},function(){var t,n,r,i,s,o=document.getElementsByTagName("body")[0],u=document.createElement("div");t=document.createElement(o?"div":"body"),r={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"},o&&e.extend(r,{position:"absolute",left:"-1000px",top:"-1000px"});for(s in r)t.style[s]=r[s];t.appendChild(u),n=o||document.documentElement,n.insertBefore(t,n.firstChild),u.style.cssText="position: absolute; left: 10.7432222px;",i=e(u).offset().left,e.support.offsetFractions=i>10&&i<11,t.innerHTML="",n.removeChild(t)}()}(jQuery),function(e,t){e.widget("ui.draggable",e.ui.mouse,{version:"1.10.4",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){this.options.helper==="original"&&!/^(?:r|a|f)/.test(this.element.css("position"))&&(this.element[0].style.position="relative"),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._mouseInit()},_destroy:function(){this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._mouseDestroy()},_mouseCapture:function(t){var n=this.options;return this.helper||n.disabled||e(t.target).closest(".ui-resizable-handle").length>0?!1:(this.handle=this._getHandle(t),this.handle?(e(n.iframeFix===!0?"iframe":n.iframeFix).each(function(){e("<div class='ui-draggable-iframeFix' style='background: #fff;'></div>").css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1e3}).css(e(this).offset()).appendTo("body")}),!0):!1)},_mouseStart:function(t){var n=this.options;return this.helper=this._createHelper(t),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),e.ui.ddmanager&&(e.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(),this.offsetParent=this.helper.offsetParent(),this.offsetParentCssPosition=this.offsetParent.css("position"),this.offset=this.positionAbs=this.element.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},this.offset.scroll=!1,e.extend(this.offset,{click:{left:t.pageX-this.offset.left,top:t.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.originalPosition=this.position=this._generatePosition(t),this.originalPageX=t.pageX,this.originalPageY=t.pageY,n.cursorAt&&this._adjustOffsetFromHelper(n.cursorAt),this._setContainment(),this._trigger("start",t)===!1?(this._clear(),!1):(this._cacheHelperProportions(),e.ui.ddmanager&&!n.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t),this._mouseDrag(t,!0),e.ui.ddmanager&&e.ui.ddmanager.dragStart(this,t),!0)},_mouseDrag:function(t,n){this.offsetParentCssPosition==="fixed"&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(t),this.positionAbs=this._convertPositionTo("absolute");if(!n){var r=this._uiHash();if(this._trigger("drag",t,r)===!1)return this._mouseUp({}),!1;this.position=r.position}if(!this.options.axis||this.options.axis!=="y")this.helper[0].style.left=this.position.left+"px";if(!this.options.axis||this.options.axis!=="x")this.helper[0].style.top=this.position.top+"px";return e.ui.ddmanager&&e.ui.ddmanager.drag(this,t),!1},_mouseStop:function(t){var n=this,r=!1;return e.ui.ddmanager&&!this.options.dropBehaviour&&(r=e.ui.ddmanager.drop(this,t)),this.dropped&&(r=this.dropped,this.dropped=!1),this.options.helper==="original"&&!e.contains(this.element[0].ownerDocument,this.element[0])?!1:(this.options.revert==="invalid"&&!r||this.options.revert==="valid"&&r||this.options.revert===!0||e.isFunction(this.options.revert)&&this.options.revert.call(this.element,r)?e(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){n._trigger("stop",t)!==!1&&n._clear()}):this._trigger("stop",t)!==!1&&this._clear(),!1)},_mouseUp:function(t){return e("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)}),e.ui.ddmanager&&e.ui.ddmanager.dragStop(this,t),e.ui.mouse.prototype._mouseUp.call(this,t)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(t){return this.options.handle?!!e(t.target).closest(this.element.find(this.options.handle)).length:!0},_createHelper:function(t){var n=this.options,r=e.isFunction(n.helper)?e(n.helper.apply(this.element[0],[t])):n.helper==="clone"?this.element.clone().removeAttr("id"):this.element;return r.parents("body").length||r.appendTo(n.appendTo==="parent"?this.element[0].parentNode:n.appendTo),r[0]!==this.element[0]&&!/(fixed|absolute)/.test(r.css("position"))&&r.css("position","absolute"),r},_adjustOffsetFromHelper:function(t){typeof t=="string"&&(t=t.split(" ")),e.isArray(t)&&(t={left:+t[0],top:+t[1]||0}),"left"in t&&(this.offset.click.left=t.left+this.margins.left),"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),"top"in t&&(this.offset.click.top=t.top+this.margins.top),"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_getParentOffset:function(){var t=this.offsetParent.offset();this.cssPosition==="absolute"&&this.scrollParent[0]!==document&&e.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop());if(this.offsetParent[0]===document.body||this.offsetParent[0].tagName&&this.offsetParent[0].tagName.toLowerCase()==="html"&&e.ui.ie)t={top:0,left:0};return{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if(this.cssPosition==="relative"){var e=this.element.position();return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:e.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t,n,r,i=this.options;if(!i.containment){this.containment=null;return}if(i.containment==="window"){this.containment=[e(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,e(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,e(window).scrollLeft()+e(window).width()-this.helperProportions.width-this.margins.left,e(window).scrollTop()+(e(window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];return}if(i.containment==="document"){this.containment=[0,0,e(document).width()-this.helperProportions.width-this.margins.left,(e(document).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];return}if(i.containment.constructor===Array){this.containment=i.containment;return}i.containment==="parent"&&(i.containment=this.helper[0].parentNode),n=e(i.containment),r=n[0];if(!r)return;t=n.css("overflow")!=="hidden",this.containment=[(parseInt(n.css("borderLeftWidth"),10)||0)+(parseInt(n.css("paddingLeft"),10)||0),(parseInt(n.css("borderTopWidth"),10)||0)+(parseInt(n.css("paddingTop"),10)||0),(t?Math.max(r.scrollWidth,r.offsetWidth):r.offsetWidth)-(parseInt(n.css("borderRightWidth"),10)||0)-(parseInt(n.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(t?Math.max(r.scrollHeight,r.offsetHeight):r.offsetHeight)-(parseInt(n.css("borderBottomWidth"),10)||0)-(parseInt(n.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relative_container=n},_convertPositionTo:function(t,n){n||(n=this.position);var r=t==="absolute"?1:-1,i=this.cssPosition!=="absolute"||this.scrollParent[0]!==document&&!!e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent;return this.offset.scroll||(this.offset.scroll={top:i.scrollTop(),left:i.scrollLeft()}),{top:n.top+this.offset.relative.top*r+this.offset.parent.top*r-(this.cssPosition==="fixed"?-this.scrollParent.scrollTop():this.offset.scroll.top)*r,left:n.left+this.offset.relative.left*r+this.offset.parent.left*r-(this.cssPosition==="fixed"?-this.scrollParent.scrollLeft():this.offset.scroll.left)*r}},_generatePosition:function(t){var n,r,i,s,o=this.options,u=this.cssPosition!=="absolute"||this.scrollParent[0]!==document&&!!e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,a=t.pageX,f=t.pageY;return this.offset.scroll||(this.offset.scroll={top:u.scrollTop(),left:u.scrollLeft()}),this.originalPosition&&(this.containment&&(this.relative_container?(r=this.relative_container.offset(),n=[this.containment[0]+r.left,this.containment[1]+r.top,this.containment[2]+r.left,this.containment[3]+r.top]):n=this.containment,t.pageX-this.offset.click.left<n[0]&&(a=n[0]+this.offset.click.left),t.pageY-this.offset.click.top<n[1]&&(f=n[1]+this.offset.click.top),t.pageX-this.offset.click.left>n[2]&&(a=n[2]+this.offset.click.left),t.pageY-this.offset.click.top>n[3]&&(f=n[3]+this.offset.click.top)),o.grid&&(i=o.grid[1]?this.originalPageY+Math.round((f-this.originalPageY)/o.grid[1])*o.grid[1]:this.originalPageY,f=n?i-this.offset.click.top>=n[1]||i-this.offset.click.top>n[3]?i:i-this.offset.click.top>=n[1]?i-o.grid[1]:i+o.grid[1]:i,s=o.grid[0]?this.originalPageX+Math.round((a-this.originalPageX)/o.grid[0])*o.grid[0]:this.originalPageX,a=n?s-this.offset.click.left>=n[0]||s-this.offset.click.left>n[2]?s:s-this.offset.click.left>=n[0]?s-o.grid[0]:s+o.grid[0]:s)),{top:f-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(this.cssPosition==="fixed"?-this.scrollParent.scrollTop():this.offset.scroll.top),left:a-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(this.cssPosition==="fixed"?-this.scrollParent.scrollLeft():this.offset.scroll.left)}},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]!==this.element[0]&&!this.cancelHelperRemoval&&this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1},_trigger:function(t,n,r){return r=r||this._uiHash(),e.ui.plugin.call(this,t,[n,r]),t==="drag"&&(this.positionAbs=this._convertPositionTo("absolute")),e.Widget.prototype._trigger.call(this,t,n,r)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),e.ui.plugin.add("draggable","connectToSortable",{start:function(t,n){var r=e(this).data("ui-draggable"),i=r.options,s=e.extend({},n,{item:r.element});r.sortables=[],e(i.connectToSortable).each(function(){var n=e.data(this,"ui-sortable");n&&!n.options.disabled&&(r.sortables.push({instance:n,shouldRevert:n.options.revert}),n.refreshPositions(),n._trigger("activate",t,s))})},stop:function(t,n){var r=e(this).data("ui-draggable"),i=e.extend({},n,{item:r.element});e.each(r.sortables,function(){this.instance.isOver?(this.instance.isOver=0,r.cancelHelperRemoval=!0,this.instance.cancelHelperRemoval=!1,this.shouldRevert&&(this.instance.options.revert=this.shouldRevert),this.instance._mouseStop(t),this.instance.options.helper=this.instance.options._helper,r.options.helper==="original"&&this.instance.currentItem.css({top:"auto",left:"auto"})):(this.instance.cancelHelperRemoval=!1,this.instance._trigger("deactivate",t,i))})},drag:function(t,n){var r=e(this).data("ui-draggable"),i=this;e.each(r.sortables,function(){var s=!1,o=this;this.instance.positionAbs=r.positionAbs,this.instance.helperProportions=r.helperProportions,this.instance.offset.click=r.offset.click,this.instance._intersectsWith(this.instance.containerCache)&&(s=!0,e.each(r.sortables,function(){return this.instance.positionAbs=r.positionAbs,this.instance.helperProportions=r.helperProportions,this.instance.offset.click=r.offset.click,this!==o&&this.instance._intersectsWith(this.instance.containerCache)&&e.contains(o.instance.element[0],this.instance.element[0])&&(s=!1),s})),s?(this.instance.isOver||(this.instance.isOver=1,this.instance.currentItem=e(i).clone().removeAttr("id").appendTo(this.instance.element).data("ui-sortable-item",!0),this.instance.options._helper=this.instance.options.helper,this.instance.options.helper=function(){return n.helper[0]},t.target=this.instance.currentItem[0],this.instance._mouseCapture(t,!0),this.instance._mouseStart(t,!0,!0),this.instance.offset.click.top=r.offset.click.top,this.instance.offset.click.left=r.offset.click.left,this.instance.offset.parent.left-=r.offset.parent.left-this.instance.offset.parent.left,this.instance.offset.parent.top-=r.offset.parent.top-this.instance.offset.parent.top,r._trigger("toSortable",t),r.dropped=this.instance.element,r.currentItem=r.element,this.instance.fromOutside=r),this.instance.currentItem&&this.instance._mouseDrag(t)):this.instance.isOver&&(this.instance.isOver=0,this.instance.cancelHelperRemoval=!0,this.instance.options.revert=!1,this.instance._trigger("out",t,this.instance._uiHash(this.instance)),this.instance._mouseStop(t,!0),this.instance.options.helper=this.instance.options._helper,this.instance.currentItem.remove(),this.instance.placeholder&&this.instance.placeholder.remove(),r._trigger("fromSortable",t),r.dropped=!1)})}}),e.ui.plugin.add("draggable","cursor",{start:function(){var t=e("body"),n=e(this).data("ui-draggable").options;t.css("cursor")&&(n._cursor=t.css("cursor")),t.css("cursor",n.cursor)},stop:function(){var t=e(this).data("ui-draggable").options;t._cursor&&e("body").css("cursor",t._cursor)}}),e.ui.plugin.add("draggable","opacity",{start:function(t,n){var r=e(n.helper),i=e(this).data("ui-draggable").options;r.css("opacity")&&(i._opacity=r.css("opacity")),r.css("opacity",i.opacity)},stop:function(t,n){var r=e(this).data("ui-draggable").options;r._opacity&&e(n.helper).css("opacity",r._opacity)}}),e.ui.plugin.add("draggable","scroll",{start:function(){var t=e(this).data("ui-draggable");t.scrollParent[0]!==document&&t.scrollParent[0].tagName!=="HTML"&&(t.overflowOffset=t.scrollParent.offset())},drag:function(t){var n=e(this).data("ui-draggable"),r=n.options,i=!1;if(n.scrollParent[0]!==document&&n.scrollParent[0].tagName!=="HTML"){if(!r.axis||r.axis!=="x")n.overflowOffset.top+n.scrollParent[0].offsetHeight-t.pageY<r.scrollSensitivity?n.scrollParent[0].scrollTop=i=n.scrollParent[0].scrollTop+r.scrollSpeed:t.pageY-n.overflowOffset.top<r.scrollSensitivity&&(n.scrollParent[0].scrollTop=i=n.scrollParent[0].scrollTop-r.scrollSpeed);if(!r.axis||r.axis!=="y")n.overflowOffset.left+n.scrollParent[0].offsetWidth-t.pageX<r.scrollSensitivity?n.scrollParent[0].scrollLeft=i=n.scrollParent[0].scrollLeft+r.scrollSpeed:t.pageX-n.overflowOffset.left<r.scrollSensitivity&&(n.scrollParent[0].scrollLeft=i=n.scrollParent[0].scrollLeft-r.scrollSpeed)}else{if(!r.axis||r.axis!=="x")t.pageY-e(document).scrollTop()<r.scrollSensitivity?i=e(document).scrollTop(e(document).scrollTop()-r.scrollSpeed):e(window).height()-(t.pageY-e(document).scrollTop())<r.scrollSensitivity&&(i=e(document).scrollTop(e(document).scrollTop()+r.scrollSpeed));if(!r.axis||r.axis!=="y")t.pageX-e(document).scrollLeft()<r.scrollSensitivity?i=e(document).scrollLeft(e(document).scrollLeft()-r.scrollSpeed):e(window).width()-(t.pageX-e(document).scrollLeft())<r.scrollSensitivity&&(i=e(document).scrollLeft(e(document).scrollLeft()+r.scrollSpeed))}i!==!1&&e.ui.ddmanager&&!r.dropBehaviour&&e.ui.ddmanager.prepareOffsets(n,t)}}),e.ui.plugin.add("draggable","snap",{start:function(){var t=e(this).data("ui-draggable"),n=t.options;t.snapElements=[],e(n.snap.constructor!==String?n.snap.items||":data(ui-draggable)":n.snap).each(function(){var n=e(this),r=n.offset();this!==t.element[0]&&t.snapElements.push({item:this,width:n.outerWidth(),height:n.outerHeight(),top:r.top,left:r.left})})},drag:function(t,n){var r,i,s,o,u,a,f,l,c,h,p=e(this).data("ui-draggable"),d=p.options,v=d.snapTolerance,m=n.offset.left,g=m+p.helperProportions.width,y=n.offset.top,b=y+p.helperProportions.height;for(c=p.snapElements.length-1;c>=0;c--){u=p.snapElements[c].left,a=u+p.snapElements[c].width,f=p.snapElements[c].top,l=f+p.snapElements[c].height;if(g<u-v||m>a+v||b<f-v||y>l+v||!e.contains(p.snapElements[c].item.ownerDocument,p.snapElements[c].item)){p.snapElements[c].snapping&&p.options.snap.release&&p.options.snap.release.call(p.element,t,e.extend(p._uiHash(),{snapItem:p.snapElements[c].item})),p.snapElements[c].snapping=!1;continue}d.snapMode!=="inner"&&(r=Math.abs(f-b)<=v,i=Math.abs(l-y)<=v,s=Math.abs(u-g)<=v,o=Math.abs(a-m)<=v,r&&(n.position.top=p._convertPositionTo("relative",{top:f-p.helperProportions.height,left:0}).top-p.margins.top),i&&(n.position.top=p._convertPositionTo("relative",{top:l,left:0}).top-p.margins.top),s&&(n.position.left=p._convertPositionTo("relative",{top:0,left:u-p.helperProportions.width}).left-p.margins.left),o&&(n.position.left=p._convertPositionTo("relative",{top:0,left:a}).left-p.margins.left)),h=r||i||s||o,d.snapMode!=="outer"&&(r=Math.abs(f-y)<=v,i=Math.abs(l-b)<=v,s=Math.abs(u-m)<=v,o=Math.abs(a-g)<=v,r&&(n.position.top=p._convertPositionTo("relative",{top:f,left:0}).top-p.margins.top),i&&(n.position.top=p._convertPositionTo("relative",{top:l-p.helperProportions.height,left:0}).top-p.margins.top),s&&(n.position.left=p._convertPositionTo("relative",{top:0,left:u}).left-p.margins.left),o&&(n.position.left=p._convertPositionTo("relative",{top:0,left:a-p.helperProportions.width}).left-p.margins.left)),!p.snapElements[c].snapping&&(r||i||s||o||h)&&p.options.snap.snap&&p.options.snap.snap.call(p.element,t,e.extend(p._uiHash(),{snapItem:p.snapElements[c].item})),p.snapElements[c].snapping=r||i||s||o||h}}}),e.ui.plugin.add("draggable","stack",{start:function(){var t,n=this.data("ui-draggable").options,r=e.makeArray(e(n.stack)).sort(function(t,n){return(parseInt(e(t).css("zIndex"),10)||0)-(parseInt(e(n).css("zIndex"),10)||0)});if(!r.length)return;t=parseInt(e(r[0]).css("zIndex"),10)||0,e(r).each(function(n){e(this).css("zIndex",t+n)}),this.css("zIndex",t+r.length)}}),e.ui.plugin.add("draggable","zIndex",{start:function(t,n){var r=e(n.helper),i=e(this).data("ui-draggable").options;r.css("zIndex")&&(i._zIndex=r.css("zIndex")),r.css("zIndex",i.zIndex)},stop:function(t,n){var r=e(this).data("ui-draggable").options;r._zIndex&&e(n.helper).css("zIndex",r._zIndex)}})}(jQuery),function(e,t){function n(e){return parseInt(e,10)||0}function r(e){return!isNaN(parseInt(e,10))}e.widget("ui.resizable",e.ui.mouse,{version:"1.10.4",widgetEventPrefix:"resize",options:{alsoResize:!1,animate:!1,animateDuration:"slow",animateEasing:"swing",aspectRatio:!1,autoHide:!1,containment:!1,ghost:!1,grid:!1,handles:"e,s,se",helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:90,resize:null,start:null,stop:null},_create:function(){var t,n,r,i,s,o=this,u=this.options;this.element.addClass("ui-resizable"),e.extend(this,{_aspectRatio:!!u.aspectRatio,aspectRatio:u.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:u.helper||u.ghost||u.animate?u.helper||"ui-resizable-helper":null}),this.element[0].nodeName.match(/canvas|textarea|input|select|button|img/i)&&(this.element.wrap(e("<div class='ui-wrapper' style='overflow: hidden;'></div>").css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")})),this.element=this.element.parent().data("ui-resizable",this.element.data("ui-resizable")),this.elementIsWrapper=!0,this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")}),this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0}),this.originalResizeStyle=this.originalElement.css("resize"),this.originalElement.css("resize","none"),this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"})),this.originalElement.css({margin:this.originalElement.css("margin")}),this._proportionallyResize()),this.handles=u.handles||(e(".ui-resizable-handle",this.element).length?{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"}:"e,s,se");if(this.handles.constructor===String){this.handles==="all"&&(this.handles="n,e,s,w,se,sw,ne,nw"),t=this.handles.split(","),this.handles={};for(n=0;n<t.length;n++)r=e.trim(t[n]),s="ui-resizable-"+r,i=e("<div class='ui-resizable-handle "+s+"'></div>"),i.css({zIndex:u.zIndex}),"se"===r&&i.addClass("ui-icon ui-icon-gripsmall-diagonal-se"),this.handles[r]=".ui-resizable-"+r,this.element.append(i)}this._renderAxis=function(t){var n,r,i,s;t=t||this.element;for(n in this.handles){this.handles[n].constructor===String&&(this.handles[n]=e(this.handles[n],this.element).show()),this.elementIsWrapper&&this.originalElement[0].nodeName.match(/textarea|input|select|button/i)&&(r=e(this.handles[n],this.element),s=/sw|ne|nw|se|n|s/.test(n)?r.outerHeight():r.outerWidth(),i=["padding",/ne|nw|n/.test(n)?"Top":/se|sw|s/.test(n)?"Bottom":/^e$/.test(n)?"Right":"Left"].join(""),t.css(i,s),this._proportionallyResize());if(!e(this.handles[n]).length)continue}},this._renderAxis(this.element),this._handles=e(".ui-resizable-handle",this.element).disableSelection(),this._handles.mouseover(function(){o.resizing||(this.className&&(i=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i)),o.axis=i&&i[1]?i[1]:"se")}),u.autoHide&&(this._handles.hide(),e(this.element).addClass("ui-resizable-autohide").mouseenter(function(){if(u.disabled)return;e(this).removeClass("ui-resizable-autohide"),o._handles.show()}).mouseleave(function(){if(u.disabled)return;o.resizing||(e(this).addClass("ui-resizable-autohide"),o._handles.hide())})),this._mouseInit()},_destroy:function(){this._mouseDestroy();var t,n=function(t){e(t).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").removeData("ui-resizable").unbind(".resizable").find(".ui-resizable-handle").remove()};return this.elementIsWrapper&&(n(this.element),t=this.element,this.originalElement.css({position:t.css("position"),width:t.outerWidth(),height:t.outerHeight(),top:t.css("top"),left:t.css("left")}).insertAfter(t),t.remove()),this.originalElement.css("resize",this.originalResizeStyle),n(this.originalElement),this},_mouseCapture:function(t){var n,r,i=!1;for(n in this.handles){r=e(this.handles[n])[0];if(r===t.target||e.contains(r,t.target))i=!0}return!this.options.disabled&&i},_mouseStart:function(t){var r,i,s,o=this.options,u=this.element.position(),a=this.element;return this.resizing=!0,/absolute/.test(a.css("position"))?a.css({position:"absolute",top:a.css("top"),left:a.css("left")}):a.is(".ui-draggable")&&a.css({position:"absolute",top:u.top,left:u.left}),this._renderProxy(),r=n(this.helper.css("left")),i=n(this.helper.css("top")),o.containment&&(r+=e(o.containment).scrollLeft()||0,i+=e(o.containment).scrollTop()||0),this.offset=this.helper.offset(),this.position={left:r,top:i},this.size=this._helper?{width:this.helper.width(),height:this.helper.height()}:{width:a.width(),height:a.height()},this.originalSize=this._helper?{width:a.outerWidth(),height:a.outerHeight()}:{width:a.width(),height:a.height()},this.originalPosition={left:r,top:i},this.sizeDiff={width:a.outerWidth()-a.width(),height:a.outerHeight()-a.height()},this.originalMousePosition={left:t.pageX,top:t.pageY},this.aspectRatio=typeof o.aspectRatio=="number"?o.aspectRatio:this.originalSize.width/this.originalSize.height||1,s=e(".ui-resizable-"+this.axis).css("cursor"),e("body").css("cursor",s==="auto"?this.axis+"-resize":s),a.addClass("ui-resizable-resizing"),this._propagate("start",t),!0},_mouseDrag:function(t){var n,r=this.helper,i={},s=this.originalMousePosition,o=this.axis,u=this.position.top,a=this.position.left,f=this.size.width,l=this.size.height,c=t.pageX-s.left||0,h=t.pageY-s.top||0,p=this._change[o];if(!p)return!1;n=p.apply(this,[t,c,h]),this._updateVirtualBoundaries(t.shiftKey);if(this._aspectRatio||t.shiftKey)n=this._updateRatio(n,t);return n=this._respectSize(n,t),this._updateCache(n),this._propagate("resize",t),this.position.top!==u&&(i.top=this.position.top+"px"),this.position.left!==a&&(i.left=this.position.left+"px"),this.size.width!==f&&(i.width=this.size.width+"px"),this.size.height!==l&&(i.height=this.size.height+"px"),r.css(i),!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize(),e.isEmptyObject(i)||this._trigger("resize",t,this.ui()),!1},_mouseStop:function(t){this.resizing=!1;var n,r,i,s,o,u,a,f=this.options,l=this;return this._helper&&(n=this._proportionallyResizeElements,r=n.length&&/textarea/i.test(n[0].nodeName),i=r&&e.ui.hasScroll(n[0],"left")?0:l.sizeDiff.height,s=r?0:l.sizeDiff.width,o={width:l.helper.width()-s,height:l.helper.height()-i},u=parseInt(l.element.css("left"),10)+(l.position.left-l.originalPosition.left)||null,a=parseInt(l.element.css("top"),10)+(l.position.top-l.originalPosition.top)||null,f.animate||this.element.css(e.extend(o,{top:a,left:u})),l.helper.height(l.size.height),l.helper.width(l.size.width),this._helper&&!f.animate&&this._proportionallyResize()),e("body").css("cursor","auto"),this.element.removeClass("ui-resizable-resizing"),this._propagate("stop",t),this._helper&&this.helper.remove(),!1},_updateVirtualBoundaries:function(e){var t,n,i,s,o,u=this.options;o={minWidth:r(u.minWidth)?u.minWidth:0,maxWidth:r(u.maxWidth)?u.maxWidth:Infinity,minHeight:r(u.minHeight)?u.minHeight:0,maxHeight:r(u.maxHeight)?u.maxHeight:Infinity};if(this._aspectRatio||e)t=o.minHeight*this.aspectRatio,i=o.minWidth/this.aspectRatio,n=o.maxHeight*this.aspectRatio,s=o.maxWidth/this.aspectRatio,t>o.minWidth&&(o.minWidth=t),i>o.minHeight&&(o.minHeight=i),n<o.maxWidth&&(o.maxWidth=n),s<o.maxHeight&&(o.maxHeight=s);this._vBoundaries=o},_updateCache:function(e){this.offset=this.helper.offset(),r(e.left)&&(this.position.left=e.left),r(e.top)&&(this.position.top=e.top),r(e.height)&&(this.size.height=e.height),r(e.width)&&(this.size.width=e.width)},_updateRatio:function(e){var t=this.position,n=this.size,i=this.axis;return r(e.height)?e.width=e.height*this.aspectRatio:r(e.width)&&(e.height=e.width/this.aspectRatio),i==="sw"&&(e.left=t.left+(n.width-e.width),e.top=null),i==="nw"&&(e.top=t.top+(n.height-e.height),e.left=t.left+(n.width-e.width)),e},_respectSize:function(e){var t=this._vBoundaries,n=this.axis,i=r(e.width)&&t.maxWidth&&t.maxWidth<e.width,s=r(e.height)&&t.maxHeight&&t.maxHeight<e.height,o=r(e.width)&&t.minWidth&&t.minWidth>e.width,u=r(e.height)&&t.minHeight&&t.minHeight>e.height,a=this.originalPosition.left+this.originalSize.width,f=this.position.top+this.size.height,l=/sw|nw|w/.test(n),c=/nw|ne|n/.test(n);return o&&(e.width=t.minWidth),u&&(e.height=t.minHeight),i&&(e.width=t.maxWidth),s&&(e.height=t.maxHeight),o&&l&&(e.left=a-t.minWidth),i&&l&&(e.left=a-t.maxWidth),u&&c&&(e.top=f-t.minHeight),s&&c&&(e.top=f-t.maxHeight),!e.width&&!e.height&&!e.left&&e.top?e.top=null:!e.width&&!e.height&&!e.top&&e.left&&(e.left=null),e},_proportionallyResize:function(){if(!this._proportionallyResizeElements.length)return;var e,t,n,r,i,s=this.helper||this.element;for(e=0;e<this._proportionallyResizeElements.length;e++){i=this._proportionallyResizeElements[e];if(!this.borderDif){this.borderDif=[],n=[i.css("borderTopWidth"),i.css("borderRightWidth"),i.css("borderBottomWidth"),i.css("borderLeftWidth")],r=[i.css("paddingTop"),i.css("paddingRight"),i.css("paddingBottom"),i.css("paddingLeft")];for(t=0;t<n.length;t++)this.borderDif[t]=(parseInt(n[t],10)||0)+(parseInt(r[t],10)||0)}i.css({height:s.height()-this.borderDif[0]-this.borderDif[2]||0,width:s.width()-this.borderDif[1]-this.borderDif[3]||0})}},_renderProxy:function(){var t=this.element,n=this.options;this.elementOffset=t.offset(),this._helper?(this.helper=this.helper||e("<div style='overflow:hidden;'></div>"),this.helper.addClass(this._helper).css({width:this.element.outerWidth()-1,height:this.element.outerHeight()-1,position:"absolute",left:this.elementOffset.left+"px",top:this.elementOffset.top+"px",zIndex:++n.zIndex}),this.helper.appendTo("body").disableSelection()):this.helper=this.element},_change:{e:function(e,t){return{width:this.originalSize.width+t}},w:function(e,t){var n=this.originalSize,r=this.originalPosition;return{left:r.left+t,width:n.width-t}},n:function(e,t,n){var r=this.originalSize,i=this.originalPosition;return{top:i.top+n,height:r.height-n}},s:function(e,t,n){return{height:this.originalSize.height+n}},se:function(t,n,r){return e.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[t,n,r]))},sw:function(t,n,r){return e.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[t,n,r]))},ne:function(t,n,r){return e.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[t,n,r]))},nw:function(t,n,r){return e.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[t,n,r]))}},_propagate:function(t,n){e.ui.plugin.call(this,t,[n,this.ui()]),t!=="resize"&&this._trigger(t,n,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}}),e.ui.plugin.add("resizable","animate",{stop:function(t){var n=e(this).data("ui-resizable"),r=n.options,i=n._proportionallyResizeElements,s=i.length&&/textarea/i.test(i[0].nodeName),o=s&&e.ui.hasScroll(i[0],"left")?0:n.sizeDiff.height,u=s?0:n.sizeDiff.width,a={width:n.size.width-u,height:n.size.height-o},f=parseInt(n.element.css("left"),10)+(n.position.left-n.originalPosition.left)||null,l=parseInt(n.element.css("top"),10)+(n.position.top-n.originalPosition.top)||null;n.element.animate(e.extend(a,l&&f?{top:l,left:f}:{}),{duration:r.animateDuration,easing:r.animateEasing,step:function(){var r={width:parseInt(n.element.css("width"),10),height:parseInt(n.element.css("height"),10),top:parseInt(n.element.css("top"),10),left:parseInt(n.element.css("left"),10)};i&&i.length&&e(i[0]).css({width:r.width,height:r.height}),n._updateCache(r),n._propagate("resize",t)}})}}),e.ui.plugin.add("resizable","containment",{start:function(){var t,r,i,s,o,u,a,f=e(this).data("ui-resizable"),l=f.options,c=f.element,h=l.containment,p=h instanceof e?h.get(0):/parent/.test(h)?c.parent().get(0):h;if(!p)return;f.containerElement=e(p),/document/.test(h)||h===document?(f.containerOffset={left:0,top:0},f.containerPosition={left:0,top:0},f.parentData={element:e(document),left:0,top:0,width:e(document).width(),height:e(document).height()||document.body.parentNode.scrollHeight}):(t=e(p),r=[],e(["Top","Right","Left","Bottom"]).each(function(e,i){r[e]=n(t.css("padding"+i))}),f.containerOffset=t.offset(),f.containerPosition=t.position(),f.containerSize={height:t.innerHeight()-r[3],width:t.innerWidth()-r[1]},i=f.containerOffset,s=f.containerSize.height,o=f.containerSize.width,u=e.ui.hasScroll(p,"left")?p.scrollWidth:o,a=e.ui.hasScroll(p)?p.scrollHeight:s,f.parentData={element:p,left:i.left,top:i.top,width:u,height:a})},resize:function(t){var n,r,i,s,o=e(this).data("ui-resizable"),u=o.options,a=o.containerOffset,f=o.position,l=o._aspectRatio||t.shiftKey,c={top:0,left:0},h=o.containerElement;h[0]!==document&&/static/.test(h.css("position"))&&(c=a),f.left<(o._helper?a.left:0)&&(o.size.width=o.size.width+(o._helper?o.position.left-a.left:o.position.left-c.left),l&&(o.size.height=o.size.width/o.aspectRatio),o.position.left=u.helper?a.left:0),f.top<(o._helper?a.top:0)&&(o.size.height=o.size.height+(o._helper?o.position.top-a.top:o.position.top),l&&(o.size.width=o.size.height*o.aspectRatio),o.position.top=o._helper?a.top:0),o.offset.left=o.parentData.left+o.position.left,o.offset.top=o.parentData.top+o.position.top,n=Math.abs((o._helper?o.offset.left-c.left:o.offset.left-c.left)+o.sizeDiff.width),r=Math.abs((o._helper?o.offset.top-c.top:o.offset.top-a.top)+o.sizeDiff.height),i=o.containerElement.get(0)===o.element.parent().get(0),s=/relative|absolute/.test(o.containerElement.css("position")),i&&s&&(n-=Math.abs(o.parentData.left)),n+o.size.width>=o.parentData.width&&(o.size.width=o.parentData.width-n,l&&(o.size.height=o.size.width/o.aspectRatio)),r+o.size.height>=o.parentData.height&&(o.size.height=o.parentData.height-r,l&&(o.size.width=o.size.height*o.aspectRatio))},stop:function(){var t=e(this).data("ui-resizable"),n=t.options,r=t.containerOffset,i=t.containerPosition,s=t.containerElement,o=e(t.helper),u=o.offset(),a=o.outerWidth()-t.sizeDiff.width,f=o.outerHeight()-t.sizeDiff.height;t._helper&&!n.animate&&/relative/.test(s.css("position"))&&e(this).css({left:u.left-i.left-r.left,width:a,height:f}),t._helper&&!n.animate&&/static/.test(s.css("position"))&&e(this).css({left:u.left-i.left-r.left,width:a,height:f})}}),e.ui.plugin.add("resizable","alsoResize",{start:function(){var t=e(this).data("ui-resizable"),n=t.options,r=function(t){e(t).each(function(){var t=e(this);t.data("ui-resizable-alsoresize",{width:parseInt(t.width(),10),height:parseInt(t.height(),10),left:parseInt(t.css("left"),10),top:parseInt(t.css("top"),10)})})};typeof n.alsoResize=="object"&&!n.alsoResize.parentNode?n.alsoResize.length?(n.alsoResize=n.alsoResize[0],r(n.alsoResize)):e.each(n.alsoResize,function(e){r(e)}):r(n.alsoResize)},resize:function(t,n){var r=e(this).data("ui-resizable"),i=r.options,s=r.originalSize,o=r.originalPosition,u={height:r.size.height-s.height||0,width:r.size.width-s.width||0,top:r.position.top-o.top||0,left:r.position.left-o.left||0},a=function(t,r){e(t).each(function(){var t=e(this),i=e(this).data("ui-resizable-alsoresize"),s={},o=r&&r.length?r:t.parents(n.originalElement[0]).length?["width","height"]:["width","height","top","left"];e.each(o,function(e,t){var n=(i[t]||0)+(u[t]||0);n&&n>=0&&(s[t]=n||null)}),t.css(s)})};typeof i.alsoResize=="object"&&!i.alsoResize.nodeType?e.each(i.alsoResize,function(e,t){a(e,t)}):a(i.alsoResize)},stop:function(){e(this).removeData("resizable-alsoresize")}}),e.ui.plugin.add("resizable","ghost",{start:function(){var t=e(this).data("ui-resizable"),n=t.options,r=t.size;t.ghost=t.originalElement.clone(),t.ghost.css({opacity:.25,display:"block",position:"relative",height:r.height,width:r.width,margin:0,left:0,top:0}).addClass("ui-resizable-ghost").addClass(typeof n.ghost=="string"?n.ghost:""),t.ghost.appendTo(t.helper)},resize:function(){var t=e(this).data("ui-resizable");t.ghost&&t.ghost.css({position:"relative",height:t.size.height,width:t.size.width})},stop:function(){var t=e(this).data("ui-resizable");t.ghost&&t.helper&&t.helper.get(0).removeChild(t.ghost.get(0))}}),e.ui.plugin.add("resizable","grid",{resize:function(){var t=e(this).data("ui-resizable"),n=t.options,r=t.size,i=t.originalSize,s=t.originalPosition,o=t.axis,u=typeof n.grid=="number"?[n.grid,n.grid]:n.grid,a=u[0]||1,f=u[1]||1,l=Math.round((r.width-i.width)/a)*a,c=Math.round((r.height-i.height)/f)*f,h=i.width+l,p=i.height+c,d=n.maxWidth&&n.maxWidth<h,v=n.maxHeight&&n.maxHeight<p,m=n.minWidth&&n.minWidth>h,g=n.minHeight&&n.minHeight>p;n.grid=u,m&&(h+=a),g&&(p+=f),d&&(h-=a),v&&(p-=f),/^(se|s|e)$/.test(o)?(t.size.width=h,t.size.height=p):/^(ne)$/.test(o)?(t.size.width=h,t.size.height=p,t.position.top=s.top-c):/^(sw)$/.test(o)?(t.size.width=h,t.size.height=p,t.position.left=s.left-l):(p-f>0?(t.size.height=p,t.position.top=s.top-c):(t.size.height=f,t.position.top=s.top+i.height-f),h-a>0?(t.size.width=h,t.position.left=s.left-l):(t.size.width=a,t.position.left=s.left+i.width-a))}})}(jQuery),function(e,t){var n=0,r={},i={};r.height=r.paddingTop=r.paddingBottom=r.borderTopWidth=r.borderBottomWidth="hide",i.height=i.paddingTop=i.paddingBottom=i.borderTopWidth=i.borderBottomWidth="show",e.widget("ui.accordion",{version:"1.10.4",options:{active:0,animate:{},collapsible:!1,event:"click",header:"> li > :first-child,> :not(li):even",heightStyle:"auto",icons:{activeHeader:"ui-icon-triangle-1-s",header:"ui-icon-triangle-1-e"},activate:null,beforeActivate:null},_create:function(){var t=this.options;this.prevShow=this.prevHide=e(),this.element.addClass("ui-accordion ui-widget ui-helper-reset").attr("role","tablist"),!t.collapsible&&(t.active===!1||t.active==null)&&(t.active=0),this._processPanels(),t.active<0&&(t.active+=this.headers.length),this._refresh()},_getCreateEventData:function(){return{header:this.active,panel:this.active.length?this.active.next():e(),content:this.active.length?this.active.next():e()}},_createIcons:function(){var t=this.options.icons;t&&(e("<span>").addClass("ui-accordion-header-icon ui-icon "+t.header).prependTo(this.headers),this.active.children(".ui-accordion-header-icon").removeClass(t.header).addClass(t.activeHeader),this.headers.addClass("ui-accordion-icons"))},_destroyIcons:function(){this.headers.removeClass("ui-accordion-icons").children(".ui-accordion-header-icon").remove()},_destroy:function(){var e;this.element.removeClass("ui-accordion ui-widget ui-helper-reset").removeAttr("role"),this.headers.removeClass("ui-accordion-header ui-accordion-header-active ui-helper-reset ui-state-default ui-corner-all ui-state-active ui-state-disabled ui-corner-top").removeAttr("role").removeAttr("aria-expanded").removeAttr("aria-selected").removeAttr("aria-controls").removeAttr("tabIndex").each(function(){/^ui-accordion/.test(this.id)&&this.removeAttribute("id")}),this._destroyIcons(),e=this.headers.next().css("display","").removeAttr("role").removeAttr("aria-hidden").removeAttr("aria-labelledby").removeClass("ui-helper-reset ui-widget-content ui-corner-bottom ui-accordion-content ui-accordion-content-active ui-state-disabled").each(function(){/^ui-accordion/.test(this.id)&&this.removeAttribute("id")}),this.options.heightStyle!=="content"&&e.css("height","")},_setOption:function(e,t){if(e==="active"){this._activate(t);return}e==="event"&&(this.options.event&&this._off(this.headers,this.options.event),this._setupEvents(t)),this._super(e,t),e==="collapsible"&&!t&&this.options.active===!1&&this._activate(0),e==="icons"&&(this._destroyIcons(),t&&this._createIcons()),e==="disabled"&&this.headers.add(this.headers.next()).toggleClass("ui-state-disabled",!!t)},_keydown:function(t){if(t.altKey||t.ctrlKey)return;var n=e.ui.keyCode,r=this.headers.length,i=this.headers.index(t.target),s=!1;switch(t.keyCode){case n.RIGHT:case n.DOWN:s=this.headers[(i+1)%r];break;case n.LEFT:case n.UP:s=this.headers[(i-1+r)%r];break;case n.SPACE:case n.ENTER:this._eventHandler(t);break;case n.HOME:s=this.headers[0];break;case n.END:s=this.headers[r-1]}s&&(e(t.target).attr("tabIndex",-1),e(s).attr("tabIndex",0),s.focus(),t.preventDefault())},_panelKeyDown:function(t){t.keyCode===e.ui.keyCode.UP&&t.ctrlKey&&e(t.currentTarget).prev().focus()},refresh:function(){var t=this.options;this._processPanels(),t.active===!1&&t.collapsible===!0||!this.headers.length?(t.active=!1,this.active=e()):t.active===!1?this._activate(0):this.active.length&&!e.contains(this.element[0],this.active[0])?this.headers.length===this.headers.find(".ui-state-disabled").length?(t.active=!1,this.active=e()):this._activate(Math.max(0,t.active-1)):t.active=this.headers.index(this.active),this._destroyIcons(),this._refresh()},_processPanels:function(){this.headers=this.element.find(this.options.header).addClass("ui-accordion-header ui-helper-reset ui-state-default ui-corner-all"),this.headers.next().addClass("ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom").filter(":not(.ui-accordion-content-active)").hide()},_refresh:function(){var t,r=this.options,i=r.heightStyle,s=this.element.parent(),o=this.accordionId="ui-accordion-"+(this.element.attr("id")||++n);this.active=this._findActive(r.active).addClass("ui-accordion-header-active ui-state-active ui-corner-top").removeClass("ui-corner-all"),this.active.next().addClass("ui-accordion-content-active").show(),this.headers.attr("role","tab").each(function(t){var n=e(this),r=n.attr("id"),i=n.next(),s=i.attr("id");r||(r=o+"-header-"+t,n.attr("id",r)),s||(s=o+"-panel-"+t,i.attr("id",s)),n.attr("aria-controls",s),i.attr("aria-labelledby",r)}).next().attr("role","tabpanel"),this.headers.not(this.active).attr({"aria-selected":"false","aria-expanded":"false",tabIndex:-1}).next().attr({"aria-hidden":"true"}).hide(),this.active.length?this.active.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0}).next().attr({"aria-hidden":"false"}):this.headers.eq(0).attr("tabIndex",0),this._createIcons(),this._setupEvents(r.event),i==="fill"?(t=s.height(),this.element.siblings(":visible").each(function(){var n=e(this),r=n.css("position");if(r==="absolute"||r==="fixed")return;t-=n.outerHeight(!0)}),this.headers.each(function(){t-=e(this).outerHeight(!0)}),this.headers.next().each(function(){e(this).height(Math.max(0,t-e(this).innerHeight()+e(this).height()))}).css("overflow","auto")):i==="auto"&&(t=0,this.headers.next().each(function(){t=Math.max(t,e(this).css("height","").height())}).height(t))},_activate:function(t){var n=this._findActive(t)[0];if(n===this.active[0])return;n=n||this.active[0],this._eventHandler({target:n,currentTarget:n,preventDefault:e.noop})},_findActive:function(t){return typeof t=="number"?this.headers.eq(t):e()},_setupEvents:function(t){var n={keydown:"_keydown"};t&&e.each(t.split(" "),function(e,t){n[t]="_eventHandler"}),this._off(this.headers.add(this.headers.next())),this._on(this.headers,n),this._on(this.headers.next(),{keydown:"_panelKeyDown"}),this._hoverable(this.headers),this._focusable(this.headers)},_eventHandler:function(t){var n=this.options,r=this.active,i=e(t.currentTarget),s=i[0]===r[0],o=s&&n.collapsible,u=o?e():i.next(),a=r.next(),f={oldHeader:r,oldPanel:a,newHeader:o?e():i,newPanel:u};t.preventDefault();if(s&&!n.collapsible||this._trigger("beforeActivate",t,f)===!1)return;n.active=o?!1:this.headers.index(i),this.active=s?e():i,this._toggle(f),r.removeClass("ui-accordion-header-active ui-state-active"),n.icons&&r.children(".ui-accordion-header-icon").removeClass(n.icons.activeHeader).addClass(n.icons.header),s||(i.removeClass("ui-corner-all").addClass("ui-accordion-header-active ui-state-active ui-corner-top"),n.icons&&i.children(".ui-accordion-header-icon").removeClass(n.icons.header).addClass(n.icons.activeHeader),i.next().addClass("ui-accordion-content-active"))},_toggle:function(t){var n=t.newPanel,r=this.prevShow.length?this.prevShow:t.oldPanel;this.prevShow.add(this.prevHide).stop(!0,!0),this.prevShow=n,this.prevHide=r,this.options.animate?this._animate(n,r,t):(r.hide(),n.show(),this._toggleComplete(t)),r.attr({"aria-hidden":"true"}),r.prev().attr("aria-selected","false"),n.length&&r.length?r.prev().attr({tabIndex:-1,"aria-expanded":"false"}):n.length&&this.headers.filter(function(){return e(this).attr("tabIndex")===0}).attr("tabIndex",-1),n.attr("aria-hidden","false").prev().attr({"aria-selected":"true",tabIndex:0,"aria-expanded":"true"})},_animate:function(e,t,n){var s,o,u,a=this,f=0,l=e.length&&(!t.length||e.index()<t.index()),c=this.options.animate||{},h=l&&c.down||c,p=function(){a._toggleComplete(n)};typeof h=="number"&&(u=h),typeof h=="string"&&(o=h),o=o||h.easing||c.easing,u=u||h.duration||c.duration;if(!t.length)return e.animate(i,u,o,p);if(!e.length)return t.animate(r,u,o,p);s=e.show().outerHeight(),t.animate(r,{duration:u,easing:o,step:function(e,t){t.now=Math.round(e)}}),e.hide().animate(i,{duration:u,easing:o,complete:p,step:function(e,n){n.now=Math.round(e),n.prop!=="height"?f+=n.now:a.options.heightStyle!=="content"&&(n.now=Math.round(s-t.outerHeight()-f),f=0)}})},_toggleComplete:function(e){var t=e.oldPanel;t.removeClass("ui-accordion-content-active").prev().removeClass("ui-corner-top").addClass("ui-corner-all"),t.length&&(t.parent()[0].className=t.parent()[0].className),this._trigger("activate",null,e)}})}(jQuery),function(e,t){var n,r="ui-button ui-widget ui-state-default ui-corner-all",i="ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only",s=function(){var t=e(this);setTimeout(function(){t.find(":ui-button").button("refresh")},1)},o=function(t){var n=t.name,r=t.form,i=e([]);return n&&(n=n.replace(/'/g,"\\'"),r?i=e(r).find("[name='"+n+"']"):i=e("[name='"+n+"']",t.ownerDocument).filter(function(){return!this.form})),i};e.widget("ui.button",{version:"1.10.4",defaultElement:"<button>",options:{disabled:null,text:!0,label:null,icons:{primary:null,secondary:null}},_create:function(){this.element.closest("form").unbind("reset"+this.eventNamespace).bind("reset"+this.eventNamespace,s),typeof this.options.disabled!="boolean"?this.options.disabled=!!this.element.prop("disabled"):this.element.prop("disabled",this.options.disabled),this._determineButtonType(),this.hasTitle=!!this.buttonElement.attr("title");var t=this,i=this.options,u=this.type==="checkbox"||this.type==="radio",a=u?"":"ui-state-active";i.label===null&&(i.label=this.type==="input"?this.buttonElement.val():this.buttonElement.html()),this._hoverable(this.buttonElement),this.buttonElement.addClass(r).attr("role","button").bind("mouseenter"+this.eventNamespace,function(){if(i.disabled)return;this===n&&e(this).addClass("ui-state-active")}).bind("mouseleave"+this.eventNamespace,function(){if(i.disabled)return;e(this).removeClass(a)}).bind("click"+this.eventNamespace,function(e){i.disabled&&(e.preventDefault(),e.stopImmediatePropagation())}),this._on({focus:function(){this.buttonElement.addClass("ui-state-focus")},blur:function(){this.buttonElement.removeClass("ui-state-focus")}}),u&&this.element.bind("change"+this.eventNamespace,function(){t.refresh()}),this.type==="checkbox"?this.buttonElement.bind("click"+this.eventNamespace,function(){if(i.disabled)return!1}):this.type==="radio"?this.buttonElement.bind("click"+this.eventNamespace,function(){if(i.disabled)return!1;e(this).addClass("ui-state-active"),t.buttonElement.attr("aria-pressed","true");var n=t.element[0];o(n).not(n).map(function(){return e(this).button("widget")[0]}).removeClass("ui-state-active").attr("aria-pressed","false")}):(this.buttonElement.bind("mousedown"+this.eventNamespace,function(){if(i.disabled)return!1;e(this).addClass("ui-state-active"),n=this,t.document.one("mouseup",function(){n=null})}).bind("mouseup"+this.eventNamespace,function(){if(i.disabled)return!1;e(this).removeClass("ui-state-active")}).bind("keydown"+this.eventNamespace,function(t){if(i.disabled)return!1;(t.keyCode===e.ui.keyCode.SPACE||t.keyCode===e.ui.keyCode.ENTER)&&e(this).addClass("ui-state-active")}).bind("keyup"+this.eventNamespace+" blur"+this.eventNamespace,function(){e(this).removeClass("ui-state-active")}),this.buttonElement.is("a")&&this.buttonElement.keyup(function(t){t.keyCode===e.ui.keyCode.SPACE&&e(this).click()})),this._setOption("disabled",i.disabled),this._resetButton()},_determineButtonType:function(){var e,t,n;this.element.is("[type=checkbox]")?this.type="checkbox":this.element.is("[type=radio]")?this.type="radio":this.element.is("input")?this.type="input":this.type="button",this.type==="checkbox"||this.type==="radio"?(e=this.element.parents().last(),t="label[for='"+this.element.attr("id")+"']",this.buttonElement=e.find(t),this.buttonElement.length||(e=e.length?e.siblings():this.element.siblings(),this.buttonElement=e.filter(t),this.buttonElement.length||(this.buttonElement=e.find(t))),this.element.addClass("ui-helper-hidden-accessible"),n=this.element.is(":checked"),n&&this.buttonElement.addClass("ui-state-active"),this.buttonElement.prop("aria-pressed",n)):this.buttonElement=this.element},widget:function(){return this.buttonElement},_destroy:function(){this.element.removeClass("ui-helper-hidden-accessible"),this.buttonElement.removeClass(r+" ui-state-active "+i).removeAttr("role").removeAttr("aria-pressed").html(this.buttonElement.find(".ui-button-text").html()),this.hasTitle||this.buttonElement.removeAttr("title")},_setOption:function(e,t){this._super(e,t);if(e==="disabled"){this.element.prop("disabled",!!t),t&&this.buttonElement.removeClass("ui-state-focus");return}this._resetButton()},refresh:function(){var t=this.element.is("input, button")?this.element.is(":disabled"):this.element.hasClass("ui-button-disabled");t!==this.options.disabled&&this._setOption("disabled",t),this.type==="radio"?o(this.element[0]).each(function(){e(this).is(":checked")?e(this).button("widget").addClass("ui-state-active").attr("aria-pressed","true"):e(this).button("widget").removeClass("ui-state-active").attr("aria-pressed","false")}):this.type==="checkbox"&&(this.element.is(":checked")?this.buttonElement.addClass("ui-state-active").attr("aria-pressed","true"):this.buttonElement.removeClass("ui-state-active").attr("aria-pressed","false"))},_resetButton:function(){if(this.type==="input"){this.options.label&&this.element.val(this.options.label);return}var t=this.buttonElement.removeClass(i),n=e("<span></span>",this.document[0]).addClass("ui-button-text").html(this.options.label).appendTo(t.empty()).text(),r=this.options.icons,s=r.primary&&r.secondary,o=[];r.primary||r.secondary?(this.options.text&&o.push("ui-button-text-icon"+(s?"s":r.primary?"-primary":"-secondary")),r.primary&&t.prepend("<span class='ui-button-icon-primary ui-icon "+r.primary+"'></span>"),r.secondary&&t.append("<span class='ui-button-icon-secondary ui-icon "+r.secondary+"'></span>"),this.options.text||(o.push(s?"ui-button-icons-only":"ui-button-icon-only"),this.hasTitle||t.attr("title",e.trim(n)))):o.push("ui-button-text-only"),t.addClass(o.join(" "))}}),e.widget("ui.buttonset",{version:"1.10.4",options:{items:"button, input[type=button], input[type=submit], input[type=reset], input[type=checkbox], input[type=radio], a, :data(ui-button)"},_create:function(){this.element.addClass("ui-buttonset")},_init:function(){this.refresh()},_setOption:function(e,t){e==="disabled"&&this.buttons.button("option",e,t),this._super(e,t)},refresh:function(){var t=this.element.css("direction")==="rtl";this.buttons=this.element.find(this.options.items).filter(":ui-button").button("refresh").end().not(":ui-button").button().end().map(function(){return e(this).button("widget")[0]}).removeClass("ui-corner-all ui-corner-left ui-corner-right").filter(":first").addClass(t?"ui-corner-right":"ui-corner-left").end().filter(":last").addClass(t?"ui-corner-left":"ui-corner-right").end().end()},_destroy:function(){this.element.removeClass("ui-buttonset"),this.buttons.map(function(){return e(this).button("widget")[0]}).removeClass("ui-corner-left ui-corner-right").end().button("destroy")}})}(jQuery),function(e,t){var n={buttons:!0,height:!0,maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0,width:!0},r={maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0};e.widget("ui.dialog",{version:"1.10.4",options:{appendTo:"body",autoOpen:!0,buttons:[],closeOnEscape:!0,closeText:"close",dialogClass:"",draggable:!0,hide:null,height:"auto",maxHeight:null,maxWidth:null,minHeight:150,minWidth:150,modal:!1,position:{my:"center",at:"center",of:window,collision:"fit",using:function(t){var n=e(this).css(t).offset().top;n<0&&e(this).css("top",t.top-n)}},resizable:!0,show:null,title:null,width:300,beforeClose:null,close:null,drag:null,dragStart:null,dragStop:null,focus:null,open:null,resize:null,resizeStart:null,resizeStop:null},_create:function(){this.originalCss={display:this.element[0].style.display,width:this.element[0].style.width,minHeight:this.element[0].style.minHeight,maxHeight:this.element[0].style.maxHeight,height:this.element[0].style.height},this.originalPosition={parent:this.element.parent(),index:this.element.parent().children().index(this.element)},this.originalTitle=this.element.attr("title"),this.options.title=this.options.title||this.originalTitle,this._createWrapper(),this.element.show().removeAttr("title").addClass("ui-dialog-content ui-widget-content").appendTo(this.uiDialog),this._createTitlebar(),this._createButtonPane(),this.options.draggable&&e.fn.draggable&&this._makeDraggable(),this.options.resizable&&e.fn.resizable&&this._makeResizable(),this._isOpen=!1},_init:function(){this.options.autoOpen&&this.open()},_appendTo:function(){var t=this.options.appendTo;return t&&(t.jquery||t.nodeType)?e(t):this.document.find(t||"body").eq(0)},_destroy:function(){var e,t=this.originalPosition;this._destroyOverlay(),this.element.removeUniqueId().removeClass("ui-dialog-content ui-widget-content").css(this.originalCss).detach(),this.uiDialog.stop(!0,!0).remove(),this.originalTitle&&this.element.attr("title",this.originalTitle),e=t.parent.children().eq(t.index),e.length&&e[0]!==this.element[0]?e.before(this.element):t.parent.append(this.element)},widget:function(){return this.uiDialog},disable:e.noop,enable:e.noop,close:function(t){var n,r=this;if(!this._isOpen||this._trigger("beforeClose",t)===!1)return;this._isOpen=!1,this._destroyOverlay();if(!this.opener.filter(":focusable").focus().length)try{n=this.document[0].activeElement,n&&n.nodeName.toLowerCase()!=="body"&&e(n).blur()}catch(i){}this._hide(this.uiDialog,this.options.hide,function(){r._trigger("close",t)})},isOpen:function(){return this._isOpen},moveToTop:function(){this._moveToTop()},_moveToTop:function(e,t){var n=!!this.uiDialog.nextAll(":visible").insertBefore(this.uiDialog).length;return n&&!t&&this._trigger("focus",e),n},open:function(){var t=this;if(this._isOpen){this._moveToTop()&&this._focusTabbable();return}this._isOpen=!0,this.opener=e(this.document[0].activeElement),this._size(),this._position(),this._createOverlay(),this._moveToTop(null,!0),this._show(this.uiDialog,this.options.show,function(){t._focusTabbable(),t._trigger("focus")}),this._trigger("open")},_focusTabbable:function(){var e=this.element.find("[autofocus]");e.length||(e=this.element.find(":tabbable")),e.length||(e=this.uiDialogButtonPane.find(":tabbable")),e.length||(e=this.uiDialogTitlebarClose.filter(":tabbable")),e.length||(e=this.uiDialog),e.eq(0).focus()},_keepFocus:function(t){function n(){var t=this.document[0].activeElement,n=this.uiDialog[0]===t||e.contains(this.uiDialog[0],t);n||this._focusTabbable()}t.preventDefault(),n.call(this),this._delay(n)},_createWrapper:function(){this.uiDialog=e("<div>").addClass("ui-dialog ui-widget ui-widget-content ui-corner-all ui-front "+this.options.dialogClass).hide().attr({tabIndex:-1,role:"dialog"}).appendTo(this._appendTo()),this._on(this.uiDialog,{keydown:function(t){if(this.options.closeOnEscape&&!t.isDefaultPrevented()&&t.keyCode&&t.keyCode===e.ui.keyCode.ESCAPE){t.preventDefault(),this.close(t);return}if(t.keyCode!==e.ui.keyCode.TAB)return;var n=this.uiDialog.find(":tabbable"),r=n.filter(":first"),i=n.filter(":last");t.target!==i[0]&&t.target!==this.uiDialog[0]||!!t.shiftKey?(t.target===r[0]||t.target===this.uiDialog[0])&&t.shiftKey&&(i.focus(1),t.preventDefault()):(r.focus(1),t.preventDefault())},mousedown:function(e){this._moveToTop(e)&&this._focusTabbable()}}),this.element.find("[aria-describedby]").length||this.uiDialog.attr({"aria-describedby":this.element.uniqueId().attr("id")})},_createTitlebar:function(){var t;this.uiDialogTitlebar=e("<div>").addClass("ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix").prependTo(this.uiDialog),this._on(this.uiDialogTitlebar,{mousedown:function(t){e(t.target).closest(".ui-dialog-titlebar-close")||this.uiDialog.focus()}}),this.uiDialogTitlebarClose=e("<button type='button'></button>").button({label:this.options.closeText,icons:{primary:"ui-icon-closethick"},text:!1}).addClass("ui-dialog-titlebar-close").appendTo(this.uiDialogTitlebar),this._on(this.uiDialogTitlebarClose,{click:function(e){e.preventDefault(),this.close(e)}}),t=e("<span>").uniqueId().addClass("ui-dialog-title").prependTo(this.uiDialogTitlebar),this._title(t),this.uiDialog.attr({"aria-labelledby":t.attr("id")})},_title:function(e){this.options.title||e.html("&#160;"),e.text(this.options.title)},_createButtonPane:function(){this.uiDialogButtonPane=e("<div>").addClass("ui-dialog-buttonpane ui-widget-content ui-helper-clearfix"),this.uiButtonSet=e("<div>").addClass("ui-dialog-buttonset").appendTo(this.uiDialogButtonPane),this._createButtons()},_createButtons:function(){var t=this,n=this.options.buttons;this.uiDialogButtonPane.remove(),this.uiButtonSet.empty();if(e.isEmptyObject(n)||e.isArray(n)&&!n.length){this.uiDialog.removeClass("ui-dialog-buttons");return}e.each(n,function(n,r){var i,s;r=e.isFunction(r)?{click:r,text:n}:r,r=e.extend({type:"button"},r),i=r.click,r.click=function(){i.apply(t.element[0],arguments)},s={icons:r.icons,text:r.showText},delete r.icons,delete r.showText,e("<button></button>",r).button(s).appendTo(t.uiButtonSet)}),this.uiDialog.addClass("ui-dialog-buttons"),this.uiDialogButtonPane.appendTo(this.uiDialog)},_makeDraggable:function(){function r(e){return{position:e.position,offset:e.offset}}var t=this,n=this.options;this.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",handle:".ui-dialog-titlebar",containment:"document",start:function(n,i){e(this).addClass("ui-dialog-dragging"),t._blockFrames(),t._trigger("dragStart",n,r(i))},drag:function(e,n){t._trigger("drag",e,r(n))},stop:function(i,s){n.position=[s.position.left-t.document.scrollLeft(),s.position.top-t.document.scrollTop()],e(this).removeClass("ui-dialog-dragging"),t._unblockFrames(),t._trigger("dragStop",i,r(s))}})},_makeResizable:function(){function o(e){return{originalPosition:e.originalPosition,originalSize:e.originalSize,position:e.position,size:e.size}}var t=this,n=this.options,r=n.resizable,i=this.uiDialog.css("position"),s=typeof r=="string"?r:"n,e,s,w,se,sw,ne,nw";this.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:this.element,maxWidth:n.maxWidth,maxHeight:n.maxHeight,minWidth:n.minWidth,minHeight:this._minHeight(),handles:s,start:function(n,r){e(this).addClass("ui-dialog-resizing"),t._blockFrames(),t._trigger("resizeStart",n,o(r))},resize:function(e,n){t._trigger("resize",e,o(n))},stop:function(r,i){n.height=e(this).height(),n.width=e(this).width(),e(this).removeClass("ui-dialog-resizing"),t._unblockFrames(),t._trigger("resizeStop",r,o(i))}}).css("position",i)},_minHeight:function(){var e=this.options;return e.height==="auto"?e.minHeight:Math.min(e.minHeight,e.height)},_position:function(){var e=this.uiDialog.is(":visible");e||this.uiDialog.show(),this.uiDialog.position(this.options.position),e||this.uiDialog.hide()},_setOptions:function(t){var i=this,s=!1,o={};e.each(t,function(e,t){i._setOption(e,t),e in n&&(s=!0),e in r&&(o[e]=t)}),s&&(this._size(),this._position()),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option",o)},_setOption:function(e,t){var n,r,i=this.uiDialog;e==="dialogClass"&&i.removeClass(this.options.dialogClass).addClass(t);if(e==="disabled")return;this._super(e,t),e==="appendTo"&&this.uiDialog.appendTo(this._appendTo()),e==="buttons"&&this._createButtons(),e==="closeText"&&this.uiDialogTitlebarClose.button({label:""+t}),e==="draggable"&&(n=i.is(":data(ui-draggable)"),n&&!t&&i.draggable("destroy"),!n&&t&&this._makeDraggable()),e==="position"&&this._position(),e==="resizable"&&(r=i.is(":data(ui-resizable)"),r&&!t&&i.resizable("destroy"),r&&typeof t=="string"&&i.resizable("option","handles",t),!r&&t!==!1&&this._makeResizable()),e==="title"&&this._title(this.uiDialogTitlebar.find(".ui-dialog-title"))},_size:function(){var e,t,n,r=this.options;this.element.show().css({width:"auto",minHeight:0,maxHeight:"none",height:0}),r.minWidth>r.width&&(r.width=r.minWidth),e=this.uiDialog.css({height:"auto",width:r.width}).outerHeight(),t=Math.max(0,r.minHeight-e),n=typeof r.maxHeight=="number"?Math.max(0,r.maxHeight-e):"none",r.height==="auto"?this.element.css({minHeight:t,maxHeight:n,height:"auto"}):this.element.height(Math.max(0,r.height-e)),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option","minHeight",this._minHeight())},_blockFrames:function(){this.iframeBlocks=this.document.find("iframe").map(function(){var t=e(this);return e("<div>").css({position:"absolute",width:t.outerWidth(),height:t.outerHeight()}).appendTo(t.parent()).offset(t.offset())[0]})},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_allowInteraction:function(t){return e(t.target).closest(".ui-dialog").length?!0:!!e(t.target).closest(".ui-datepicker").length},_createOverlay:function(){if(!this.options.modal)return;var t=this,n=this.widgetFullName;e.ui.dialog.overlayInstances||this._delay(function(){e.ui.dialog.overlayInstances&&this.document.bind("focusin.dialog",function(r){t._allowInteraction(r)||(r.preventDefault(),e(".ui-dialog:visible:last .ui-dialog-content").data(n)._focusTabbable())})}),this.overlay=e("<div>").addClass("ui-widget-overlay ui-front").appendTo(this._appendTo()),this._on(this.overlay,{mousedown:"_keepFocus"}),e.ui.dialog.overlayInstances++},_destroyOverlay:function(){if(!this.options.modal)return;this.overlay&&(e.ui.dialog.overlayInstances--,e.ui.dialog.overlayInstances||this.document.unbind("focusin.dialog"),this.overlay.remove(),this.overlay=null)}}),e.ui.dialog.overlayInstances=0,e.uiBackCompat!==!1&&e.widget("ui.dialog",e.ui.dialog,{_position:function(){var t=this.options.position,n=[],r=[0,0],i;if(t){if(typeof t=="string"||typeof t=="object"&&"0"in t)n=t.split?t.split(" "):[t[0],t[1]],n.length===1&&(n[1]=n[0]),e.each(["left","top"],function(e,t){+n[e]===n[e]&&(r[e]=n[e],n[e]=t)}),t={my:n[0]+(r[0]<0?r[0]:"+"+r[0])+" "+n[1]+(r[1]<0?r[1]:"+"+r[1]),at:n.join(" ")};t=e.extend({},e.ui.dialog.prototype.options.position,t)}else t=e.ui.dialog.prototype.options.position;i=this.uiDialog.is(":visible"),i||this.uiDialog.show(),this.uiDialog.position(t),i||this.uiDialog.hide()}})}(jQuery),function(e,t){var n=5;e.widget("ui.slider",e.ui.mouse,{version:"1.10.4",widgetEventPrefix:"slide",options:{animate:!1,distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null,change:null,slide:null,start:null,stop:null},_create:function(){this._keySliding=!1,this._mouseSliding=!1,this._animateOff=!0,this._handleIndex=null,this._detectOrientation(),this._mouseInit(),this.element.addClass("ui-slider ui-slider-"+this.orientation+" ui-widget"+" ui-widget-content"+" ui-corner-all"),this._refresh(),this._setOption("disabled",this.options.disabled),this._animateOff=!1},_refresh:function(){this._createRange(),this._createHandles(),this._setupEvents(),this._refreshValue()},_createHandles:function(){var t,n,r=this.options,i=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),s="<a class='ui-slider-handle ui-state-default ui-corner-all' href='#'></a>",o=[];n=r.values&&r.values.length||1,i.length>n&&(i.slice(n).remove(),i=i.slice(0,n));for(t=i.length;t<n;t++)o.push(s);this.handles=i.add(e(o.join("")).appendTo(this.element)),this.handle=this.handles.eq(0),this.handles.each(function(t){e(this).data("ui-slider-handle-index",t)})},_createRange:function(){var t=this.options,n="";t.range?(t.range===!0&&(t.values?t.values.length&&t.values.length!==2?t.values=[t.values[0],t.values[0]]:e.isArray(t.values)&&(t.values=t.values.slice(0)):t.values=[this._valueMin(),this._valueMin()]),!this.range||!this.range.length?(this.range=e("<div></div>").appendTo(this.element),n="ui-slider-range ui-widget-header ui-corner-all"):this.range.removeClass("ui-slider-range-min ui-slider-range-max").css({left:"",bottom:""}),this.range.addClass(n+(t.range==="min"||t.range==="max"?" ui-slider-range-"+t.range:""))):(this.range&&this.range.remove(),this.range=null)},_setupEvents:function(){var e=this.handles.add(this.range).filter("a");this._off(e),this._on(e,this._handleEvents),this._hoverable(e),this._focusable(e)},_destroy:function(){this.handles.remove(),this.range&&this.range.remove(),this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-widget ui-widget-content ui-corner-all"),this._mouseDestroy()},_mouseCapture:function(t){var n,r,i,s,o,u,a,f,l=this,c=this.options;return c.disabled?!1:(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),n={x:t.pageX,y:t.pageY},r=this._normValueFromMouse(n),i=this._valueMax()-this._valueMin()+1,this.handles.each(function(t){var n=Math.abs(r-l.values(t));if(i>n||i===n&&(t===l._lastChangedValue||l.values(t)===c.min))i=n,s=e(this),o=t}),u=this._start(t,o),u===!1?!1:(this._mouseSliding=!0,this._handleIndex=o,s.addClass("ui-state-active").focus(),a=s.offset(),f=!e(t.target).parents().addBack().is(".ui-slider-handle"),this._clickOffset=f?{left:0,top:0}:{left:t.pageX-a.left-s.width()/2,top:t.pageY-a.top-s.height()/2-(parseInt(s.css("borderTopWidth"),10)||0)-(parseInt(s.css("borderBottomWidth"),10)||0)+(parseInt(s.css("marginTop"),10)||0)},this.handles.hasClass("ui-state-hover")||this._slide(t,o,r),this._animateOff=!0,!0))},_mouseStart:function(){return!0},_mouseDrag:function(e){var t={x:e.pageX,y:e.pageY},n=this._normValueFromMouse(t);return this._slide(e,this._handleIndex,n),!1},_mouseStop:function(e){return this.handles.removeClass("ui-state-active"),this._mouseSliding=!1,this._stop(e,this._handleIndex),this._change(e,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1,!1},_detectOrientation:function(){this.orientation=this.options.orientation==="vertical"?"vertical":"horizontal"},_normValueFromMouse:function(e){var t,n,r,i,s;return this.orientation==="horizontal"?(t=this.elementSize.width,n=e.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(t=this.elementSize.height,n=e.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)),r=n/t,r>1&&(r=1),r<0&&(r=0),this.orientation==="vertical"&&(r=1-r),i=this._valueMax()-this._valueMin(),s=this._valueMin()+r*i,this._trimAlignValue(s)},_start:function(e,t){var n={handle:this.handles[t],value:this.value()};return this.options.values&&this.options.values.length&&(n.value=this.values(t),n.values=this.values()),this._trigger("start",e,n)},_slide:function(e,t,n){var r,i,s;this.options.values&&this.options.values.length?(r=this.values(t?0:1),this.options.values.length===2&&this.options.range===!0&&(t===0&&n>r||t===1&&n<r)&&(n=r),n!==this.values(t)&&(i=this.values(),i[t]=n,s=this._trigger("slide",e,{handle:this.handles[t],value:n,values:i}),r=this.values(t?0:1),s!==!1&&this.values(t,n))):n!==this.value()&&(s=this._trigger("slide",e,{handle:this.handles[t],value:n}),s!==!1&&this.value(n))},_stop:function(e,t){var n={handle:this.handles[t],value:this.value()};this.options.values&&this.options.values.length&&(n.value=this.values(t),n.values=this.values()),this._trigger("stop",e,n)},_change:function(e,t){if(!this._keySliding&&!this._mouseSliding){var n={handle:this.handles[t],value:this.value()};this.options.values&&this.options.values.length&&(n.value=this.values(t),n.values=this.values()),this._lastChangedValue=t,this._trigger("change",e,n)}},value:function(e){if(arguments.length){this.options.value=this._trimAlignValue(e),this._refreshValue(),this._change(null,0);return}return this._value()},values:function(t,n){var r,i,s;if(arguments.length>1){this.options.values[t]=this._trimAlignValue(n),this._refreshValue(),this._change(null,t);return}if(!arguments.length)return this._values();if(!e.isArray(arguments[0]))return this.options.values&&this.options.values.length?this._values(t):this.value();r=this.options.values,i=arguments[0];for(s=0;s<r.length;s+=1)r[s]=this._trimAlignValue(i[s]),this._change(null,s);this._refreshValue()},_setOption:function(t,n){var r,i=0;t==="range"&&this.options.range===!0&&(n==="min"?(this.options.value=this._values(0),this.options.values=null):n==="max"&&(this.options.value=this._values(this.options.values.length-1),this.options.values=null)),e.isArray(this.options.values)&&(i=this.options.values.length),e.Widget.prototype._setOption.apply(this,arguments);switch(t){case"orientation":this._detectOrientation(),this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation),this._refreshValue();break;case"value":this._animateOff=!0,this._refreshValue(),this._change(null,0),this._animateOff=!1;break;case"values":this._animateOff=!0,this._refreshValue();for(r=0;r<i;r+=1)this._change(null,r);this._animateOff=!1;break;case"min":case"max":this._animateOff=!0,this._refreshValue(),this._animateOff=!1;break;case"range":this._animateOff=!0,this._refresh(),this._animateOff=!1}},_value:function(){var e=this.options.value;return e=this._trimAlignValue(e),e},_values:function(e){var t,n,r;if(arguments.length)return t=this.options.values[e],t=this._trimAlignValue(t),t;if(this.options.values&&this.options.values.length){n=this.options.values.slice();for(r=0;r<n.length;r+=1)n[r]=this._trimAlignValue(n[r]);return n}return[]},_trimAlignValue:function(e){if(e<=this._valueMin())return this._valueMin();if(e>=this._valueMax())return this._valueMax();var t=this.options.step>0?this.options.step:1,n=(e-this._valueMin())%t,r=e-n;return Math.abs(n)*2>=t&&(r+=n>0?t:-t),parseFloat(r.toFixed(5))},_valueMin:function(){return this.options.min},_valueMax:function(){return this.options.max},_refreshValue:function(){var t,n,r,i,s,o=this.options.range,u=this.options,a=this,f=this._animateOff?!1:u.animate,l={};this.options.values&&this.options.values.length?this.handles.each(function(r){n=(a.values(r)-a._valueMin())/(a._valueMax()-a._valueMin())*100,l[a.orientation==="horizontal"?"left":"bottom"]=n+"%",e(this).stop(1,1)[f?"animate":"css"](l,u.animate),a.options.range===!0&&(a.orientation==="horizontal"?(r===0&&a.range.stop(1,1)[f?"animate":"css"]({left:n+"%"},u.animate),r===1&&a.range[f?"animate":"css"]({width:n-t+"%"},{queue:!1,duration:u.animate})):(r===0&&a.range.stop(1,1)[f?"animate":"css"]({bottom:n+"%"},u.animate),r===1&&a.range[f?"animate":"css"]({height:n-t+"%"},{queue:!1,duration:u.animate}))),t=n}):(r=this.value(),i=this._valueMin(),s=this._valueMax(),n=s!==i?(r-i)/(s-i)*100:0,l[this.orientation==="horizontal"?"left":"bottom"]=n+"%",this.handle.stop(1,1)[f?"animate":"css"](l,u.animate),o==="min"&&this.orientation==="horizontal"&&this.range.stop(1,1)[f?"animate":"css"]({width:n+"%"},u.animate),o==="max"&&this.orientation==="horizontal"&&this.range[f?"animate":"css"]({width:100-n+"%"},{queue:!1,duration:u.animate}),o==="min"&&this.orientation==="vertical"&&this.range.stop(1,1)[f?"animate":"css"]({height:n+"%"},u.animate),o==="max"&&this.orientation==="vertical"&&this.range[f?"animate":"css"]({height:100-n+"%"},{queue:!1,duration:u.animate}))},_handleEvents:{keydown:function(t){var r,i,s,o,u=e(t.target).data("ui-slider-handle-index");switch(t.keyCode){case e.ui.keyCode.HOME:case e.ui.keyCode.END:case e.ui.keyCode.PAGE_UP:case e.ui.keyCode.PAGE_DOWN:case e.ui.keyCode.UP:case e.ui.keyCode.RIGHT:case e.ui.keyCode.DOWN:case e.ui.keyCode.LEFT:t.preventDefault();if(!this._keySliding){this._keySliding=!0,e(t.target).addClass("ui-state-active"),r=this._start(t,u);if(r===!1)return}}o=this.options.step,this.options.values&&this.options.values.length?i=s=this.values(u):i=s=this.value();switch(t.keyCode){case e.ui.keyCode.HOME:s=this._valueMin();break;case e.ui.keyCode.END:s=this._valueMax();break;case e.ui.keyCode.PAGE_UP:s=this._trimAlignValue(i+(this._valueMax()-this._valueMin())/n);break;case e.ui.keyCode.PAGE_DOWN:s=this._trimAlignValue(i-(this._valueMax()-this._valueMin())/n);break;case e.ui.keyCode.UP:case e.ui.keyCode.RIGHT:if(i===this._valueMax())return;s=this._trimAlignValue(i+o);break;case e.ui.keyCode.DOWN:case e.ui.keyCode.LEFT:if(i===this._valueMin())return;s=this._trimAlignValue(i-o)}this._slide(t,u,s)},click:function(e){e.preventDefault()},keyup:function(t){var n=e(t.target).data("ui-slider-handle-index");this._keySliding&&(this._keySliding=!1,this._stop(t,n),this._change(t,n),e(t.target).removeClass("ui-state-active"))}}})}(jQuery),define("jquery-ui",function(){}),define("time-slider",["jquery","message-bus","layout","jquery-ui","i18n"],function($,bus,layout,ui,i18n){var divTimeSliderLabel,div,divTimeSlider,timestampSet={},timestamps,getLocalizedDate=function(date){var defaultMonths=["Jan.","Feb.","Mar.","Apr.","May","June","July","Aug.","Sep.","Oct.","Nov.","Dec."],months=i18n.months?eval(i18n.months):defaultMonths,arr=date.split("-");return arr[1]&&(arr[1]=months[arr[1]-1]),arr[1]+" "+arr[0]};div=layout.timeSlider,divTimeSlider=$("<div/>").attr("id","time_slider"),div.append(divTimeSlider),divTimeSlider.slider({change:function(e,t){var n=new Date;n.setISO8601(timestamps[t.value]),divTimeSliderLabel.text(getLocalizedDate(timestamps[t.value])),bus.send("time-slider.selection",n)}}),divTimeSlider.slider("option","min",0),divTimeSlider.slider("option","max",0),divTimeSliderLabel=$("<div/>").attr("id","time_slider_label"),div.append(divTimeSliderLabel),bus.listen("add-layer",function(e,t){var n,r;if(t.hasOwnProperty("timestamps")){n=t.timestamps;for(r=0;r<n.length;r++)timestampSet[n[r]]=!0}}),bus.listen("layers-loaded",function(){timestamps=Object.keys(timestampSet).sort(),divTimeSlider.slider("value",divTimeSlider.slider("value"))})}),function(e,t,n,r){var i=n("html"),s=n(e),o=n(t),u=n.fancybox=function(){u.open.apply(this,arguments)},a=navigator.userAgent.match(/msie/i),f=null,l=t.createTouch!==r,c=function(e){return e&&e.hasOwnProperty&&e instanceof n},h=function(e){return e&&"string"===n.type(e)},p=function(e){return h(e)&&0<e.indexOf("%")},d=function(e,t){var n=parseInt(e,10)||0;return t&&p(e)&&(n*=u.getViewport()[t]/100),Math.ceil(n)},v=function(e,t){return d(e,t)+"px"};n.extend(u,{version:"2.1.5",defaults:{padding:15,margin:20,width:800,height:600,minWidth:100,minHeight:100,maxWidth:9999,maxHeight:9999,pixelRatio:1,autoSize:!0,autoHeight:!1,autoWidth:!1,autoResize:!0,autoCenter:!l,fitToView:!0,aspectRatio:!1,topRatio:.5,leftRatio:.5,scrolling:"auto",wrapCSS:"",arrows:!0,closeBtn:!0,closeClick:!1,nextClick:!1,mouseWheel:!0,autoPlay:!1,playSpeed:3e3,preload:3,modal:!1,loop:!0,ajax:{dataType:"html",headers:{"X-fancyBox":!0}},iframe:{scrolling:"auto",preload:!0},swf:{wmode:"transparent",allowfullscreen:"true",allowscriptaccess:"always"},keys:{next:{13:"left",34:"up",39:"left",40:"up"},prev:{8:"right",33:"down",37:"right",38:"down"},close:[27],play:[32],toggle:[70]},direction:{next:"left",prev:"right"},scrollOutside:!0,index:0,type:null,href:null,content:null,title:null,tpl:{wrap:'<div class="fancybox-wrap" tabIndex="-1"><div class="fancybox-skin"><div class="fancybox-outer"><div class="fancybox-inner"></div></div></div></div>',image:'<img class="fancybox-image" src="{href}" alt="" />',iframe:'<iframe id="fancybox-frame{rnd}" name="fancybox-frame{rnd}" class="fancybox-iframe" frameborder="0" vspace="0" hspace="0" webkitAllowFullScreen mozallowfullscreen allowFullScreen'+(a?' allowtransparency="true"':"")+"></iframe>",error:'<p class="fancybox-error">The requested content cannot be loaded.<br/>Please try again later.</p>',closeBtn:'<a title="Close" class="fancybox-item fancybox-close" href="javascript:;"></a>',next:'<a title="Next" class="fancybox-nav fancybox-next" href="javascript:;"><span></span></a>',prev:'<a title="Previous" class="fancybox-nav fancybox-prev" href="javascript:;"><span></span></a>'},openEffect:"fade",openSpeed:250,openEasing:"swing",openOpacity:!0,openMethod:"zoomIn",closeEffect:"fade",closeSpeed:250,closeEasing:"swing",closeOpacity:!0,closeMethod:"zoomOut",nextEffect:"elastic",nextSpeed:250,nextEasing:"swing",nextMethod:"changeIn",prevEffect:"elastic",prevSpeed:250,prevEasing:"swing",prevMethod:"changeOut",helpers:{overlay:!0,title:!0},onCancel:n.noop,beforeLoad:n.noop,afterLoad:n.noop,beforeShow:n.noop,afterShow:n.noop,beforeChange:n.noop,beforeClose:n.noop,afterClose:n.noop},group:{},opts:{},previous:null,coming:null,current:null,isActive:!1,isOpen:!1,isOpened:!1,wrap:null,skin:null,outer:null,inner:null,player:{timer:null,isActive:!1},ajaxLoad:null,imgPreload:null,transitions:{},helpers:{},open:function(e,t){if(e&&(n.isPlainObject(t)||(t={}),!1!==u.close(!0)))return n.isArray(e)||(e=c(e)?n(e).get():[e]),n.each(e,function(i,s){var o={},a,f,l,p,d;"object"===n.type(s)&&(s.nodeType&&(s=n(s)),c(s)?(o={href:s.data("fancybox-href")||s.attr("href"),title:s.data("fancybox-title")||s.attr("title"),isDom:!0,element:s},n.metadata&&n.extend(!0,o,s.metadata())):o=s),a=t.href||o.href||(h(s)?s:null),f=t.title!==r?t.title:o.title||"",p=(l=t.content||o.content)?"html":t.type||o.type,!p&&o.isDom&&(p=s.data("fancybox-type"),p||(p=(p=s.prop("class").match(/fancybox\.(\w+)/))?p[1]:null)),h(a)&&(p||(u.isImage(a)?p="image":u.isSWF(a)?p="swf":"#"===a.charAt(0)?p="inline":h(s)&&(p="html",l=s)),"ajax"===p&&(d=a.split(/\s+/,2),a=d.shift(),d=d.shift())),l||("inline"===p?a?l=n(h(a)?a.replace(/.*(?=#[^\s]+$)/,""):a):o.isDom&&(l=s):"html"===p?l=a:!p&&!a&&o.isDom&&(p="inline",l=s)),n.extend(o,{href:a,type:p,content:l,title:f,selector:d}),e[i]=o}),u.opts=n.extend(!0,{},u.defaults,t),t.keys!==r&&(u.opts.keys=t.keys?n.extend({},u.defaults.keys,t.keys):!1),u.group=e,u._start(u.opts.index)},cancel:function(){var e=u.coming;e&&!1!==u.trigger("onCancel")&&(u.hideLoading(),u.ajaxLoad&&u.ajaxLoad.abort(),u.ajaxLoad=null,u.imgPreload&&(u.imgPreload.onload=u.imgPreload.onerror=null),e.wrap&&e.wrap.stop(!0,!0).trigger("onReset").remove(),u.coming=null,u.current||u._afterZoomOut(e))},close:function(e){u.cancel(),!1!==u.trigger("beforeClose")&&(u.unbindEvents(),u.isActive&&(!u.isOpen||!0===e?(n(".fancybox-wrap").stop(!0).trigger("onReset").remove(),u._afterZoomOut()):(u.isOpen=u.isOpened=!1,u.isClosing=!0,n(".fancybox-item, .fancybox-nav").remove(),u.wrap.stop(!0,!0).removeClass("fancybox-opened"),u.transitions[u.current.closeMethod]())))},play:function(e){var t=function(){clearTimeout(u.player.timer)},n=function(){t(),u.current&&u.player.isActive&&(u.player.timer=setTimeout(u.next,u.current.playSpeed))},r=function(){t(),o.unbind(".player"),u.player.isActive=!1,u.trigger("onPlayEnd")};!0===e||!u.player.isActive&&!1!==e?u.current&&(u.current.loop||u.current.index<u.group.length-1)&&(u.player.isActive=!0,o.bind({"onCancel.player beforeClose.player":r,"onUpdate.player":n,"beforeLoad.player":t}),n(),u.trigger("onPlayStart")):r()},next:function(e){var t=u.current;t&&(h(e)||(e=t.direction.next),u.jumpto(t.index+1,e,"next"))},prev:function(e){var t=u.current;t&&(h(e)||(e=t.direction.prev),u.jumpto(t.index-1,e,"prev"))},jumpto:function(e,t,n){var i=u.current;i&&(e=d(e),u.direction=t||i.direction[e>=i.index?"next":"prev"],u.router=n||"jumpto",i.loop&&(0>e&&(e=i.group.length+e%i.group.length),e%=i.group.length),i.group[e]!==r&&(u.cancel(),u._start(e)))},reposition:function(e,t){var r=u.current,i=r?r.wrap:null,s;i&&(s=u._getPosition(t),e&&"scroll"===e.type?(delete s.position,i.stop(!0,!0).animate(s,200)):(i.css(s),r.pos=n.extend({},r.dim,s)))},update:function(e){var t=e&&e.type,n=!t||"orientationchange"===t;n&&(clearTimeout(f),f=null),u.isOpen&&!f&&(f=setTimeout(function(){var r=u.current;r&&!u.isClosing&&(u.wrap.removeClass("fancybox-tmp"),(n||"load"===t||"resize"===t&&r.autoResize)&&u._setDimension(),"scroll"===t&&r.canShrink||u.reposition(e),u.trigger("onUpdate"),f=null)},n&&!l?0:300))},toggle:function(e){u.isOpen&&(u.current.fitToView="boolean"===n.type(e)?e:!u.current.fitToView,l&&(u.wrap.removeAttr("style").addClass("fancybox-tmp"),u.trigger("onUpdate")),u.update())},hideLoading:function(){o.unbind(".loading"),n("#fancybox-loading").remove()},showLoading:function(){var e,t;u.hideLoading(),e=n('<div id="fancybox-loading"><div></div></div>').click(u.cancel).appendTo("body"),o.bind("keydown.loading",function(e){27===(e.which||e.keyCode)&&(e.preventDefault(),u.cancel())}),u.defaults.fixed||(t=u.getViewport(),e.css({position:"absolute",top:.5*t.h+t.y,left:.5*t.w+t.x}))},getViewport:function(){var t=u.current&&u.current.locked||!1,n={x:s.scrollLeft(),y:s.scrollTop()};return t?(n.w=t[0].clientWidth,n.h=t[0].clientHeight):(n.w=l&&e.innerWidth?e.innerWidth:s.width(),n.h=l&&e.innerHeight?e.innerHeight:s.height()),n},unbindEvents:function(){u.wrap&&c(u.wrap)&&u.wrap.unbind(".fb"),o.unbind(".fb"),s.unbind(".fb")},bindEvents:function(){var e=u.current,t;e&&(s.bind("orientationchange.fb"+(l?"":" resize.fb")+(e.autoCenter&&!e.locked?" scroll.fb":""),u.update),(t=e.keys)&&o.bind("keydown.fb",function(i){var s=i.which||i.keyCode,o=i.target||i.srcElement;if(27===s&&u.coming)return!1;!i.ctrlKey&&!i.altKey&&!i.shiftKey&&!i.metaKey&&(!o||!o.type&&!n(o).is("[contenteditable]"))&&n.each(t,function(t,o){if(1<e.group.length&&o[s]!==r)return u[t](o[s]),i.preventDefault(),!1;if(-1<n.inArray(s,o))return u[t](),i.preventDefault(),!1})}),n.fn.mousewheel&&e.mouseWheel&&u.wrap.bind("mousewheel.fb",function(t,r,i,s){for(var o=n(t.target||null),a=!1;o.length&&!a&&!o.is(".fancybox-skin")&&!o.is(".fancybox-wrap");)a=o[0]&&(!o[0].style.overflow||"hidden"!==o[0].style.overflow)&&(o[0].clientWidth&&o[0].scrollWidth>o[0].clientWidth||o[0].clientHeight&&o[0].scrollHeight>o[0].clientHeight),o=n(o).parent();0!==r&&!a&&1<u.group.length&&!e.canShrink&&(0<s||0<i?u.prev(0<s?"down":"left"):(0>s||0>i)&&u.next(0>s?"up":"right"),t.preventDefault())}))},trigger:function(e,t){var r,i=t||u.coming||u.current;if(i){n.isFunction(i[e])&&(r=i[e].apply(i,Array.prototype.slice.call(arguments,1)));if(!1===r)return!1;i.helpers&&n.each(i.helpers,function(t,r){r&&u.helpers[t]&&n.isFunction(u.helpers[t][e])&&u.helpers[t][e](n.extend(!0,{},u.helpers[t].defaults,r),i)}),o.trigger(e)}},isImage:function(e){return h(e)&&e.match(/(^data:image\/.*,)|(\.(jp(e|g|eg)|gif|png|bmp|webp|svg)((\?|#).*)?$)/i)},isSWF:function(e){return h(e)&&e.match(/\.(swf)((\?|#).*)?$/i)},_start:function(e){var t={},r,i;e=d(e),r=u.group[e]||null;if(!r)return!1;t=n.extend(!0,{},u.opts,r),r=t.margin,i=t.padding,"number"===n.type(r)&&(t.margin=[r,r,r,r]),"number"===n.type(i)&&(t.padding=[i,i,i,i]),t.modal&&n.extend(!0,t,{closeBtn:!1,closeClick:!1,nextClick:!1,arrows:!1,mouseWheel:!1,keys:null,helpers:{overlay:{closeClick:!1}}}),t.autoSize&&(t.autoWidth=t.autoHeight=!0),"auto"===t.width&&(t.autoWidth=!0),"auto"===t.height&&(t.autoHeight=!0),t.group=u.group,t.index=e,u.coming=t;if(!1===u.trigger("beforeLoad"))u.coming=null;else{i=t.type,r=t.href;if(!i)return u.coming=null,u.current&&u.router&&"jumpto"!==u.router?(u.current.index=e,u[u.router](u.direction)):!1;u.isActive=!0;if("image"===i||"swf"===i)t.autoHeight=t.autoWidth=!1,t.scrolling="visible";"image"===i&&(t.aspectRatio=!0),"iframe"===i&&l&&(t.scrolling="scroll"),t.wrap=n(t.tpl.wrap).addClass("fancybox-"+(l?"mobile":"desktop")+" fancybox-type-"+i+" fancybox-tmp "+t.wrapCSS).appendTo(t.parent||"body"),n.extend(t,{skin:n(".fancybox-skin",t.wrap),outer:n(".fancybox-outer",t.wrap),inner:n(".fancybox-inner",t.wrap)}),n.each(["Top","Right","Bottom","Left"],function(e,n){t.skin.css("padding"+n,v(t.padding[e]))}),u.trigger("onReady");if("inline"===i||"html"===i){if(!t.content||!t.content.length)return u._error("content")}else if(!r)return u._error("href");"image"===i?u._loadImage():"ajax"===i?u._loadAjax():"iframe"===i?u._loadIframe():u._afterLoad()}},_error:function(e){n.extend(u.coming,{type:"html",autoWidth:!0,autoHeight:!0,minWidth:0,minHeight:0,scrolling:"no",hasError:e,content:u.coming.tpl.error}),u._afterLoad()},_loadImage:function(){var e=u.imgPreload=new Image;e.onload=function(){this.onload=this.onerror=null,u.coming.width=this.width/u.opts.pixelRatio,u.coming.height=this.height/u.opts.pixelRatio,u._afterLoad()},e.onerror=function(){this.onload=this.onerror=null,u._error("image")},e.src=u.coming.href,!0!==e.complete&&u.showLoading()},_loadAjax:function(){var e=u.coming;u.showLoading(),u.ajaxLoad=n.ajax(n.extend({},e.ajax,{url:e.href,error:function(e,t){u.coming&&"abort"!==t?u._error("ajax",e):u.hideLoading()},success:function(t,n){"success"===n&&(e.content=t,u._afterLoad())}}))},_loadIframe:function(){var e=u.coming,t=n(e.tpl.iframe.replace(/\{rnd\}/g,(new Date).getTime())).attr("scrolling",l?"auto":e.iframe.scrolling).attr("src",e.href);n(e.wrap).bind("onReset",function(){try{n(this).find("iframe").hide().attr("src","//about:blank").end().empty()}catch(e){}}),e.iframe.preload&&(u.showLoading(),t.one("load",function(){n(this).data("ready",1),l||n(this).bind("load.fb",u.update),n(this).parents(".fancybox-wrap").width("100%").removeClass("fancybox-tmp").show(),u._afterLoad()})),e.content=t.appendTo(e.inner),e.iframe.preload||u._afterLoad()},_preloadImages:function(){var e=u.group,t=u.current,n=e.length,r=t.preload?Math.min(t.preload,n-1):0,i,s;for(s=1;s<=r;s+=1)i=e[(t.index+s)%n],"image"===i.type&&i.href&&((new Image).src=i.href)},_afterLoad:function(){var e=u.coming,t=u.current,r,i,s,o,a;u.hideLoading();if(e&&!1!==u.isActive)if(!1===u.trigger("afterLoad",e,t))e.wrap.stop(!0).trigger("onReset").remove(),u.coming=null;else{t&&(u.trigger("beforeChange",t),t.wrap.stop(!0).removeClass("fancybox-opened").find(".fancybox-item, .fancybox-nav").remove()),u.unbindEvents(),r=e.content,i=e.type,s=e.scrolling,n.extend(u,{wrap:e.wrap,skin:e.skin,outer:e.outer,inner:e.inner,current:e,previous:t}),o=e.href;switch(i){case"inline":case"ajax":case"html":e.selector?r=n("<div>").html(r).find(e.selector):c(r)&&(r.data("fancybox-placeholder")||r.data("fancybox-placeholder",n('<div class="fancybox-placeholder"></div>').insertAfter(r).hide()),r=r.show().detach(),e.wrap.bind("onReset",function(){n(this).find(r).length&&r.hide().replaceAll(r.data("fancybox-placeholder")).data("fancybox-placeholder",!1)}));break;case"image":r=e.tpl.image.replace("{href}",o);break;case"swf":r='<object id="fancybox-swf" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="100%" height="100%"><param name="movie" value="'+o+'"></param>',a="",n.each(e.swf,function(e,t){r+='<param name="'+e+'" value="'+t+'"></param>',a+=" "+e+'="'+t+'"'}),r+='<embed src="'+o+'" type="application/x-shockwave-flash" width="100%" height="100%"'+a+"></embed></object>"}(!c(r)||!r.parent().is(e.inner))&&e.inner.append(r),u.trigger("beforeShow"),e.inner.css("overflow","yes"===s?"scroll":"no"===s?"hidden":s),u._setDimension(),u.reposition(),u.isOpen=!1,u.coming=null,u.bindEvents(),u.isOpened?t.prevMethod&&u.transitions[t.prevMethod]():n(".fancybox-wrap").not(e.wrap).stop(!0).trigger("onReset").remove(),u.transitions[u.isOpened?e.nextMethod:e.openMethod](),u._preloadImages()}},_setDimension:function(){var e=u.getViewport(),t=0,r=!1,i=!1,r=u.wrap,s=u.skin,o=u.inner,a=u.current,i=a.width,f=a.height,l=a.minWidth,c=a.minHeight,h=a.maxWidth,m=a.maxHeight,g=a.scrolling,y=a.scrollOutside?a.scrollbarWidth:0,S=a.margin,x=d(S[1]+S[3]),T=d(S[0]+S[2]),N,C,k,L,A,O,M,_,D;r.add(s).add(o).width("auto").height("auto").removeClass("fancybox-tmp"),S=d(s.outerWidth(!0)-s.width()),N=d(s.outerHeight(!0)-s.height()),C=x+S,k=T+N,L=p(i)?(e.w-C)*d(i)/100:i,A=p(f)?(e.h-k)*d(f)/100:f;if("iframe"===a.type){if(D=a.content,a.autoHeight&&1===D.data("ready"))try{D[0].contentWindow.document.location&&(o.width(L).height(9999),O=D.contents().find("body"),y&&O.css("overflow-x","hidden"),A=O.outerHeight(!0))}catch(P){}}else if(a.autoWidth||a.autoHeight)o.addClass("fancybox-tmp"),a.autoWidth||o.width(L),a.autoHeight||o.height(A),a.autoWidth&&(L=o.width()),a.autoHeight&&(A=o.height()),o.removeClass("fancybox-tmp");i=d(L),f=d(A),_=L/A,l=d(p(l)?d(l,"w")-C:l),h=d(p(h)?d(h,"w")-C:h),c=d(p(c)?d(c,"h")-k:c),m=d(p(m)?d(m,"h")-k:m),O=h,M=m,a.fitToView&&(h=Math.min(e.w-C,h),m=Math.min(e.h-k,m)),C=e.w-x,T=e.h-T,a.aspectRatio?(i>h&&(i=h,f=d(i/_)),f>m&&(f=m,i=d(f*_)),i<l&&(i=l,f=d(i/_)),f<c&&(f=c,i=d(f*_))):(i=Math.max(l,Math.min(i,h)),a.autoHeight&&"iframe"!==a.type&&(o.width(i),f=o.height()),f=Math.max(c,Math.min(f,m)));if(a.fitToView)if(o.width(i).height(f),r.width(i+S),e=r.width(),x=r.height(),a.aspectRatio)for(;(e>C||x>T)&&i>l&&f>c&&!(19<t++);)f=Math.max(c,Math.min(m,f-10)),i=d(f*_),i<l&&(i=l,f=d(i/_)),i>h&&(i=h,f=d(i/_)),o.width(i).height(f),r.width(i+S),e=r.width(),x=r.height();else i=Math.max(l,Math.min(i,i-(e-C))),f=Math.max(c,Math.min(f,f-(x-T)));y&&"auto"===g&&f<A&&i+S+y<C&&(i+=y),o.width(i).height(f),r.width(i+S),e=r.width(),x=r.height(),r=(e>C||x>T)&&i>l&&f>c,i=a.aspectRatio?i<O&&f<M&&i<L&&f<A:(i<O||f<M)&&(i<L||f<A),n.extend(a,{dim:{width:v(e),height:v(x)},origWidth:L,origHeight:A,canShrink:r,canExpand:i,wPadding:S,hPadding:N,wrapSpace:x-s.outerHeight(!0),skinSpace:s.height()-f}),!D&&a.autoHeight&&f>c&&f<m&&!i&&o.height("auto")},_getPosition:function(e){var t=u.current,n=u.getViewport(),r=t.margin,i=u.wrap.width()+r[1]+r[3],s=u.wrap.height()+r[0]+r[2],r={position:"absolute",top:r[0],left:r[3]};return t.autoCenter&&t.fixed&&!e&&s<=n.h&&i<=n.w?r.position="fixed":t.locked||(r.top+=n.y,r.left+=n.x),r.top=v(Math.max(r.top,r.top+(n.h-s)*t.topRatio)),r.left=v(Math.max(r.left,r.left+(n.w-i)*t.leftRatio)),r},_afterZoomIn:function(){var e=u.current;e&&(u.isOpen=u.isOpened=!0,u.wrap.css("overflow","visible").addClass("fancybox-opened"),u.update(),(e.closeClick||e.nextClick&&1<u.group.length)&&u.inner.css("cursor","pointer").bind("click.fb",function(t){!n(t.target).is("a")&&!n(t.target).parent().is("a")&&(t.preventDefault(),u[e.closeClick?"close":"next"]())}),e.closeBtn&&n(e.tpl.closeBtn).appendTo(u.skin).bind("click.fb",function(e){e.preventDefault(),u.close()}),e.arrows&&1<u.group.length&&((e.loop||0<e.index)&&n(e.tpl.prev).appendTo(u.outer).bind("click.fb",u.prev),(e.loop||e.index<u.group.length-1)&&n(e.tpl.next).appendTo(u.outer).bind("click.fb",u.next)),u.trigger("afterShow"),!e.loop&&e.index===e.group.length-1?u.play(!1):u.opts.autoPlay&&!u.player.isActive&&(u.opts.autoPlay=!1,u.play()))},_afterZoomOut:function(e){e=e||u.current,n(".fancybox-wrap").trigger("onReset").remove(),n.extend(u,{group:{},opts:{},router:!1,current:null,isActive:!1,isOpened:!1,isOpen:!1,isClosing:!1,wrap:null,skin:null,outer:null,inner:null}),u.trigger("afterClose",e)}}),u.transitions={getOrigPosition:function(){var e=u.current,t=e.element,n=e.orig,r={},i=50,s=50,o=e.hPadding,a=e.wPadding,f=u.getViewport();!n&&e.isDom&&t.is(":visible")&&(n=t.find("img:first"),n.length||(n=t)),c(n)?(r=n.offset(),n.is("img")&&(i=n.outerWidth(),s=n.outerHeight())):(r.top=f.y+(f.h-s)*e.topRatio,r.left=f.x+(f.w-i)*e.leftRatio);if("fixed"===u.wrap.css("position")||e.locked)r.top-=f.y,r.left-=f.x;return r={top:v(r.top-o*e.topRatio),left:v(r.left-a*e.leftRatio),width:v(i+a),height:v(s+o)}},step:function(e,t){var n,r,i=t.prop;r=u.current;var s=r.wrapSpace,o=r.skinSpace;if("width"===i||"height"===i)n=t.end===t.start?1:(e-t.start)/(t.end-t.start),u.isClosing&&(n=1-n),r="width"===i?r.wPadding:r.hPadding,r=e-r,u.skin[i](d("width"===i?r:r-s*n)),u.inner[i](d("width"===i?r:r-s*n-o*n))},zoomIn:function(){var e=u.current,t=e.pos,r=e.openEffect,i="elastic"===r,s=n.extend({opacity:1},t);delete s.position,i?(t=this.getOrigPosition(),e.openOpacity&&(t.opacity=.1)):"fade"===r&&(t.opacity=.1),u.wrap.css(t).animate(s,{duration:"none"===r?0:e.openSpeed,easing:e.openEasing,step:i?this.step:null,complete:u._afterZoomIn})},zoomOut:function(){var e=u.current,t=e.closeEffect,n="elastic"===t,r={opacity:.1};n&&(r=this.getOrigPosition(),e.closeOpacity&&(r.opacity=.1)),u.wrap.animate(r,{duration:"none"===t?0:e.closeSpeed,easing:e.closeEasing,step:n?this.step:null,complete:u._afterZoomOut})},changeIn:function(){var e=u.current,t=e.nextEffect,n=e.pos,r={opacity:1},i=u.direction,s;n.opacity=.1,"elastic"===t&&(s="down"===i||"up"===i?"top":"left","down"===i||"right"===i?(n[s]=v(d(n[s])-200),r[s]="+=200px"):(n[s]=v(d(n[s])+200),r[s]="-=200px")),"none"===t?u._afterZoomIn():u.wrap.css(n).animate(r,{duration:e.nextSpeed,easing:e.nextEasing,complete:u._afterZoomIn})},changeOut:function(){var e=u.previous,t=e.prevEffect,r={opacity:.1},i=u.direction;"elastic"===t&&(r["down"===i||"up"===i?"top":"left"]=("up"===i||"left"===i?"-":"+")+"=200px"),e.wrap.animate(r,{duration:"none"===t?0:e.prevSpeed,easing:e.prevEasing,complete:function(){n(this).trigger("onReset").remove()}})}},u.helpers.overlay={defaults:{closeClick:!0,speedOut:200,showEarly:!0,css:{},locked:!l,fixed:!0},overlay:null,fixed:!1,el:n("html"),create:function(e){e=n.extend({},this.defaults,e),this.overlay&&this.close(),this.overlay=n('<div class="fancybox-overlay"></div>').appendTo(u.coming?u.coming.parent:e.parent),this.fixed=!1,e.fixed&&u.defaults.fixed&&(this.overlay.addClass("fancybox-overlay-fixed"),this.fixed=!0)},open:function(e){var t=this;e=n.extend({},this.defaults,e),this.overlay?this.overlay.unbind(".overlay").width("auto").height("auto"):this.create(e),this.fixed||(s.bind("resize.overlay",n.proxy(this.update,this)),this.update()),e.closeClick&&this.overlay.bind("click.overlay",function(e){if(n(e.target).hasClass("fancybox-overlay"))return u.isActive?u.close():t.close(),!1}),this.overlay.css(e.css).show()},close:function(){var e,t;s.unbind("resize.overlay"),this.el.hasClass("fancybox-lock")&&(n(".fancybox-margin").removeClass("fancybox-margin"),e=s.scrollTop(),t=s.scrollLeft(),this.el.removeClass("fancybox-lock"),s.scrollTop(e).scrollLeft(t)),n(".fancybox-overlay").remove().hide(),n.extend(this,{overlay:null,fixed:!1})},update:function(){var e="100%",n;this.overlay.width(e).height("100%"),a?(n=Math.max(t.documentElement.offsetWidth,t.body.offsetWidth),o.width()>n&&(e=o.width())):o.width()>s.width()&&(e=o.width()),this.overlay.width(e).height(o.height())},onReady:function(e,t){var r=this.overlay;n(".fancybox-overlay").stop(!0,!0),r||this.create(e),e.locked&&this.fixed&&t.fixed&&(r||(this.margin=o.height()>s.height()?n("html").css("margin-right").replace("px",""):!1),t.locked=this.overlay.append(t.wrap),t.fixed=!1),!0===e.showEarly&&this.beforeShow.apply(this,arguments)},beforeShow:function(e,t){var r,i;t.locked&&(!1!==this.margin&&(n("*").filter(function(){return"fixed"===n(this).css("position")&&!n(this).hasClass("fancybox-overlay")&&!n(this).hasClass("fancybox-wrap")}).addClass("fancybox-margin"),this.el.addClass("fancybox-margin")),r=s.scrollTop(),i=s.scrollLeft(),this.el.addClass("fancybox-lock"),s.scrollTop(r).scrollLeft(i)),this.open(e)},onUpdate:function(){this.fixed||this.update()},afterClose:function(e){this.overlay&&!u.coming&&this.overlay.fadeOut(e.speedOut,n.proxy(this.close,this))}},u.helpers.title={defaults:{type:"float",position:"bottom"},beforeShow:function(e){var t=u.current,r=t.title,i=e.type;n.isFunction(r)&&(r=r.call(t.element,t));if(h(r)&&""!==n.trim(r)){t=n('<div class="fancybox-title fancybox-title-'+i+'-wrap">'+r+"</div>");switch(i){case"inside":i=u.skin;break;case"outside":i=u.wrap;break;case"over":i=u.inner;break;default:i=u.skin,t.appendTo("body"),a&&t.width(t.width()),t.wrapInner('<span class="child"></span>'),u.current.margin[2]+=Math.abs(d(t.css("margin-bottom")))}t["top"===e.position?"prependTo":"appendTo"](i)}}},n.fn.fancybox=function(e){var t,r=n(this),i=this.selector||"",s=function(s){var o=n(this).blur(),a=t,f,l;!s.ctrlKey&&!s.altKey&&!s.shiftKey&&!s.metaKey&&!o.is(".fancybox-wrap")&&(f=e.groupAttr||"data-fancybox-group",l=o.attr(f),l||(f="rel",l=o.get(0)[f]),l&&""!==l&&"nofollow"!==l&&(o=i.length?n(i):r,o=o.filter("["+f+'="'+l+'"]'),a=o.index(this)),e.index=a,!1!==u.open(o,e)&&s.preventDefault())};return e=e||{},t=e.index||0,!i||!1===e.live?r.unbind("click.fb-start").bind("click.fb-start",s):o.undelegate(i,"click.fb-start").delegate(i+":not('.fancybox-item, .fancybox-nav')","click.fb-start",s),this.filter("[data-fancybox-start=1]").trigger("click"),this},o.ready(function(){var t,s;n.scrollbarWidth===r&&(n.scrollbarWidth=function(){var e=n('<div style="width:50px;height:50px;overflow:auto"><div/></div>').appendTo("body"),t=e.children(),t=t.innerWidth()-t.height(99).innerWidth();return e.remove(),t});if(n.support.fixedPosition===r){t=n.support,s=n('<div style="position:fixed;top:20px;"></div>').appendTo("body");var o=20===s[0].offsetTop||15===s[0].offsetTop;s.remove(),t.fixedPosition=o}n.extend(u.defaults,{scrollbarWidth:n.scrollbarWidth(),fixed:n.support.fixedPosition,parent:n("body")}),t=n(e).width(),i.addClass("fancybox-lock-test"),s=n(e).width(),i.removeClass("fancybox-lock-test"),n("<style type='text/css'>.fancybox-margin{margin-right:"+(s-t)+"px;}</style>").appendTo("head")})}(window,document,jQuery),define("fancy-box",function(){}),define("layer-list",["jquery","message-bus","layout","jquery-ui","fancy-box"],function(e,t,n){var r=new Array,i=null,s=n.layers;return i=e("<div/>").attr("id","all_layers"),i.addClass("ui-accordion-icons"),i.accordion({animate:!1,heightStyle:"content",collapsible:!0,active:!1}),s.append(i),t.listen("add-group",function(n,r){var s,o,u,a,f;s=e("<div/>").html(r.name).disableSelection(),r.hasOwnProperty("infoLink")&&(infoButton=e('<a style="position:absolute;top:3px;right:4px;width:16px;height:16px;padding:0;" class="layer_info_button" href="'+r.infoLink+'"></a>'),infoButton.click(function(e){e.stopPropagation()}),infoButton.fancybox({autoScale:!1,openEffect:"elastic",closeEffect:"elastic",type:"ajax",overlayOpacity:.5}),s.append(infoButton)),o=e("<table/>"),o.attr("id","group-content-table-"+r.id),r.hasOwnProperty("parentId")?(u=r.parentId,a=e("#group-content-table-"+u),a.length==0&&t.send("error","Group "+r.name+" references nonexistent group: "+u),a.append(s).append(o)):(i.append(s),f=e("<div/>").css("padding","10px 2px 10px 2px"),f.append(o),i.append(f).accordion("refresh"))}),t.listen("add-portal-layer",function(n,s){var o,u,a,a,f,l,c,h,p;o=e("#group-content-table-"+s.groupId),o.length==0?t.send("error","Layer "+s.label+" references nonexistent group: "+s.groupId):(u=e("<tr/>").attr("id","layer-row-"+s.id).addClass("layer_row"),a=e("<td/>").addClass("layer_legend"),u.append(a),f=e("<td/>").css("width","16px"),l=e("<div/>").addClass("layer_visibility"),s.active&&l.addClass("checked"),l.mousedown(function(){l.addClass("mousedown")}).mouseup(function(){l.removeClass("mousedown")}).mouseenter(function(){l.addClass("in")}).mouseleave(function(){l.removeClass("in")}).click(function(){l.toggleClass("checked"),s.active=l.hasClass("checked"),t.send("portal-layer-visibility",s)}),f.append(l),u.append(f),c=e("<td/>").addClass("layer_name"),c.html(s.label),u.append(c),h=e("<td/>").addClass("layer_info"),s.hasOwnProperty("infoLink")&&(p=e("<a/>").attr("href",s.infoLink),p.addClass("layer_info_button"),p.fancybox({closeBtn:"true",openEffect:"elastic",closeEffect:"elastic",type:"iframe",overlayOpacity:.5}),h.append(p)),u.append(h),e.each(s.wmsLayers,function(e,t){t.hasOwnProperty("timestamps")&&r.push(t)}),o.append(u),i.accordion("refresh"))}),t.listen("time-slider.selection",function(n,i){for(var s=0;s<r.length;s++){var o=r[s],u=o.timestamps,a=null;u.sort();for(var f=0;f<u.length;f++){var l=u[f],c=new Date;c.setISO8601(l);if(!(c<=i))break;a=c}a==null&&(a=new Date,a.setISO8601(u[0]));var h=e("#layer-row-"+o.id+" .layer_name");h.find("span").remove(),e("<span/>").html(" ("+a.getFullYear()+")").appendTo(h),t.send("layer-timestamp-selected",[o.id,a])}}),t.listen("show-layer-list",function(e,t){s.show()}),t.listen("hide-layer-list",function(e,t){s.hide()}),s}),define("info-control",["map","message-bus"],function(e,t){var n=new OpenLayers.Control.WMSGetFeatureInfo({url:null,title:"Identify features by clicking",queryVisible:!0,infoFormat:"application/vnd.ogc.gml",hover:!1,drillDown:!0,maxFeatures:5,handlerOptions:{click:{single:!0,"double":!1}},eventListeners:{getfeatureinfo:function(e){e.features&&t.send("info-features",[e.features,e.xy.x,e.xy.y])}},formatOptions:{typeName:"XXX",featureNS:"http://www.openplans.org/unredd"}});t.send("set-default-exclusive-control",[n]),t.send("activate-default-exclusive-control"),t.listen("maplayer-added",function(e,t,r){r.queryable&&(n.layers==null&&(n.layers=new Array),n.layers.push(t),n.url==null&&(n.url=r.url))})}),define("info-dialog",["jquery","message-bus","map"],function(e,t,n){t.listen("info-features",function(r,i,s,o){var u,a,f,l,c,h;c=new OpenLayers.Projection("EPSG:4326"),h=new OpenLayers.Projection("EPSG:900913");for(u=0;u<i.length;u++)i[u].geometry.transform(c,h);a=e("#info_popup"),a.length===0?a=e("<div/>").attr("id","info_popup"):a.empty(),a.dialog({closeOnEscape:!0,width:300,resizable:!1,close:function(e,r){t.send("clear-highlighted-features"),n.getLayer("Highlighted Features").destroyFeatures()},autoOpen:!1}),e.each(i,function(n,r){var i,s,o,u,f,l,c,h;i=r.gml.featureNSPrefix+":"+r.gml.featureType,s=e("<table/>"),o=e("<tr/>"),u=e('<td colspan="2" class="area_name" />'),o.append(u),s.append(o),s.mouseenter(function(){t.send("highlight-feature",r)}),s.mouseleave(function(){t.send("clear-highlighted-features")}),h=e("<table/>"),e.each(r.attributes,function(t,n){var r=e("<td/>").html(t),i=e("<td/>").html(":&nbsp;&nbsp;&nbsp;"+n),s=e("<tr/>").append(r).append(i);h.append(s)}),u.append(h),f=e("<tr/>"),l=e('<td class="td_left" id="indicator_buttons_container_'+n+'"/>'),f.append(l),s.append(f),l.append('<img src="styles/images/ajax-loader.gif" alt="wait"/>'),t.send("ajax",{url:"indicators?layerId="+i,success:function(t,s,o){var u,a;for(u=0;u<t.length;u++)a="stats_link_"+n+"_"+t[u].id,e("#indicator_buttons_container_"+n).append('<a style="color:white" class="feature_link fancybox.iframe" id="'+a+'" href="indicator?objectId='+r.attributes[t[u].fieldId]+"&layerId="+i+"&indicatorId="+t[u].id+'">'+t[u].name+"</a>"),e("#"+a).fancybox({maxWidth:840,maxHeight:600,fitToView:!1,width:840,height:590,autoSize:!1,closeClick:!1,openEffect:"none",closeEffect:"fade"})},errorMsg:"Could not obtain the indicator",complete:function(){e("#indicator_buttons_container_"+n).children("img").remove()}}),c=e('<td class="td_right"/>'),c.append('<a style="color:white" class="feature_link" href="#" id="zoom_to_feature_'+n+'">Zoom to area</a>'),f.append(c),a.append(s),e("#zoom_to_feature_"+n).click(function(){t.send("zoom-to",r.geometry.getBounds().scale(1.2))})}),i.length===0?a.dialog("close"):a.dialog("isOpen")||(f=s+100,l=o-200,a.dialog("option","position",[f,l]),a.dialog("open"),a.dialog("moveToTop"))}),t.listen("highlight-feature",function(e,t){var r=n.getLayer("Highlighted Features");r.removeAllFeatures(),r.addFeatures(t),r.redraw()}),t.listen("clear-highlighted-features",function(){var e=n.getLayer("Highlighted Features");e.removeAllFeatures(),e.redraw()})}),define("center",["map","message-bus"],function(e,t){var n=function(){var t=new OpenLayers.Projection("EPSG:4326"),n=new OpenLayers.LonLat(24,-4);n.transform(t,e.projection),e.setCenter(n,5)};t.listen("layers-loaded",n),t.listen("initial-zoom",n)}),define("zoom-bar",["jquery","message-bus"],function(e,t){var n=e("<a/>").attr("id","zoom_out").appendTo("body");n.click(function(){t.send("zoom-out")});var r=e("<a/>").attr("id","zoom_in").appendTo("body");r.click(function(){t.send("zoom-in")});var i=e("<a/>").attr("id","zoom_to_max_extent").appendTo("body");i.click(function(){t.send("initial-zoom")})}),define("layer-list-selector",["jquery","message-bus","layout","customization","i18n","jquery-ui","layer-list"],function(e,t,n,r,i,s,o){var u=n.layerListSelector,a=e('<input type="radio" id="show_all_layers" name="layer_list_selector" checked="checked"><label for="show_all_layers">'+i.layers+"</label>"),f=e('<input type="radio" id="show_active_layers" name="layer_list_selector"><label for="show_active_layers">'+i.selected_layers+"</label>");return u.append(a),u.append(f),a.click(function(){t.send("show-layer-list"),t.send("hide-active-layer-list")}),f.click(function(){t.send("show-active-layer-list"),t.send("hide-layer-list")}),u.buttonset(),u.show(),u}),define("active-layer-list",["jquery","message-bus","layout","map","jquery-ui"],function(e,t,n,r){var i=n.activeLayers,s=e("<div/>").attr("id","active_layers"),o=e("<h3/>").html("Selected layers");s.append(o);var u=e("<div/>");s.append(u);var a=e('<table style="width:100%;margin:auto"></table>');return u.append(a),s.accordion({collapsible:!1,autoHeight:!1,animated:!1,heightStyle:"content",create:function(t,n){e("#active_layers_pane .ui-icon-triangle-1-s").hide()}}),i.append(s),t.listen("layer-visibility",function(n,i,o){function f(n){var o=e('<tr id="'+n+'_tr1"><td>'+i.name+"</td></tr>"),u=e('<div style="margin-top:4px; margin-bottom:12px;" id="layerId_transparency_slider"></div>'),f=e('<td colspan="2"></td>');f.append(u);var l=e('<tr id="'+n+'_tr2"></tr>');l.append(f),a.append(o),a.append(l),e(u).slider({min:0,max:100,value:100*r.getLayer(n).opacity,slide:function(e,n){t.send("transparency-slider-changed",[i,n.value/100])}}),s.accordion("refresh")}function l(t){e("#"+t+"_tr1").remove(),e("#"+t+"_tr2").remove()}var u=i.id;o?f(u):l(u)}),t.listen("show-active-layer-list",function(e,t){s.accordion("refresh"),i.show()}),t.listen("hide-active-layer-list",function(e,t){i.hide()}),s}),require.config({baseUrl:"modules",urlArgs:"bust="+(new Date).getTime(),paths:{jquery:"./js/jquery-2.1.0.js","jquery-ui":"./js/jquery-ui-1.10.3.js","fancy-box":"../js/jquery.fancybox.pack",openlayers:"../js/OpenLayers/OpenLayers.debug",mustache:"../js/jquery.mustache"},shim:{"fancy-box":["jquery"],mustache:["jquery"]}}),require(["customization"]),define("main-optimizer",function(){});